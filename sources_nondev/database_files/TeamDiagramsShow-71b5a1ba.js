import{r as ft,_ as gt,b as ht,B as vt,C as yt,a as _t,w as bt,u as wt}from"./Editor-eb89fe0f.js";import{B as xt}from"./BaseHead-46c51054.js";import{m as Q,B as te,g as Te,f as me,i as St,j as Tt,k as Ce,h as $t}from"./app-661dd882.js";import{B as Ue}from"./BaseSpinner-45530dc1.js";import{B as ae}from"./BaseSvgIcon-3b58455f.js";import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";import{R as X,a3 as h,S as o,a4 as D,Y as p,U as t,$ as H,V as b,W as he,al as Je,T as v,a6 as M,X as c,ag as Me,k as Ke,i as De,ap as Oe,a5 as y,a7 as Z,a8 as ne,Z as oe,aa as kt,r as ie,ai as It,f as se,ab as Ne,ac as Pe,aq as Ze,ar as Ct,ao as fe,a2 as Bt,ak as Dt,j as Et,as as et,at as Vt,a9 as Lt,w as tt,ae as ce,b as Se}from"./index.esm-4dcaccf3.js";import{M as At,B as Ut}from"./BaseMenu-cb81a806.js";import{L as Ee,B as Mt,S as Re}from"./statamic-urls-e4aac463.js";import{B as be,a as ve}from"./BaseSvgImage-7cdda525.js";import{u as le,M as Ot,W as je}from"./use-team-in-url-78771335.js";import{B as we}from"./BaseButtonSolid-7d99f2a9.js";import{B as st}from"./BaseCardStatus-bedfa41d.js";import{B as ze}from"./BaseModal-90243189.js";import{B as at}from"./BaseLayout-71b4d9d7.js";import{B as ot}from"./BaseInput-fcb7e685.js";import{_ as Nt}from"./Label-43647b22.js";import{B as it}from"./BaseAlertError-5c13e689.js";import{u as Be}from"./use-blueprint-driver-transforms-5a947102.js";import{D as Pt,_ as Ge}from"./joint-plus-2422b6af.js";import{B as Fe,a as Rt,F as jt}from"./BaseListboxDataDriven-0da3894d.js";import{_ as zt}from"./ActionMessage-b254b993.js";import{u as Ft}from"./use-current-team-2a8bf787.js";import{B as Gt}from"./BasePopover-22de608c.js";import{N as qt}from"./NavbarUserDropdown-37f0b991.js";import{R as Ht}from"./role-permissions-feb7b1ca.js";import{D as ge,_ as nt,a as Wt,b as Qt,c as Xt}from"./ComboboxTeamMembershipsAndGroups-b391c683.js";import{L as rt}from"./LabelGuest-94fd857d.js";import"./vue-resize.esm-903d13a9.js";import"./Checkbox-06b54ec2.js";import"./_baseFlatten-e5cb9b58.js";import"./BaseButtonSecondary-80093306.js";import"./headlessui-float-afd6f717.js";import"./use-text-value-460f9583.js";import"./BaseFieldErrors-601b2e42.js";import"./Button-03e53c17.js";import"./Input-d5846cb4.js";import"./ValidationErrors-ccdf439b.js";import"./Banner-82979b90.js";import"./combobox-ddd1a678.js";import"./form-a9b2eced.js";const Yt=X({components:{BaseSvgIcon:ae,MenuItem:At},props:{icon:{type:String,required:!1,default:null},iconSize:{type:Number,required:!1,default:1},disabled:{type:Boolean,default:!1},href:{type:String,required:!1,default:null},newTab:{type:Boolean,default:!1},isAccent:{type:Boolean,default:!1}}}),Jt=["href","target"];function Kt(e,s,d,g,r,u){const i=h("BaseSvgIcon"),a=h("MenuItem");return o(),D(a,{class:"block text-gray-600"},{default:p(({active:l})=>[t("a",Je(e.$attrs,{class:["flex h-full w-full select-none items-center px-4 py-2",{"hover:cursor-pointer":!e.disabled,"hover:cursor-not-allowed":e.disabled,"bg-gray-100 text-indigo-600":l}],href:e.disabled?null:e.href,target:e.href&&e.newTab?"_blank":"_self"}),[e.icon?(o(),D(i,{key:0,class:H(["mr-2",{"text-gray-400":!l&&!e.isAccent,"text-teal-400":e.isAccent,"bg-gray-100 text-indigo-600":l&&!e.isAccent}]),icon:e.icon,size:e.iconSize},null,8,["class","icon","size"])):b("",!0),he(e.$slots,"default")],16,Jt)]),_:3})}const Zt=W(Yt,[["render",Kt]]),Le={LARAVEL_MIGRATION:"laravel-migration",LARAVEL_BLUEPRINT:"laravel-blueprint",ADONIS_MIGRATION:"adonis-migration"},qe={PENDING:"pending",COMPLETED:"completed",FAILED:"failed"},es={},ts={href:"/roadmap",target:"_blank"},ss=t("span",{class:"mr-2 inline-block rounded-full bg-yellow-200 px-3 py-1 text-sm font-semibold text-yellow-800"},"Coming Soon",-1),as=[ss];function os(e,s){return o(),v("a",ts,as)}const is=W(es,[["render",os]]);const ns=X({components:{LabelPro:Ee,LabelComingSoon:is},props:{exportType:{type:Object,required:!0},isSelected:{type:Boolean,required:!0}},emits:["click"]}),rs={key:0,class:"tick absolute z-50 grow-0 text-base text-indigo-600 opacity-50"},ls=t("svg",{class:"h-8 w-8",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1),ds=[ls],us={class:"mb-2 mt-5 text-gray-500"},cs={key:0,style:{height:"3rem"}},ms={key:1,style:{height:"3rem"},class:"w-full"},ps=["src"],fs={class:"mt-1 px-3 pb-3 text-base"},gs={key:1,class:"mb-2"},hs={key:2},vs={key:3},ys=t("span",{class:"mb-2 inline-block rounded-full bg-indigo-lightest px-3 py-1 text-sm font-semibold text-grey-darker"},"✨ Beta",-1),_s=[ys];function bs(e,s,d,g,r,u){const i=h("LabelComingSoon"),a=h("LabelPro");return o(),v("div",{class:H(["export-type-card relative flex cursor-pointer flex-col rounded-lg border-b-2 border-l-2 border-r-2 border-gray-300 shadow-md hover:shadow-xl",{"text-gray-500":!e.exportType.live,"text-gray-700":e.exportType.live,"border-indigo-600":e.isSelected}]),onClick:s[0]||(s[0]=Me(l=>e.$emit("click"),["stop"]))},[t("div",{class:H(["rounded-t border-t-2 px-2 py-2 text-center text-lg font-semibold",{"border-emerald-500 bg-gray-200 text-gray-700":!e.isSelected,"border-indigo-600 bg-indigo-600 text-indigo-100":e.isSelected}])},M(e.exportType.name),3),e.isSelected?(o(),v("span",rs,ds)):b("",!0),t("div",null,[t("div",us,[e.exportType.icon?(o(),v("div",cs,[t("i",{class:H(["text-5xl",{[e.exportType.icon]:!0,"text-indigo-800 opacity-75":e.isSelected}])},null,2)])):b("",!0),e.exportType.svg?(o(),v("div",ms,[t("img",{class:"mx-auto",src:e.exportType.svg},null,8,ps)])):b("",!0)])]),t("div",fs,M(e.exportType.description),1),e.exportType.live?b("",!0):(o(),v("div",gs,[c(i)])),"pro"in e.exportType&&e.exportType.pro?(o(),v("div",hs,[c(a,{class:"mb-2","key-for-access":e.exportType.pro},null,8,["key-for-access"])])):b("",!0),e.exportType.beta?(o(),v("div",vs,_s)):b("",!0)],2)}const lt=W(ns,[["render",bs]]);var dt={exports:{}};(function(e){e.exports=function(s){var d={};function g(r){if(d[r])return d[r].exports;var u=d[r]={i:r,l:!1,exports:{}};return s[r].call(u.exports,u,u.exports,g),u.l=!0,u.exports}return g.m=s,g.c=d,g.d=function(r,u,i){g.o(r,u)||Object.defineProperty(r,u,{enumerable:!0,get:i})},g.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},g.t=function(r,u){if(u&1&&(r=g(r)),u&8||u&4&&typeof r=="object"&&r&&r.__esModule)return r;var i=Object.create(null);if(g.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:r}),u&2&&typeof r!="string")for(var a in r)g.d(i,a,(function(l){return r[l]}).bind(null,a));return i},g.n=function(r){var u=r&&r.__esModule?function(){return r.default}:function(){return r};return g.d(u,"a",u),u},g.o=function(r,u){return Object.prototype.hasOwnProperty.call(r,u)},g.p="",g(g.s="fb15")}({"0549":function(s,d,g){var r=g("4bad");d=r(!1),d.push([s.i,".fade-enter-active[data-v-2964abc9],.fade-leave-active[data-v-2964abc9]{-webkit-transition:opacity .3s;transition:opacity .3s}.fade-enter[data-v-2964abc9],.fade-leave-to[data-v-2964abc9]{opacity:0}.velmld-overlay[data-v-2964abc9]{position:absolute;z-index:3000;margin:0;top:0;right:0;bottom:0;left:0;-webkit-transition:opacity .3s;transition:opacity .3s}.velmld-spinner[data-v-2964abc9]{top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);position:absolute;text-align:center}.velmld-full-screen[data-v-2964abc9]{position:fixed}",""]),s.exports=d},"0ef1":function(s,d,g){g("bf56")},"499e":function(s,d,g){g.r(d);function r(L,$){for(var N=[],j={},R=0;R<$.length;R++){var G=$[R],z=G[0],re=G[1],Y=G[2],pe=G[3],K={id:L+":"+R,css:re,media:Y,sourceMap:pe};j[z]?j[z].parts.push(K):N.push(j[z]={id:z,parts:[K]})}return N}g.d(d,"default",function(){return B});var u=typeof document<"u";if(typeof DEBUG<"u"&&DEBUG&&!u)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},a=u&&(document.head||document.getElementsByTagName("head")[0]),l=null,m=0,x=!1,w=function(){},k=null,C="data-vue-ssr-id",f=typeof navigator<"u"&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function B(L,$,N,j){x=N,k=j||{};var R=r(L,$);return U(R),function(z){for(var re=[],Y=0;Y<R.length;Y++){var pe=R[Y],K=i[pe.id];K.refs--,re.push(K)}z?(R=r(L,z),U(R)):R=[];for(var Y=0;Y<re.length;Y++){var K=re[Y];if(K.refs===0){for(var ue=0;ue<K.parts.length;ue++)K.parts[ue]();delete i[K.id]}}}}function U(L){for(var $=0;$<L.length;$++){var N=L[$],j=i[N.id];if(j){j.refs++;for(var R=0;R<j.parts.length;R++)j.parts[R](N.parts[R]);for(;R<N.parts.length;R++)j.parts.push(T(N.parts[R]));j.parts.length>N.parts.length&&(j.parts.length=N.parts.length)}else{for(var G=[],R=0;R<N.parts.length;R++)G.push(T(N.parts[R]));i[N.id]={id:N.id,refs:1,parts:G}}}}function E(){var L=document.createElement("style");return L.type="text/css",a.appendChild(L),L}function T(L){var $,N,j=document.querySelector("style["+C+'~="'+L.id+'"]');if(j){if(x)return w;j.parentNode.removeChild(j)}if(f){var R=m++;j=l||(l=E()),$=q.bind(null,j,R,!1),N=q.bind(null,j,R,!0)}else j=E(),$=ee.bind(null,j),N=function(){j.parentNode.removeChild(j)};return $(L),function(z){if(z){if(z.css===L.css&&z.media===L.media&&z.sourceMap===L.sourceMap)return;$(L=z)}else N()}}var P=function(){var L=[];return function($,N){return L[$]=N,L.filter(Boolean).join(`
`)}}();function q(L,$,N,j){var R=N?"":j.css;if(L.styleSheet)L.styleSheet.cssText=P($,R);else{var G=document.createTextNode(R),z=L.childNodes;z[$]&&L.removeChild(z[$]),z.length?L.insertBefore(G,z[$]):L.appendChild(G)}}function ee(L,$){var N=$.css,j=$.media,R=$.sourceMap;if(j&&L.setAttribute("media",j),k.ssrId&&L.setAttribute(C,$.id),R&&(N+=`
/*# sourceURL=`+R.sources[0]+" */",N+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(R))))+" */"),L.styleSheet)L.styleSheet.cssText=N;else{for(;L.firstChild;)L.removeChild(L.firstChild);L.appendChild(document.createTextNode(N))}}},"4bad":function(s,d,g){s.exports=function(i){var a=[];return a.toString=function(){return this.map(function(m){var x=r(m,i);return m[2]?"@media ".concat(m[2]," {").concat(x,"}"):x}).join("")},a.i=function(l,m,x){typeof l=="string"&&(l=[[null,l,""]]);var w={};if(x)for(var k=0;k<this.length;k++){var C=this[k][0];C!=null&&(w[C]=!0)}for(var f=0;f<l.length;f++){var B=[].concat(l[f]);x&&w[B[0]]||(m&&(B[2]?B[2]="".concat(m," and ").concat(B[2]):B[2]=m),a.push(B))}},a};function r(i,a){var l=i[1]||"",m=i[3];if(!m)return l;if(a&&typeof btoa=="function"){var x=u(m),w=m.sources.map(function(k){return"/*# sourceURL=".concat(m.sourceRoot||"").concat(k," */")});return[l].concat(w).concat([x]).join(`
`)}return[l].join(`
`)}function u(i){var a=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a);return"/*# ".concat(l," */")}},"4d5e":function(s,d,g){g("bf31")},8875:function(s,d,g){var r,u,i;(function(a,l){u=[],r=l,i=typeof r=="function"?r.apply(d,u):r,i!==void 0&&(s.exports=i)})(typeof self<"u"?self:this,function(){function a(){var l=Object.getOwnPropertyDescriptor(document,"currentScript");if(!l&&"currentScript"in document&&document.currentScript||l&&l.get!==a&&document.currentScript)return document.currentScript;try{throw new Error}catch(q){var m=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,x=/@([^@]*):(\d+):(\d+)\s*$/ig,w=m.exec(q.stack)||x.exec(q.stack),k=w&&w[1]||!1,C=w&&w[2]||!1,f=document.location.href.replace(document.location.hash,""),B,U,E,T=document.getElementsByTagName("script");k===f&&(B=document.documentElement.outerHTML,U=new RegExp("(?:[^\\n]+?\\n){0,"+(C-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),E=B.replace(U,"$1").trim());for(var P=0;P<T.length;P++)if(T[P].readyState==="interactive"||T[P].src===k||k===f&&T[P].innerHTML&&T[P].innerHTML.trim()===E)return T[P];return null}}return a})},"8bbf":function(s,d){s.exports=ft},bf31:function(s,d,g){var r=g("0549");typeof r=="string"&&(r=[[s.i,r,""]]),r.locals&&(s.exports=r.locals);var u=g("499e").default;u("53e60f72",r,!0,{sourceMap:!1,shadowMode:!1})},bf56:function(s,d,g){var r=g("c06e");typeof r=="string"&&(r=[[s.i,r,""]]),r.locals&&(s.exports=r.locals);var u=g("499e").default;u("1d100946",r,!0,{sourceMap:!1,shadowMode:!1})},c06e:function(s,d,g){var r=g("4bad");d=r(!1),d.push([s.i,".velmld-parent{position:relative!important}",""]),s.exports=d},fb15:function(s,d,g){if(g.r(d),typeof window<"u"){var r=window.document.currentScript;{var u=g("8875");r=u(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:u})}var i=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(g.p=i[1])}var a=g("8bbf");const l=Object(a.withScopeId)("data-v-2964abc9");Object(a.pushScopeId)("data-v-2964abc9");const m={class:"velmld-spinner"};Object(a.popScopeId)();const x=l((S,I,n,V,A,F)=>(Object(a.openBlock)(),Object(a.createBlock)(a.Transition,{name:"fade"},{default:l(()=>[Object(a.withDirectives)(Object(a.createVNode)("div",{class:[{"velmld-full-screen":n.isFullScreen},"velmld-overlay"],style:{backgroundColor:n.backgroundColor},ref:"velmld"},[Object(a.createVNode)("div",m,[Object(a.renderSlot)(S.$slots,"default",{},()=>[(Object(a.openBlock)(),Object(a.createBlock)(Object(a.resolveDynamicComponent)(n.spinner),{color:n.color,size:`${n.size}px`,duration:`${n.duration}s`},null,8,["color","size","duration"]))]),n.text.length?(Object(a.openBlock)(),Object(a.createBlock)("div",{key:0,style:{color:n.color,...n.textStyle}},Object(a.toDisplayString)(n.text),5)):Object(a.createCommentVNode)("",!0)])],6),[[a.vShow,A.isActive||A.isActiveDelay]])]),_:3})));function w(S,I,n,V,A,F){return Object(a.openBlock)(),Object(a.createBlock)("svg",{version:"1.1",id:"loader-1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:n.size,height:n.size,viewBox:"0 0 50 50",style:{"enable-background":"new 0 0 50 50"},"xml:space":"preserve"},[Object(a.createVNode)("path",{fill:n.color,d:"M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z"},[Object(a.createVNode)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 25 25",to:"360 25 25",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"])],8,["width","height"])}var k={name:"spinner",props:{color:{type:String,default:"#CCC"},size:{type:String,default:"40px"},duration:{type:String,default:"0.6s"}}};k.render=w,k.__file="src/loaders/spinner.vue";var C=k;function f(S,I,n,V,A,F){return Object(a.openBlock)(),Object(a.createBlock)("svg",{version:"1.1",id:"loader-1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:n.size,height:n.size,viewBox:"0 0 40 40","enable-background":"new 0 0 40 40","xml:space":"preserve"},[Object(a.createVNode)("path",{opacity:"0.2",fill:n.color,d:`M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946
      s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634
      c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z`},null,8,["fill"]),Object(a.createVNode)("path",{fill:n.color,d:`M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0
      C22.32,8.481,24.301,9.057,26.013,10.047z`},[Object(a.createVNode)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 20 20",to:"360 20 20",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"])],8,["width","height"])}var B={name:"ring",props:{color:{type:String,default:"#CCC"},size:{type:String,default:"40px"},duration:{type:String,default:"0.6s"}}};B.render=f,B.__file="src/loaders/ring.vue";var U=B;function E(S,I,n,V,A,F){return Object(a.openBlock)(),Object(a.createBlock)("svg",{version:"1.1",id:"loader-1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:n.size,height:n.size,viewBox:"0 0 50 50",style:{"enable-background":"new 0 0 50 50"},"xml:space":"preserve"},[Object(a.createVNode)("path",{fill:n.color,d:"M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z"},[Object(a.createVNode)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 25 25",to:"360 25 25",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"])],8,["width","height"])}var T={name:"mini-spinner",props:{color:{type:String,default:"#CCC"},size:{type:String,default:"40px"},duration:{type:String,default:"0.6s"}}};T.render=E,T.__file="src/loaders/mini-spinner.vue";var P=T;function q(S,I,n,V,A,F){return Object(a.openBlock)(),Object(a.createBlock)("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:n.size,height:n.size,viewBox:"0 0 24 30",style:{"enable-background":"new 0 0 50 50"},"xml:space":"preserve"},[Object(a.createVNode)("rect",{x:"0",y:"0",width:"4",height:"10",fill:n.color},[Object(a.createVNode)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"]),Object(a.createVNode)("rect",{x:"10",y:"0",width:"4",height:"10",fill:n.color},[Object(a.createVNode)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0.2s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"]),Object(a.createVNode)("rect",{x:"20",y:"0",width:"4",height:"10",fill:n.color},[Object(a.createVNode)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0.4s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"])],8,["width","height"])}var ee={name:"line-wave",props:{color:{type:String,default:"#CCC"},size:{type:String,default:"40px"},duration:{type:String,default:"0.6s"}}};ee.render=q,ee.__file="src/loaders/line-wave.vue";var L=ee;function $(S,I,n,V,A,F){return Object(a.openBlock)(),Object(a.createBlock)("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:n.size,height:n.size,viewBox:"0 0 24 30",style:{"enable-background":"new 0 0 50 50"},"xml:space":"preserve"},[Object(a.createVNode)("rect",{x:"0",y:"13",width:"4",height:"5",fill:n.color},[Object(a.createVNode)("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"]),Object(a.createVNode)("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"]),Object(a.createVNode)("rect",{x:"10",y:"13",width:"4",height:"5",fill:n.color},[Object(a.createVNode)("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.15s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"]),Object(a.createVNode)("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.15s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"]),Object(a.createVNode)("rect",{x:"20",y:"13",width:"4",height:"5",fill:n.color},[Object(a.createVNode)("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.3s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"]),Object(a.createVNode)("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.3s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"])],8,["width","height"])}var N={name:"line-scale",props:{color:{type:String,default:"#CCC"},size:{type:String,default:"40px"},duration:{type:String,default:"0.6s"}}};N.render=$,N.__file="src/loaders/line-scale.vue";var j=N;function R(S,I,n,V,A,F){return Object(a.openBlock)(),Object(a.createBlock)("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:n.size,height:n.size,viewBox:"0 0 24 24",style:{"enable-background":"new 0 0 50 50"},"xml:space":"preserve"},[Object(a.createVNode)("rect",{x:"0",y:"0",width:"4",height:"7",fill:n.color},[Object(a.createVNode)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"scale",values:"1,1; 1,3; 1,1",begin:"0s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"]),Object(a.createVNode)("rect",{x:"10",y:"0",width:"4",height:"7",fill:n.color},[Object(a.createVNode)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"scale",values:"1,1; 1,3; 1,1",begin:"0.2s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"]),Object(a.createVNode)("rect",{x:"20",y:"0",width:"4",height:"7",fill:n.color},[Object(a.createVNode)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"scale",values:"1,1; 1,3; 1,1",begin:"0.4s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"])],8,["width","height"])}var G={name:"line-down",props:{color:{type:String,default:"#CCC"},size:{type:String,default:"40px"},duration:{type:String,default:"0.6s"}}};G.render=R,G.__file="src/loaders/line-down.vue";var z=G;function re(S,I,n,V,A,F){return Object(a.openBlock)(),Object(a.createBlock)("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:n.size,height:n.size,viewBox:"0 0 24 30",style:{"enable-background":"new 0 0 50 50"},"xml:space":"preserve"},[Object(a.createVNode)("rect",{x:"0",y:"0",width:"4",height:"20",fill:n.color},[Object(a.createVNode)("animate",{attributeName:"opacity",attributeType:"XML",values:"1; .2; 1",begin:"0s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"]),Object(a.createVNode)("rect",{x:"7",y:"0",width:"4",height:"20",fill:n.color},[Object(a.createVNode)("animate",{attributeName:"opacity",attributeType:"XML",values:"1; .2; 1",begin:"0.2s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"]),Object(a.createVNode)("rect",{x:"14",y:"0",width:"4",height:"20",fill:n.color},[Object(a.createVNode)("animate",{attributeName:"opacity",attributeType:"XML",values:"1; .2; 1",begin:"0.4s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"])],8,["width","height"])}var Y={name:"bar-fade",props:{color:{type:String,default:"#CCC"},size:{type:String,default:"40px"},duration:{type:String,default:"0.6s"}}};Y.render=re,Y.__file="src/loaders/bar-fade.vue";var pe=Y;function K(S,I,n,V,A,F){return Object(a.openBlock)(),Object(a.createBlock)("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:n.size,height:n.size,viewBox:"0 0 24 30",style:{"enable-background":"new 0 0 50 50"},"xml:space":"preserve"},[Object(a.createVNode)("rect",{x:"0",y:"10",width:"4",height:"10",fill:n.color,opacity:"0.2"},[Object(a.createVNode)("animate",{attributeName:"opacity",attributeType:"XML",values:"0.2; 1; .2",begin:"0s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"]),Object(a.createVNode)("animate",{attributeName:"height",attributeType:"XML",values:"10; 20; 10",begin:"0s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"]),Object(a.createVNode)("animate",{attributeName:"y",attributeType:"XML",values:"10; 5; 10",begin:"0s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"]),Object(a.createVNode)("rect",{x:"8",y:"10",width:"4",height:"10",fill:n.color,opacity:"0.2"},[Object(a.createVNode)("animate",{attributeName:"opacity",attributeType:"XML",values:"0.2; 1; .2",begin:"0.15s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"]),Object(a.createVNode)("animate",{attributeName:"height",attributeType:"XML",values:"10; 20; 10",begin:"0.15s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"]),Object(a.createVNode)("animate",{attributeName:"y",attributeType:"XML",values:"10; 5; 10",begin:"0.15s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"]),Object(a.createVNode)("rect",{x:"16",y:"10",width:"4",height:"10",fill:n.color,opacity:"0.2"},[Object(a.createVNode)("animate",{attributeName:"opacity",attributeType:"XML",values:"0.2; 1; .2",begin:"0.3s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"]),Object(a.createVNode)("animate",{attributeName:"height",attributeType:"XML",values:"10; 20; 10",begin:"0.3s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"]),Object(a.createVNode)("animate",{attributeName:"y",attributeType:"XML",values:"10; 5; 10",begin:"0.3s",dur:n.duration,repeatCount:"indefinite"},null,8,["dur"])],8,["fill"])],8,["width","height"])}var ue={name:"bar-fade-scale",props:{color:{type:String,default:"#CCC"},size:{type:String,default:"40px"},duration:{type:String,default:"0.6s"}}};ue.render=K,ue.__file="src/loaders/bar-fade-scale.vue";var ye=ue,xe={Spinner:C,Ring:U,MiniSpinner:P,LineWave:L,LineScale:j,LineDown:z,BarFade:pe,BarFadeScale:ye},_e={name:"vue-element-loading",props:{active:Boolean,spinner:{type:String,default:"spinner"},text:{type:String,default:""},textStyle:{type:Object,default:function(){return{}}},color:{type:String,default:"#000"},isFullScreen:{type:Boolean,default:!1},backgroundColor:{type:String,default:"rgba(255, 255, 255, .9)"},size:{type:String,default:"40"},duration:{type:String,default:"0.6"},delay:{type:[String,Number],default:0}},data(){return{isActive:this.active||!1,isActiveDelay:!1}},mounted(){if(this.$refs.velmld.parentNode.classList.add("velmld-parent"),this.delay){const S=+this.delay*1e3;this.delayActive(S)}},methods:{delayActive(S){this.isActiveDelay=!0,setTimeout(()=>{this.isActiveDelay=!1},S)}},watch:{active(S){this.isActive=S,S&&this.$refs.velmld.parentNode.classList.add("velmld-parent")}},components:xe};g("4d5e"),g("0ef1"),_e.render=x,_e.__scopeId="data-v-2964abc9",_e.__file="src/index.vue";var Ve=_e,O=Ve;d.default=O}})})(dt);var ws=dt.exports;const xs=Ke(ws);const Ss=X({components:{VueElementLoading:xs},props:{isLoading:{type:Boolean,default:!1},firstMessage:{type:String,default:null}},data(){return{hasShownFirstMessage:!1,messages:["Locating the required gigapixels to render...","Spinning up the hamster...","The architects are still drafting your diagram","We're building as fast as we can","The server is powered by a lemon and two electrodes","We're testing your patience","... as if you had any other choice","Moving satellites into position","Waiting for the system admin to hit enter...","Paging for the system admin...","Warming up the processors...","Reconfiguring the office coffee machine...","RE-calibrating the internet...","Reticulating splines...","Generating witty dialog...","Swapping time and space...","Spinning violently around the y-axis...","Tokenizing real life...","Upgrading Windows, your PC will restart several times. Sit back and relax.","Please wait while the little elves draw your diagram","Checking the gravitational constant in your locale...","Go ahead -- hold your breath!","...at least you're not on hold...","The server is powered by a lemon and two electrodes.","We're testing your patience","keep calm and npm install","The bits are flowing slowly today","Reconfoobling energymotron...","(Insert quarter)","Are we there yet?","Just count to 10","It's not you. It's me.","Counting backwards from Infinity","Don't panic...","Embiggening Prototypes","We're making you a cookie.","Creating time-loop inversion field","Computing chance of success","I feel like im supposed to be loading something. . .","What do you call 8 Hobbits? A Hobbyte.","Should have used a compiled language...","Adjusting flux capacitor...","Please wait until the sloth starts moving.","Don't break your screen yet!","I swear it's almost done.","Let's take a mindfulness minute...","Cleaning off the cobwebs...","Making sure all the i's have dots...","Granting wishes...","Get some coffee and come back in ten minutes..","You shall not pass! yet..","Load it and they will come","Convincing AI not to turn evil..","Computing the secret to life, the universe, and everything.","I think I am, therefore, I am. I think.","git happens","A commit a day keeps the mobs away","Have you tried turning it off and on again?","Dividing by zero...","If I’m not back in five minutes, just wait longer.","Cracking military-grade encryption...","Simulating traveling salesman...","Proving P=NP...","Entangling superstrings...","Twiddling thumbs...","Searching for plot device...","Trying to sort in O(n)...","Looking for sense of humour, please hold on.","Reheating coffee ...","Converting bug to feature...","Quitting vim...","Installing dependencies","Switching to the latest JS framework...","Finding someone to hold my beer","BRB, working on my side project","@todo Insert witty loading message","Let's hope it's worth the wait","Aw, snap! Not..","Ordering 1s and 0s...","Updating dependencies...","Please wait... Consulting the manual...","Loading funny message...","Feel free to spin in your chair","Mining some bitcoins...","Downloading more RAM..","Initializing the initializer...","Optimizing the optimizer...","Running swag sticker detection...","Shovelling coal into the server...","Pushing pixels...","Updating Updater...","Downloading Downloader...","Debugging Debugger...","Reading Terms and Conditions for you.","You seem like a nice person...","Work, work...","Patience! This is difficult, you know...","Discovering new ways of making you wait...","TODO: Insert elevator music","Still faster than Windows update","Composer hack: Waiting for reqs to be fetched is less frustrating if you add -vvv to your command.","Obfuscating quantum entaglement"],message:"",timeout:null,textStyle:{marginTop:"20px",transition:"opacity .5s ease-in-out"}}},watch:{isLoading:{immediate:!0,handler(e,s){e?(this.hasShownFirstMessage=!1,this.setRandomMessage(),this.createTimeout(this.getRandomArbitrary())):clearTimeout(this.timeout)}}},unmounted(){clearTimeout(this.timeout)},methods:{createTimeout(e){const s=this;this.timeout=setTimeout(()=>{s.setRandomMessage(),s.createTimeout(s.getRandomArbitrary())},e)},getRandomArbitrary(e=5e3,s=8e3){return Math.random()*(s-e)+e},setRandomMessage(){this.hasShownFirstMessage?this.message=this.messages[Math.floor(Math.random()*this.messages.length)]:(this.message=this.firstMessage,this.hasShownFirstMessage=!0)}}});function Ts(e,s,d,g,r,u){const i=h("VueElementLoading");return o(),D(i,{class:"flex items-center",active:e.isLoading,text:e.message,spinner:"line-scale",color:"#38a89d","text-style":e.textStyle},null,8,["active","text","text-style"])}const ut=W(Ss,[["render",Ts],["__scopeId","data-v-6c612c92"]]),$s=25,ks=X({components:{BaseSvgIcon:ae,ModalExportTile:lt,BaseModalTwoPane:be,BaseSvgImage:ve,LoaderFunnyText:ut},props:{modelValue:{type:Boolean,default:!1,required:!0},blueprint:{type:Object,required:!0}},emits:["update:modelValue"],setup(){const{teamInUrl:e}=le();return{emitter:De("emitter"),teamInUrl:e}},data(){return{isLoading:!1,exportTypes:[],selectedExportTypeId:null,selectedVersion:null,exportUuid:null,totalRetries:0,hasDownloaded:!1,timer:null}},computed:{...Q(["totalUnsavedUpdates","isViewOnly"]),generalExportTypes(){return _.filter(this.exportTypes,{framework:null})},frameworkExportTypes(){return _.reject(this.exportTypes,{framework:null})},selectedExportType(){return _.find(this.exportTypes,{id:this.selectedExportTypeId})}},mounted(){this.selectedExportTypeId=null,this.blueprint.driver===te.MYSQL?this.exportTypes.push({id:te.MYSQL,name:"MySQL",icon:"icon-mysql",description:"Export the schema of your MySQL database diagram as DDL",live:!0,framework:null}):this.blueprint.driver===te.PGSQL?this.exportTypes.push({id:te.PGSQL,name:"PostgreSQL",icon:"icon-postgres",description:"Export the schema of your PostgreSQL database diagram as DDL",live:!0,framework:null}):this.blueprint.driver===te.SQLSRV&&this.exportTypes.push({id:te.SQLSRV,name:"SQL Server",icon:"icon-mssql",description:"Export the schema of your SQL Server database diagram as DDL",live:!0,framework:null}),this.exportTypes=this.exportTypes.concat([{id:"image",name:"Image",svg:"/img/heroicons-photograph.svg",description:"Export diagram as an image in .png format",live:!0,beta:!1,framework:null,versions:[]},{id:"denormalized-json",name:"JSON",icon:"icon-css",description:"Export a json representation of your diagram",live:!0,pro:"can_export_import_denormalized_json",beta:!1,framework:null,versions:[]},{id:Le.LARAVEL_MIGRATION,name:"Laravel Migrations",icon:"icon-laravel",description:"Generate laravel migration classes",live:!0,beta:!1,framework:"laravel",versions:[]},{id:Le.LARAVEL_BLUEPRINT,name:"Laravel Blueprint",svg:"/img/logos/laravel-blueprint-gray.svg",description:"Generate draft file with model definitions for Laravel Shift Blueprint",live:!0,beta:!1,framework:"laravel",versions:[]},{id:Le.ADONIS_MIGRATION,name:"AdonisJs",svg:"/img/logos/adonisjs.svg",description:"Generate AdonisJs (Knex.js) migration schema files",live:!0,beta:!1,framework:"adonis",versions:[{text:"Adonis v5",value:5},{text:"Adonis v4",value:4}]}])},beforeUnmount(){this.stopPolling()},methods:{beforeOpen(){this.isLoading=!1,this.selectedExportTypeId=null,this.exportUuid=null,this.totalRetries=0},stopPolling(){this.timer&&(clearInterval(this.timer),this.timer=null)},async pollForExport(){const e=await axios.get(`/api/exports/${this.exportUuid}`);this.totalRetries++,this.totalRetries>=$s&&(this.stopPolling(),this.isLoading=!1,this.emitter.emit("toast-error","Export timed out.")),e.data.data.status===qe.COMPLETED&&(this.stopPolling(),this.hasDownloaded||(this.hasDownloaded=!0,await this.downloadExport(e.data.data.download_url)),this.isLoading=!1),e.data.data.status===qe.FAILED&&(this.stopPolling(),this.isLoading=!1,this.emitter.emit("toast-error",`Export failed. Let us know and we'll look into it. (Export ID: ${this.exportUuid})`))},async downloadExport(e){const s=await axios.get(e,{responseType:"blob"});this._download(s)},selectExportType(e){this.selectedExportTypeId=e,this.selectedVersion=null,this.exportTypeHasVersions(e)&&(this.selectedVersion=this.selectedExportType.versions[0].value)},canExportExportType(e){const s=_.find(this.exportTypes,{id:e});if(!s.live)return!1;if(!("pro"in s)||!s.pro)return!0;const d=s.pro;return _.has(this.teamInUrl.cans,d)?this.teamInUrl.cans[d]:!1},exportTypeHasVersions(e){if(!e)return!1;const s=_.find(this.exportTypes,{id:e});return s.versions&&s.versions.length>0},async export(e){this.isLoading=!0,this.totalUnsavedUpdates>0&&!this.isViewOnly&&await this.$store.dispatch("saveDiagram",{shouldToast:!1,shouldRefetchDiagram:!0,amplitudeTag:"Blueprint saved - export"}),this.isLoading=!0;try{const s={format:e};this.selectedVersion&&(s.version=this.selectedVersion);const d=await axios.post(`/api/teams/${this.teamInUrl.slug}/blueprints/${this.blueprint.id}/exports`,s);this.exportUuid=d.data.data.uuid,this.totalRetries=0,this.hasDownloaded=!1,this.timer=setInterval(()=>{this.pollForExport()},5e3)}catch(s){let d="Export failed. ";_.has(s.response,"data")&&_.has(s.response.data,"message")&&(d=d+s.response.data.message),this.emitter.emit("toast-error",d),this.isLoading=!1}},async downloadClicked(e){if(!this.selectedExportTypeId||!this.canExportExportType(this.selectedExportTypeId)){e.preventDefault();return}await this.export(this.selectedExportTypeId)},_download(e){const s=new Blob([e.data]);if(window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(s);return}const d=window.URL.createObjectURL(s),g=document.createElement("a");g.href=d;let r="content-disposition"in e.headers?e.headers["content-disposition"]:e.headers["Content-Disposition"];const u=this.parseContentDispositionHeaderForFileName(r);g.download=u,g.click(),setTimeout(function(){window.URL.revokeObjectURL(d)},100)},parseContentDispositionHeaderForFileName(e){const d=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(e);return d!=null&&d[1]?d[1].replace(/['"]/g,""):"export"}}}),Is={key:0,style:{"min-height":"500px"}},Cs={key:1},Bs=t("h2",{class:"mx-1 text-xl font-semibold text-gray-500"},"General",-1),Ds={class:"mb-8 mt-2 grid grid-cols-3 gap-3 text-center text-xl"},Es=t("h2",{class:"mx-1 text-xl font-semibold text-gray-500"}," Framework Specific ",-1),Vs={class:"mb-8 mt-2 grid grid-cols-3 gap-3 text-center text-xl"},Ls={class:"w-1/3"},As=t("label",{for:"version",class:"block text-sm font-medium leading-5 text-gray-700"},"Version",-1),Us=["value"],Ms=t("hr",{class:"my-5 border border-gray-200"},null,-1),Os={class:"mt-5 flex w-full justify-center text-center"},Ns={key:1,class:"mt-2 w-full justify-center text-center font-medium text-teal-600"},Ps=["href"];function Rs(e,s,d,g,r,u){const i=h("BaseSvgImage"),a=h("LoaderFunnyText"),l=h("ModalExportTile"),m=h("BaseSvgIcon"),x=h("BaseModalTwoPane");return o(),D(x,{"model-value":e.modelValue,width:"5xl","onUpdate:modelValue":s[3]||(s[3]=w=>e.$emit("update:modelValue",w)),onBeforeOpen:e.beforeOpen},Oe({image:p(()=>[c(i,{width:"200px",svg:"undraw/undraw_download_re_li50"})]),content:p(()=>[e.isLoading?(o(),v("div",Is,[c(a,{style:{height:"500px"},"is-loading":e.isLoading,"first-message":"Exporting diagram ..."},null,8,["is-loading"])])):b("",!0),e.isLoading?b("",!0):(o(),v("div",Cs,[Bs,t("div",Ds,[(o(!0),v(Z,null,ne(e.generalExportTypes,w=>(o(),D(l,{key:w.id,"export-type":w,"is-selected":w.id===e.selectedExportTypeId,onClick:k=>e.selectExportType(w.id)},null,8,["export-type","is-selected","onClick"]))),128))]),Es,t("div",Vs,[(o(!0),v(Z,null,ne(e.frameworkExportTypes,w=>(o(),D(l,{key:w.id,"export-type":w,"is-selected":w.id===e.selectedExportTypeId,onClick:k=>e.selectExportType(w.id)},null,8,["export-type","is-selected","onClick"]))),128))]),e.exportTypeHasVersions(e.selectedExportTypeId)?(o(),v("div",{key:0,class:"flex flex-col items-center border-t-2 border-gray-200 pt-5",onClick:s[1]||(s[1]=Me(()=>{},["stop"]))},[t("div",Ls,[As,oe(t("select",{id:"version","onUpdate:modelValue":s[0]||(s[0]=w=>e.selectedVersion=w),class:"mt-1 block w-full rounded-md border border-gray-300 bg-white py-2 pl-3 pr-10 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm"},[(o(!0),v(Z,null,ne(e.selectedExportType.versions,w=>(o(),v("option",{key:w.value,value:w.value},M(w.text),9,Us))),128))],512),[[kt,e.selectedVersion]])])])):b("",!0),Ms,t("div",Os,[t("a",{class:H([[{"cursor-not-allowed opacity-50":!e.selectedExportTypeId||!e.canExportExportType(e.selectedExportTypeId),"cursor-pointer":e.selectedExportTypeId&&e.canExportExportType(e.selectedExportTypeId)}],"rounded bg-indigo-600 px-6 py-3 font-medium tracking-wider text-white hover:bg-indigo-500"]),onClick:s[2]||(s[2]=w=>e.downloadClicked(w))},"Start export ",2)]),e.selectedExportTypeId&&!e.canExportExportType(e.selectedExportTypeId)?(o(),v("div",Ns,[c(m,{size:"1.2",class:"mr-1 text-teal-500",icon:"heroicons/v2-outline/information-circle"}),t("a",{class:"hover:underline",href:e.teamInUrl.subscription_page_url,target:"_blank"},"Upgrade your plan",8,Ps),y(" to export as "+M(e.selectedExportType.name)+". ",1)])):b("",!0)]))]),_:2},[e.isLoading?void 0:{name:"title",fn:p(()=>[y(" Export diagram ")]),key:"0"}]),1032,["model-value","onBeforeOpen"])}const js=W(ks,[["render",Rs]]),Ae={PENDING:"pending",ORIGINAL_FILE_UPLOADED:"completed",PROCESSING:"processing",DDL_PARSED:"ddl-parsed",STATS_CALCULATED:"stats-calculated",COMPLETED:"completed",FAILED:"failed"},Ie={MYSQL:"mysql",PGSQL:"pgsql",SQLSRV:"sqlsrv",DENORMALIZED_JSON:"denormalized-json"};const zs=25,Fs=X({components:{ModalExportTile:lt,BaseSvgIcon:ae,BaseCardStatus:st,BaseButtonSolid:we,BaseModalTwoPane:be,BaseSvgImage:ve,LoaderFunnyText:ut},props:{modelValue:{type:Boolean,default:!1,required:!0},blueprint:{type:Object,required:!0}},emits:["update:modelValue"],setup(e){const s=Te(),{teamInUrl:d}=le(),g=De("emitter");let r=null,u=ie(!1),i=ie(null),a=ie(null),l=ie([]),m=0,x=ie({"total-tables-imported":0,"total-columns-imported":0,"total-relationships-imported":0});It(()=>{e.blueprint.driver===te.MYSQL?l.value.push({id:te.MYSQL,name:"MySQL DDL",icon:"icon-mysql",description:"Import from a MySQL DDL file.",live:!0,accept:".sql",extension:".sql"}):e.blueprint.driver===te.PGSQL?l.value.push({id:te.PGSQL,name:"PostgreSQL DDL",icon:"icon-postgres",description:"Import from a PostgreSQL DDL file.",live:!0,accept:".sql",extension:".sql"}):e.blueprint.driver===te.SQLSRV&&l.value.push({id:te.SQLSRV,name:"SQL Server DDL",icon:"icon-mssql",description:"Import from a SQL Server DDL file.",live:!0,accept:".sql",extension:".sql"}),l.value.push({id:"denormalized-json",name:"JSON",icon:"icon-css",description:"Import from a JSON schema file exported from DrawSQL.",live:!0,pro:"can_export_import_denormalized_json",accept:"application/json",extension:".json"})});const w=se(()=>a.value===Ie.MYSQL||a.value===Ie.PGSQL||a.value===Ie.SQLSRV),k=T=>{a.value=T},C=se(()=>!a.value||!l.value?null:l.value.find(T=>T.id===a.value)),f=()=>{if(!a.value)return!1;const T=C.value;if(!T.live)return!1;if(!("pro"in T)||!T.pro)return!0;const P=T.pro;return _.has(d.value.cans,P)?d.value.cans[P]:!1},B=()=>{r&&(clearInterval(r),r=null)},U=()=>{r=setInterval(()=>{E()},5e3)},E=async()=>{const T=await axios.get(`/api/imports/${i.value.uuid}`);if(i.value=T.data.data,m++,m>=zs&&(B(),u.value=!1,g.emit("toast-error","Import timed out.")),i.value.status===Ae.COMPLETED){if(B(),u.value=!1,x.value=i.value.metadata["import-stats"],me().isCanvasVersionV1)await s.dispatch("reloadCanvas");else{if(C.value.id===Ie.DENORMALIZED_JSON)await me().reloadSchema();else{const P=me().graph.getElements(),q=me().graph.getBBox();await me().reloadSchema();let L=me().graph.getElements().filter(N=>!P.some(j=>N.id===j.id));const $=St(P)?{}:{x:q.x,y:q.y+q.height+100};me().autoLayout(L,$)}await s.dispatch("saveDiagram",{shouldToast:!1,shouldRefetchDiagram:!1,amplitudeTag:"Blueprint saved - Post import"})}Tt.getInstance().logEvent("Blueprint Imported",{blueprint_id:e.blueprint.id,team_id:d.value.id,total_tables:x.value["total-tables-imported"],total_columns:x.value["total-columns-imported"],total_relationships:x.value["total-relationships-imported"]})}else i.value.status===Ae.FAILED&&(B(),u.value=!1,g.emit("toast-error",`Import failed. Let us know and we'll look into it. (Import ID: ${i.value.uuid})`))};return{importStats:x,isLoading:u,isSqlDdlImportType:w,importModel:i,importTypes:l,canImportImportType:f,selectedImportTypeId:a,selectedImportType:C,startPolling:U,stopPolling:B,pollForImport:E,selectImportType:k,emitter:g,teamInUrl:d,IMPORT_STATUSES:Ae}},data(){return{fileToImport:null}},computed:{...Q(["totalUnsavedUpdates"]),outputHasUnsupportedStatements(){var e,s;return((s=(e=this.importModel)==null?void 0:e.unsupported_statements)==null?void 0:s.length)>0},outputHasWarnings(){var e,s,d;return((d=(s=(e=this.importModel)==null?void 0:e.metadata)==null?void 0:s.warnings)==null?void 0:d.length)>0},outputHasErrors(){var e,s,d;return((d=(s=(e=this.importModel)==null?void 0:e.metadata)==null?void 0:s.errors)==null?void 0:d.length)>0},isSqlSrv(){return this.blueprint?this.blueprint.driver===te.SQLSRV:!1}},methods:{beforeOpen(){this.importModel=null,this.isLoading=!1,this.fileToImport=null,this.selectedImportTypeId=null},openFileSelectorDialog(){this.$refs.fileInput.click()},fileChanged(e){this.fileToImport=e.target.files[0]},async importBlueprint(){this.isLoading=!0,this.totalUnsavedUpdates>0&&await this.$store.dispatch("saveDiagram",{shouldToast:!1,shouldRefetchDiagram:!0,amplitudeTag:"Blueprint saved - import"});const e=new FormData;e.append("file",this.fileToImport),e.append("format",this.selectedImportType.id);try{this.stopPolling();const s=await axios({method:"post",url:`/api/blueprints/${this.blueprint.id}/imports`,data:e,headers:{"content-type":"multipart/form-data"}});this.importModel=s.data.data,this.startPolling()}catch{this.emitter.emit("toast-error","Failed to begin import. Please try again.")}},close(){this.$emit("update:modelValue")}}}),J=e=>(Ne("data-v-129db84a"),e=e(),Pe(),e),Gs={style:{"min-height":"200px"}},qs={key:0},Hs={key:1},Ws=J(()=>t("p",null,"Your DDL have been successfully imported.",-1)),Qs=J(()=>t("span",{class:"text-teal-500"},"Imported: ",-1)),Xs={key:0},Ys=J(()=>t("br",null,null,-1)),Js=J(()=>t("br",null,null,-1)),Ks={key:1,class:"mt-2"},Zs=J(()=>t("span",{class:"text-yellow-600"},"Warnings:",-1)),ea={class:"list-disc"},ta={class:"ml-4 text-yellow-600"},sa={key:0,class:"list-disc"},aa={class:"ml-4 text-yellow-600"},oa=J(()=>t("span",{class:"text-yellow-600"},"Import failed",-1)),ia=J(()=>t("p",null,"The importer could not parse the DDL file.",-1)),na={key:0,class:"mt-2"},ra=J(()=>t("span",{class:"text-red-600"},"Errors:",-1)),la={class:"list-disc"},da={class:"ml-4 text-yellow-600"},ua={key:1},ca=J(()=>t("br",null,null,-1)),ma=J(()=>t("br",null,null,-1)),pa={key:2},fa=J(()=>t("h2",{class:"text-md font-medium text-gray-700"},[t("span",{class:"font-semibold text-gray-500"},"Step 1: "),y("Select source file format ")],-1)),ga={class:"mb-4 mt-2 grid grid-cols-2 gap-3 text-center text-xl"},ha={key:0,class:"mb-2 w-full justify-center text-center font-medium text-yellow-600"},va=["href"],ya=J(()=>t("h2",{class:"text-md mt-6 font-medium text-gray-700"},[t("span",{class:"font-semibold text-gray-500"},"Step 2: "),y("Select file to upload ")],-1)),_a={class:"mt-2 rounded-lg bg-gray-100 p-4"},ba={class:"mb-2 text-sm text-gray-700"},wa={key:0},xa=J(()=>t("div",null,null,-1)),Sa={key:0,class:"rounded-l rounded-r-lg border-l-4 border-yellow-500 bg-yellow-100 px-4 py-2 text-yellow-700 shadow",role:"alert"},Ta=J(()=>t("div",{class:"flex items-center"},[t("div",{class:"py-1"},[t("svg",{class:"mr-2 h-4 w-4 fill-current text-yellow-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[t("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})])]),t("div",null,[t("p",{class:"text-sm"}," Statements must be delimited with a semicolon. ")])],-1)),$a=[Ta],ka={key:1,class:"mt-2 flex w-full flex-col items-center justify-center text-center text-xl text-teal-600"},Ia=["accept"],Ca={class:"text-medium flex w-full flex-col items-center justify-center text-center text-teal-600"},Ba={key:0,class:"mt-2 text-sm"},Da=J(()=>t("h2",{class:"text-md mt-6 font-medium text-gray-700"},[t("span",{class:"font-semibold text-gray-500"},"Step 3: "),y("Upload and import ")],-1)),Ea={class:"mt-2 flex justify-center rounded-lg bg-gray-100 p-4"};function Va(e,s,d,g,r,u){const i=h("BaseSvgImage"),a=h("LoaderFunnyText"),l=h("BaseSvgIcon"),m=h("BaseCardStatus"),x=h("ModalExportTile"),w=h("BaseButtonSolid"),k=h("BaseModalTwoPane");return o(),D(k,{"model-value":e.modelValue,width:"3xl","onUpdate:modelValue":s[4]||(s[4]=C=>e.$emit("update:modelValue",C)),onBeforeOpen:e.beforeOpen},{image:p(()=>[c(i,{width:"230px",svg:"undraw/undraw_going_up_re_86kg"})]),title:p(()=>[y(" Import ")]),content:p(()=>{var C;return[t("div",Gs,[e.isLoading?(o(),v("div",qs,[c(a,{style:{height:"200px"},"is-loading":e.isLoading,"first-message":"Importing diagram ..."},null,8,["is-loading"])])):b("",!0),e.isLoading?b("",!0):(o(),v("div",Hs,[e.importModel&&e.importModel.status===e.IMPORT_STATUSES.COMPLETED?(o(),D(m,{key:0,type:"success","button-text":"Back to diagram",onButtonClicked:e.close},{header:p(()=>[c(l,{size:1.3,icon:"celebrate"}),y(" Import complete! ")]),additionalDetails:p(()=>[Qs,y(" "+M(e.importStats["total-tables-imported"])+" tables, "+M(e.importStats["total-columns-imported"])+" columns and "+M(e.importStats["total-relationships-imported"])+" relationships. ",1),e.isSqlDdlImportType&&e.importStats["total-relationships-imported"]>0?(o(),v("span",Xs,[Ys,Js,y("Info: The importer infers relationship cardinality from foreign keys. Please review them.")])):b("",!0),e.outputHasWarnings||e.outputHasUnsupportedStatements?(o(),v("ul",Ks,[Zs,(o(!0),v(Z,null,ne(e.importModel.metadata.warnings,(f,B)=>(o(),v("li",{key:B},[t("ul",ea,[t("li",ta,M(f.message),1)])]))),128)),e.outputHasUnsupportedStatements?(o(),v("ul",sa,[t("li",aa,M(e.importModel.unsupported_statements.length)+" "+M(e.importModel.unsupported_statements.length===1?"statement was":"statements were")+" unsupported. ",1)])):b("",!0)])):b("",!0)]),default:p(()=>[Ws]),_:1},8,["onButtonClicked"])):b("",!0),e.importModel&&e.importModel.status===e.IMPORT_STATUSES.FAILED?(o(),D(m,{key:1,type:"error","button-text":"Back to diagram",onButtonClicked:e.close},{header:p(()=>[oa]),additionalDetails:p(()=>[e.outputHasErrors?(o(),v("ul",na,[ra,(o(!0),v(Z,null,ne(e.importModel.metadata.errors,(f,B)=>(o(),v("li",{key:B},[t("ul",la,[t("li",da,M(f.message),1)])]))),128))])):(o(),v("p",ua,[y(" This usually happens when the DDL is invalid. Please check that the DDL is valid by running it on a database, then try again."),ca,ma,y("If you're still having trouble, please let us know and we'll have a look (Import ID: "+M(e.importModel.uuid)+"). ",1)]))]),default:p(()=>[ia]),_:1},8,["onButtonClicked"])):b("",!0),e.importModel?b("",!0):(o(),v("div",pa,[fa,t("div",ga,[(o(!0),v(Z,null,ne(e.importTypes,f=>(o(),D(x,{key:f.id,"export-type":f,"is-selected":f.id===e.selectedImportTypeId,onClick:B=>e.selectImportType(f.id)},null,8,["export-type","is-selected","onClick"]))),128))]),e.selectedImportTypeId&&!e.canImportImportType()?(o(),v("div",ha,[c(l,{size:"1.2",class:"mr-1 text-yellow-500",icon:"heroicons/v2-outline/information-circle"}),t("a",{class:"underline",href:e.teamInUrl.subscription_page_url,target:"_blank"},"Upgrade your plan",8,va),y(" to import from "+M(e.selectedImportType.name)+". ",1)])):b("",!0),ya,t("div",_a,[t("p",ba,[y(" Upload a "),e.selectedImportType?(o(),v("strong",wa,[t("span",null,M(e.selectedImportType.name),1),y(" file ("+M(e.selectedImportType.extension)+").",1)])):b("",!0),y(" The imported tables will be appended to the current schema diagram. ")]),xa,e.isSqlSrv?(o(),v("div",Sa,$a)):b("",!0),e.fileToImport?b("",!0):(o(),v("div",ka,[c(w,{disabled:!e.selectedImportTypeId||!e.canImportImportType(),onClick:s[0]||(s[0]=f=>e.openFileSelectorDialog())},{default:p(()=>[y("Select file")]),_:1},8,["disabled"])])),t("input",{ref:"fileInput",type:"file",accept:(C=e.selectedImportType)==null?void 0:C.accept,class:"hidden",onChange:s[1]||(s[1]=f=>e.fileChanged(f))},null,40,Ia),t("div",Ca,[e.fileToImport?(o(),v("div",Ba,[c(l,{icon:"heroicons/outline/check-circle",class:"mr-1 h-6 w-6 text-teal-500",size:1.5}),t("span",{class:"cursor-pointer font-mono text-sm tracking-tighter hover:underline",onClick:s[2]||(s[2]=Me(f=>e.openFileSelectorDialog(),["stop"]))},M(e.fileToImport.name),1)])):b("",!0)])]),Da,t("div",Ea,[c(w,{disabled:!e.fileToImport||!e.canImportImportType(),onClick:s[3]||(s[3]=f=>e.importBlueprint(f))},{default:p(()=>[y("Begin import")]),_:1},8,["disabled"])])]))]))])]}),_:1},8,["model-value","onBeforeOpen"])}const La=W(Fs,[["render",Va],["__scopeId","data-v-129db84a"]]),Aa=X({components:{JetLabel:Nt}});function Ua(e,s,d,g,r,u){const i=h("JetLabel");return o(),D(i,Ze(Ct(e.$attrs)),{default:p(()=>[he(e.$slots,"default")]),_:3},16)}const ct=W(Aa,[["render",Ua]]),He="STATE_IDLE",Ma="STATE_SAVING",Oa="STATE_SUCCESS",Na="STATE_FAILURE",Pa=X({components:{BaseColorPicker:gt,DataTypeAutocompleteCombobox:Pt,BaseButtonSolid:we,BaseSvgIcon:ae,LabelPro:Ee,BaseModal:ze,BaseAlertError:it,BaseForm:Mt,BaseInput:ot,BaseTextArea:at,BaseLabel:ct},props:{modelValue:{type:Boolean,default:!1,required:!0}},emits:["update:modelValue"],setup(){const e=Te(),{teamInUrl:s}=le(),d=Be().getDatabaseDriverIconClass,g=Be().getDatabaseDriverText;return{canManageDiagram:se(()=>e.getters["diagramAccess/canManageDiagram"]),teamInUrl:s,getDatabaseDriverIconClass:d,getDatabaseDriverText:g}},data(){return{state:He,isLoading:!1,form:{name:null,default_column_driver_data_type_id:null,default_column_driver_data_type_params:null,description:"",is_private:!1,default_table_color:null,is_table_comments_collapsed:!1,is_autosave_enabled:!0,errors:{}}}},computed:{...Q("diagram",{diagram:"getDiagram"}),...Q("constants",{tableColors:"tableColors"}),...Q(["blueprint","totalUnsavedUpdates"]),isNameChanged(){return this.form.name!==this.diagram.name},canCreatePrivateDiagrams(){return this.teamInUrl.cans.can_create_private_diagrams},StatamicUrls(){return Re}},methods:{useCanvasStore:me,...Ce("diagram",{dispatchSetDiagram:"setDiagram"}),...Ce({dispatchSetBlueprint:"setBlueprint"}),activate(){this.form.name=this.diagram.name,this.form.default_column_driver_data_type_id=this.diagram.default_column_driver_data_type_id,this.form.default_column_driver_data_type_params=this.diagram.default_column_driver_data_type_params?this.diagram.default_column_driver_data_type_params:[],this.form.description=this.diagram.description??"",this.form.is_private=this.diagram.is_private,this.form.default_table_color=this.diagram.default_table_color,this.form.is_table_comments_collapsed=this.blueprint.is_table_comments_collapsed,this.form.is_autosave_enabled=this.blueprint.is_autosave_enabled,this.form.errors={}},onChangeDefaultTableColorRadio(e){e&&(this.form.default_table_color=_.head(this.tableColors))},async save(){try{this.form.errors={},this.state=Ma;const e=_.omit(this.form,["is_table_comments_collapsed","is_autosave_enabled"]),s=await axios.patch(`/api/diagrams/${this.diagram.id}`,e),d={...this.diagram,...s.data.data};this.dispatchSetDiagram(d),this._replaceUrl(d.slug);const g=_.pick(this.form,["is_table_comments_collapsed","is_autosave_enabled"]),r=await axios.patch(`/api/blueprints/${this.blueprint.id}`,g),u={...this.blueprint,..._.pick(r.data.data,["is_table_comments_collapsed","is_autosave_enabled"])};this.dispatchSetBlueprint(u),this.activate(),this.state=Oa,setTimeout(()=>{this.state=He},3500)}catch(e){this.state=Na,_.isUndefined(e.response.data.errors)?this.form.errors={generic:e.response.data.message}:this.form.errors=e.response.data.errors}},_replaceUrl(e){window.history.replaceState(null,null,`/teams/${this.teamInUrl.slug}/diagrams/${e}`+window.location.search)}}}),Ra={class:"flex"},ja=t("div",{class:"w-1/3 pr-5 text-lg"},"Diagram Properties",-1),za={class:"w-2/3 pl-5"},Fa={key:0,class:"mt-1 text-xs italic text-yellow-600"},Ga={class:"mt-3"},qa={key:0,class:"mt-3"},Ha={class:"mt-1"},Wa={class:"flex"},Qa={class:"inline-flex w-1/2 items-center"},Xa=t("span",{class:"ml-2"},"Public",-1),Ya={class:"inline-flex w-1/2 items-center"},Ja=["disabled"],Ka={class:"mt-3"},Za=t("hr",{class:"my-5"},null,-1),eo={class:"flex"},to=t("div",{class:"w-1/3 pr-5 text-lg"},[y(" Editor config "),t("div",{class:"mt-2 text-sm text-gray-500"}," Display preferences and defaults when new columns or tables are created. ")],-1),so={class:"w-2/3 pl-5"},ao={class:"mt-1 flex"},oo={class:"w-1/2"},io={class:"inline-flex w-full items-center"},no=["checked"],ro=t("span",{class:"ml-2"},"Selected color",-1),lo={class:"mt-1 inline-flex w-full items-center"},uo=t("span",{class:"ml-2"},"Auto assign",-1),co={class:"w-1/2"},mo={class:"mt-5"},po={class:"mt-1 w-1/2"},fo={key:0,class:"mt-5"},go=["href"],ho={class:"flex"},vo={class:"inline-flex w-1/2 items-center"},yo=t("span",{class:"ml-2"},"Always show",-1),_o={class:"inline-flex w-1/2 items-center"},bo=t("span",{class:"ml-2"},"Collapsed",-1),wo=t("hr",{class:"my-5"},null,-1),xo={class:"flex"},So=t("div",{class:"w-1/3 pr-5 text-lg"},[y(" Autosave "),t("div",{class:"mt-2 text-sm text-gray-500"}," Enable periodic autosave to reduce data loss. Autosave is triggered within the specified interval if there are unsaved changes. ")],-1),To={class:"w-2/3 pl-5"},$o={class:"mt-1 flex"},ko={class:"w-1/2"},Io={class:"inline-flex w-full items-center"},Co=t("span",{class:"ml-2"},"On",-1),Bo={class:"mt-1 inline-flex w-full items-center"},Do=t("span",{class:"ml-2"},"Off",-1),Eo={class:"mt-3"},Vo={class:"relative mt-2 w-3/12 rounded-md shadow-sm"},Lo=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},[t("span",{id:"price-currency",class:"text-gray-500 sm:text-sm"},"minutes")],-1),Ao=t("hr",{class:"my-5"},null,-1),Uo={class:"mt-2 flex w-full items-center justify-center"},Mo=t("div",{class:"invisible w-1/3"},null,-1),Oo={class:"w-1/3 text-center"},No={class:"w-1/3"},Po={key:0,class:"text-right font-semibold text-teal-600"},Ro={key:1,class:"text-left font-semibold text-red-600"};function jo(e,s,d,g,r,u){const i=h("BaseAlertError"),a=h("BaseLabel"),l=h("BaseInput"),m=h("BaseTextArea"),x=h("LabelPro"),w=h("BaseColorPicker"),k=h("DataTypeAutocompleteCombobox"),C=h("BaseSvgIcon"),f=h("BaseButtonSolid"),B=h("BaseForm"),U=h("BaseModal");return o(),D(U,{"model-value":e.modelValue,"onUpdate:modelValue":s[13]||(s[13]=E=>e.$emit("update:modelValue",E)),onBeforeOpen:e.activate},{title:p(()=>[y(" Diagram settings ")]),content:p(()=>[e.form?(o(),D(B,{key:0,class:"w-full space-y-6"},{default:p(()=>[e.form.errors.generic?(o(),D(i,{key:0,class:"mb-3"},{default:p(()=>[y(M(e.form.errors.generic),1)]),_:1})):b("",!0),t("div",Ra,[ja,t("div",za,[t("div",null,[t("div",null,[c(a,{for:"name",value:"Name"}),c(l,{id:"name",modelValue:e.form.name,"onUpdate:modelValue":s[0]||(s[0]=E=>e.form.name=E),type:"text",class:"mt-1 block w-full",required:"",errors:[e.form.errors.name,e.form.errors.slug]},null,8,["modelValue","errors"])]),e.isNameChanged&&e.state!=="STATE_FAILURE"?(o(),v("div",Fa," Note: A name change will also update the diagram slug and might break all external links to this diagram. ")):b("",!0)]),t("div",Ga,[t("div",null,[c(a,{for:"description",value:"Description"}),c(m,{modelValue:e.form.description,"onUpdate:modelValue":s[1]||(s[1]=E=>e.form.description=E),type:"text",class:"mt-1 block w-full",required:"",rows:"2",placeholder:"Optional diagram description",error:e.form.errors.description},null,8,["modelValue","error"])])]),e.canManageDiagram?(o(),v("div",qa,[c(a,{for:"is_private",value:"View access"}),t("div",Ha,[t("div",Wa,[t("label",Qa,[oe(t("input",{"onUpdate:modelValue":s[2]||(s[2]=E=>e.form.is_private=E),type:"radio",class:"form-radio text-indigo-500",name:"is_private",value:!1},null,512),[[fe,e.form.is_private]]),Xa]),t("label",Ya,[oe(t("input",{"onUpdate:modelValue":s[3]||(s[3]=E=>e.form.is_private=E),type:"radio",class:"form-radio text-indigo-500",name:"is_private",disabled:!e.canCreatePrivateDiagrams,value:!0},null,8,Ja),[[fe,e.form.is_private]]),t("span",{class:H(["ml-2",{"text-gray-500":!e.canCreatePrivateDiagrams}])},"Private",2),e.teamInUrl?(o(),D(x,{key:0,"key-for-access":"can_create_private_diagrams",team:e.teamInUrl},null,8,["team"])):b("",!0)])])])])):b("",!0),t("div",Ka,[c(a,{value:"Database"}),t("div",null,[t("i",{class:H(["mr-1 text-gray-700",[e.getDatabaseDriverIconClass(e.blueprint.driver)]])},null,2),y(M(e.getDatabaseDriverText(e.blueprint.driver)),1)])])])]),Za,t("div",eo,[to,t("div",so,[t("div",null,[c(a,{value:"Default table color"}),t("div",ao,[t("div",oo,[t("label",io,[t("input",{type:"radio",class:"form-radio text-indigo-500",name:"default_table_color",checked:!!e.form.default_table_color,value:!0,onInput:s[4]||(s[4]=(...E)=>e.onChangeDefaultTableColorRadio&&e.onChangeDefaultTableColorRadio(...E))},null,40,no),ro]),t("label",lo,[oe(t("input",{"onUpdate:modelValue":s[5]||(s[5]=E=>e.form.default_table_color=E),type:"radio",class:"form-radio text-indigo-500",name:"default_table_color",value:null},null,512),[[fe,e.form.default_table_color]]),uo])]),t("div",co,[e.form.default_table_color?(o(),D(w,{key:0,modelValue:e.form.default_table_color,"onUpdate:modelValue":s[6]||(s[6]=E=>e.form.default_table_color=E),swatches:e.tableColors},null,8,["modelValue","swatches"])):b("",!0)])])]),t("div",mo,[c(a,{value:"Default column datatype"}),t("div",po,[c(k,{"driver-data-type-id":e.form.default_column_driver_data_type_id,"onUpdate:driverDataTypeId":s[7]||(s[7]=E=>e.form.default_column_driver_data_type_id=E),"driver-data-type-params":e.form.default_column_driver_data_type_params,"onUpdate:driverDataTypeParams":s[8]||(s[8]=E=>e.form.default_column_driver_data_type_params=E),dark:"",width:"14rem","teleport-target":!0,"show-button":!1,placement:"right-start",strategy:"fixed","is-arrow-attached":!0,"input-class":`bg-white border border-gray-300 rounded-md py-2 px-4 text-gray-800 leading-tight cursor-text
                              focus:ring-indigo-500 focus:border-indigo-500 focus:ring-1`},null,8,["driver-data-type-id","driver-data-type-params"])])]),e.useCanvasStore().isCanvasVersionV1?(o(),v("div",fo,[c(a,null,{default:p(()=>[y(" Table comments style "),t("a",{tabindex:"-1",href:e.StatamicUrls["b5c2d49e-3401-4e46-a831-b53d57d3a7ed"],target:"_blank"},[c(C,{class:"ml-1 text-gray-500 hover:text-teal-600",icon:"zondicons/information-outline",size:1})],8,go)]),_:1}),t("div",ho,[t("label",vo,[oe(t("input",{"onUpdate:modelValue":s[9]||(s[9]=E=>e.form.is_table_comments_collapsed=E),type:"radio",class:"form-radio text-indigo-500",name:"is_table_comments_collapsed",value:!1},null,512),[[fe,e.form.is_table_comments_collapsed]]),yo]),t("label",_o,[oe(t("input",{"onUpdate:modelValue":s[10]||(s[10]=E=>e.form.is_table_comments_collapsed=E),type:"radio",class:"form-radio text-indigo-500",name:"is_table_comments_collapsed",value:!0},null,512),[[fe,e.form.is_table_comments_collapsed]]),bo])])])):b("",!0)])]),wo,t("div",xo,[So,t("div",To,[t("div",null,[c(a,{value:"Autosave"}),t("div",$o,[t("div",ko,[t("label",Io,[oe(t("input",{"onUpdate:modelValue":s[11]||(s[11]=E=>e.form.is_autosave_enabled=E),type:"radio",class:"form-radio text-indigo-500",name:"is_autosave_enabled",value:!0},null,512),[[fe,e.form.is_autosave_enabled]]),Co]),t("label",Bo,[oe(t("input",{"onUpdate:modelValue":s[12]||(s[12]=E=>e.form.is_autosave_enabled=E),type:"radio",class:"form-radio text-indigo-500",name:"is_autosave_enabled",value:!1},null,512),[[fe,e.form.is_autosave_enabled]]),Do])])]),t("div",Eo,[c(a,{for:"autosaveInterval",value:"Autosave interval"}),t("div",Vo,[c(l,{id:"autosaveInterval",disabled:"","model-value":5,type:"text",class:"mt-1 block w-full pr-16"}),Lo])])])])]),Ao,t("div",Uo,[Mo,t("div",Oo,[c(f,{"is-loading":e.state==="STATE_SAVING",onClick:e.save},{default:p(()=>[y(" Save settings ")]),_:1},8,["is-loading","onClick"])]),t("div",No,[c(Bt,{"enter-active-class":"transition-all transition-medium ease-out-quad","leave-active-class":"transition-all transition-medium ease-in-quad","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:p(()=>[e.state==="STATE_SUCCESS"?(o(),v("div",Po,[c(C,{icon:"zondicons/checkmark-outline",class:"mr-1"}),y("Saved! ")])):e.state==="STATE_FAILURE"?(o(),v("div",Ro," Couldn't save, please check errors ")):b("",!0)]),_:1})])])]),_:1})):b("",!0)]),_:1},8,["model-value","onBeforeOpen"])}const zo=W(Pa,[["render",jo]]),We="STATE_IDLE",Fo="STATE_SAVING",Go="STATE_SUCCESS",qo="STATE_FAILURE",Ho=X({components:{BaseSvgIcon:ae,BaseSvgImage:ve,BaseButtonWhite:Fe,BaseTextArea:at,BaseModalTwoPane:be,BaseButtonSolid:we,BaseLabel:ct,BaseInput:ot,BaseAlertError:it},props:{modelValue:{type:Boolean,default:!1,required:!0}},emits:["update:modelValue","showAllVersions"],data(){return{state:We,isLoading:!1,form:{name:"",note:""},formErrors:{}}},computed:{...Q("diagram",{diagram:"getDiagram"})},methods:{beforeOpen(){this.state=We,this.form={name:"",note:""},this.formErrors={}},async save(){try{this.state=Fo,await this.$store.dispatch("saveDiagram",{shouldToast:!1,shouldRefetchDiagram:!0,amplitudeTag:"Blueprint saved - tag new version"}),this.formErrors={};const e=this.form;await axios.post(`/api/diagrams/${this.diagram.id}/versions`,e),this.state=Go}catch(e){this.state=qo,_.isUndefined(e.response.data.errors)?this.formErrors={generic:e.response.data.message}:this.formErrors=e.response.data.errors}},showAllVersions(){this.$emit("update:modelValue"),this.$emit("showAllVersions")}}}),Wo=t("div",{class:"mb-2 text-left text-gray-700"}," Versions help you better document your diagram changes and maintain a trail of how it evolves over time. You will be able to easily preview, restore or duplicate created versions into a new diagram. ",-1),Qo={class:"mt-5 flex-col"},Xo={key:0},Yo={class:"mt-3 w-full"},Jo={class:"mt-3 w-full"},Ko={class:"mt-3 w-full"},Zo={class:"mt-8 flex w-full justify-between"},ei={key:1},ti={class:"mb-5 mt-8 rounded border border-gray-300 p-5"},si={class:"flex w-full items-center justify-center text-xl text-indigo-600"},ai={class:"mt-2 w-full break-words text-center text-gray-500"},oi={class:"mt-8 flex w-full justify-between"};function ii(e,s,d,g,r,u){const i=h("BaseSvgImage"),a=h("BaseAlertError"),l=h("BaseLabel"),m=h("BaseInput"),x=h("BaseTextArea"),w=h("BaseButtonWhite"),k=h("BaseButtonSolid"),C=h("BaseSvgIcon"),f=h("BaseModalTwoPane");return o(),D(f,{width:"3xl","model-value":e.modelValue,"onUpdate:modelValue":s[3]||(s[3]=B=>e.$emit("update:modelValue",B)),onBeforeOpen:e.beforeOpen},{image:p(()=>[c(i,{width:"160px",svg:"undraw/undraw_treasure_of-9-i"})]),title:p(()=>[y(" Tag a new version ")]),content:p(()=>[Wo,t("div",Qo,[e.state!=="STATE_SUCCESS"?(o(),v("div",Xo,[t("div",Yo,[e.formErrors.generic?(o(),D(a,{key:0,class:"mb-3"},{default:p(()=>[y(M(e.formErrors.generic),1)]),_:1})):b("",!0)]),t("div",Jo,[c(l,{for:"name",value:"Version name"}),c(m,{id:"name",modelValue:e.form.name,"onUpdate:modelValue":s[0]||(s[0]=B=>e.form.name=B),type:"text",class:"mt-1 block w-full",errors:e.formErrors.name,required:""},null,8,["modelValue","errors"])]),t("div",Ko,[c(l,{for:"note",value:"Notes (Optional)"}),c(x,{id:"note",modelValue:e.form.note,"onUpdate:modelValue":s[1]||(s[1]=B=>e.form.note=B),class:"mt-1 block w-full",error:e.formErrors.note,rows:"2",placeholder:"Include an optional description of what have changed for this version.",name:"note"},null,8,["modelValue","error"])]),t("div",Zo,[c(w,{onClick:e.showAllVersions},{default:p(()=>[y(" View all versions ")]),_:1},8,["onClick"]),c(k,{"is-loading":e.state==="STATE_SAVING",onClick:e.save},{default:p(()=>[y(" Save & Tag ")]),_:1},8,["is-loading","onClick"])])])):b("",!0),e.state==="STATE_SUCCESS"?(o(),v("div",ei,[t("div",ti,[t("div",si,[c(C,{size:.8,icon:"zondicons/checkmark-outline",class:"mr-1"}),y("New version tagged! ")]),t("div",ai,[y(" We've successfully tagged this new version as "),t("strong",null,M(e.form.name),1),y(". ")])]),t("div",oi,[c(w,{onClick:e.showAllVersions},{default:p(()=>[y(" View all versions ")]),_:1},8,["onClick"]),c(k,{onClick:s[2]||(s[2]=B=>e.$emit("update:modelValue"))},{default:p(()=>[y(" Done ")]),_:1})])])):b("",!0)])]),_:1},8,["model-value","onBeforeOpen"])}const ni=W(Ho,[["render",ii]]);const Qe="STATE_ACTIVATING",Xe="STATE_IDLE",ri="STATE_CONFIRM",li="STATE_RESTORING",di="STATE_SUCCESS",Ye="STATE_FAILURE",ui=X({components:{BaseButtonSolid:we,BaseSvgIcon:ae,BaseButtonWhite:Fe,BaseSvgImage:ve,BaseSpinner:Ue,BaseModal:ze,BaseCardStatus:st},directives:{tooltip:Ot},props:{modelValue:{type:Boolean,default:!1,required:!0}},emits:["update:modelValue"],setup(){const{teamInUrl:e}=le();return{teamInUrl:e}},data(){return{state:Qe,isLoading:!1,versions:[],team:this.teamInUrl,restoreToVersionId:null,error:null}},computed:{...Q("diagram",{diagram:"getDiagram"}),restoreToVersion(){return this.restoreToVersionId?_.find(this.versions,{id:this.restoreToVersionId}):null}},methods:{...Ce({dispatchReloadCanvas:"reloadCanvas",dispatchSetBlueprint:"setBlueprint"}),async beforeOpen(){try{this.state=Qe;const e=await axios.get(`/api/diagrams/${this.diagram.id}/versions`);this.versions=e.data.data,this.state=Xe}catch(e){this.state=Ye,this.error=e}},restoreConfirm(e){this.restoreToVersionId=e,this.state=ri},async restore(){try{this.state=li,await axios.post(`/api/diagrams/${this.diagram.id}/versions/${this.restoreToVersionId}/restores`),this.state=di,this.timer=setTimeout(()=>window.location.reload(),5e3)}catch(e){this.state=Ye,this.error=e}},getPreviewUrl(e){return`/teams/${this.team.slug}/diagrams/${this.diagram.slug}/versions/${e}`},cancelRestore(){this.state=Xe},close(){this.$emit("update:modelValue")}}}),$e=e=>(Ne("data-v-137baa31"),e=e(),Pe(),e),ci={key:0,class:"flex w-full items-center justify-center"},mi={class:"py-32 text-lg tracking-wider text-gray-600"},pi={key:1},fi={key:0,class:"mx-24 my-8 text-center"},gi=$e(()=>t("p",{class:"text-gray-600"}," This diagram does not have any tagged versions, yet. Save & tag your first version via the dropdown (top-right, next to the save button) to start! ",-1)),hi={class:"flex w-4/12 items-center truncate pr-2 text-left text-gray-600"},vi=["src"],yi={class:"truncate leading-5"},_i=$e(()=>t("br",null,null,-1)),bi={class:"text-sm italic"},wi={class:"my-auto w-1/2 pr-1"},xi={class:"truncate font-bold text-gray-700"},Si={class:"version-description text-xs text-gray-500"},Ti={class:"flex w-2/12 justify-end"},$i=["href"],ki=["onClick"],Ii={key:2},Ci={class:"mb-5 mt-8 rounded bg-yellow-100 p-5"},Bi={class:"mb-3 flex items-center text-left text-yellow-600"},Di=$e(()=>t("span",{class:"ml-2 text-2xl font-semibold"},"Are you sure?",-1)),Ei={class:"mt-2 w-full break-words text-left leading-normal text-gray-600"},Vi=["href"],Li={class:"italic"},Ai=$e(()=>t("span",{class:"font-bold text-yellow-600"},"replace the current diagram",-1)),Ui={class:"mt-8 flex w-full justify-end space-x-4"},Mi={key:3,class:"flex w-full items-center justify-center"},Oi={class:"py-32 text-lg tracking-wider text-indigo-900"},Ni={class:"italic"},Pi={class:"mt-8 flex w-full items-center justify-center"},Ri=$e(()=>t("p",null,"Reloading the diagram now ...",-1));function ji(e,s,d,g,r,u){const i=h("BaseSpinner"),a=h("BaseSvgImage"),l=h("BaseSvgIcon"),m=h("BaseButtonWhite"),x=h("BaseButtonSolid"),w=h("BaseCardStatus"),k=h("BaseModal"),C=Dt("tooltip");return o(),D(k,{width:"2xl","model-value":e.modelValue,"onUpdate:modelValue":s[0]||(s[0]=f=>e.$emit("update:modelValue",f)),onBeforeOpen:e.beforeOpen},{title:p(()=>[y(" Version History ")]),content:p(()=>[e.state==="STATE_ACTIVATING"?(o(),v("div",ci,[t("div",mi,[c(i,{size:6,class:"mr-3 inline-flex"}),y("Loading diagram versions ... ")])])):b("",!0),e.state==="STATE_IDLE"?(o(),v("ul",pi,[e.versions.length===0?(o(),v("div",fi,[gi,c(a,{class:"mt-5",height:"100px",width:"100px",svg:"undraw/undraw_no_data_re_kwbl"})])):b("",!0),(o(!0),v(Z,null,ne(e.versions,f=>(o(),v("li",{key:f.id,class:"my-1 flex w-full rounded-lg py-3 px-2 hover:bg-gray-100"},[t("div",hi,[t("img",{class:"mr-2 rounded-full",style:{height:"30px",width:"30px"},src:f.created_by.profile_photo_url,alt:""},null,8,vi),t("div",yi,[y(M(f.create_at_relative),1),_i,t("span",bi,M(f.created_by.name),1)])]),t("div",wi,[t("div",xi,M(f.name),1),t("div",Si,M(f.note),1)]),t("span",Ti,[oe((o(),v("a",{class:"flex inline-flex cursor-pointer items-center rounded py-2 px-2 font-medium tracking-wider text-gray-400 hover:bg-gray-200 hover:text-teal-600 focus:outline-none focus:ring-2",href:e.getPreviewUrl(f.id),target:"_blank"},[c(l,{icon:"zondicons/view-show",size:1.2})],8,$i)),[[C,"Preview"]]),oe((o(),v("button",{class:"ml-1 flex inline-flex cursor-pointer items-center rounded py-2 px-2 font-medium tracking-wider text-gray-400 hover:bg-gray-200 hover:text-red-600 focus:outline-none focus:ring-2",onClick:B=>e.restoreConfirm(f.id)},[c(l,{icon:"zondicons/reload",size:1.2})],8,ki)),[[C,"Restore to this version"]])])]))),128))])):b("",!0),e.state==="STATE_CONFIRM"&&e.restoreToVersion?(o(),v("div",Ii,[t("div",Ci,[t("div",Bi,[c(l,{size:1.5,icon:"zondicons/exclamation-outline"}),Di]),t("div",Ei,[y(" Are you sure you'd like to restore diagram "),t("strong",null,M(e.diagram.name),1),y(" to version "),t("a",{class:"cursor-pointer font-bold text-indigo-600 underline",href:e.getPreviewUrl(e.restoreToVersion.id),target:"_blank"},M(e.restoreToVersion.name),9,Vi),y(" that was created "),t("span",Li,M(e.restoreToVersion.create_at_relative),1),y(". This will "),Ai,y(" and you will lose any changes made. All previous versions will still remain intact. ")])]),t("div",Ui,[c(m,{size:"xl",onClick:e.cancelRestore},{default:p(()=>[y(" Cancel ")]),_:1},8,["onClick"]),c(x,{variant:"warning",size:"xl",onClick:e.restore},{default:p(()=>[y("Restore")]),_:1},8,["onClick"])])])):b("",!0),e.state==="STATE_RESTORING"?(o(),v("div",Mi,[t("div",Oi,[c(i,{size:6,class:"mr-3 inline-flex"}),y("Restoring from previous version ... ")])])):b("",!0),e.state==="STATE_SUCCESS"?(o(),D(w,{key:4,type:"success",onButtonClicked:e.close},{header:p(()=>[c(l,{size:1.3,icon:"celebrate"}),y(" Restore completed! ")]),default:p(()=>[t("p",null,[y(" Your diagram has been successfully restored to version: "),t("span",Ni,M(e.restoreToVersion.name),1)]),t("div",Pi,[c(i,{size:6,class:"mr-2 inline-flex text-gray-500"}),Ri])]),_:1},8,["onButtonClicked"])):b("",!0),e.state==="STATE_FAILURE"?(o(),D(w,{key:5,type:"error","additional-details":e.error,"button-text":"Back to diagram",onButtonClicked:e.close},null,8,["additional-details","onButtonClicked"])):b("",!0)]),_:1},8,["model-value","onBeforeOpen"])}const zi=W(ui,[["render",ji],["__scopeId","data-v-137baa31"]]),Fi=X({components:{BaseSvgIcon:ae,BaseButtonSolid:we,BaseButtonWhite:Fe,BaseModalTwoPane:be,BaseSvgImage:ve},props:{modelValue:{type:Boolean,default:!1,required:!0},title:{type:String,required:!0,default:""},description:{type:String,required:!0,default:""}},emits:["update:modelValue"],setup(){const{teamInUrl:e}=le();return{teamInUrl:e}},data(){return{isUpgradeButtonHovered:!1}},computed:{subscriptionPageUrl(){return this.teamInUrl.subscription_page_url},StatamicUrls(){return Re}},methods:{}}),Gi={class:"py-5 text-gray-700 opacity-75"},qi={class:"mb-3 text-xl font-bold text-gray-800"},Hi=["href"],Wi={class:"mt-5 flex-col"},Qi={class:"mt-8 flex w-full justify-between"};function Xi(e,s,d,g,r,u){const i=h("BaseSvgImage"),a=h("BaseButtonWhite"),l=h("BaseSvgIcon"),m=h("BaseButtonSolid"),x=h("BaseModalTwoPane");return o(),D(x,{"data-cy":"plan-upgrade-modal","model-value":e.modelValue,width:"3xl","onUpdate:modelValue":s[1]||(s[1]=w=>e.$emit("update:modelValue",w))},{image:p(()=>[c(i,{width:"180px",svg:"undraw/undraw_be_the_hero_ssr2"})]),title:p(()=>[he(e.$slots,"title",{},()=>[y(" 🔒 Available with upgrade ")])]),content:p(()=>[t("div",Gi,[t("h2",qi,M(e.title),1),y(" "+M(e.description)+" ",1),t("a",{class:"text-indigo-600 underline",href:e.StatamicUrls["1afa2148-e293-4457-b076-610e382a15c1"],target:"_blank"},"Find out more",8,Hi)]),t("div",Wi,[t("div",Qi,[c(a,{size:"2xl",onClick:s[0]||(s[0]=w=>e.$emit("update:modelValue"))},{default:p(()=>[y(" Maybe later ")]),_:1}),c(m,{size:"2xl",as:"a",href:e.subscriptionPageUrl,target:"_blank",class:"group","data-cy":"plan-upgrade-to-billing-button"},{default:p(()=>[y(" Upgrade "),c(l,{class:"hidden group-hover:inline-block",size:1.5,icon:"celebrate"})]),_:1},8,["href"])])])]),_:3},8,["model-value"])}const Yi=W(Fi,[["render",Xi]]);var mt={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */(function(e,s){(function(g,r){e.exports=r()})(Et,function(){return function(){var d={686:function(u,i,a){a.d(i,{default:function(){return Ve}});var l=a(279),m=a.n(l),x=a(370),w=a.n(x),k=a(817),C=a.n(k);function f(O){try{return document.execCommand(O)}catch{return!1}}var B=function(S){var I=C()(S);return f("cut"),I},U=B;function E(O){var S=document.documentElement.getAttribute("dir")==="rtl",I=document.createElement("textarea");I.style.fontSize="12pt",I.style.border="0",I.style.padding="0",I.style.margin="0",I.style.position="absolute",I.style[S?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;return I.style.top="".concat(n,"px"),I.setAttribute("readonly",""),I.value=O,I}var T=function(S,I){var n=E(S);I.container.appendChild(n);var V=C()(n);return f("copy"),n.remove(),V},P=function(S){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},n="";return typeof S=="string"?n=T(S,I):S instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(S==null?void 0:S.type)?n=T(S.value,I):(n=C()(S),f("copy")),n},q=P;function ee(O){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ee=function(I){return typeof I}:ee=function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},ee(O)}var L=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=S.action,n=I===void 0?"copy":I,V=S.container,A=S.target,F=S.text;if(n!=="copy"&&n!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(A!==void 0)if(A&&ee(A)==="object"&&A.nodeType===1){if(n==="copy"&&A.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(n==="cut"&&(A.hasAttribute("readonly")||A.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(F)return q(F,{container:V});if(A)return n==="cut"?U(A):q(A,{container:V})},$=L;function N(O){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?N=function(I){return typeof I}:N=function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},N(O)}function j(O,S){if(!(O instanceof S))throw new TypeError("Cannot call a class as a function")}function R(O,S){for(var I=0;I<S.length;I++){var n=S[I];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(O,n.key,n)}}function G(O,S,I){return S&&R(O.prototype,S),I&&R(O,I),O}function z(O,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function");O.prototype=Object.create(S&&S.prototype,{constructor:{value:O,writable:!0,configurable:!0}}),S&&re(O,S)}function re(O,S){return re=Object.setPrototypeOf||function(n,V){return n.__proto__=V,n},re(O,S)}function Y(O){var S=ue();return function(){var n=ye(O),V;if(S){var A=ye(this).constructor;V=Reflect.construct(n,arguments,A)}else V=n.apply(this,arguments);return pe(this,V)}}function pe(O,S){return S&&(N(S)==="object"||typeof S=="function")?S:K(O)}function K(O){if(O===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O}function ue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function ye(O){return ye=Object.setPrototypeOf?Object.getPrototypeOf:function(I){return I.__proto__||Object.getPrototypeOf(I)},ye(O)}function xe(O,S){var I="data-clipboard-".concat(O);if(S.hasAttribute(I))return S.getAttribute(I)}var _e=function(O){z(I,O);var S=Y(I);function I(n,V){var A;return j(this,I),A=S.call(this),A.resolveOptions(V),A.listenClick(n),A}return G(I,[{key:"resolveOptions",value:function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof V.action=="function"?V.action:this.defaultAction,this.target=typeof V.target=="function"?V.target:this.defaultTarget,this.text=typeof V.text=="function"?V.text:this.defaultText,this.container=N(V.container)==="object"?V.container:document.body}},{key:"listenClick",value:function(V){var A=this;this.listener=w()(V,"click",function(F){return A.onClick(F)})}},{key:"onClick",value:function(V){var A=V.delegateTarget||V.currentTarget,F=this.action(A)||"copy",ke=$({action:F,container:this.container,target:this.target(A),text:this.text(A)});this.emit(ke?"success":"error",{action:F,text:ke,trigger:A,clearSelection:function(){A&&A.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(V){return xe("action",V)}},{key:"defaultTarget",value:function(V){var A=xe("target",V);if(A)return document.querySelector(A)}},{key:"defaultText",value:function(V){return xe("text",V)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(V){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return q(V,A)}},{key:"cut",value:function(V){return U(V)}},{key:"isSupported",value:function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],A=typeof V=="string"?[V]:V,F=!!document.queryCommandSupported;return A.forEach(function(ke){F=F&&!!document.queryCommandSupported(ke)}),F}}]),I}(m()),Ve=_e},828:function(u){var i=9;if(typeof Element<"u"&&!Element.prototype.matches){var a=Element.prototype;a.matches=a.matchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector||a.webkitMatchesSelector}function l(m,x){for(;m&&m.nodeType!==i;){if(typeof m.matches=="function"&&m.matches(x))return m;m=m.parentNode}}u.exports=l},438:function(u,i,a){var l=a(828);function m(k,C,f,B,U){var E=w.apply(this,arguments);return k.addEventListener(f,E,U),{destroy:function(){k.removeEventListener(f,E,U)}}}function x(k,C,f,B,U){return typeof k.addEventListener=="function"?m.apply(null,arguments):typeof f=="function"?m.bind(null,document).apply(null,arguments):(typeof k=="string"&&(k=document.querySelectorAll(k)),Array.prototype.map.call(k,function(E){return m(E,C,f,B,U)}))}function w(k,C,f,B){return function(U){U.delegateTarget=l(U.target,C),U.delegateTarget&&B.call(k,U)}}u.exports=x},879:function(u,i){i.node=function(a){return a!==void 0&&a instanceof HTMLElement&&a.nodeType===1},i.nodeList=function(a){var l=Object.prototype.toString.call(a);return a!==void 0&&(l==="[object NodeList]"||l==="[object HTMLCollection]")&&"length"in a&&(a.length===0||i.node(a[0]))},i.string=function(a){return typeof a=="string"||a instanceof String},i.fn=function(a){var l=Object.prototype.toString.call(a);return l==="[object Function]"}},370:function(u,i,a){var l=a(879),m=a(438);function x(f,B,U){if(!f&&!B&&!U)throw new Error("Missing required arguments");if(!l.string(B))throw new TypeError("Second argument must be a String");if(!l.fn(U))throw new TypeError("Third argument must be a Function");if(l.node(f))return w(f,B,U);if(l.nodeList(f))return k(f,B,U);if(l.string(f))return C(f,B,U);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function w(f,B,U){return f.addEventListener(B,U),{destroy:function(){f.removeEventListener(B,U)}}}function k(f,B,U){return Array.prototype.forEach.call(f,function(E){E.addEventListener(B,U)}),{destroy:function(){Array.prototype.forEach.call(f,function(E){E.removeEventListener(B,U)})}}}function C(f,B,U){return m(document.body,f,B,U)}u.exports=x},817:function(u){function i(a){var l;if(a.nodeName==="SELECT")a.focus(),l=a.value;else if(a.nodeName==="INPUT"||a.nodeName==="TEXTAREA"){var m=a.hasAttribute("readonly");m||a.setAttribute("readonly",""),a.select(),a.setSelectionRange(0,a.value.length),m||a.removeAttribute("readonly"),l=a.value}else{a.hasAttribute("contenteditable")&&a.focus();var x=window.getSelection(),w=document.createRange();w.selectNodeContents(a),x.removeAllRanges(),x.addRange(w),l=x.toString()}return l}u.exports=i},279:function(u){function i(){}i.prototype={on:function(a,l,m){var x=this.e||(this.e={});return(x[a]||(x[a]=[])).push({fn:l,ctx:m}),this},once:function(a,l,m){var x=this;function w(){x.off(a,w),l.apply(m,arguments)}return w._=l,this.on(a,w,m)},emit:function(a){var l=[].slice.call(arguments,1),m=((this.e||(this.e={}))[a]||[]).slice(),x=0,w=m.length;for(x;x<w;x++)m[x].fn.apply(m[x].ctx,l);return this},off:function(a,l){var m=this.e||(this.e={}),x=m[a],w=[];if(x&&l)for(var k=0,C=x.length;k<C;k++)x[k].fn!==l&&x[k].fn._!==l&&w.push(x[k]);return w.length?m[a]=w:delete m[a],this}},u.exports=i,u.exports.TinyEmitter=i}},g={};function r(u){if(g[u])return g[u].exports;var i=g[u]={exports:{}};return d[u](i,i.exports,r),i.exports}return function(){r.n=function(u){var i=u&&u.__esModule?function(){return u.default}:function(){return u};return r.d(i,{a:i}),i}}(),function(){r.d=function(u,i){for(var a in i)r.o(i,a)&&!r.o(u,a)&&Object.defineProperty(u,a,{enumerable:!0,get:i[a]})}}(),function(){r.o=function(u,i){return Object.prototype.hasOwnProperty.call(u,i)}}(),r(686)}().default})})(mt);var Ji=mt.exports;const Ki=Ke(Ji);function Zi(e){const s=(e==null?void 0:e.appendToBody)===void 0?!0:e.appendToBody;return{toClipboard(d,g){return new Promise((r,u)=>{const i=document.createElement("button"),a=new Ki(i,{text:()=>d,action:()=>"copy",container:g!==void 0?g:document.body});a.on("success",l=>{a.destroy(),r(l)}),a.on("error",l=>{a.destroy(),u(l)}),s&&document.body.appendChild(i),i.click(),s&&document.body.removeChild(i)})}}}const en=X({components:{JetActionMessage:zt,BaseSvgImage:ve,BaseModalTwoPane:be},props:{modelValue:{type:Boolean,default:!1,required:!0}},emits:["update:modelValue"],setup(){let e=ie(null);const{teamInUrl:s}=le(),{toClipboard:d}=Zi();return{toClipboard:d,buttonCopyRef:e,teamInUrl:s}},data(){return{timerId:null,diagramUrl:"",showCopiedText:!1,supportsClipboard:!1}},computed:{...Q("diagram",{diagram:"getDiagram"})},created(){navigator.clipboard&&(this.supportsClipboard=!0)},methods:{beforeOpen(){this.diagramUrl=route("team-diagram.show",[this.teamInUrl,this.diagram])},inputClicked(){this.$refs.diagramUrlInput.select()},async copyToClipboard(){this.$refs.diagramUrlInput.select(),this.$refs.diagramUrlInput.setSelectionRange(0,99999),await navigator.clipboard.writeText(this.diagramUrl)},resetTimer(){this.timerId&&(clearTimeout(this.timerId),this.timerId=null)},onCopied(){this.resetTimer(),this.showCopiedText=!0,this.timerId=setTimeout(()=>this.showCopiedText=!1,2e3)}}}),tn={class:"mb-2 text-left text-gray-700"},sn={key:0},an=t("strong",null,"private",-1),on={key:1},nn={class:"my-5 flex-col"},rn={class:"mt-3 w-full"},ln={class:"flex justify-between"},dn=t("label",{class:"mb-2 block text-sm font-bold text-gray-700",for:"name"}," Share link ",-1),un={class:"flex"},cn=t("span",null,"Copy",-1),mn=[cn];function pn(e,s,d,g,r,u){const i=h("BaseSvgImage"),a=h("JetActionMessage"),l=h("BaseModalTwoPane");return o(),D(l,{"model-value":e.modelValue,width:"3xl","initial-focus":e.buttonCopyRef,"onUpdate:modelValue":s[3]||(s[3]=m=>e.$emit("update:modelValue",m)),onBeforeOpen:e.beforeOpen},{image:p(()=>[c(i,{width:"180px",svg:"undraw/undraw_link_shortener_mvf6"})]),title:p(()=>[y(" Share diagram link ")]),content:p(()=>[t("div",tn,[e.diagram.is_private?(o(),v("span",sn,[y("Diagram access is set to "),an,y(". Hence, only invited team members and guests can access the diagram via this link.")])):(o(),v("span",on,"Anyone with this link will get view-only access, and only team members can edit the diagram."))]),t("div",nn,[t("div",null,[t("div",rn,[t("div",ln,[dn,e.showCopiedText?(o(),D(a,{key:0,on:!0},{default:p(()=>[y(" Copied ")]),_:1})):b("",!0)]),t("div",un,[oe(t("input",{id:"name",ref:"diagramUrlInput","onUpdate:modelValue":s[0]||(s[0]=m=>e.diagramUrl=m),readonly:"",class:H(["inline appearance-none rounded border border-gray-200 bg-gray-200 py-2 px-2 text-sm leading-tight leading-tight text-gray-700 focus:outline-none focus:ring-0",{"w-9/12 rounded-r-none":e.supportsClipboard,"w-full":!e.supportsClipboard}]),type:"text",onClick:s[1]||(s[1]=(...m)=>e.inputClicked&&e.inputClicked(...m))},null,2),[[et,e.diagramUrl]]),e.supportsClipboard?(o(),v("button",{key:0,class:"inline w-3/12 cursor-pointer rounded rounded-l-none border border-indigo-500 bg-indigo-500 py-2 px-5 font-medium tracking-wider text-white hover:bg-indigo-600 focus:outline-none",onClick:s[2]||(s[2]=(...m)=>e.copyToClipboard&&e.copyToClipboard(...m))},mn)):b("",!0)])])])])]),_:1},8,["model-value","initial-focus","onBeforeOpen"])}const fn=W(en,[["render",pn]]),gn=X({components:{BaseModalTwoPane:be,BaseSvgImage:ve},props:{modelValue:{type:Boolean,default:!1,required:!0}},emits:["update:modelValue"],setup(){const{teamInUrl:e}=le();return{teamInUrl:e}},data(){return{embedLink:"",embedHtml:""}},computed:{...Q("diagram",{diagram:"getDiagram"})},methods:{beforeOpen(){this.embedLink=route("team-diagram-embed.show",[this.teamInUrl,this.diagram]),this.embedHtml=`
        <iframe
          width="100%"
          height="500px"
          style="box-shadow: 0 2px 8px 0 rgba(63,69,81,0.16); border-radius:15px;"
          allowtransparency="true"
          allowfullscreen="true"
          scrolling="no"
          title="Embedded DrawSQL IFrame"
          frameborder="0"
          src="${this.embedLink}"></iframe>
    `},embedInputClicked(){this.$refs.embedInput.select()}}}),hn=t("div",{class:"mb-2 text-left text-gray-700"}," Embed this database schema into your blog, documentation, or any other websites. Embeds will be view-only, and will automatically be kept up to date. ",-1),vn={key:0,class:"my-5 rounded border-l-4 border-yellow-500 bg-yellow-100 py-3 px-2 text-yellow-700 shadow",role:"alert"},yn=t("div",{class:"flex items-center"},[t("div",{class:"py-1"},[t("svg",{class:"mr-4 h-6 w-6 fill-current text-yellow-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[t("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})])]),t("div",null,[t("p",{class:"text-sm"}," This diagram has private access - only public diagrams can be embedded right now. ")])],-1),_n=[yn],bn={key:1,class:"my-5 flex-col"},wn={class:"mt-5 w-full"},xn=t("label",{class:"mb-2 block text-sm font-bold text-gray-700"}," iframe ",-1),Sn={class:"flex"},Tn={class:"w-full rounded bg-gray-200 p-3 text-sm text-gray-700"},$n={class:"mt-8 w-full"},kn=t("label",{class:"mb-2 block text-sm font-bold text-gray-700"}," Link only ",-1);function In(e,s,d,g,r,u){const i=h("BaseSvgImage"),a=h("BaseModalTwoPane");return o(),D(a,{"model-value":e.modelValue,width:"3xl","initial-focus":null,"onUpdate:modelValue":s[2]||(s[2]=l=>e.$emit("update:modelValue",l)),onBeforeOpen:e.beforeOpen},{image:p(()=>[c(i,{width:"180px",svg:"undraw/undraw_insert_re_s97w"})]),title:p(()=>[y(" Embed diagram ")]),content:p(()=>[hn,e.diagram.is_private?(o(),v("div",vn,_n)):(o(),v("div",bn,[t("div",null,[t("div",wn,[xn,t("div",Sn,[t("span",Tn,M(e.embedHtml),1)])]),t("div",$n,[kn,oe(t("input",{ref:"embedInput","onUpdate:modelValue":s[0]||(s[0]=l=>e.embedLink=l),readonly:"",class:"inline w-full appearance-none rounded border border-gray-200 bg-gray-200 py-2 px-2 text-sm leading-tight leading-tight text-gray-700 focus:border-indigo-500 focus:bg-gray-100 focus:outline-none",type:"text",onClick:s[1]||(s[1]=(...l)=>e.embedInputClicked&&e.embedInputClicked(...l))},null,512),[[et,e.embedLink]])])])]))]),_:1},8,["model-value","onBeforeOpen"])}const Cn=W(gn,[["render",In]]);function pt(){const e=se(()=>Lt().props.auth.user),s=(d,g=null)=>{if(!e.value){let r="/login?redirectUrl="+encodeURIComponent(d);return g&&(r+="&redirectText="+encodeURIComponent(g)),r}return d};return{user:Vt(e),urlOrLoginFirst:s}}const Bn=X({name:"ViewOnlyDropdown",components:{BasePopover:Gt,BaseSvgIcon:ae},setup(){const{currentTeam:e}=Ft(),{user:s}=pt();return{currentTeam:e,user:s}},computed:{...Q(["totalUnsavedUpdates"]),loginUrl(){return"/login?redirectUrl="+encodeURIComponent(window.location.pathname)}}}),Dn={class:"bg-white p-5 leading-relaxed text-grey-darker"},En={key:0},Vn=t("strong",null,"view",-1),Ln=["href"],An={key:1},Un=t("strong",null,"view",-1);function Mn(e,s,d,g,r,u){const i=h("BaseSvgIcon"),a=h("BasePopover");return o(),D(a,{width:"300px",offset:[0,4],strategy:"fixed"},{trigger:p(()=>[t("button",{class:H(["mt-0 block w-full rounded border px-4 py-2 leading-none text-white no-underline hover:bg-white hover:text-indigo-500 focus:outline-0",[{"border-white":e.totalUnsavedUpdates===0,"border-amber font-medium hover:border-white hover:shadow-lg":e.totalUnsavedUpdates>0}]])},[c(i,{icon:"heroicons/outline/eye",size:1,class:H([{"text-yellow-400 hover:text-indigo-600":e.totalUnsavedUpdates>0}])},null,8,["class"]),y(" View Only "),c(i,{size:1.25,icon:"heroicons/solid/chevron-down"})],2)]),content:p(()=>[t("div",Dn,[e.user?(o(),v("span",An,[y(" You can only "),Un,y(" this diagram. To save updates, request edit access from the diagram owner or admins. ")])):(o(),v("div",En,[y(" You're not logged in. You can "),Vn,y(" this public diagram, but will need to login to save changes. "),t("a",{class:"mt-3 ml-auto block rounded bg-teal-500 py-2 px-5 text-center font-bold text-teal-50 hover:bg-teal-700 focus:outline-none",style:{width:"fit-content"},href:e.loginUrl}," Login ",8,Ln)]))])]),_:1})}const On=W(Bn,[["render",Mn]]);function Nn(e={}){const s=Te(),{interval:d=5*60*1e3}=e;async function g(){!s.state.isViewOnly&&s.getters.totalUnsavedUpdates>0&&await s.dispatch("saveDiagram",{shouldToast:!1,shouldRefetchDiagram:!1,amplitudeTag:"Blueprint saved - autosave",shouldSkipIfRecentlySaved:!0})}const{isActive:r,pause:u,resume:i}=ht(g,d);return{isActive:r,pause:u,resume:i}}const Pn={__name:"ListboxDiagramVisibility",props:{modelValue:{type:Boolean,default:null,required:!0},teleportTarget:{type:[Boolean,String],required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1}},setup(e){const{teamInUrl:s}=le(),d=se(()=>s.value.cans.can_create_private_diagrams),g=[{text:"Public",value:!1},{text:"Private",value:!0,disabled:!d.value,icon:d.value?null:"heroicons/v2-outline/lock-closed"}],r=e,u=se(()=>"focus:bg-gray-100 hover:bg-gray-100 ring-1 ring-inset ring-gray-300 px-2 flex items-center font-bold "+(r.modelValue?"text-teal-500":"text-yellow-500"));return(i,a)=>(o(),D(Rt,{disabled:e.disabled,placement:"bottom-end",strategy:"fixed",width:"120px","model-value":e.modelValue,items:g,"teleport-target":e.teleportTarget,"show-append-icon":!0,class:"h-full rounded bg-transparent text-xs text-gray-500","trigger-classes":u.value,"onUpdate:modelValue":a[0]||(a[0]=l=>i.$emit("update:modelValue",l))},Oe({_:2},[ne(i.$slots,(l,m)=>({name:m,fn:p(x=>[x?he(i.$slots,m,Ze(Je({key:0},x))):he(i.$slots,m,{key:1})])}))]),1032,["disabled","model-value","teleport-target","trigger-classes"]))}},Rn=t("div",{"aria-hidden":"true"},[t("div",{class:"h-px"}),t("div",{class:"pt-2"},[t("div",{class:"py-px"},[t("div",{class:"h-8"})])])],-1),jn={class:"absolute inset-x-px bottom-0"},zn={class:"flex items-center justify-between space-x-3 border-t border-gray-200 px-2 py-1 sm:px-3"},Fn={class:"flex items-center"},Gn=t("div",{class:"text-xs leading-5"},[t("div",null,"Guests can only be granted view access to diagrams."),t("div",null," To grant edit access, add them as a team member first. ")],-1),qn={class:"flex-shrink-0"},Hn={__name:"TeamUsersAndGroupsAndGuestsInvite",props:{diagramId:{type:Number,default:null,required:!0},userIdsToExclude:{type:Array,default:()=>[],required:!1},membershipIdsToExclude:{type:Array,default:()=>[],required:!1},groupIdsToExclude:{type:Array,default:()=>[],required:!1},teamSlug:{type:String,default:"",required:!0},disabled:{type:Boolean,default:!1,required:!1},searchPlaceholder:{type:String,default:"Invite team members, groups or guests",required:!1}},emits:["invited"],setup(e,{emit:s}){const d=e,g=s;let r=ie([]),u=ie([]),i=ie([]),a=ie(ge.VIEW),l=ie(!1),m=ie(!1);const x=se(()=>i.value.length>0?[ge.VIEW]:[ge.ADMIN,ge.EDIT,ge.VIEW]),w=async()=>{l.value=!0;let k=null,C=null;(r.value.length>0||u.value.length>0)&&(k=await axios.post(`/api/diagrams/${d.diagramId}/permissibles`,{membership_ids:r.value.map(f=>f.id),group_ids:u.value.map(f=>f.id),permission:a.value})),i.value.length>0&&(C=await axios.post(`/api/diagrams/${d.diagramId}/invitations`,{emails:i.value.map(f=>f.email),permission:a.value})),g("invited",{diagramPermissibles:k?k.data.data:[],diagramInvitations:C?C.data.data:[]}),l.value=!1,r.value=[],u.value=[],i.value=[]};return tt(i,(k,C)=>{k.length>C&&(a.value=ge.VIEW)}),(k,C)=>(o(),D(Wt,{modelValueMemberships:ce(r),"onUpdate:modelValueMemberships":C[1]||(C[1]=f=>Se(r)?r.value=f:r=f),modelValueGroups:ce(u),"onUpdate:modelValueGroups":C[2]||(C[2]=f=>Se(u)?u.value=f:u=f),modelValueDiagramInvitations:ce(i),"onUpdate:modelValueDiagramInvitations":C[3]||(C[3]=f=>Se(i)?i.value=f:i=f),disabled:e.disabled,offset:2,"user-ids-to-exclude":e.userIdsToExclude,"membership-ids-to-exclude":e.membershipIdsToExclude,"group-ids-to-exclude":e.groupIdsToExclude,"teleport-target":!0,"full-width-content":!0,"adaptive-width":!0,"team-slug":e.teamSlug,"can-invite-guests":!0,"search-placeholder":e.searchPlaceholder,"onUpdate:query":C[4]||(C[4]=f=>Se(m)?m.value=!0:m=!0)},Oe({_:2},[ce(m)?{name:"toolbarSpacer",fn:p(()=>[Rn]),key:"0"}:void 0,ce(m)?{name:"toolbar",fn:p(()=>[t("div",jn,[t("div",zn,[t("div",Fn,[c(nt,{modelValue:ce(a),"onUpdate:modelValue":C[0]||(C[0]=f=>Se(a)?a.value=f:a=f),placement:"right-start","trigger-classes":"hover:bg-gray-100 active:bg-gray-100 focus:bg-gray-100 px-2","allowed-diagram-permission-option-values":x.value},null,8,["modelValue","allowed-diagram-permission-option-values"]),ce(i).length>0?(o(),D(ce(je),{key:0,class:"flex items-center","popper-class":"popper-in-dialog"},{popper:p(()=>[Gn]),default:p(()=>[c(ae,{size:"1",class:"ml-0.5 text-gray-400",icon:"heroicons/v2-outline/information-circle"})]),_:1})):b("",!0)]),t("div",qn,[c(we,{size:"sm","is-loading":ce(l),onClick:w},{default:p(()=>[y(" Send invite ")]),_:1},8,["is-loading"])])])])]),key:"1"}:void 0]),1032,["modelValueMemberships","modelValueGroups","modelValueDiagramInvitations","disabled","user-ids-to-exclude","membership-ids-to-exclude","group-ids-to-exclude","team-slug","search-placeholder"]))}},Wn={class:"flex items-center justify-between py-2 px-4 text-sm leading-6"},Qn={class:"flex w-full max-w-full items-center gap-x-4"},Xn={class:"flex h-8 w-8 items-center justify-center"},Yn={class:"min-w-0 grow space-y-0.5"},Jn={class:"flex items-center"},Kn={class:"truncate text-sm font-semibold text-gray-900"},Zn={class:"truncate text-xs text-gray-500"},er={class:"shrink-0 grow-0 font-semibold"},tr={__name:"DiagramGuestUserListItem",props:{user:{type:Object,default:null,required:!0}},setup(e){return(s,d)=>(o(),v("li",Wn,[t("div",Qn,[t("div",Xn,[c(ae,{class:"h-8 w-8 px-0.5 text-gray-400",size:"2",icon:"heroicons/v2-outline/identification"})]),t("div",Yn,[t("div",Jn,[t("p",Kn,M(e.user.name),1),c(rt,{class:"ml-1 flex-shrink-0 flex-grow-0"})]),t("p",Zn,M(e.user.email),1)]),t("span",er,[he(s.$slots,"rightContent")])])]))}},sr={class:"flex items-center justify-between py-2 px-4 text-sm leading-6"},ar={class:"flex w-full max-w-full items-center gap-x-4"},or={class:"flex h-8 w-8 items-center justify-center"},ir={class:"min-w-0 grow space-y-0.5"},nr={class:"flex items-center"},rr=t("p",{class:"truncate text-sm font-semibold text-gray-900"}," Invite sent ",-1),lr={class:"truncate text-xs text-gray-500"},dr={class:"shrink-0 grow-0 font-semibold"},ur={__name:"DiagramInvitationListItem",props:{email:{type:String,default:null,required:!0}},setup(e){return(s,d)=>(o(),v("li",sr,[t("div",ar,[t("div",or,[c(ae,{class:"h-8 w-8 px-0.5 text-gray-400",size:"2",icon:"heroicons/v2-outline/envelope"})]),t("div",ir,[t("div",nr,[rr,c(rt,{class:"ml-1 flex-shrink-0 flex-grow-0"})]),t("p",lr,M(e.email),1)]),t("span",dr,[he(s.$slots,"rightContent")])])]))}},cr="STATE_IDLE",mr=X({components:{DiagramInvitationListItem:ur,TeamGuestUserListItem:tr,TeamGroupListItem:Qt,LabelPro:Ee,ListboxOption:jt,TeamUsersAndGroupsAndGuestsInvite:Hn,BaseSpinner:Ue,TeamUserListItem:Xt,ListboxDiagramVisibility:Pn,ListboxDiagramPermission:nt,BaseSvgIcon:ae,BaseModal:ze,VTooltip:je},props:{modelValue:{type:Boolean,default:!1,required:!0}},emits:["update:modelValue"],setup(){const e=Te(),{teamInUrl:s}=le(),d=Be().getDatabaseDriverIconClass,g=Be().getDatabaseDriverText,r=De("emitter"),u=se(()=>s.value.cans.can_share_with_team),i=se(()=>e.getters["diagramAccess/canManageDiagram"]),a=se(()=>e.getters["diagramAccess/teamAdminsCount"]);return{DIAGRAM_PERMISSIONS:ge,canManageDiagram:i,teamAdminsCount:a,teamInUrl:s,canShareWithTeam:u,getDatabaseDriverIconClass:d,getDatabaseDriverText:g,emitter:r}},data(){return{owner:null,existingDiagramPermissibles:[],existingDiagramPermissiblesBeingUpdated:[],existingDiagramInvitations:[],existingDiagramInvitationsBeingUpdated:[],state:cr,isLoading:!1,form:{is_private:!1},loaders:{isUpdatingDiagramVisibility:!1,isDiagramPermissiblesLoading:!1}}},computed:{...Q("diagram",{diagram:"getDiagram"}),...Q("constants",{tableColors:"tableColors"}),...Q(["blueprint","totalUnsavedUpdates"]),StatamicUrls(){return Re},isNameChanged(){return this.form.name!==this.diagram.name},existingMembershipDiagramPermissibles(){return this.existingDiagramPermissibles.filter(e=>e.diagram_permissible.type==="membership")},existingGroupDiagramPermissibles(){return this.existingDiagramPermissibles.filter(e=>e.diagram_permissible.type==="group")},existingGuestUserDiagramPermissibles(){return this.existingDiagramPermissibles.filter(e=>e.diagram_permissible.type==="user")}},methods:{...Ce("diagram",{dispatchUpdateDiagram:"updateDiagram"}),async activate(){this.form.is_private=this.diagram.is_private;const e=[this.loadDiagramUsersFromApi(),this.loadDiagramOwnerFromApi(),this.loadDiagramInvitationsFromApi()];await Promise.all(e)},appendToExistingDiagramPermissibles({diagramPermissibles:e,diagramInvitations:s}){this.existingDiagramPermissibles=Ge(e,this.existingDiagramPermissibles,"id"),this.existingDiagramInvitations=Ge(s,this.existingDiagramInvitations,"id")},async loadDiagramUsersFromApi(){this.loaders.isDiagramPermissiblesLoading=!0;const e=await axios.get(`/api/diagrams/${this.diagram.id}/permissibles`);this.existingDiagramPermissibles=e.data.data,this.loaders.isDiagramPermissiblesLoading=!1},async loadDiagramOwnerFromApi(){const e=await axios.get(route("api.diagram-owner.show",{diagram:this.diagram}));this.owner=e.data.data},async loadDiagramInvitationsFromApi(){const e=await axios.get(`/api/diagrams/${this.diagram.id}/invitations`);this.existingDiagramInvitations=e.data.data},async updateDiagramVisibility(e){const s={is_private:e};this.loaders.isUpdatingDiagramVisibility=!0;try{const d=await axios.patch(`/api/diagrams/${this.diagram.id}`,s);await this.dispatchUpdateDiagram({prop:"is_private",value:d.data.data.is_private}),this.emitter.emit("toast-success","Diagram visibility updated.")}catch(d){console.error(d),this.form.is_private=!e,this.emitter.emit("toast-error","Failed to update diagram visibility.")}finally{this.loaders.isUpdatingDiagramVisibility=!1}},async updateDiagramPermissible(e,s){if(e==="no-access"){await this.deleteDiagramUserPermission(s);return}this.existingDiagramPermissiblesBeingUpdated.push(s.id);try{await axios.patch(route("api.diagram-permissible.update",[this.diagram,s]),{permission:e}),s.permission=e,this.emitter.emit("toast-success","Permission updated.")}catch(d){console.error(d),this.emitter.emit("toast-error","Failed to update permission.")}finally{this.existingDiagramPermissiblesBeingUpdated=this.existingDiagramPermissiblesBeingUpdated.filter(d=>d!==s.id)}},async updateDiagramInvitation(e,s){if(e==="no-access"){await this.deleteDiagramInvitation(s);return}},async deleteDiagramUserPermission(e){this.existingDiagramPermissiblesBeingUpdated.push(e.id);try{await axios.delete(`/api/diagrams/${this.diagram.id}/permissibles/${e.id}`),this.existingDiagramPermissibles=this.existingDiagramPermissibles.filter(s=>s.id!==e.id),this.emitter.emit("toast-success","Permission revoked.")}catch{this.emitter.emit("toast-error","Failed to revoke permission.")}finally{this.existingDiagramPermissiblesBeingUpdated=this.existingDiagramPermissiblesBeingUpdated.filter(s=>s!==e.id)}},async deleteDiagramInvitation(e){this.existingDiagramInvitationsBeingUpdated.push(e.id);try{await axios.delete(`/api/diagrams/${this.diagram.id}/invitations/${e.id}`),this.existingDiagramInvitations=this.existingDiagramInvitations.filter(s=>s.id!==e.id),this.emitter.emit("toast-success","Invitation revoked.")}catch{this.emitter.emit("toast-error","Failed to revoke invitation.")}finally{this.existingDiagramInvitationsBeingUpdated=this.existingDiagramInvitationsBeingUpdated.filter(s=>s!==e.id)}}}}),pr={key:0,class:"w-full space-y-6"},fr={class:"flex"},gr=t("div",{class:"w-1/3 pr-5 text-lg"},"Public access",-1),hr={class:"w-2/3 pl-5"},vr={class:"flex items-center justify-between"},yr={class:"flex flex-grow flex-col"},_r={class:"flex items-center text-sm font-medium leading-6 text-gray-900"},br={class:"mt-2 rounded-lg bg-gray-50 shadow-sm ring-1 ring-gray-900/5"},wr={class:"py-2 px-4 text-sm leading-6"},xr={key:0,class:"flex items-start"},Sr={class:"shrink-0"},Tr=t("div",{class:"ml-2"},[y(" Diagram is "),t("strong",{class:"text-yellow-500"},"public"),y(". Anybody with the link can access and view this diagram. ")],-1),$r={key:1,class:"flex items-start"},kr={class:"shrink-0"},Ir=t("div",{class:"ml-2"},[y(" Diagram is "),t("strong",{class:"text-teal-500"},"private"),y(". Only invited team members and guests can access this diagram. ")],-1),Cr=t("hr",{class:"my-5"},null,-1),Br={class:"flex"},Dr={class:"w-1/3 pr-5 text-lg"},Er=t("div",{class:"leading-5"},"Granular access permissions",-1),Vr={class:"mt-2 text-sm text-gray-500"},Lr=["href"],Ar={class:"w-2/3 pl-5"},Ur={key:0,class:"relative mb-4"},Mr=t("label",{for:"combobox",class:"block text-sm font-medium leading-6 text-gray-900"},"Send invite",-1),Or={class:"rounded-lg bg-gray-50 shadow-sm ring-1 ring-gray-900/5"},Nr={class:"divide-y divide-gray-900/5"},Pr=t("span",{class:"px-2 text-xs font-normal text-gray-500"},"Owner",-1),Rr={key:1,class:"px-2 text-xs font-normal text-gray-500"},jr=t("span",{class:"flex items-center justify-between py-1.5 pl-6 pr-4 text-red-500"}," Remove access ",-1),zr=[jr],Fr={key:1,class:"px-2 text-xs font-normal text-gray-500"},Gr=t("span",{class:"flex items-center justify-between py-1.5 pl-6 pr-4 text-red-500"}," Remove access ",-1),qr=[Gr],Hr={key:1,class:"px-2 text-xs font-normal text-gray-500"},Wr=t("span",{class:"flex items-center justify-between py-1.5 pl-6 pr-4 text-red-500"}," Remove access ",-1),Qr=[Wr],Xr={key:1,class:"px-2 text-xs font-normal text-gray-500"},Yr=t("span",{class:"flex items-center justify-between py-1.5 pl-6 pr-4 text-red-500"}," Revoke invite ",-1),Jr=[Yr],Kr={key:1,class:"flex items-center justify-between py-2 px-4 text-sm leading-6"},Zr={class:"flex items-center gap-x-4"},el={class:"min-w-0 flex-auto space-y-0.5"},tl={class:"text-sm font-medium text-gray-400"},sl=["href"],al={class:"ml-1 inline-flex items-center rounded-full bg-gray-200 px-1.5 py-0.5 text-xs font-medium text-gray-500 ring-1 ring-inset ring-gray-700/10"},ol=t("span",{class:"ml-2 flex-shrink-0 font-semibold"},[t("span",{class:"px-2 text-xs font-normal text-gray-500"},"Can admin")],-1);function il(e,s,d,g,r,u){const i=h("LabelPro"),a=h("BaseSpinner"),l=h("ListboxDiagramVisibility"),m=h("BaseSvgIcon"),x=h("TeamUsersAndGroupsAndGuestsInvite"),w=h("TeamUserListItem"),k=h("ListboxOption"),C=h("ListboxDiagramPermission"),f=h("TeamGroupListItem"),B=h("TeamGuestUserListItem"),U=h("DiagramInvitationListItem"),E=h("BaseModal");return o(),D(E,{width:"2xl","model-value":e.modelValue,"initial-focus":null,"onUpdate:modelValue":s[1]||(s[1]=T=>e.$emit("update:modelValue",T)),onBeforeOpen:e.activate},{title:p(()=>[y("Diagram access")]),content:p(()=>[e.form?(o(),v("div",pr,[t("div",fr,[gr,t("div",hr,[t("div",vr,[t("span",yr,[t("span",_r,[y("Diagram visibility "),e.teamInUrl?(o(),D(i,{key:0,"key-for-access":"can_create_private_diagrams",team:e.teamInUrl},null,8,["team"])):b("",!0)])]),e.loaders.isUpdatingDiagramVisibility?(o(),D(a,{key:0,class:"-ml-1 mr-1.5 text-gray-400",size:3.5})):b("",!0),c(l,{modelValue:e.form.is_private,"onUpdate:modelValue":[s[0]||(s[0]=T=>e.form.is_private=T),e.updateDiagramVisibility],disabled:!e.canManageDiagram},null,8,["modelValue","disabled","onUpdate:modelValue"])]),t("div",br,[t("div",wr,[e.form.is_private?b("",!0):(o(),v("div",xr,[t("div",Sr,[c(m,{icon:"heroicons/outline/exclamation-circle",class:"h-6 w-6 text-yellow-500",size:1.5})]),Tr])),e.form.is_private?(o(),v("div",$r,[t("div",kr,[c(m,{icon:"heroicons/outline/check-circle",class:"h-6 w-6 text-teal-500",size:1.5})]),Ir])):b("",!0)])])])]),Cr,t("div",Br,[t("div",Dr,[Er,t("div",Vr,[y(" Manage diagram access or invite team members, groups or external guests. "),t("a",{class:"mt-2 block underline",href:e.StatamicUrls["17b54dab-32bc-45e0-a9d0-9e4cc344a186"]},"Learn more",8,Lr)])]),t("div",Ar,[e.canManageDiagram?(o(),v("div",Ur,[Mr,c(x,{disabled:!e.canManageDiagram,"diagram-id":e.diagram.id,"user-ids-to-exclude":e.owner?[e.owner.id]:[],"membership-ids-to-exclude":e.existingMembershipDiagramPermissibles.map(T=>T.diagram_permissible.id),"group-ids-to-exclude":e.existingGroupDiagramPermissibles.map(T=>T.diagram_permissible.id),"team-slug":e.teamInUrl.slug,class:"mt-2",onInvited:e.appendToExistingDiagramPermissibles},null,8,["disabled","diagram-id","user-ids-to-exclude","membership-ids-to-exclude","group-ids-to-exclude","team-slug","onInvited"])])):b("",!0),t("div",Or,[t("ul",Nr,[e.owner?(o(),D(w,{key:0,user:e.owner},{rightContent:p(()=>[Pr]),_:1},8,["user"])):b("",!0),(o(!0),v(Z,null,ne(e.existingMembershipDiagramPermissibles,T=>(o(),v(Z,{key:T.id},[T.diagram_permissible.user?(o(),D(w,{key:0,user:T.diagram_permissible.user},{rightContent:p(()=>[e.existingDiagramPermissiblesBeingUpdated.includes(T.id)?(o(),D(a,{key:0,class:"-ml-1 mr-1.5 text-gray-400",size:1})):e.canManageDiagram?(o(),D(C,{key:2,"teleport-target":!0,placement:"bottom-start","model-value":T.permission,"onUpdate:modelValue":P=>e.updateDiagramPermissible(P,T)},{appendIcon:p(()=>[c(m,{class:"-mr-1 text-gray-400",icon:"heroicons/mini/chevron-down",size:1.3})]),appendOptions:p(()=>[c(k,{as:"template",value:"no-access"},{default:p(({active:P})=>[t("li",{class:H(["list-option relative rounded hover:cursor-pointer",[{"bg-red-50":P}]])},zr,2)]),_:1})]),_:2},1032,["model-value","onUpdate:modelValue"])):(o(),v("span",Rr,"Can "+M(T.permission),1))]),_:2},1032,["user"])):b("",!0)],64))),128)),(o(!0),v(Z,null,ne(e.existingGroupDiagramPermissibles,T=>(o(),v(Z,{key:T.id},[T.diagram_permissible?(o(),D(f,{key:0,group:T.diagram_permissible,"team-slug":e.teamInUrl.slug},{rightContent:p(()=>[e.existingDiagramPermissiblesBeingUpdated.includes(T.id)?(o(),D(a,{key:0,class:"-ml-1 mr-1.5 text-gray-400",size:1})):e.canManageDiagram?(o(),D(C,{key:2,"teleport-target":!0,placement:"bottom-start","model-value":T.permission,"onUpdate:modelValue":P=>e.updateDiagramPermissible(P,T)},{appendIcon:p(()=>[c(m,{class:"-mr-1 text-gray-400",icon:"heroicons/mini/chevron-down",size:1.3})]),appendOptions:p(()=>[c(k,{as:"template",value:"no-access"},{default:p(({active:P})=>[t("li",{class:H(["list-option relative rounded hover:cursor-pointer",[{"bg-red-50":P}]])},qr,2)]),_:1})]),_:2},1032,["model-value","onUpdate:modelValue"])):(o(),v("span",Fr,"Can "+M(T.permission),1))]),_:2},1032,["group","team-slug"])):b("",!0)],64))),128)),(o(!0),v(Z,null,ne(e.existingGuestUserDiagramPermissibles,T=>(o(),v(Z,{key:T.id},[T.diagram_permissible.type==="user"?(o(),D(B,{key:0,user:T.diagram_permissible},{rightContent:p(()=>[e.existingDiagramPermissiblesBeingUpdated.includes(T.id)?(o(),D(a,{key:0,class:"-ml-1 mr-1.5 text-gray-400",size:1})):e.canManageDiagram?(o(),D(C,{key:2,"teleport-target":!0,placement:"bottom-start","model-value":T.permission,"allowed-diagram-permission-option-values":[e.DIAGRAM_PERMISSIONS.VIEW],"onUpdate:modelValue":P=>e.updateDiagramPermissible(P,T)},{appendIcon:p(()=>[c(m,{class:"-mr-1 text-gray-400",icon:"heroicons/mini/chevron-down",size:1.3})]),appendOptions:p(()=>[c(k,{as:"template",value:"no-access"},{default:p(({active:P})=>[t("li",{class:H(["list-option relative rounded hover:cursor-pointer",[{"bg-red-50":P}]])},Qr,2)]),_:1})]),_:2},1032,["model-value","allowed-diagram-permission-option-values","onUpdate:modelValue"])):(o(),v("span",Hr,"Can "+M(T.permission),1))]),_:2},1032,["user"])):b("",!0)],64))),128)),(o(!0),v(Z,null,ne(e.existingDiagramInvitations,T=>(o(),D(U,{key:T.id,email:T.email},{rightContent:p(()=>[e.existingDiagramInvitationsBeingUpdated.includes(T.id)?(o(),D(a,{key:0,class:"-ml-1 mr-1.5 text-gray-400",size:1})):e.canManageDiagram?(o(),D(C,{key:2,"teleport-target":!0,placement:"bottom-start","model-value":T.permission,"allowed-diagram-permission-option-values":[e.DIAGRAM_PERMISSIONS.VIEW],"onUpdate:modelValue":P=>e.updateDiagramInvitation(P,T)},{appendIcon:p(()=>[c(m,{class:"-mr-1 text-gray-400",icon:"heroicons/mini/chevron-down",size:1.3})]),appendOptions:p(()=>[c(k,{as:"template",value:"no-access"},{default:p(({active:P})=>[t("li",{class:H(["list-option relative rounded hover:cursor-pointer",[{"bg-red-50":P}]])},Jr,2)]),_:1})]),_:2},1032,["model-value","allowed-diagram-permission-option-values","onUpdate:modelValue"])):(o(),v("span",Xr,"Can "+M(T.permission),1))]),_:2},1032,["email"]))),128)),e.teamAdminsCount&&e.teamAdminsCount>1?(o(),v("li",Kr,[t("div",Zr,[t("div",el,[t("p",tl,[t("a",{class:"hover:underline",href:e.route("team-memberships.show",[e.teamInUrl.slug])+"#members",target:"_blank"},"Team admins",8,sl),t("span",al,M(e.teamAdminsCount),1)])])]),ol])):b("",!0)])])])])])):b("",!0)]),_:1},8,["model-value","onBeforeOpen"])}const nl=W(mr,[["render",il]]);const rl=X({components:{ModalManageAccess:nl,VTooltip:je,NavbarUserDropdown:qt,BaseMenu:Ut,BaseSvgIcon:ae,BaseSpinner:Ue,ViewOnlyDropdown:On,NavbarDropdownItem:Zt,ModalExportBlueprint:js,ModalImportBlueprint:La,ModalDiagramSettings:zo,ModalVersionHistory:zi,ModalTagNewVersion:ni,ModalPlanUpgrade:Yi,ModalShareLink:fn,ModalShareEmbed:Cn,LabelPro:Ee},props:{user:{type:Object,required:!1,default:null}},setup(){const e=Te(),s=De("emitter"),{teamInUrl:d,teamInUrlHasPermission:g}=le(),r=pt().urlOrLoginFirst,{isActive:u,pause:i,resume:a}=Nn(),l=se(()=>e.getters.isAutosaveEnabled),m=se(()=>new URLSearchParams(window.location.search).has("playwright-test")),x=se(()=>e.getters["diagramAccess/canViewAccessSettingsDiagram"]);return tt(l,w=>{w?a():i()},{immediate:!0}),{showSaveForTestButton:m,canViewAccessSettingsDiagram:x,teamInUrl:d,teamInUrlHasPermission:g,urlOrLoginFirst:r,emitter:s,isAutosaveEnabled:l}},data(){return{team:this.teamInUrl,isUpgradeToProHovered:!1,isShownModals:{diagramSettings:!1,exportBlueprint:!1,importBlueprint:!1,planUpgrade:!1,shareEmbed:!1,shareLink:!1,manageAccess:!1,tagNewVersion:!1,versionHistory:!1},lastSavedAtHumanized:null}},created(){this.ROLE_PERMISSIONS=Ht},computed:{...Q("diagram",{diagram:"getDiagram"}),...Q(["isSaving","blueprint","totalUnsavedUpdates"]),...Q("driverDataTypes",{driverDataTypes:"getDriverDataTypes"}),isViewOnly(){return this.$store.state.isViewOnly},homeOrLandingPageUrl(){return this.route("diagrams-index")},isOnFreePlan(){return this.team.isOnFreePlan},diagramUrl(){return window.location.origin+`/teams/${this.team.slug}/diagrams/${this.diagram.slug}`},twitterUrl(){return encodeURI(`https://twitter.com/intent/tweet?text=Just created a 🔥 diagram for my schema '${this.diagram.name}' in @drawSQL:
${this.diagramUrl}`)},lastSavedAt(){return this.$store.state.lastSavedAt}},mounted(){window.addEventListener("beforeunload",e=>{if(this.isViewOnly||this.totalUnsavedUpdates===0)return;const s="You have unsaved changes. Are you sure you want leave?";return(e||window.event).returnValue=s,s})},methods:{updateRelativeTime(){this.lastSavedAtHumanized=$t.duration(this.lastSavedAt-new Date).humanize(!0)},async save(){await this.$store.dispatch("saveDiagram",{shouldToast:!0,shouldRefetchDiagram:!0,amplitudeTag:"Blueprint saved - manual"})},async saveForTest(){await this.$store.dispatch("saveDiagram",{shouldToast:!1,shouldRefetchDiagram:!1,amplitudeTag:null})},showExportDialog(){this.isShownModals.exportBlueprint=!0},showImportDialog(){this.isShownModals.importBlueprint=!0},showSettingsDialog(){this.isShownModals.diagramSettings=!0},showTagNewVersionDialog(){if(!this.team.cans.can_version){this.isShownModals.planUpgrade=!0;return}this.isShownModals.tagNewVersion=!0},showVersionHistoryDialog(){if(!this.team.cans.can_version){this.isShownModals.planUpgrade=!0;return}this.isShownModals.versionHistory=!0},requestFullScreen(){this.emitter.emit("request-full-screen")},showShareLinkDialog(){this.isShownModals.shareLink=!0},showShareEmbedDialog(){this.isShownModals.shareEmbed=!0},showManageAccessDialog(){this.isShownModals.manageAccess=!0}}}),de=e=>(Ne("data-v-1ff9a3f3"),e=e(),Pe(),e),ll={class:"top-navbar fixed flex w-full flex-wrap items-center justify-between bg-indigo-500 px-4 py-1 leading-tight shadow-md",style:{"min-height":"55px"}},dl={class:"mr-6 flex shrink-0 items-center text-white"},ul=["href"],cl={class:"ml-4 flex w-auto items-center space-x-1"},ml={key:0},pl={key:1,class:"my-2"},fl=de(()=>t("hr",{class:"my-2"},null,-1)),gl=de(()=>t("div",{class:"flex justify-between px-4 font-semibold text-gray-500"}," New ",-1)),hl=de(()=>t("span",null,"Share",-1)),vl=[hl],yl={class:"text-gray-700"},_l=de(()=>t("div",{class:"grow"},null,-1)),bl={key:0,class:"flex hidden shrink-0 items-center text-lg text-white md:block"},wl=["href"],xl=de(()=>t("span",{class:"mx-1 text-indigo-lighter"},">",-1)),Sl=de(()=>t("div",{class:"grow"},null,-1)),Tl={class:"flex h-full w-auto items-center"},$l={key:0,class:"flex items-center"},kl={class:"mr-4 inline-flex text-indigo-lighter"},Il={class:"text-xs leading-5"},Cl={key:0,class:"font-semibold"},Bl={key:1,class:"font-semibold text-yellow-400"},Dl={key:2,class:"font-semibold"},El={key:3},Vl={class:"inline-flex"},Ll={key:1,class:"mr-2 inline-block h-3 w-2 fill-current text-yellow-400",viewBox:"0 0 20 20"},Al=de(()=>t("circle",{cx:"10",cy:"10",r:"10"},null,-1)),Ul=[Al],Ml={key:2,class:"mr-2 inline-block h-3 w-2 stroke-current",viewBox:"0 0 22 22"},Ol=de(()=>t("circle",{cx:"11",cy:"11",r:"9",fill:"none","stroke-width":"3"},null,-1)),Nl=[Ol],Pl=de(()=>t("span",{style:{"margin-bottom":"1px"}},"Save",-1)),Rl={"data-cy":"navbar-canvas-save-dropdown-button",class:"nav-button mt-0 flex items-center rounded rounded-l-none border border-l-0 border-white px-1 py-1 leading-none text-white no-underline hover:bg-white hover:text-indigo-500 focus:outline-none",type:"button",tabindex:"-1"},jl={class:"py-2 text-gray-700"},zl={key:1,class:"flex items-center"},Fl={key:0,class:"mr-4 mt-0 text-indigo-lighter"},Gl=de(()=>t("span",{class:"text-yellow-400"},"Saves disallowed",-1)),ql=[Gl],Hl={key:1,class:"ml-4 flex w-auto items-center"};function Wl(e,s,d,g,r,u){const i=h("BaseSvgIcon"),a=h("NavbarDropdownItem"),l=h("LabelPro"),m=h("BaseMenu"),x=h("VTooltip"),w=h("BaseSpinner"),k=h("ViewOnlyDropdown"),C=h("NavbarUserDropdown"),f=h("ModalExportBlueprint"),B=h("ModalImportBlueprint"),U=h("ModalTagNewVersion"),E=h("ModalVersionHistory"),T=h("ModalShareLink"),P=h("ModalShareEmbed"),q=h("ModalManageAccess"),ee=h("ModalDiagramSettings"),L=h("ModalPlanUpgrade");return o(),v("nav",ll,[t("div",dl,[t("a",{href:e.homeOrLandingPageUrl},[c(i,{icon:"drawsql-white",size:1.5,class:"ml-2 mr-4"}),c(i,{icon:"drawsql-text-white",width:6,height:1,class:"mr-4 hidden lg:inline-block"})],8,ul),t("div",cl,[c(m,{width:"17rem",strategy:"fixed",offset:4},{trigger:p($=>[t("button",{class:H(["nav-dropdown mt-0 inline-block hidden rounded px-4 py-3 text-base leading-none text-white hover:cursor-pointer hover:bg-indigo-600 hover:shadow-lg md:block",{"bg-indigo-600":$.open}])}," File ",2)]),content:p(()=>[e.isViewOnly?b("",!0):(o(),v("div",ml,[c(a,{icon:"zondicons/cog",onClick:s[0]||(s[0]=$=>e.showSettingsDialog())},{default:p(()=>[y("Settings")]),_:1}),c(a,{icon:"zondicons/time",onClick:s[1]||(s[1]=$=>e.showVersionHistoryDialog())},{default:p(()=>[y("Version History"),c(l,{"key-for-access":"can_version","should-redirect":!1})]),_:1}),c(a,{icon:"zondicons/play-outline",onClick:s[2]||(s[2]=$=>e.requestFullScreen())},{default:p(()=>[y("Presentation Mode")]),_:1})])),e.isViewOnly?b("",!0):(o(),v("hr",pl)),e.isViewOnly?b("",!0):(o(),D(a,{key:2,icon:"zondicons/upload",onClick:s[3]||(s[3]=$=>e.showImportDialog())},{default:p(()=>[y("Import")]),_:1})),c(a,{icon:"zondicons/download",onClick:s[4]||(s[4]=$=>e.showExportDialog())},{default:p(()=>[y("Export")]),_:1}),t("div",null,[fl,gl,c(a,{icon:"zondicons/compose",href:e.urlOrLoginFirst(e.route("diagrams-index",{_query:{new:!0}}),"👋 Please login to create a new diagram."),"new-tab":!0},{default:p(()=>[y("Create a new diagram")]),_:1},8,["href"]),c(a,{icon:"zondicons/plugin",href:"/templates","new-tab":!0},{default:p(()=>[y("Load from templates")]),_:1}),c(a,{icon:"zondicons/edit-copy",href:e.urlOrLoginFirst(e.diagram.clone_url,"👋 Please login to clone the diagram into your account."),"new-tab":!0},{default:p(()=>[y("Make a copy")]),_:1},8,["href"])])]),_:1}),c(m,{strategy:"fixed",offset:4},{trigger:p($=>[t("button",{class:H(["nav-dropdown mt-0 inline-block hidden w-max rounded px-4 py-3 text-base leading-none text-white hover:cursor-pointer hover:bg-indigo-600 md:block",{"bg-indigo-600":$.open}])},vl,2)]),content:p(()=>[t("div",yl,[e.canViewAccessSettingsDiagram?(o(),D(a,{key:0,icon:"heroicons/solid/users",onClick:s[5]||(s[5]=$=>e.showManageAccessDialog())},{default:p(()=>[y("Manage access")]),_:1})):b("",!0),c(a,{icon:"zondicons/link",onClick:s[6]||(s[6]=$=>e.showShareLinkDialog())},{default:p(()=>[y("Sharable Link")]),_:1}),c(a,{icon:"zondicons/code",onClick:s[7]||(s[7]=$=>e.showShareEmbedDialog())},{default:p(()=>[y("Embed")]),_:1}),e.diagram.is_private?b("",!0):(o(),D(a,{key:1,icon:"twitter",href:e.twitterUrl,"new-tab":!0},{default:p(()=>[y("Twitter")]),_:1},8,["href"]))])]),_:1})])]),_l,e.diagram?(o(),v("div",bl,[t("a",{href:e.homeOrLandingPageUrl,class:"text-indigo-lighter hover:text-white hover:underline"},"Diagrams",8,wl),xl,y(" "+M(e.diagram.name),1)])):b("",!0),Sl,t("div",Tl,[e.isViewOnly?b("",!0):(o(),v("div",$l,[t("p",kl,[c(x,{onShow:e.updateRelativeTime},{popper:p(()=>[t("div",Il,[e.isSaving?(o(),v("div",Cl,"Saving...")):b("",!0),!e.isSaving&&e.totalUnsavedUpdates>0?(o(),v("div",Bl," Unsaved changes ")):b("",!0),!e.isSaving&&e.totalUnsavedUpdates===0?(o(),v("div",Dl," All changes saved ")):b("",!0),e.lastSavedAt?(o(),v("div",El," Last saved "+M(e.lastSavedAtHumanized),1)):b("",!0),t("div",null,[y(" Periodic autosave: "),t("strong",null,M(e.isAutosaveEnabled?"On":"Off"),1)])])]),default:p(()=>[t("div",null,[e.isSaving?(o(),D(i,{key:0,style:{"stroke-width":"1"},size:2,icon:"heroicons/custom/cloud-loading"})):b("",!0),!e.isSaving&&e.totalUnsavedUpdates>0?(o(),D(i,{key:1,class:"text-yellow-400",style:{"stroke-width":"1"},size:2,icon:"heroicons/custom/cloud-exclaimation"})):b("",!0),!e.isSaving&&e.totalUnsavedUpdates===0?(o(),D(i,{key:2,style:{"stroke-width":"1"},size:2,icon:"heroicons/custom/cloud-check"})):b("",!0)])]),_:1},8,["onShow"])]),t("div",Vl,[e.showSaveForTestButton?(o(),v("button",{key:0,class:"fixed bottom-0 left-0","data-testid":"canvas-navbar-save-for-test-btn",onClick:s[8]||(s[8]=$=>e.saveForTest())}," Test Save ")):b("",!0),t("a",{href:"#","data-testid":"canvas-navbar-save-btn",class:H(["nav-button mt-0 flex items-center rounded rounded-r-none border px-4 py-3 text-lg leading-none text-white no-underline hover:bg-white hover:text-indigo-500",[{"border-white":e.isSaving||e.totalUnsavedUpdates===0,"border-yellow-400 hover:border-white hover:shadow-lg":!e.isSaving&&e.totalUnsavedUpdates>0}]]),onClick:s[9]||(s[9]=$=>e.save())},[e.isSaving?(o(),D(w,{key:0,class:"-ml-1 mr-1.5",size:3.5})):b("",!0),!e.isSaving&&e.totalUnsavedUpdates>0?(o(),v("svg",Ll,Ul)):b("",!0),!e.isSaving&&e.totalUnsavedUpdates===0?(o(),v("svg",Ml,Nl)):b("",!0),Pl],2),c(m,{width:"210px",strategy:"fixed",offset:4},{trigger:p(()=>[t("button",Rl,[c(i,{icon:"zondicons/cheveron-down",size:1.2})])]),content:p(()=>[t("div",jl,[c(a,{"data-cy":"navbar-canvas-tag-new-version-button",icon:"zondicons/tag",onClick:s[10]||(s[10]=$=>e.showTagNewVersionDialog())},{default:p(()=>[y("Tag a new version")]),_:1})])]),_:1})])])),e.isViewOnly?(o(),v("div",zl,[e.totalUnsavedUpdates>0?(o(),v("p",Fl,ql)):b("",!0),c(k)])):b("",!0)]),e.user?(o(),v("div",Hl,[c(C)])):b("",!0),e.blueprint?(o(),D(f,{key:2,modelValue:e.isShownModals.exportBlueprint,"onUpdate:modelValue":s[11]||(s[11]=$=>e.isShownModals.exportBlueprint=$),blueprint:e.blueprint},null,8,["modelValue","blueprint"])):b("",!0),e.blueprint?(o(),D(B,{key:3,modelValue:e.isShownModals.importBlueprint,"onUpdate:modelValue":s[12]||(s[12]=$=>e.isShownModals.importBlueprint=$),blueprint:e.blueprint},null,8,["modelValue","blueprint"])):b("",!0),c(U,{modelValue:e.isShownModals.tagNewVersion,"onUpdate:modelValue":s[13]||(s[13]=$=>e.isShownModals.tagNewVersion=$),onShowAllVersions:s[14]||(s[14]=$=>e.isShownModals.versionHistory=!0)},null,8,["modelValue"]),c(E,{modelValue:e.isShownModals.versionHistory,"onUpdate:modelValue":s[15]||(s[15]=$=>e.isShownModals.versionHistory=$),onShowAllVersions:s[16]||(s[16]=$=>e.isShownModals.versionHistory=!0)},null,8,["modelValue"]),c(T,{modelValue:e.isShownModals.shareLink,"onUpdate:modelValue":s[17]||(s[17]=$=>e.isShownModals.shareLink=$)},null,8,["modelValue"]),c(P,{modelValue:e.isShownModals.shareEmbed,"onUpdate:modelValue":s[18]||(s[18]=$=>e.isShownModals.shareEmbed=$)},null,8,["modelValue"]),e.canViewAccessSettingsDiagram?(o(),D(q,{key:4,modelValue:e.isShownModals.manageAccess,"onUpdate:modelValue":s[19]||(s[19]=$=>e.isShownModals.manageAccess=$)},null,8,["modelValue"])):b("",!0),c(ee,{modelValue:e.isShownModals.diagramSettings,"onUpdate:modelValue":s[20]||(s[20]=$=>e.isShownModals.diagramSettings=$)},null,8,["modelValue"]),c(L,{modelValue:e.isShownModals.planUpgrade,"onUpdate:modelValue":s[21]||(s[21]=$=>e.isShownModals.planUpgrade=$),title:"Diagram versions",description:"Versions help you better document your diagram changes and maintain a trail of how it evolves over time. You will be able to easily preview, restore or duplicate previously created versions into a new diagram."},null,8,["modelValue","description"])])}const Ql=W(rl,[["render",Wl],["__scopeId","data-v-1ff9a3f3"]]),Xl=X({components:{BlueprintCanvas:vt,NavbarCanvas:Ql,BaseHead:xt,CanvasLayout:yt,BlueprintEditor:_t},props:{...bt()},setup(e){return me().setCanvasVersion(e.canvasVersion),{isCanvasSetup:wt(e)}}});function Yl(e,s,d,g,r,u){const i=h("BaseHead"),a=h("NavbarCanvas"),l=h("BlueprintEditor"),m=h("BlueprintCanvas"),x=h("CanvasLayout");return o(),D(x,null,{navbar:p(()=>[c(a,{user:e.$page.props.auth.user},null,8,["user"])]),default:p(()=>[c(i,{title:e.diagram.name,description:e.diagram.description??`Database schema diagram for ${e.diagram.name}`,image:e.diagram.screenshot_url,"image-alt":`Database schema diagram for ${e.diagram.name}`},null,8,["title","description","image","image-alt"]),e.canvasVersion===1?(o(),D(l,{key:0,ref:"blueprintEditor",blueprint:e.blueprint,"is-view-only":!e.diagramAccess.canUpdateDiagram},null,8,["blueprint","is-view-only"])):b("",!0),e.canvasVersion===2&&e.isCanvasSetup?(o(),D(m,{key:1,blueprint:e.blueprint,"margin-top":"55px","is-view-only":!e.diagramAccess.canUpdateDiagram},null,8,["blueprint","is-view-only"])):b("",!0)]),_:1})}const Pd=W(Xl,[["render",Yl]]);export{Pd as default};
