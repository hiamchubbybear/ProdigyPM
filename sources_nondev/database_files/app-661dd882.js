var Mh=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var it=(t,e,n)=>(Mh(t,e,"read from private field"),n?n.call(t):e.get(t)),ze=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},oi=(t,e,n,i)=>(Mh(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n);var wa=(t,e,n,i)=>({set _(r){oi(t,e,r,n)},get _(){return it(t,e,i)}}),$i=(t,e,n)=>(Mh(t,e,"access private method"),n);import{e as Nf,r as Cb,m as $n,i as Pb,w as Rf,a as Ib,b as Wc,c as kb,t as FE,h as VE,g as zE,o as GE,n as HE,d as UE,f as Ob,j as vs,k as Zn,l as jE,O as WE,p as YE,q as XE,_ as Zt}from"./index.esm-4dcaccf3.js";var qE=!1;function KE(){return Lb().__VUE_DEVTOOLS_GLOBAL_HOOK__}function Lb(){return typeof navigator<"u"&&typeof window<"u"?window:typeof global<"u"?global:{}}const ZE=typeof Proxy=="function",JE="devtools-plugin:setup",QE="plugin:settings:set";let io,Id;function tT(){var t;return io!==void 0||(typeof window<"u"&&window.performance?(io=!0,Id=window.performance):typeof global<"u"&&(!((t=global.perf_hooks)===null||t===void 0)&&t.performance)?(io=!0,Id=global.perf_hooks.performance):io=!1),io}function eT(){return tT()?Id.now():Date.now()}class nT{constructor(e,n){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=n;const i={};if(e.settings)for(const o in e.settings){const a=e.settings[o];i[o]=a.defaultValue}const r=`__vue-devtools-plugin-settings__${e.id}`;let s=Object.assign({},i);try{const o=localStorage.getItem(r),a=JSON.parse(o);Object.assign(s,a)}catch{}this.fallbacks={getSettings(){return s},setSettings(o){try{localStorage.setItem(r,JSON.stringify(o))}catch{}s=o},now(){return eT()}},n&&n.on(QE,(o,a)=>{o===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(o,a)=>this.target?this.target.on[a]:(...l)=>{this.onQueue.push({method:a,args:l})}}),this.proxiedTarget=new Proxy({},{get:(o,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...l)=>(this.targetQueue.push({method:a,args:l,resolve:()=>{}}),this.fallbacks[a](...l)):(...l)=>new Promise(c=>{this.targetQueue.push({method:a,args:l,resolve:c})})})}async setRealTarget(e){this.target=e;for(const n of this.onQueue)this.target.on[n.method](...n.args);for(const n of this.targetQueue)n.resolve(await this.target[n.method](...n.args))}}function iT(t,e){const n=t,i=Lb(),r=KE(),s=ZE&&n.enableEarlyProxy;if(r&&(i.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!s))r.emit(JE,t,e);else{const o=s?new nT(n,r):null;(i.__VUE_DEVTOOLS_PLUGINS__=i.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:e,proxy:o}),o&&e(o.proxiedTarget)}}/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let Mb;const wu=t=>Mb=t,Db=Symbol();function kd(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var za;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(za||(za={}));function rT(){const t=Nf(!0),e=t.run(()=>Cb({}));let n=[],i=[];const r=$n({install(s){wu(r),r._a=s,s.provide(Db,r),s.config.globalProperties.$pinia=r,i.forEach(o=>n.push(o)),i=[]},use(s){return!this._a&&!qE?i.push(s):n.push(s),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return r}const Nb=()=>{};function qg(t,e,n,i=Nb){t.push(e);const r=()=>{const s=t.indexOf(e);s>-1&&(t.splice(s,1),i())};return!n&&zE()&&GE(r),r}function ro(t,...e){t.slice().forEach(n=>{n(...e)})}const sT=t=>t();function Od(t,e){t instanceof Map&&e instanceof Map&&e.forEach((n,i)=>t.set(i,n)),t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const i=e[n],r=t[n];kd(r)&&kd(i)&&t.hasOwnProperty(n)&&!Wc(i)&&!kb(i)?t[n]=Od(r,i):t[n]=i}return t}const oT=Symbol();function aT(t){return!kd(t)||!t.hasOwnProperty(oT)}const{assign:Gr}=Object;function lT(t){return!!(Wc(t)&&t.effect)}function cT(t,e,n,i){const{state:r,actions:s,getters:o}=e,a=n.state.value[t];let l;function c(){a||(n.state.value[t]=r?r():{});const h=UE(n.state.value[t]);return Gr(h,s,Object.keys(o||{}).reduce((u,d)=>(u[d]=$n(Ob(()=>{wu(n);const f=n._s.get(t);return o[d].call(f,f)})),u),{}))}return l=Rb(t,c,e,n,i,!0),l}function Rb(t,e,n={},i,r,s){let o;const a=Gr({actions:{}},n),l={deep:!0};let c,h,u=[],d=[],f;const p=i.state.value[t];!s&&!p&&(i.state.value[t]={}),Cb({});let g;function v(b){let w;c=h=!1,typeof b=="function"?(b(i.state.value[t]),w={type:za.patchFunction,storeId:t,events:f}):(Od(i.state.value[t],b),w={type:za.patchObject,payload:b,storeId:t,events:f});const T=g=Symbol();HE().then(()=>{g===T&&(c=!0)}),h=!0,ro(u,w,i.state.value[t])}const x=s?function(){const{state:w}=n,T=w?w():{};this.$patch(E=>{Gr(E,T)})}:Nb;function S(){o.stop(),u=[],d=[],i._s.delete(t)}function C(b,w){return function(){wu(i);const T=Array.from(arguments),E=[],D=[];function $(O){E.push(O)}function z(O){D.push(O)}ro(d,{args:T,name:b,store:k,after:$,onError:z});let j;try{j=w.apply(this&&this.$id===t?this:k,T)}catch(O){throw ro(D,O),O}return j instanceof Promise?j.then(O=>(ro(E,O),O)).catch(O=>(ro(D,O),Promise.reject(O))):(ro(E,j),j)}}const P={_p:i,$id:t,$onAction:qg.bind(null,d),$patch:v,$reset:x,$subscribe(b,w={}){const T=qg(u,b,w.detached,()=>E()),E=o.run(()=>Rf(()=>i.state.value[t],D=>{(w.flush==="sync"?h:c)&&b({storeId:t,type:za.direct,events:f},D)},Gr({},l,w)));return T},$dispose:S},k=Ib(P);i._s.set(t,k);const m=(i._a&&i._a.runWithContext||sT)(()=>i._e.run(()=>(o=Nf()).run(e)));for(const b in m){const w=m[b];if(Wc(w)&&!lT(w)||kb(w))s||(p&&aT(w)&&(Wc(w)?w.value=p[b]:Od(w,p[b])),i.state.value[t][b]=w);else if(typeof w=="function"){const T=C(b,w);m[b]=T,a.actions[b]=w}}return Gr(k,m),Gr(FE(k),m),Object.defineProperty(k,"$state",{get:()=>i.state.value[t],set:b=>{v(w=>{Gr(w,b)})}}),i._p.forEach(b=>{Gr(k,o.run(()=>b({store:k,app:i._a,pinia:i,options:a})))}),p&&s&&n.hydrate&&n.hydrate(k.$state,p),c=!0,h=!0,k}function is(t,e,n){let i,r;const s=typeof e=="function";typeof t=="string"?(i=t,r=s?n:e):(r=t,i=t.id);function o(a,l){const c=VE();return a=a||(c?Pb(Db,null):null),a&&wu(a),a=Mb,a._s.has(i)||(s?Rb(i,e,r,a):cT(i,r,a)),a._s.get(i)}return o.$id=i,o}function uT(t){return{all:t=t||new Map,on:function(e,n){var i=t.get(e);i?i.push(n):t.set(e,[n])},off:function(e,n){var i=t.get(e);i&&(n?i.splice(i.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var i=t.get(e);i&&i.slice().map(function(r){r(n)}),(i=t.get("*"))&&i.slice().map(function(r){r(e,n)})}}}let ec;const hT=new Uint8Array(16);function dT(){if(!ec&&(ec=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ec))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ec(hT)}const fT=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function $b(t){return typeof t=="string"&&fT.test(t)}const xn=[];for(let t=0;t<256;++t)xn.push((t+256).toString(16).slice(1));function pT(t,e=0){return xn[t[e+0]]+xn[t[e+1]]+xn[t[e+2]]+xn[t[e+3]]+"-"+xn[t[e+4]]+xn[t[e+5]]+"-"+xn[t[e+6]]+xn[t[e+7]]+"-"+xn[t[e+8]]+xn[t[e+9]]+"-"+xn[t[e+10]]+xn[t[e+11]]+xn[t[e+12]]+xn[t[e+13]]+xn[t[e+14]]+xn[t[e+15]]}const gT=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Kg={randomUUID:gT};function Yi(t,e,n){if(Kg.randomUUID&&!e&&!t)return Kg.randomUUID();t=t||{};const i=t.random||(t.rng||dT)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){n=n||0;for(let r=0;r<16;++r)e[n+r]=i[r];return e}return pT(i)}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Bb;function bt(){return Bb.apply(null,arguments)}function mT(t){Bb=t}function Oi(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Cs(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function pe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $f(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(pe(t,e))return!1;return!0}function Yn(t){return t===void 0}function Cr(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function yl(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function Fb(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function Kr(t,e){for(var n in e)pe(e,n)&&(t[n]=e[n]);return pe(e,"toString")&&(t.toString=e.toString),pe(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Ki(t,e,n,i){return l0(t,e,n,i,!0).utc()}function vT(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function jt(t){return t._pf==null&&(t._pf=vT()),t._pf}var Ld;Array.prototype.some?Ld=Array.prototype.some:Ld=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function Bf(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=jt(t),n=Ld.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function _u(t){var e=Ki(NaN);return t!=null?Kr(jt(e),t):jt(e).userInvalidated=!0,e}var Zg=bt.momentProperties=[],Dh=!1;function Ff(t,e){var n,i,r,s=Zg.length;if(Yn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Yn(e._i)||(t._i=e._i),Yn(e._f)||(t._f=e._f),Yn(e._l)||(t._l=e._l),Yn(e._strict)||(t._strict=e._strict),Yn(e._tzm)||(t._tzm=e._tzm),Yn(e._isUTC)||(t._isUTC=e._isUTC),Yn(e._offset)||(t._offset=e._offset),Yn(e._pf)||(t._pf=jt(e)),Yn(e._locale)||(t._locale=e._locale),s>0)for(n=0;n<s;n++)i=Zg[n],r=e[i],Yn(r)||(t[i]=r);return t}function bl(t){Ff(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Dh===!1&&(Dh=!0,bt.updateOffset(this),Dh=!1)}function Li(t){return t instanceof bl||t!=null&&t._isAMomentObject!=null}function Vb(t){bt.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function xi(t,e){var n=!0;return Kr(function(){if(bt.deprecationHandler!=null&&bt.deprecationHandler(null,t),n){var i=[],r,s,o,a=arguments.length;for(s=0;s<a;s++){if(r="",typeof arguments[s]=="object"){r+=`
[`+s+"] ";for(o in arguments[0])pe(arguments[0],o)&&(r+=o+": "+arguments[0][o]+", ");r=r.slice(0,-2)}else r=arguments[s];i.push(r)}Vb(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var Jg={};function zb(t,e){bt.deprecationHandler!=null&&bt.deprecationHandler(t,e),Jg[t]||(Vb(e),Jg[t]=!0)}bt.suppressDeprecationWarnings=!1;bt.deprecationHandler=null;function Zi(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function yT(t){var e,n;for(n in t)pe(t,n)&&(e=t[n],Zi(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Md(t,e){var n=Kr({},t),i;for(i in e)pe(e,i)&&(Cs(t[i])&&Cs(e[i])?(n[i]={},Kr(n[i],t[i]),Kr(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)pe(t,i)&&!pe(e,i)&&Cs(t[i])&&(n[i]=Kr({},n[i]));return n}function Vf(t){t!=null&&this.set(t)}var Dd;Object.keys?Dd=Object.keys:Dd=function(t){var e,n=[];for(e in t)pe(t,e)&&n.push(e);return n};var bT={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function xT(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return Zi(i)?i.call(e,n):i}function Xi(t,e,n){var i=""+Math.abs(t),r=e-i.length,s=t>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var zf=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,nc=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Nh={},_o={};function Rt(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(_o[t]=r),e&&(_o[e[0]]=function(){return Xi(r.apply(this,arguments),e[1],e[2])}),n&&(_o[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function wT(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function _T(t){var e=t.match(zf),n,i;for(n=0,i=e.length;n<i;n++)_o[e[n]]?e[n]=_o[e[n]]:e[n]=wT(e[n]);return function(r){var s="",o;for(o=0;o<i;o++)s+=Zi(e[o])?e[o].call(r,t):e[o];return s}}function Mc(t,e){return t.isValid()?(e=Gb(e,t.localeData()),Nh[e]=Nh[e]||_T(e),Nh[e](t)):t.localeData().invalidDate()}function Gb(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(nc.lastIndex=0;n>=0&&nc.test(t);)t=t.replace(nc,i),nc.lastIndex=0,n-=1;return t}var ST={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ET(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(zf).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var TT="Invalid date";function AT(){return this._invalidDate}var CT="%d",PT=/\d{1,2}/;function IT(t){return this._ordinal.replace("%d",t)}var kT={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function OT(t,e,n,i){var r=this._relativeTime[n];return Zi(r)?r(t,e,n,i):r.replace(/%d/i,t)}function LT(t,e){var n=this._relativeTime[t>0?"future":"past"];return Zi(n)?n(e):n.replace(/%s/i,e)}var Qg={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function wi(t){return typeof t=="string"?Qg[t]||Qg[t.toLowerCase()]:void 0}function Gf(t){var e={},n,i;for(i in t)pe(t,i)&&(n=wi(i),n&&(e[n]=t[i]));return e}var MT={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function DT(t){var e=[],n;for(n in t)pe(t,n)&&e.push({unit:n,priority:MT[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var Hb=/\d/,ri=/\d\d/,Ub=/\d{3}/,Hf=/\d{4}/,Su=/[+-]?\d{6}/,Be=/\d\d?/,jb=/\d\d\d\d?/,Wb=/\d\d\d\d\d\d?/,Eu=/\d{1,3}/,Uf=/\d{1,4}/,Tu=/[+-]?\d{1,6}/,Ko=/\d+/,Au=/[+-]?\d+/,NT=/Z|[+-]\d\d:?\d\d/gi,Cu=/Z|[+-]\d\d(?::?\d\d)?/gi,RT=/[+-]?\d+(\.\d{1,3})?/,xl=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Zo=/^[1-9]\d?/,jf=/^([1-9]\d|\d)/,Yc;Yc={};function Et(t,e,n){Yc[t]=Zi(e)?e:function(i,r){return i&&n?n:e}}function $T(t,e){return pe(Yc,t)?Yc[t](e._strict,e._locale):new RegExp(BT(t))}function BT(t){return Sr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,s){return n||i||r||s}))}function Sr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ci(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ie(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=ci(e)),n}var Nd={};function Se(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),Cr(e)&&(i=function(s,o){o[e]=ie(s)}),r=t.length,n=0;n<r;n++)Nd[t[n]]=i}function wl(t,e){Se(t,function(n,i,r,s){r._w=r._w||{},e(n,r._w,r,s)})}function FT(t,e,n){e!=null&&pe(Nd,t)&&Nd[t](e,n._a,n,t)}function Pu(t){return t%4===0&&t%100!==0||t%400===0}var Ln=0,yr=1,Gi=2,mn=3,Ci=4,br=5,ys=6,VT=7,zT=8;Rt("Y",0,0,function(){var t=this.year();return t<=9999?Xi(t,4):"+"+t});Rt(0,["YY",2],0,function(){return this.year()%100});Rt(0,["YYYY",4],0,"year");Rt(0,["YYYYY",5],0,"year");Rt(0,["YYYYYY",6,!0],0,"year");Et("Y",Au);Et("YY",Be,ri);Et("YYYY",Uf,Hf);Et("YYYYY",Tu,Su);Et("YYYYYY",Tu,Su);Se(["YYYYY","YYYYYY"],Ln);Se("YYYY",function(t,e){e[Ln]=t.length===2?bt.parseTwoDigitYear(t):ie(t)});Se("YY",function(t,e){e[Ln]=bt.parseTwoDigitYear(t)});Se("Y",function(t,e){e[Ln]=parseInt(t,10)});function Ga(t){return Pu(t)?366:365}bt.parseTwoDigitYear=function(t){return ie(t)+(ie(t)>68?1900:2e3)};var Yb=Jo("FullYear",!0);function GT(){return Pu(this.year())}function Jo(t,e){return function(n){return n!=null?(Xb(this,t,n),bt.updateOffset(this,e),this):Ya(this,t)}}function Ya(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function Xb(t,e,n){var i,r,s,o,a;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}s=n,o=t.month(),a=t.date(),a=a===29&&o===1&&!Pu(s)?28:a,r?i.setUTCFullYear(s,o,a):i.setFullYear(s,o,a)}}function HT(t){return t=wi(t),Zi(this[t])?this[t]():this}function UT(t,e){if(typeof t=="object"){t=Gf(t);var n=DT(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=wi(t),Zi(this[t]))return this[t](e);return this}function jT(t,e){return(t%e+e)%e}var Je;Array.prototype.indexOf?Je=Array.prototype.indexOf:Je=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Wf(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=jT(e,12);return t+=(e-n)/12,n===1?Pu(t)?29:28:31-n%7%2}Rt("M",["MM",2],"Mo",function(){return this.month()+1});Rt("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Rt("MMMM",0,0,function(t){return this.localeData().months(this,t)});Et("M",Be,Zo);Et("MM",Be,ri);Et("MMM",function(t,e){return e.monthsShortRegex(t)});Et("MMMM",function(t,e){return e.monthsRegex(t)});Se(["M","MM"],function(t,e){e[yr]=ie(t)-1});Se(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[yr]=r:jt(n).invalidMonth=t});var WT="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),qb="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Kb=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,YT=xl,XT=xl;function qT(t,e){return t?Oi(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Kb).test(e)?"format":"standalone"][t.month()]:Oi(this._months)?this._months:this._months.standalone}function KT(t,e){return t?Oi(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Kb.test(e)?"format":"standalone"][t.month()]:Oi(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ZT(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)s=Ki([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(s,"").toLocaleLowerCase();return n?e==="MMM"?(r=Je.call(this._shortMonthsParse,o),r!==-1?r:null):(r=Je.call(this._longMonthsParse,o),r!==-1?r:null):e==="MMM"?(r=Je.call(this._shortMonthsParse,o),r!==-1?r:(r=Je.call(this._longMonthsParse,o),r!==-1?r:null)):(r=Je.call(this._longMonthsParse,o),r!==-1?r:(r=Je.call(this._shortMonthsParse,o),r!==-1?r:null))}function JT(t,e,n){var i,r,s;if(this._monthsParseExact)return ZT.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=Ki([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function Zb(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ie(e);else if(e=t.localeData().monthsParse(e),!Cr(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,Wf(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function Jb(t){return t!=null?(Zb(this,t),bt.updateOffset(this,!0),this):Ya(this,"Month")}function QT(){return Wf(this.year(),this.month())}function tA(t){return this._monthsParseExact?(pe(this,"_monthsRegex")||Qb.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(pe(this,"_monthsShortRegex")||(this._monthsShortRegex=YT),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function eA(t){return this._monthsParseExact?(pe(this,"_monthsRegex")||Qb.call(this),t?this._monthsStrictRegex:this._monthsRegex):(pe(this,"_monthsRegex")||(this._monthsRegex=XT),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function Qb(){function t(l,c){return c.length-l.length}var e=[],n=[],i=[],r,s,o,a;for(r=0;r<12;r++)s=Ki([2e3,r]),o=Sr(this.monthsShort(s,"")),a=Sr(this.months(s,"")),e.push(o),n.push(a),i.push(a),i.push(o);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function nA(t,e,n,i,r,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,i,r,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,i,r,s,o),a}function Xa(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Xc(t,e,n){var i=7+e-n,r=(7+Xa(t,0,i).getUTCDay()-e)%7;return-r+i-1}function t0(t,e,n,i,r){var s=(7+n-i)%7,o=Xc(t,i,r),a=1+7*(e-1)+s+o,l,c;return a<=0?(l=t-1,c=Ga(l)+a):a>Ga(t)?(l=t+1,c=a-Ga(t)):(l=t,c=a),{year:l,dayOfYear:c}}function qa(t,e,n){var i=Xc(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,s,o;return r<1?(o=t.year()-1,s=r+Er(o,e,n)):r>Er(t.year(),e,n)?(s=r-Er(t.year(),e,n),o=t.year()+1):(o=t.year(),s=r),{week:s,year:o}}function Er(t,e,n){var i=Xc(t,e,n),r=Xc(t+1,e,n);return(Ga(t)-i+r)/7}Rt("w",["ww",2],"wo","week");Rt("W",["WW",2],"Wo","isoWeek");Et("w",Be,Zo);Et("ww",Be,ri);Et("W",Be,Zo);Et("WW",Be,ri);wl(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=ie(t)});function iA(t){return qa(t,this._week.dow,this._week.doy).week}var rA={dow:0,doy:6};function sA(){return this._week.dow}function oA(){return this._week.doy}function aA(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function lA(t){var e=qa(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Rt("d",0,"do","day");Rt("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Rt("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Rt("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Rt("e",0,0,"weekday");Rt("E",0,0,"isoWeekday");Et("d",Be);Et("e",Be);Et("E",Be);Et("dd",function(t,e){return e.weekdaysMinRegex(t)});Et("ddd",function(t,e){return e.weekdaysShortRegex(t)});Et("dddd",function(t,e){return e.weekdaysRegex(t)});wl(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:jt(n).invalidWeekday=t});wl(["d","e","E"],function(t,e,n,i){e[i]=ie(t)});function cA(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function uA(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Yf(t,e){return t.slice(e,7).concat(t.slice(0,e))}var hA="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),e0="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),dA="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),fA=xl,pA=xl,gA=xl;function mA(t,e){var n=Oi(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Yf(n,this._week.dow):t?n[t.day()]:n}function vA(t){return t===!0?Yf(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function yA(t){return t===!0?Yf(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function bA(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)s=Ki([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(s,"").toLocaleLowerCase();return n?e==="dddd"?(r=Je.call(this._weekdaysParse,o),r!==-1?r:null):e==="ddd"?(r=Je.call(this._shortWeekdaysParse,o),r!==-1?r:null):(r=Je.call(this._minWeekdaysParse,o),r!==-1?r:null):e==="dddd"?(r=Je.call(this._weekdaysParse,o),r!==-1||(r=Je.call(this._shortWeekdaysParse,o),r!==-1)?r:(r=Je.call(this._minWeekdaysParse,o),r!==-1?r:null)):e==="ddd"?(r=Je.call(this._shortWeekdaysParse,o),r!==-1||(r=Je.call(this._weekdaysParse,o),r!==-1)?r:(r=Je.call(this._minWeekdaysParse,o),r!==-1?r:null)):(r=Je.call(this._minWeekdaysParse,o),r!==-1||(r=Je.call(this._weekdaysParse,o),r!==-1)?r:(r=Je.call(this._shortWeekdaysParse,o),r!==-1?r:null))}function xA(t,e,n){var i,r,s;if(this._weekdaysParseExact)return bA.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=Ki([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(s="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function wA(t){if(!this.isValid())return t!=null?this:NaN;var e=Ya(this,"Day");return t!=null?(t=cA(t,this.localeData()),this.add(t-e,"d")):e}function _A(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function SA(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=uA(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function EA(t){return this._weekdaysParseExact?(pe(this,"_weekdaysRegex")||Xf.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(pe(this,"_weekdaysRegex")||(this._weekdaysRegex=fA),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function TA(t){return this._weekdaysParseExact?(pe(this,"_weekdaysRegex")||Xf.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(pe(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=pA),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function AA(t){return this._weekdaysParseExact?(pe(this,"_weekdaysRegex")||Xf.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(pe(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=gA),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Xf(){function t(h,u){return u.length-h.length}var e=[],n=[],i=[],r=[],s,o,a,l,c;for(s=0;s<7;s++)o=Ki([2e3,1]).day(s),a=Sr(this.weekdaysMin(o,"")),l=Sr(this.weekdaysShort(o,"")),c=Sr(this.weekdays(o,"")),e.push(a),n.push(l),i.push(c),r.push(a),r.push(l),r.push(c);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function qf(){return this.hours()%12||12}function CA(){return this.hours()||24}Rt("H",["HH",2],0,"hour");Rt("h",["hh",2],0,qf);Rt("k",["kk",2],0,CA);Rt("hmm",0,0,function(){return""+qf.apply(this)+Xi(this.minutes(),2)});Rt("hmmss",0,0,function(){return""+qf.apply(this)+Xi(this.minutes(),2)+Xi(this.seconds(),2)});Rt("Hmm",0,0,function(){return""+this.hours()+Xi(this.minutes(),2)});Rt("Hmmss",0,0,function(){return""+this.hours()+Xi(this.minutes(),2)+Xi(this.seconds(),2)});function n0(t,e){Rt(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}n0("a",!0);n0("A",!1);function i0(t,e){return e._meridiemParse}Et("a",i0);Et("A",i0);Et("H",Be,jf);Et("h",Be,Zo);Et("k",Be,Zo);Et("HH",Be,ri);Et("hh",Be,ri);Et("kk",Be,ri);Et("hmm",jb);Et("hmmss",Wb);Et("Hmm",jb);Et("Hmmss",Wb);Se(["H","HH"],mn);Se(["k","kk"],function(t,e,n){var i=ie(t);e[mn]=i===24?0:i});Se(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});Se(["h","hh"],function(t,e,n){e[mn]=ie(t),jt(n).bigHour=!0});Se("hmm",function(t,e,n){var i=t.length-2;e[mn]=ie(t.substr(0,i)),e[Ci]=ie(t.substr(i)),jt(n).bigHour=!0});Se("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[mn]=ie(t.substr(0,i)),e[Ci]=ie(t.substr(i,2)),e[br]=ie(t.substr(r)),jt(n).bigHour=!0});Se("Hmm",function(t,e,n){var i=t.length-2;e[mn]=ie(t.substr(0,i)),e[Ci]=ie(t.substr(i))});Se("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[mn]=ie(t.substr(0,i)),e[Ci]=ie(t.substr(i,2)),e[br]=ie(t.substr(r))});function PA(t){return(t+"").toLowerCase().charAt(0)==="p"}var IA=/[ap]\.?m?\.?/i,kA=Jo("Hours",!0);function OA(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var r0={calendar:bT,longDateFormat:ST,invalidDate:TT,ordinal:CT,dayOfMonthOrdinalParse:PT,relativeTime:kT,months:WT,monthsShort:qb,week:rA,weekdays:hA,weekdaysMin:dA,weekdaysShort:e0,meridiemParse:IA},Ge={},_a={},Ka;function LA(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function tm(t){return t&&t.toLowerCase().replace("_","-")}function MA(t){for(var e=0,n,i,r,s;e<t.length;){for(s=tm(t[e]).split("-"),n=s.length,i=tm(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=Iu(s.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&LA(s,i)>=n-1)break;n--}e++}return Ka}function DA(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Iu(t){var e=null,n;if(Ge[t]===void 0&&typeof module<"u"&&module&&module.exports&&DA(t))try{e=Ka._abbr,n=require,n("./locale/"+t),Qr(e)}catch{Ge[t]=null}return Ge[t]}function Qr(t,e){var n;return t&&(Yn(e)?n=Or(t):n=Kf(t,e),n?Ka=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Ka._abbr}function Kf(t,e){if(e!==null){var n,i=r0;if(e.abbr=t,Ge[t]!=null)zb("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Ge[t]._config;else if(e.parentLocale!=null)if(Ge[e.parentLocale]!=null)i=Ge[e.parentLocale]._config;else if(n=Iu(e.parentLocale),n!=null)i=n._config;else return _a[e.parentLocale]||(_a[e.parentLocale]=[]),_a[e.parentLocale].push({name:t,config:e}),null;return Ge[t]=new Vf(Md(i,e)),_a[t]&&_a[t].forEach(function(r){Kf(r.name,r.config)}),Qr(t),Ge[t]}else return delete Ge[t],null}function NA(t,e){if(e!=null){var n,i,r=r0;Ge[t]!=null&&Ge[t].parentLocale!=null?Ge[t].set(Md(Ge[t]._config,e)):(i=Iu(t),i!=null&&(r=i._config),e=Md(r,e),i==null&&(e.abbr=t),n=new Vf(e),n.parentLocale=Ge[t],Ge[t]=n),Qr(t)}else Ge[t]!=null&&(Ge[t].parentLocale!=null?(Ge[t]=Ge[t].parentLocale,t===Qr()&&Qr(t)):Ge[t]!=null&&delete Ge[t]);return Ge[t]}function Or(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ka;if(!Oi(t)){if(e=Iu(t),e)return e;t=[t]}return MA(t)}function RA(){return Dd(Ge)}function Zf(t){var e,n=t._a;return n&&jt(t).overflow===-2&&(e=n[yr]<0||n[yr]>11?yr:n[Gi]<1||n[Gi]>Wf(n[Ln],n[yr])?Gi:n[mn]<0||n[mn]>24||n[mn]===24&&(n[Ci]!==0||n[br]!==0||n[ys]!==0)?mn:n[Ci]<0||n[Ci]>59?Ci:n[br]<0||n[br]>59?br:n[ys]<0||n[ys]>999?ys:-1,jt(t)._overflowDayOfYear&&(e<Ln||e>Gi)&&(e=Gi),jt(t)._overflowWeeks&&e===-1&&(e=VT),jt(t)._overflowWeekday&&e===-1&&(e=zT),jt(t).overflow=e),t}var $A=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,BA=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,FA=/Z|[+-]\d\d(?::?\d\d)?/,ic=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Rh=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],VA=/^\/?Date\((-?\d+)/i,zA=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,GA={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function s0(t){var e,n,i=t._i,r=$A.exec(i)||BA.exec(i),s,o,a,l,c=ic.length,h=Rh.length;if(r){for(jt(t).iso=!0,e=0,n=c;e<n;e++)if(ic[e][1].exec(r[1])){o=ic[e][0],s=ic[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(r[3]){for(e=0,n=h;e<n;e++)if(Rh[e][1].exec(r[3])){a=(r[2]||" ")+Rh[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(r[4])if(FA.exec(r[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),Qf(t)}else t._isValid=!1}function HA(t,e,n,i,r,s){var o=[UA(t),qb.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return s&&o.push(parseInt(s,10)),o}function UA(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function jA(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function WA(t,e,n){if(t){var i=e0.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return jt(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function YA(t,e,n){if(t)return GA[t];if(e)return 0;var i=parseInt(n,10),r=i%100,s=(i-r)/100;return s*60+r}function o0(t){var e=zA.exec(jA(t._i)),n;if(e){if(n=HA(e[4],e[3],e[2],e[5],e[6],e[7]),!WA(e[1],n,t))return;t._a=n,t._tzm=YA(e[8],e[9],e[10]),t._d=Xa.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),jt(t).rfc2822=!0}else t._isValid=!1}function XA(t){var e=VA.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(s0(t),t._isValid===!1)delete t._isValid;else return;if(o0(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:bt.createFromInputFallback(t)}bt.createFromInputFallback=xi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function fo(t,e,n){return t??e??n}function qA(t){var e=new Date(bt.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Jf(t){var e,n,i=[],r,s,o;if(!t._d){for(r=qA(t),t._w&&t._a[Gi]==null&&t._a[yr]==null&&KA(t),t._dayOfYear!=null&&(o=fo(t._a[Ln],r[Ln]),(t._dayOfYear>Ga(o)||t._dayOfYear===0)&&(jt(t)._overflowDayOfYear=!0),n=Xa(o,0,t._dayOfYear),t._a[yr]=n.getUTCMonth(),t._a[Gi]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[mn]===24&&t._a[Ci]===0&&t._a[br]===0&&t._a[ys]===0&&(t._nextDay=!0,t._a[mn]=0),t._d=(t._useUTC?Xa:nA).apply(null,i),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[mn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(jt(t).weekdayMismatch=!0)}}function KA(t){var e,n,i,r,s,o,a,l,c;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,n=fo(e.GG,t._a[Ln],qa($e(),1,4).year),i=fo(e.W,1),r=fo(e.E,1),(r<1||r>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,c=qa($e(),s,o),n=fo(e.gg,t._a[Ln],c.year),i=fo(e.w,c.week),e.d!=null?(r=e.d,(r<0||r>6)&&(l=!0)):e.e!=null?(r=e.e+s,(e.e<0||e.e>6)&&(l=!0)):r=s),i<1||i>Er(n,s,o)?jt(t)._overflowWeeks=!0:l!=null?jt(t)._overflowWeekday=!0:(a=t0(n,i,r,s,o),t._a[Ln]=a.year,t._dayOfYear=a.dayOfYear)}bt.ISO_8601=function(){};bt.RFC_2822=function(){};function Qf(t){if(t._f===bt.ISO_8601){s0(t);return}if(t._f===bt.RFC_2822){o0(t);return}t._a=[],jt(t).empty=!0;var e=""+t._i,n,i,r,s,o,a=e.length,l=0,c,h;for(r=Gb(t._f,t._locale).match(zf)||[],h=r.length,n=0;n<h;n++)s=r[n],i=(e.match($T(s,t))||[])[0],i&&(o=e.substr(0,e.indexOf(i)),o.length>0&&jt(t).unusedInput.push(o),e=e.slice(e.indexOf(i)+i.length),l+=i.length),_o[s]?(i?jt(t).empty=!1:jt(t).unusedTokens.push(s),FT(s,i,t)):t._strict&&!i&&jt(t).unusedTokens.push(s);jt(t).charsLeftOver=a-l,e.length>0&&jt(t).unusedInput.push(e),t._a[mn]<=12&&jt(t).bigHour===!0&&t._a[mn]>0&&(jt(t).bigHour=void 0),jt(t).parsedDateParts=t._a.slice(0),jt(t).meridiem=t._meridiem,t._a[mn]=ZA(t._locale,t._a[mn],t._meridiem),c=jt(t).era,c!==null&&(t._a[Ln]=t._locale.erasConvertYear(c,t._a[Ln])),Jf(t),Zf(t)}function ZA(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function JA(t){var e,n,i,r,s,o,a=!1,l=t._f.length;if(l===0){jt(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<l;r++)s=0,o=!1,e=Ff({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],Qf(e),Bf(e)&&(o=!0),s+=jt(e).charsLeftOver,s+=jt(e).unusedTokens.length*10,jt(e).score=s,a?s<i&&(i=s,n=e):(i==null||s<i||o)&&(i=s,n=e,o&&(a=!0));Kr(t,n||e)}function QA(t){if(!t._d){var e=Gf(t._i),n=e.day===void 0?e.date:e.day;t._a=Fb([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),Jf(t)}}function tC(t){var e=new bl(Zf(a0(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function a0(t){var e=t._i,n=t._f;return t._locale=t._locale||Or(t._l),e===null||n===void 0&&e===""?_u({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Li(e)?new bl(Zf(e)):(yl(e)?t._d=e:Oi(n)?JA(t):n?Qf(t):eC(t),Bf(t)||(t._d=null),t))}function eC(t){var e=t._i;Yn(e)?t._d=new Date(bt.now()):yl(e)?t._d=new Date(e.valueOf()):typeof e=="string"?XA(t):Oi(e)?(t._a=Fb(e.slice(0),function(n){return parseInt(n,10)}),Jf(t)):Cs(e)?QA(t):Cr(e)?t._d=new Date(e):bt.createFromInputFallback(t)}function l0(t,e,n,i,r){var s={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(Cs(t)&&$f(t)||Oi(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=r,s._l=n,s._i=t,s._f=e,s._strict=i,tC(s)}function $e(t,e,n,i){return l0(t,e,n,i,!1)}var nC=xi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=$e.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:_u()}),iC=xi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=$e.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:_u()});function c0(t,e){var n,i;if(e.length===1&&Oi(e[0])&&(e=e[0]),!e.length)return $e();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function rC(){var t=[].slice.call(arguments,0);return c0("isBefore",t)}function sC(){var t=[].slice.call(arguments,0);return c0("isAfter",t)}var oC=function(){return Date.now?Date.now():+new Date},Sa=["year","quarter","month","week","day","hour","minute","second","millisecond"];function aC(t){var e,n=!1,i,r=Sa.length;for(e in t)if(pe(t,e)&&!(Je.call(Sa,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[Sa[i]]){if(n)return!1;parseFloat(t[Sa[i]])!==ie(t[Sa[i]])&&(n=!0)}return!0}function lC(){return this._isValid}function cC(){return Mi(NaN)}function ku(t){var e=Gf(t),n=e.year||0,i=e.quarter||0,r=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,c=e.second||0,h=e.millisecond||0;this._isValid=aC(e),this._milliseconds=+h+c*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+r+i*3+n*12,this._data={},this._locale=Or(),this._bubble()}function Dc(t){return t instanceof ku}function Rd(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function uC(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0,o;for(o=0;o<i;o++)(n&&t[o]!==e[o]||!n&&ie(t[o])!==ie(e[o]))&&s++;return s+r}function u0(t,e){Rt(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+Xi(~~(n/60),2)+e+Xi(~~n%60,2)})}u0("Z",":");u0("ZZ","");Et("Z",Cu);Et("ZZ",Cu);Se(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=tp(Cu,t)});var hC=/([\+\-]|\d\d)/gi;function tp(t,e){var n=(e||"").match(t),i,r,s;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(hC)||["-",0,0],s=+(r[1]*60)+ie(r[2]),s===0?0:r[0]==="+"?s:-s)}function ep(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(Li(t)||yl(t)?t.valueOf():$e(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),bt.updateOffset(n,!1),n):$e(t).local()}function $d(t){return-Math.round(t._d.getTimezoneOffset())}bt.updateOffset=function(){};function dC(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=tp(Cu,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=$d(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?f0(this,Mi(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,bt.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:$d(this)}function fC(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function pC(t){return this.utcOffset(0,t)}function gC(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract($d(this),"m")),this}function mC(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=tp(NT,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function vC(t){return this.isValid()?(t=t?$e(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function yC(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function bC(){if(!Yn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Ff(t,this),t=a0(t),t._a?(e=t._isUTC?Ki(t._a):$e(t._a),this._isDSTShifted=this.isValid()&&uC(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function xC(){return this.isValid()?!this._isUTC:!1}function wC(){return this.isValid()?this._isUTC:!1}function h0(){return this.isValid()?this._isUTC&&this._offset===0:!1}var _C=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,SC=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Mi(t,e){var n=t,i=null,r,s,o;return Dc(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Cr(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=_C.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:ie(i[Gi])*r,h:ie(i[mn])*r,m:ie(i[Ci])*r,s:ie(i[br])*r,ms:ie(Rd(i[ys]*1e3))*r}):(i=SC.exec(t))?(r=i[1]==="-"?-1:1,n={y:cs(i[2],r),M:cs(i[3],r),w:cs(i[4],r),d:cs(i[5],r),h:cs(i[6],r),m:cs(i[7],r),s:cs(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(o=EC($e(n.from),$e(n.to)),n={},n.ms=o.milliseconds,n.M=o.months),s=new ku(n),Dc(t)&&pe(t,"_locale")&&(s._locale=t._locale),Dc(t)&&pe(t,"_isValid")&&(s._isValid=t._isValid),s}Mi.fn=ku.prototype;Mi.invalid=cC;function cs(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function em(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function EC(t,e){var n;return t.isValid()&&e.isValid()?(e=ep(e,t),t.isBefore(e)?n=em(t,e):(n=em(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function d0(t,e){return function(n,i){var r,s;return i!==null&&!isNaN(+i)&&(zb(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=n,n=i,i=s),r=Mi(n,i),f0(this,r,t),this}}function f0(t,e,n,i){var r=e._milliseconds,s=Rd(e._days),o=Rd(e._months);t.isValid()&&(i=i??!0,o&&Zb(t,Ya(t,"Month")+o*n),s&&Xb(t,"Date",Ya(t,"Date")+s*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&bt.updateOffset(t,s||o))}var TC=d0(1,"add"),AC=d0(-1,"subtract");function p0(t){return typeof t=="string"||t instanceof String}function CC(t){return Li(t)||yl(t)||p0(t)||Cr(t)||IC(t)||PC(t)||t===null||t===void 0}function PC(t){var e=Cs(t)&&!$f(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,s,o=i.length;for(r=0;r<o;r+=1)s=i[r],n=n||pe(t,s);return e&&n}function IC(t){var e=Oi(t),n=!1;return e&&(n=t.filter(function(i){return!Cr(i)&&p0(t)}).length===0),e&&n}function kC(t){var e=Cs(t)&&!$f(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,s;for(r=0;r<i.length;r+=1)s=i[r],n=n||pe(t,s);return e&&n}function OC(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function LC(t,e){arguments.length===1&&(arguments[0]?CC(arguments[0])?(t=arguments[0],e=void 0):kC(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||$e(),i=ep(n,this).startOf("day"),r=bt.calendarFormat(this,i)||"sameElse",s=e&&(Zi(e[r])?e[r].call(this,n):e[r]);return this.format(s||this.localeData().calendar(r,this,$e(n)))}function MC(){return new bl(this)}function DC(t,e){var n=Li(t)?t:$e(t);return this.isValid()&&n.isValid()?(e=wi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function NC(t,e){var n=Li(t)?t:$e(t);return this.isValid()&&n.isValid()?(e=wi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function RC(t,e,n,i){var r=Li(t)?t:$e(t),s=Li(e)?e:$e(e);return this.isValid()&&r.isValid()&&s.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(s,n):!this.isAfter(s,n))):!1}function $C(t,e){var n=Li(t)?t:$e(t),i;return this.isValid()&&n.isValid()?(e=wi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function BC(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function FC(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function VC(t,e,n){var i,r,s;if(!this.isValid())return NaN;if(i=ep(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=wi(e),e){case"year":s=Nc(this,i)/12;break;case"month":s=Nc(this,i);break;case"quarter":s=Nc(this,i)/3;break;case"second":s=(this-i)/1e3;break;case"minute":s=(this-i)/6e4;break;case"hour":s=(this-i)/36e5;break;case"day":s=(this-i-r)/864e5;break;case"week":s=(this-i-r)/6048e5;break;default:s=this-i}return n?s:ci(s)}function Nc(t,e){if(t.date()<e.date())return-Nc(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,s;return e-i<0?(r=t.clone().add(n-1,"months"),s=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),s=(e-i)/(r-i)),-(n+s)||0}bt.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";bt.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function zC(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function GC(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Mc(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Zi(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Mc(n,"Z")):Mc(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function HC(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(n+i+r+s)}function UC(t){t||(t=this.isUtc()?bt.defaultFormatUtc:bt.defaultFormat);var e=Mc(this,t);return this.localeData().postformat(e)}function jC(t,e){return this.isValid()&&(Li(t)&&t.isValid()||$e(t).isValid())?Mi({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function WC(t){return this.from($e(),t)}function YC(t,e){return this.isValid()&&(Li(t)&&t.isValid()||$e(t).isValid())?Mi({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function XC(t){return this.to($e(),t)}function g0(t){var e;return t===void 0?this._locale._abbr:(e=Or(t),e!=null&&(this._locale=e),this)}var m0=xi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function v0(){return this._locale}var qc=1e3,So=60*qc,Kc=60*So,y0=(365*400+97)*24*Kc;function Eo(t,e){return(t%e+e)%e}function b0(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-y0:new Date(t,e,n).valueOf()}function x0(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-y0:Date.UTC(t,e,n)}function qC(t){var e,n;if(t=wi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?x0:b0,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Eo(e+(this._isUTC?0:this.utcOffset()*So),Kc);break;case"minute":e=this._d.valueOf(),e-=Eo(e,So);break;case"second":e=this._d.valueOf(),e-=Eo(e,qc);break}return this._d.setTime(e),bt.updateOffset(this,!0),this}function KC(t){var e,n;if(t=wi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?x0:b0,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Kc-Eo(e+(this._isUTC?0:this.utcOffset()*So),Kc)-1;break;case"minute":e=this._d.valueOf(),e+=So-Eo(e,So)-1;break;case"second":e=this._d.valueOf(),e+=qc-Eo(e,qc)-1;break}return this._d.setTime(e),bt.updateOffset(this,!0),this}function ZC(){return this._d.valueOf()-(this._offset||0)*6e4}function JC(){return Math.floor(this.valueOf()/1e3)}function QC(){return new Date(this.valueOf())}function tP(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function eP(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function nP(){return this.isValid()?this.toISOString():null}function iP(){return Bf(this)}function rP(){return Kr({},jt(this))}function sP(){return jt(this).overflow}function oP(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Rt("N",0,0,"eraAbbr");Rt("NN",0,0,"eraAbbr");Rt("NNN",0,0,"eraAbbr");Rt("NNNN",0,0,"eraName");Rt("NNNNN",0,0,"eraNarrow");Rt("y",["y",1],"yo","eraYear");Rt("y",["yy",2],0,"eraYear");Rt("y",["yyy",3],0,"eraYear");Rt("y",["yyyy",4],0,"eraYear");Et("N",np);Et("NN",np);Et("NNN",np);Et("NNNN",vP);Et("NNNNN",yP);Se(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?jt(n).era=r:jt(n).invalidEra=t});Et("y",Ko);Et("yy",Ko);Et("yyy",Ko);Et("yyyy",Ko);Et("yo",bP);Se(["y","yy","yyy","yyyy"],Ln);Se(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Ln]=n._locale.eraYearOrdinalParse(t,r):e[Ln]=parseInt(t,10)});function aP(t,e){var n,i,r,s=this._eras||Or("en")._eras;for(n=0,i=s.length;n<i;++n){switch(typeof s[n].since){case"string":r=bt(s[n].since).startOf("day"),s[n].since=r.valueOf();break}switch(typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":r=bt(s[n].until).startOf("day").valueOf(),s[n].until=r.valueOf();break}}return s}function lP(t,e,n){var i,r,s=this.eras(),o,a,l;for(t=t.toUpperCase(),i=0,r=s.length;i<r;++i)if(o=s[i].name.toUpperCase(),a=s[i].abbr.toUpperCase(),l=s[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[i];break;case"NNNN":if(o===t)return s[i];break;case"NNNNN":if(l===t)return s[i];break}else if([o,a,l].indexOf(t)>=0)return s[i]}function cP(t,e){var n=t.since<=t.until?1:-1;return e===void 0?bt(t.since).year():bt(t.since).year()+(e-t.offset)*n}function uP(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function hP(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function dP(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function fP(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-bt(r[t].since).year())*n+r[t].offset;return this.year()}function pP(t){return pe(this,"_erasNameRegex")||ip.call(this),t?this._erasNameRegex:this._erasRegex}function gP(t){return pe(this,"_erasAbbrRegex")||ip.call(this),t?this._erasAbbrRegex:this._erasRegex}function mP(t){return pe(this,"_erasNarrowRegex")||ip.call(this),t?this._erasNarrowRegex:this._erasRegex}function np(t,e){return e.erasAbbrRegex(t)}function vP(t,e){return e.erasNameRegex(t)}function yP(t,e){return e.erasNarrowRegex(t)}function bP(t,e){return e._eraYearOrdinalRegex||Ko}function ip(){var t=[],e=[],n=[],i=[],r,s,o,a,l,c=this.eras();for(r=0,s=c.length;r<s;++r)o=Sr(c[r].name),a=Sr(c[r].abbr),l=Sr(c[r].narrow),e.push(o),t.push(a),n.push(l),i.push(o),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Rt(0,["gg",2],0,function(){return this.weekYear()%100});Rt(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Ou(t,e){Rt(0,[t,t.length],0,e)}Ou("gggg","weekYear");Ou("ggggg","weekYear");Ou("GGGG","isoWeekYear");Ou("GGGGG","isoWeekYear");Et("G",Au);Et("g",Au);Et("GG",Be,ri);Et("gg",Be,ri);Et("GGGG",Uf,Hf);Et("gggg",Uf,Hf);Et("GGGGG",Tu,Su);Et("ggggg",Tu,Su);wl(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=ie(t)});wl(["gg","GG"],function(t,e,n,i){e[i]=bt.parseTwoDigitYear(t)});function xP(t){return w0.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function wP(t){return w0.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function _P(){return Er(this.year(),1,4)}function SP(){return Er(this.isoWeekYear(),1,4)}function EP(){var t=this.localeData()._week;return Er(this.year(),t.dow,t.doy)}function TP(){var t=this.localeData()._week;return Er(this.weekYear(),t.dow,t.doy)}function w0(t,e,n,i,r){var s;return t==null?qa(this,i,r).year:(s=Er(t,i,r),e>s&&(e=s),AP.call(this,t,e,n,i,r))}function AP(t,e,n,i,r){var s=t0(t,e,n,i,r),o=Xa(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Rt("Q",0,"Qo","quarter");Et("Q",Hb);Se("Q",function(t,e){e[yr]=(ie(t)-1)*3});function CP(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Rt("D",["DD",2],"Do","date");Et("D",Be,Zo);Et("DD",Be,ri);Et("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Se(["D","DD"],Gi);Se("Do",function(t,e){e[Gi]=ie(t.match(Be)[0])});var _0=Jo("Date",!0);Rt("DDD",["DDDD",3],"DDDo","dayOfYear");Et("DDD",Eu);Et("DDDD",Ub);Se(["DDD","DDDD"],function(t,e,n){n._dayOfYear=ie(t)});function PP(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Rt("m",["mm",2],0,"minute");Et("m",Be,jf);Et("mm",Be,ri);Se(["m","mm"],Ci);var IP=Jo("Minutes",!1);Rt("s",["ss",2],0,"second");Et("s",Be,jf);Et("ss",Be,ri);Se(["s","ss"],br);var kP=Jo("Seconds",!1);Rt("S",0,0,function(){return~~(this.millisecond()/100)});Rt(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Rt(0,["SSS",3],0,"millisecond");Rt(0,["SSSS",4],0,function(){return this.millisecond()*10});Rt(0,["SSSSS",5],0,function(){return this.millisecond()*100});Rt(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Rt(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Rt(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Rt(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Et("S",Eu,Hb);Et("SS",Eu,ri);Et("SSS",Eu,Ub);var Zr,S0;for(Zr="SSSS";Zr.length<=9;Zr+="S")Et(Zr,Ko);function OP(t,e){e[ys]=ie(("0."+t)*1e3)}for(Zr="S";Zr.length<=9;Zr+="S")Se(Zr,OP);S0=Jo("Milliseconds",!1);Rt("z",0,0,"zoneAbbr");Rt("zz",0,0,"zoneName");function LP(){return this._isUTC?"UTC":""}function MP(){return this._isUTC?"Coordinated Universal Time":""}var ct=bl.prototype;ct.add=TC;ct.calendar=LC;ct.clone=MC;ct.diff=VC;ct.endOf=KC;ct.format=UC;ct.from=jC;ct.fromNow=WC;ct.to=YC;ct.toNow=XC;ct.get=HT;ct.invalidAt=sP;ct.isAfter=DC;ct.isBefore=NC;ct.isBetween=RC;ct.isSame=$C;ct.isSameOrAfter=BC;ct.isSameOrBefore=FC;ct.isValid=iP;ct.lang=m0;ct.locale=g0;ct.localeData=v0;ct.max=iC;ct.min=nC;ct.parsingFlags=rP;ct.set=UT;ct.startOf=qC;ct.subtract=AC;ct.toArray=tP;ct.toObject=eP;ct.toDate=QC;ct.toISOString=GC;ct.inspect=HC;typeof Symbol<"u"&&Symbol.for!=null&&(ct[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ct.toJSON=nP;ct.toString=zC;ct.unix=JC;ct.valueOf=ZC;ct.creationData=oP;ct.eraName=uP;ct.eraNarrow=hP;ct.eraAbbr=dP;ct.eraYear=fP;ct.year=Yb;ct.isLeapYear=GT;ct.weekYear=xP;ct.isoWeekYear=wP;ct.quarter=ct.quarters=CP;ct.month=Jb;ct.daysInMonth=QT;ct.week=ct.weeks=aA;ct.isoWeek=ct.isoWeeks=lA;ct.weeksInYear=EP;ct.weeksInWeekYear=TP;ct.isoWeeksInYear=_P;ct.isoWeeksInISOWeekYear=SP;ct.date=_0;ct.day=ct.days=wA;ct.weekday=_A;ct.isoWeekday=SA;ct.dayOfYear=PP;ct.hour=ct.hours=kA;ct.minute=ct.minutes=IP;ct.second=ct.seconds=kP;ct.millisecond=ct.milliseconds=S0;ct.utcOffset=dC;ct.utc=pC;ct.local=gC;ct.parseZone=mC;ct.hasAlignedHourOffset=vC;ct.isDST=yC;ct.isLocal=xC;ct.isUtcOffset=wC;ct.isUtc=h0;ct.isUTC=h0;ct.zoneAbbr=LP;ct.zoneName=MP;ct.dates=xi("dates accessor is deprecated. Use date instead.",_0);ct.months=xi("months accessor is deprecated. Use month instead",Jb);ct.years=xi("years accessor is deprecated. Use year instead",Yb);ct.zone=xi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",fC);ct.isDSTShifted=xi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",bC);function DP(t){return $e(t*1e3)}function NP(){return $e.apply(null,arguments).parseZone()}function E0(t){return t}var ge=Vf.prototype;ge.calendar=xT;ge.longDateFormat=ET;ge.invalidDate=AT;ge.ordinal=IT;ge.preparse=E0;ge.postformat=E0;ge.relativeTime=OT;ge.pastFuture=LT;ge.set=yT;ge.eras=aP;ge.erasParse=lP;ge.erasConvertYear=cP;ge.erasAbbrRegex=gP;ge.erasNameRegex=pP;ge.erasNarrowRegex=mP;ge.months=qT;ge.monthsShort=KT;ge.monthsParse=JT;ge.monthsRegex=eA;ge.monthsShortRegex=tA;ge.week=iA;ge.firstDayOfYear=oA;ge.firstDayOfWeek=sA;ge.weekdays=mA;ge.weekdaysMin=yA;ge.weekdaysShort=vA;ge.weekdaysParse=xA;ge.weekdaysRegex=EA;ge.weekdaysShortRegex=TA;ge.weekdaysMinRegex=AA;ge.isPM=PA;ge.meridiem=OA;function Zc(t,e,n,i){var r=Or(),s=Ki().set(i,e);return r[n](s,t)}function T0(t,e,n){if(Cr(t)&&(e=t,t=void 0),t=t||"",e!=null)return Zc(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=Zc(t,i,n,"month");return r}function rp(t,e,n,i){typeof t=="boolean"?(Cr(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Cr(e)&&(n=e,e=void 0),e=e||"");var r=Or(),s=t?r._week.dow:0,o,a=[];if(n!=null)return Zc(e,(n+s)%7,i,"day");for(o=0;o<7;o++)a[o]=Zc(e,(o+s)%7,i,"day");return a}function RP(t,e){return T0(t,e,"months")}function $P(t,e){return T0(t,e,"monthsShort")}function BP(t,e,n){return rp(t,e,n,"weekdays")}function FP(t,e,n){return rp(t,e,n,"weekdaysShort")}function VP(t,e,n){return rp(t,e,n,"weekdaysMin")}Qr("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=ie(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});bt.lang=xi("moment.lang is deprecated. Use moment.locale instead.",Qr);bt.langData=xi("moment.langData is deprecated. Use moment.localeData instead.",Or);var ar=Math.abs;function zP(){var t=this._data;return this._milliseconds=ar(this._milliseconds),this._days=ar(this._days),this._months=ar(this._months),t.milliseconds=ar(t.milliseconds),t.seconds=ar(t.seconds),t.minutes=ar(t.minutes),t.hours=ar(t.hours),t.months=ar(t.months),t.years=ar(t.years),this}function A0(t,e,n,i){var r=Mi(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function GP(t,e){return A0(this,t,e,1)}function HP(t,e){return A0(this,t,e,-1)}function nm(t){return t<0?Math.floor(t):Math.ceil(t)}function UP(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,s,o,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=nm(Bd(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=ci(t/1e3),i.seconds=r%60,s=ci(r/60),i.minutes=s%60,o=ci(s/60),i.hours=o%24,e+=ci(o/24),l=ci(C0(e)),n+=l,e-=nm(Bd(l)),a=ci(n/12),n%=12,i.days=e,i.months=n,i.years=a,this}function C0(t){return t*4800/146097}function Bd(t){return t*146097/4800}function jP(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=wi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+C0(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(Bd(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function Lr(t){return function(){return this.as(t)}}var P0=Lr("ms"),WP=Lr("s"),YP=Lr("m"),XP=Lr("h"),qP=Lr("d"),KP=Lr("w"),ZP=Lr("M"),JP=Lr("Q"),QP=Lr("y"),tI=P0;function eI(){return Mi(this)}function nI(t){return t=wi(t),this.isValid()?this[t+"s"]():NaN}function Vs(t){return function(){return this.isValid()?this._data[t]:NaN}}var iI=Vs("milliseconds"),rI=Vs("seconds"),sI=Vs("minutes"),oI=Vs("hours"),aI=Vs("days"),lI=Vs("months"),cI=Vs("years");function uI(){return ci(this.days()/7)}var cr=Math.round,yo={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function hI(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function dI(t,e,n,i){var r=Mi(t).abs(),s=cr(r.as("s")),o=cr(r.as("m")),a=cr(r.as("h")),l=cr(r.as("d")),c=cr(r.as("M")),h=cr(r.as("w")),u=cr(r.as("y")),d=s<=n.ss&&["s",s]||s<n.s&&["ss",s]||o<=1&&["m"]||o<n.m&&["mm",o]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||h<=1&&["w"]||h<n.w&&["ww",h]),d=d||c<=1&&["M"]||c<n.M&&["MM",c]||u<=1&&["y"]||["yy",u],d[2]=e,d[3]=+t>0,d[4]=i,hI.apply(null,d)}function fI(t){return t===void 0?cr:typeof t=="function"?(cr=t,!0):!1}function pI(t,e){return yo[t]===void 0?!1:e===void 0?yo[t]:(yo[t]=e,t==="s"&&(yo.ss=e-1),!0)}function gI(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=yo,r,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},yo,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),s=dI(this,!n,i,r),n&&(s=r.pastFuture(+this,s)),r.postformat(s)}var $h=Math.abs;function so(t){return(t>0)-(t<0)||+t}function Lu(){if(!this.isValid())return this.localeData().invalidDate();var t=$h(this._milliseconds)/1e3,e=$h(this._days),n=$h(this._months),i,r,s,o,a=this.asSeconds(),l,c,h,u;return a?(i=ci(t/60),r=ci(i/60),t%=60,i%=60,s=ci(n/12),n%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",c=so(this._months)!==so(a)?"-":"",h=so(this._days)!==so(a)?"-":"",u=so(this._milliseconds)!==so(a)?"-":"",l+"P"+(s?c+s+"Y":"")+(n?c+n+"M":"")+(e?h+e+"D":"")+(r||i||t?"T":"")+(r?u+r+"H":"")+(i?u+i+"M":"")+(t?u+o+"S":"")):"P0D"}var ue=ku.prototype;ue.isValid=lC;ue.abs=zP;ue.add=GP;ue.subtract=HP;ue.as=jP;ue.asMilliseconds=P0;ue.asSeconds=WP;ue.asMinutes=YP;ue.asHours=XP;ue.asDays=qP;ue.asWeeks=KP;ue.asMonths=ZP;ue.asQuarters=JP;ue.asYears=QP;ue.valueOf=tI;ue._bubble=UP;ue.clone=eI;ue.get=nI;ue.milliseconds=iI;ue.seconds=rI;ue.minutes=sI;ue.hours=oI;ue.days=aI;ue.weeks=uI;ue.months=lI;ue.years=cI;ue.humanize=gI;ue.toISOString=Lu;ue.toString=Lu;ue.toJSON=Lu;ue.locale=g0;ue.localeData=v0;ue.toIsoString=xi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Lu);ue.lang=m0;Rt("X",0,0,"unix");Rt("x",0,0,"valueOf");Et("x",Au);Et("X",RT);Se("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});Se("x",function(t,e,n){n._d=new Date(ie(t))});//! moment.js
bt.version="2.30.1";mT($e);bt.fn=ct;bt.min=rC;bt.max=sC;bt.now=oC;bt.utc=Ki;bt.unix=DP;bt.months=RP;bt.isDate=yl;bt.locale=Qr;bt.invalid=_u;bt.duration=Mi;bt.isMoment=Li;bt.weekdays=BP;bt.parseZone=NP;bt.localeData=Or;bt.isDuration=Dc;bt.monthsShort=$P;bt.weekdaysMin=VP;bt.defineLocale=Kf;bt.updateLocale=NA;bt.locales=RA;bt.weekdaysShort=FP;bt.normalizeUnits=wi;bt.relativeTimeRounding=fI;bt.relativeTimeThreshold=pI;bt.calendarFormat=OC;bt.prototype=ct;bt.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function im(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function I0(t,e,n){return e&&im(t.prototype,e),n&&im(t,n),t}function Pi(){return Pi=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Pi.apply(this,arguments)}function sp(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function Ms(t){return!!(t&&typeof t.hasOwnProperty=="function"&&(t.hasOwnProperty("__ownerID")||t._map&&t._map.hasOwnProperty("__ownerID")))}function k0(t,e,n){return Object.keys(t).reduce(function(i,r){var s=""+r;return i.has(s)?i.set(s,n(i.get(s),t[s])):i},e)}var mI=function(e){return function(n){return Ms(n)?n.get(e):n[e]}},op=function(){function t(n,i,r){if(i===void 0&&(i={}),r===void 0&&(r={}),!n||typeof n!="string")throw new Error("Expected a string key for Entity, but found "+n+".");var s=r,o=s.idAttribute,a=o===void 0?"id":o,l=s.mergeStrategy,c=l===void 0?function(p,g){return Pi({},p,g)}:l,h=s.processStrategy,u=h===void 0?function(p){return Pi({},p)}:h,d=s.fallbackStrategy,f=d===void 0?function(p,g){}:d;this._key=n,this._getId=typeof a=="function"?a:mI(a),this._idAttribute=a,this._mergeStrategy=c,this._processStrategy=u,this._fallbackStrategy=f,this.define(i)}var e=t.prototype;return e.define=function(i){this.schema=Object.keys(i).reduce(function(r,s){var o,a=i[s];return Pi({},r,(o={},o[s]=a,o))},this.schema||{})},e.getId=function(i,r,s){return this._getId(i,r,s)},e.merge=function(i,r){return this._mergeStrategy(i,r)},e.fallback=function(i,r){return this._fallbackStrategy(i,r)},e.normalize=function(i,r,s,o,a,l){var c=this,h=this.getId(i,r,s),u=this.key;if(u in l||(l[u]={}),h in l[u]||(l[u][h]=[]),l[u][h].some(function(f){return f===i}))return h;l[u][h].push(i);var d=this._processStrategy(i,r,s);return Object.keys(this.schema).forEach(function(f){if(d.hasOwnProperty(f)&&typeof d[f]=="object"){var p=c.schema[f],g=typeof p=="function"?p(i):p;d[f]=o(d[f],d,f,g,a,l)}}),a(this,d,i,r,s),h},e.denormalize=function(i,r){var s=this;return Ms(i)?k0(this.schema,i,r):(Object.keys(this.schema).forEach(function(o){if(i.hasOwnProperty(o)){var a=s.schema[o];i[o]=r(i[o],a)}}),i)},I0(t,[{key:"key",get:function(){return this._key}},{key:"idAttribute",get:function(){return this._idAttribute}}]),t}(),ap=function(){function t(n,i){i&&(this._schemaAttribute=typeof i=="string"?function(r){return r[i]}:i),this.define(n)}var e=t.prototype;return e.define=function(i){this.schema=i},e.getSchemaAttribute=function(i,r,s){return!this.isSingleSchema&&this._schemaAttribute(i,r,s)},e.inferSchema=function(i,r,s){if(this.isSingleSchema)return this.schema;var o=this.getSchemaAttribute(i,r,s);return this.schema[o]},e.normalizeValue=function(i,r,s,o,a,l){var c=this.inferSchema(i,r,s);if(!c)return i;var h=o(i,r,s,c,a,l);return this.isSingleSchema||h===void 0||h===null?h:{id:h,schema:this.getSchemaAttribute(i,r,s)}},e.denormalizeValue=function(i,r){var s=Ms(i)?i.get("schema"):i.schema;if(!this.isSingleSchema&&!s)return i;var o=this.isSingleSchema?void 0:Ms(i)?i.get("id"):i.id,a=this.isSingleSchema?this.schema:this.schema[s];return r(o||i,a)},I0(t,[{key:"isSingleSchema",get:function(){return!this._schemaAttribute}}]),t}(),vI=function(t){sp(e,t);function e(i,r){if(!r)throw new Error('Expected option "schemaAttribute" not found on UnionSchema.');return t.call(this,i,r)||this}var n=e.prototype;return n.normalize=function(r,s,o,a,l,c){return this.normalizeValue(r,s,o,a,l,c)},n.denormalize=function(r,s){return this.denormalizeValue(r,s)},e}(ap),yI=function(t){sp(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;return n.normalize=function(r,s,o,a,l,c){var h=this;return Object.keys(r).reduce(function(u,d,f){var p,g=r[d];return g!=null?Pi({},u,(p={},p[d]=h.normalizeValue(g,r,d,a,l,c),p)):u},{})},n.denormalize=function(r,s){var o=this;return Object.keys(r).reduce(function(a,l){var c,h=r[l];return Pi({},a,(c={},c[l]=o.denormalizeValue(h,s),c))},{})},e}(ap),O0=function(e){var n=Array.isArray(e);if(n&&e.length>1)throw new Error("Expected schema definition to be a single schema, but found "+e.length+".");return e[0]},L0=function(e){return Array.isArray(e)?e:Object.keys(e).map(function(n){return e[n]})},bI=function(e,n,i,r,s,o,a){e=O0(e);var l=L0(n);return l.map(function(c,h){return s(c,i,r,e,o,a)})},xI=function(e,n,i){return e=O0(e),n&&n.map?n.map(function(r){return i(r,e)}):n},wI=function(t){sp(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;return n.normalize=function(r,s,o,a,l,c){var h=this,u=L0(r);return u.map(function(d,f){return h.normalizeValue(d,s,o,a,l,c)}).filter(function(d){return d!=null})},n.denormalize=function(r,s){var o=this;return r&&r.map?r.map(function(a){return o.denormalizeValue(a,s)}):r},e}(ap),M0=function(e,n,i,r,s,o,a){var l=Pi({},n);return Object.keys(e).forEach(function(c){var h=e[c],u=typeof h=="function"?h(n):h,d=s(n[c],n,c,u,o,a);d==null?delete l[c]:l[c]=d}),l},D0=function(e,n,i){if(Ms(n))return k0(e,n,i);var r=Pi({},n);return Object.keys(e).forEach(function(s){r[s]!=null&&(r[s]=i(r[s],e[s]))}),r},_I=function(){function t(n){this.define(n)}var e=t.prototype;return e.define=function(i){this.schema=Object.keys(i).reduce(function(r,s){var o,a=i[s];return Pi({},r,(o={},o[s]=a,o))},this.schema||{})},e.normalize=function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return M0.apply(void 0,[this.schema].concat(r))},e.denormalize=function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return D0.apply(void 0,[this.schema].concat(r))},t}(),SI=function t(e,n,i,r,s,o){if(typeof e!="object"||!e)return e;if(typeof r=="object"&&(!r.normalize||typeof r.normalize!="function")){var a=Array.isArray(r)?bI:M0;return a(r,e,n,i,t,s,o)}return r.normalize(e,n,i,t,s,o)},EI=function(e){return function(n,i,r,s,o){var a=n.key,l=n.getId(r,s,o);a in e||(e[a]={});var c=e[a][l];c?e[a][l]=n.merge(c,i):e[a][l]=i}},Qo={Array:wI,Entity:op,Object:_I,Union:vI,Values:yI},TI=function(e,n){if(!e||typeof e!="object")throw new Error('Unexpected input given to normalize. Expected type to be "object", found "'+(e===null?"null":typeof e)+'".');var i={},r=EI(i),s={},o=SI(e,e,null,n,r,s);return{entities:i,result:o}},AI=function(e,n,i,r,s){var o=r(e,n);if(o===void 0&&n instanceof op&&(o=n.fallback(e,n)),typeof o!="object"||o===null)return o;if(s[n.key]||(s[n.key]={}),!s[n.key][e]){var a=Ms(o)?o:Pi({},o);s[n.key][e]=a,s[n.key][e]=n.denormalize(a,i)}return s[n.key][e]},CI=function(e){var n={},i=PI(e);return function r(s,o){if(typeof o=="object"&&(!o.denormalize||typeof o.denormalize!="function")){var a=Array.isArray(o)?xI:D0;return a(o,s,r)}return s==null?s:o instanceof op?AI(s,o,r,i,n):o.denormalize(s,r)}},PI=function(e){var n=Ms(e);return function(i,r){var s=r.key;return typeof i=="object"?i:n?e.getIn([s,i.toString()]):e[s]&&e[s][i]}},II=function(e,n,i){if(typeof e<"u")return CI(i)(e,n)},kI=typeof vs=="object"&&vs&&vs.Object===Object&&vs,N0=kI,OI=N0,LI=typeof self=="object"&&self&&self.Object===Object&&self,MI=OI||LI||Function("return this")(),Ji=MI,DI=Ji,NI=DI.Symbol,_l=NI,rm=_l,R0=Object.prototype,RI=R0.hasOwnProperty,$I=R0.toString,Ea=rm?rm.toStringTag:void 0;function BI(t){var e=RI.call(t,Ea),n=t[Ea];try{t[Ea]=void 0;var i=!0}catch{}var r=$I.call(t);return i&&(e?t[Ea]=n:delete t[Ea]),r}var FI=BI,VI=Object.prototype,zI=VI.toString;function GI(t){return zI.call(t)}var HI=GI,sm=_l,UI=FI,jI=HI,WI="[object Null]",YI="[object Undefined]",om=sm?sm.toStringTag:void 0;function XI(t){return t==null?t===void 0?YI:WI:om&&om in Object(t)?UI(t):jI(t)}var zs=XI;function qI(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Qi=qI,KI=zs,ZI=Qi,JI="[object AsyncFunction]",QI="[object Function]",tk="[object GeneratorFunction]",ek="[object Proxy]";function nk(t){if(!ZI(t))return!1;var e=KI(t);return e==QI||e==tk||e==JI||e==ek}var lp=nk,ik=Ji,rk=ik["__core-js_shared__"],sk=rk,Bh=sk,am=function(){var t=/[^.]+$/.exec(Bh&&Bh.keys&&Bh.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function ok(t){return!!am&&am in t}var ak=ok,lk=Function.prototype,ck=lk.toString;function uk(t){if(t!=null){try{return ck.call(t)}catch{}try{return t+""}catch{}}return""}var $0=uk,hk=lp,dk=ak,fk=Qi,pk=$0,gk=/[\\^$.*+?()[\]{}|]/g,mk=/^\[object .+?Constructor\]$/,vk=Function.prototype,yk=Object.prototype,bk=vk.toString,xk=yk.hasOwnProperty,wk=RegExp("^"+bk.call(xk).replace(gk,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function _k(t){if(!fk(t)||dk(t))return!1;var e=hk(t)?wk:mk;return e.test(pk(t))}var Sk=_k;function Ek(t,e){return t==null?void 0:t[e]}var Tk=Ek,Ak=Sk,Ck=Tk;function Pk(t,e){var n=Ck(t,e);return Ak(n)?n:void 0}var Gs=Pk,Ik=Gs,kk=function(){try{var t=Ik(Object,"defineProperty");return t({},"",{}),t}catch{}}(),B0=kk,lm=B0;function Ok(t,e,n){e=="__proto__"&&lm?lm(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var Mu=Ok;function Lk(t){return function(e,n,i){for(var r=-1,s=Object(e),o=i(e),a=o.length;a--;){var l=o[t?a:++r];if(n(s[l],l,s)===!1)break}return e}}var Mk=Lk,Dk=Mk,Nk=Dk(),F0=Nk;function Rk(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var $k=Rk;function Bk(t){return t!=null&&typeof t=="object"}var tr=Bk,Fk=zs,Vk=tr,zk="[object Arguments]";function Gk(t){return Vk(t)&&Fk(t)==zk}var Hk=Gk,cm=Hk,Uk=tr,V0=Object.prototype,jk=V0.hasOwnProperty,Wk=V0.propertyIsEnumerable,Yk=cm(function(){return arguments}())?cm:function(t){return Uk(t)&&jk.call(t,"callee")&&!Wk.call(t,"callee")},Du=Yk,Xk=Array.isArray,An=Xk,Jc={exports:{}};function qk(){return!1}var Kk=qk;Jc.exports;(function(t,e){var n=Ji,i=Kk,r=e&&!e.nodeType&&e,s=r&&!0&&t&&!t.nodeType&&t,o=s&&s.exports===r,a=o?n.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||i;t.exports=c})(Jc,Jc.exports);var Sl=Jc.exports,Zk=9007199254740991,Jk=/^(?:0|[1-9]\d*)$/;function Qk(t,e){var n=typeof t;return e=e??Zk,!!e&&(n=="number"||n!="symbol"&&Jk.test(t))&&t>-1&&t%1==0&&t<e}var cp=Qk,tO=9007199254740991;function eO(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=tO}var up=eO,nO=zs,iO=up,rO=tr,sO="[object Arguments]",oO="[object Array]",aO="[object Boolean]",lO="[object Date]",cO="[object Error]",uO="[object Function]",hO="[object Map]",dO="[object Number]",fO="[object Object]",pO="[object RegExp]",gO="[object Set]",mO="[object String]",vO="[object WeakMap]",yO="[object ArrayBuffer]",bO="[object DataView]",xO="[object Float32Array]",wO="[object Float64Array]",_O="[object Int8Array]",SO="[object Int16Array]",EO="[object Int32Array]",TO="[object Uint8Array]",AO="[object Uint8ClampedArray]",CO="[object Uint16Array]",PO="[object Uint32Array]",Ne={};Ne[xO]=Ne[wO]=Ne[_O]=Ne[SO]=Ne[EO]=Ne[TO]=Ne[AO]=Ne[CO]=Ne[PO]=!0;Ne[sO]=Ne[oO]=Ne[yO]=Ne[aO]=Ne[bO]=Ne[lO]=Ne[cO]=Ne[uO]=Ne[hO]=Ne[dO]=Ne[fO]=Ne[pO]=Ne[gO]=Ne[mO]=Ne[vO]=!1;function IO(t){return rO(t)&&iO(t.length)&&!!Ne[nO(t)]}var kO=IO;function OO(t){return function(e){return t(e)}}var Nu=OO,Qc={exports:{}};Qc.exports;(function(t,e){var n=N0,i=e&&!e.nodeType&&e,r=i&&!0&&t&&!t.nodeType&&t,s=r&&r.exports===i,o=s&&n.process,a=function(){try{var l=r&&r.require&&r.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();t.exports=a})(Qc,Qc.exports);var hp=Qc.exports,LO=kO,MO=Nu,um=hp,hm=um&&um.isTypedArray,DO=hm?MO(hm):LO,Ru=DO,NO=$k,RO=Du,$O=An,BO=Sl,FO=cp,VO=Ru,zO=Object.prototype,GO=zO.hasOwnProperty;function HO(t,e){var n=$O(t),i=!n&&RO(t),r=!n&&!i&&BO(t),s=!n&&!i&&!r&&VO(t),o=n||i||r||s,a=o?NO(t.length,String):[],l=a.length;for(var c in t)(e||GO.call(t,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||FO(c,l)))&&a.push(c);return a}var z0=HO,UO=Object.prototype;function jO(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||UO;return t===n}var $u=jO;function WO(t,e){return function(n){return t(e(n))}}var G0=WO,YO=G0,XO=YO(Object.keys,Object),qO=XO,KO=$u,ZO=qO,JO=Object.prototype,QO=JO.hasOwnProperty;function t2(t){if(!KO(t))return ZO(t);var e=[];for(var n in Object(t))QO.call(t,n)&&n!="constructor"&&e.push(n);return e}var H0=t2,e2=lp,n2=up;function i2(t){return t!=null&&n2(t.length)&&!e2(t)}var rs=i2,r2=z0,s2=H0,o2=rs;function a2(t){return o2(t)?r2(t):s2(t)}var ta=a2,l2=F0,c2=ta;function u2(t,e){return t&&l2(t,e,c2)}var U0=u2;function h2(){this.__data__=[],this.size=0}var d2=h2;function f2(t,e){return t===e||t!==t&&e!==e}var El=f2,p2=El;function g2(t,e){for(var n=t.length;n--;)if(p2(t[n][0],e))return n;return-1}var Bu=g2,m2=Bu,v2=Array.prototype,y2=v2.splice;function b2(t){var e=this.__data__,n=m2(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():y2.call(e,n,1),--this.size,!0}var x2=b2,w2=Bu;function _2(t){var e=this.__data__,n=w2(e,t);return n<0?void 0:e[n][1]}var S2=_2,E2=Bu;function T2(t){return E2(this.__data__,t)>-1}var A2=T2,C2=Bu;function P2(t,e){var n=this.__data__,i=C2(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}var I2=P2,k2=d2,O2=x2,L2=S2,M2=A2,D2=I2;function ea(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}ea.prototype.clear=k2;ea.prototype.delete=O2;ea.prototype.get=L2;ea.prototype.has=M2;ea.prototype.set=D2;var Fu=ea,N2=Fu;function R2(){this.__data__=new N2,this.size=0}var $2=R2;function B2(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var F2=B2;function V2(t){return this.__data__.get(t)}var z2=V2;function G2(t){return this.__data__.has(t)}var H2=G2,U2=Gs,j2=Ji,W2=U2(j2,"Map"),dp=W2,Y2=Gs,X2=Y2(Object,"create"),Vu=X2,dm=Vu;function q2(){this.__data__=dm?dm(null):{},this.size=0}var K2=q2;function Z2(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var J2=Z2,Q2=Vu,tL="__lodash_hash_undefined__",eL=Object.prototype,nL=eL.hasOwnProperty;function iL(t){var e=this.__data__;if(Q2){var n=e[t];return n===tL?void 0:n}return nL.call(e,t)?e[t]:void 0}var rL=iL,sL=Vu,oL=Object.prototype,aL=oL.hasOwnProperty;function lL(t){var e=this.__data__;return sL?e[t]!==void 0:aL.call(e,t)}var cL=lL,uL=Vu,hL="__lodash_hash_undefined__";function dL(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=uL&&e===void 0?hL:e,this}var fL=dL,pL=K2,gL=J2,mL=rL,vL=cL,yL=fL;function na(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}na.prototype.clear=pL;na.prototype.delete=gL;na.prototype.get=mL;na.prototype.has=vL;na.prototype.set=yL;var bL=na,fm=bL,xL=Fu,wL=dp;function _L(){this.size=0,this.__data__={hash:new fm,map:new(wL||xL),string:new fm}}var SL=_L;function EL(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var TL=EL,AL=TL;function CL(t,e){var n=t.__data__;return AL(e)?n[typeof e=="string"?"string":"hash"]:n.map}var zu=CL,PL=zu;function IL(t){var e=PL(this,t).delete(t);return this.size-=e?1:0,e}var kL=IL,OL=zu;function LL(t){return OL(this,t).get(t)}var ML=LL,DL=zu;function NL(t){return DL(this,t).has(t)}var RL=NL,$L=zu;function BL(t,e){var n=$L(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}var FL=BL,VL=SL,zL=kL,GL=ML,HL=RL,UL=FL;function ia(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}ia.prototype.clear=VL;ia.prototype.delete=zL;ia.prototype.get=GL;ia.prototype.has=HL;ia.prototype.set=UL;var fp=ia,jL=Fu,WL=dp,YL=fp,XL=200;function qL(t,e){var n=this.__data__;if(n instanceof jL){var i=n.__data__;if(!WL||i.length<XL-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new YL(i)}return n.set(t,e),this.size=n.size,this}var KL=qL,ZL=Fu,JL=$2,QL=F2,tM=z2,eM=H2,nM=KL;function ra(t){var e=this.__data__=new ZL(t);this.size=e.size}ra.prototype.clear=JL;ra.prototype.delete=QL;ra.prototype.get=tM;ra.prototype.has=eM;ra.prototype.set=nM;var Gu=ra,iM="__lodash_hash_undefined__";function rM(t){return this.__data__.set(t,iM),this}var sM=rM;function oM(t){return this.__data__.has(t)}var aM=oM,lM=fp,cM=sM,uM=aM;function tu(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new lM;++e<n;)this.add(t[e])}tu.prototype.add=tu.prototype.push=cM;tu.prototype.has=uM;var j0=tu;function hM(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var dM=hM;function fM(t,e){return t.has(e)}var W0=fM,pM=j0,gM=dM,mM=W0,vM=1,yM=2;function bM(t,e,n,i,r,s){var o=n&vM,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),h=s.get(e);if(c&&h)return c==e&&h==t;var u=-1,d=!0,f=n&yM?new pM:void 0;for(s.set(t,e),s.set(e,t);++u<a;){var p=t[u],g=e[u];if(i)var v=o?i(g,p,u,e,t,s):i(p,g,u,t,e,s);if(v!==void 0){if(v)continue;d=!1;break}if(f){if(!gM(e,function(x,S){if(!mM(f,S)&&(p===x||r(p,x,n,i,s)))return f.push(S)})){d=!1;break}}else if(!(p===g||r(p,g,n,i,s))){d=!1;break}}return s.delete(t),s.delete(e),d}var Y0=bM,xM=Ji,wM=xM.Uint8Array,X0=wM;function _M(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n}var SM=_M;function EM(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var pp=EM,pm=_l,gm=X0,TM=El,AM=Y0,CM=SM,PM=pp,IM=1,kM=2,OM="[object Boolean]",LM="[object Date]",MM="[object Error]",DM="[object Map]",NM="[object Number]",RM="[object RegExp]",$M="[object Set]",BM="[object String]",FM="[object Symbol]",VM="[object ArrayBuffer]",zM="[object DataView]",mm=pm?pm.prototype:void 0,Fh=mm?mm.valueOf:void 0;function GM(t,e,n,i,r,s,o){switch(n){case zM:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case VM:return!(t.byteLength!=e.byteLength||!s(new gm(t),new gm(e)));case OM:case LM:case NM:return TM(+t,+e);case MM:return t.name==e.name&&t.message==e.message;case RM:case BM:return t==e+"";case DM:var a=CM;case $M:var l=i&IM;if(a||(a=PM),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;i|=kM,o.set(t,e);var h=AM(a(t),a(e),i,r,s,o);return o.delete(t),h;case FM:if(Fh)return Fh.call(t)==Fh.call(e)}return!1}var HM=GM;function UM(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var q0=UM,jM=q0,WM=An;function YM(t,e,n){var i=e(t);return WM(t)?i:jM(i,n(t))}var K0=YM;function XM(t,e){for(var n=-1,i=t==null?0:t.length,r=0,s=[];++n<i;){var o=t[n];e(o,n,t)&&(s[r++]=o)}return s}var Z0=XM;function qM(){return[]}var J0=qM,KM=Z0,ZM=J0,JM=Object.prototype,QM=JM.propertyIsEnumerable,vm=Object.getOwnPropertySymbols,tD=vm?function(t){return t==null?[]:(t=Object(t),KM(vm(t),function(e){return QM.call(t,e)}))}:ZM,gp=tD,eD=K0,nD=gp,iD=ta;function rD(t){return eD(t,iD,nD)}var Q0=rD,ym=Q0,sD=1,oD=Object.prototype,aD=oD.hasOwnProperty;function lD(t,e,n,i,r,s){var o=n&sD,a=ym(t),l=a.length,c=ym(e),h=c.length;if(l!=h&&!o)return!1;for(var u=l;u--;){var d=a[u];if(!(o?d in e:aD.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var g=!0;s.set(t,e),s.set(e,t);for(var v=o;++u<l;){d=a[u];var x=t[d],S=e[d];if(i)var C=o?i(S,x,d,e,t,s):i(x,S,d,t,e,s);if(!(C===void 0?x===S||r(x,S,n,i,s):C)){g=!1;break}v||(v=d=="constructor")}if(g&&!v){var P=t.constructor,k=e.constructor;P!=k&&"constructor"in t&&"constructor"in e&&!(typeof P=="function"&&P instanceof P&&typeof k=="function"&&k instanceof k)&&(g=!1)}return s.delete(t),s.delete(e),g}var cD=lD,uD=Gs,hD=Ji,dD=uD(hD,"DataView"),fD=dD,pD=Gs,gD=Ji,mD=pD(gD,"Promise"),vD=mD,yD=Gs,bD=Ji,xD=yD(bD,"Set"),tx=xD,wD=Gs,_D=Ji,SD=wD(_D,"WeakMap"),ED=SD,Fd=fD,Vd=dp,zd=vD,Gd=tx,Hd=ED,ex=zs,sa=$0,bm="[object Map]",TD="[object Object]",xm="[object Promise]",wm="[object Set]",_m="[object WeakMap]",Sm="[object DataView]",AD=sa(Fd),CD=sa(Vd),PD=sa(zd),ID=sa(Gd),kD=sa(Hd),ps=ex;(Fd&&ps(new Fd(new ArrayBuffer(1)))!=Sm||Vd&&ps(new Vd)!=bm||zd&&ps(zd.resolve())!=xm||Gd&&ps(new Gd)!=wm||Hd&&ps(new Hd)!=_m)&&(ps=function(t){var e=ex(t),n=e==TD?t.constructor:void 0,i=n?sa(n):"";if(i)switch(i){case AD:return Sm;case CD:return bm;case PD:return xm;case ID:return wm;case kD:return _m}return e});var Tl=ps,Vh=Gu,OD=Y0,LD=HM,MD=cD,Em=Tl,Tm=An,Am=Sl,DD=Ru,ND=1,Cm="[object Arguments]",Pm="[object Array]",rc="[object Object]",RD=Object.prototype,Im=RD.hasOwnProperty;function $D(t,e,n,i,r,s){var o=Tm(t),a=Tm(e),l=o?Pm:Em(t),c=a?Pm:Em(e);l=l==Cm?rc:l,c=c==Cm?rc:c;var h=l==rc,u=c==rc,d=l==c;if(d&&Am(t)){if(!Am(e))return!1;o=!0,h=!1}if(d&&!h)return s||(s=new Vh),o||DD(t)?OD(t,e,n,i,r,s):LD(t,e,l,n,i,r,s);if(!(n&ND)){var f=h&&Im.call(t,"__wrapped__"),p=u&&Im.call(e,"__wrapped__");if(f||p){var g=f?t.value():t,v=p?e.value():e;return s||(s=new Vh),r(g,v,n,i,s)}}return d?(s||(s=new Vh),MD(t,e,n,i,r,s)):!1}var BD=$D,FD=BD,km=tr;function nx(t,e,n,i,r){return t===e?!0:t==null||e==null||!km(t)&&!km(e)?t!==t&&e!==e:FD(t,e,n,i,nx,r)}var ix=nx,VD=Gu,zD=ix,GD=1,HD=2;function UD(t,e,n,i){var r=n.length,s=r,o=!i;if(t==null)return!s;for(t=Object(t);r--;){var a=n[r];if(o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<s;){a=n[r];var l=a[0],c=t[l],h=a[1];if(o&&a[2]){if(c===void 0&&!(l in t))return!1}else{var u=new VD;if(i)var d=i(c,h,l,t,e,u);if(!(d===void 0?zD(h,c,GD|HD,i,u):d))return!1}}return!0}var jD=UD,WD=Qi;function YD(t){return t===t&&!WD(t)}var rx=YD,XD=rx,qD=ta;function KD(t){for(var e=qD(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,XD(r)]}return e}var ZD=KD;function JD(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var sx=JD,QD=jD,tN=ZD,eN=sx;function nN(t){var e=tN(t);return e.length==1&&e[0][2]?eN(e[0][0],e[0][1]):function(n){return n===t||QD(n,t,e)}}var iN=nN,rN=zs,sN=tr,oN="[object Symbol]";function aN(t){return typeof t=="symbol"||sN(t)&&rN(t)==oN}var Al=aN,lN=An,cN=Al,uN=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hN=/^\w*$/;function dN(t,e){if(lN(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||cN(t)?!0:hN.test(t)||!uN.test(t)||e!=null&&t in Object(e)}var mp=dN,ox=fp,fN="Expected a function";function vp(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(fN);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var o=t.apply(this,i);return n.cache=s.set(r,o)||s,o};return n.cache=new(vp.Cache||ox),n}vp.Cache=ox;var ax=vp;const vnt=Zn(ax);var pN=ax,gN=500;function mN(t){var e=pN(t,function(i){return n.size===gN&&n.clear(),i}),n=e.cache;return e}var vN=mN,yN=vN,bN=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xN=/\\(\\)?/g,wN=yN(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(bN,function(n,i,r,s){e.push(r?s.replace(xN,"$1"):i||n)}),e}),_N=wN;function SN(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var yp=SN,Om=_l,EN=yp,TN=An,AN=Al,CN=1/0,Lm=Om?Om.prototype:void 0,Mm=Lm?Lm.toString:void 0;function lx(t){if(typeof t=="string")return t;if(TN(t))return EN(t,lx)+"";if(AN(t))return Mm?Mm.call(t):"";var e=t+"";return e=="0"&&1/t==-CN?"-0":e}var PN=lx,IN=PN;function kN(t){return t==null?"":IN(t)}var ON=kN,LN=An,MN=mp,DN=_N,NN=ON;function RN(t,e){return LN(t)?t:MN(t,e)?[t]:DN(NN(t))}var cx=RN,$N=Al,BN=1/0;function FN(t){if(typeof t=="string"||$N(t))return t;var e=t+"";return e=="0"&&1/t==-BN?"-0":e}var Hu=FN,VN=cx,zN=Hu;function GN(t,e){e=VN(e,t);for(var n=0,i=e.length;t!=null&&n<i;)t=t[zN(e[n++])];return n&&n==i?t:void 0}var bp=GN,HN=bp;function UN(t,e,n){var i=t==null?void 0:HN(t,e);return i===void 0?n:i}var jN=UN;function WN(t,e){return t!=null&&e in Object(t)}var YN=WN,XN=cx,qN=Du,KN=An,ZN=cp,JN=up,QN=Hu;function tR(t,e,n){e=XN(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var o=QN(e[i]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&JN(r)&&ZN(o,r)&&(KN(t)||qN(t)))}var eR=tR,nR=YN,iR=eR;function rR(t,e){return t!=null&&iR(t,e,nR)}var sR=rR,oR=ix,aR=jN,lR=sR,cR=mp,uR=rx,hR=sx,dR=Hu,fR=1,pR=2;function gR(t,e){return cR(t)&&uR(e)?hR(dR(t),e):function(n){var i=aR(n,t);return i===void 0&&i===e?lR(n,t):oR(e,i,fR|pR)}}var mR=gR;function vR(t){return t}var Cl=vR;function yR(t){return function(e){return e==null?void 0:e[t]}}var bR=yR,xR=bp;function wR(t){return function(e){return xR(e,t)}}var _R=wR,SR=bR,ER=_R,TR=mp,AR=Hu;function CR(t){return TR(t)?SR(AR(t)):ER(t)}var PR=CR,IR=iN,kR=mR,OR=Cl,LR=An,MR=PR;function DR(t){return typeof t=="function"?t:t==null?OR:typeof t=="object"?LR(t)?kR(t[0],t[1]):IR(t):MR(t)}var Hs=DR,NR=Mu,RR=U0,$R=Hs;function BR(t,e){var n={};return e=$R(e),RR(t,function(i,r,s){NR(n,r,e(i,r,s))}),n}var FR=BR;const ux=Zn(FR),{round:VR,floor:zR,PI:hx}=Math,Ze={linear:function(t,e,n){var i=t[1]-t[0],r=e[1]-e[0];return(n-t[0])/i*r+e[0]||0}},nn=function(t){return t%360+(t<0?360:0)},pi=function(t,e){return e*VR(t/e)},Uu=function(t){return 180*t/hx%360},un=function(t,e){return e=e||!1,t=e?t:t%360,t*hx/180},Za=function(t,e){if(e===void 0)e=t===void 0?1:t,t=0;else if(e<t){const n=t;t=e,e=n}return zR(Math.random()*(e-t+1)+t)},{cos:sc,sin:zh,atan2:GR}=Math,dx=function(t,e){var n=un(t.y),i=un(e.y),r=t.x,s=e.x,o=un(s-r),a=zh(o)*sc(i),l=sc(n)*zh(i)-zh(n)*sc(i)*sc(o),c=Uu(GR(a,l)),h=["NE","E","SE","S","SW","W","NW","N"],u=c-22.5;return u<0&&(u+=360),u=parseInt(u/45),h[u]},xp=function(t,e){var n=t.x,i=t.y,r=e.x,s=e.y;return(n-=r)*n+(i-=s)*i},fx=function(t,e){return Math.sqrt(xp(t,e))},Ut={Point:1,Line:2,Ellipse:3,Rect:4,Polyline:5,Polygon:6,Curve:7,Path:8},{abs:eu,cos:Ud,sin:jd,sqrt:Dm,min:Nm,max:Rm,atan2:HR,round:$m,pow:UR,PI:Bm}=Math,M=function(t,e){if(!(this instanceof M))return new M(t,e);if(typeof t=="string"){var n=t.split(t.indexOf("@")===-1?" ":"@");t=parseFloat(n[0]),e=parseFloat(n[1])}else Object(t)===t&&(e=t.y,t=t.x);this.x=t===void 0?0:t,this.y=e===void 0?0:e};M.fromPolar=function(t,e,n){n=new M(n);var i=eu(t*Ud(e)),r=eu(t*jd(e)),s=nn(Uu(e));return s<90?r=-r:s<180?(i=-i,r=-r):s<270&&(i=-i),new M(n.x+i,n.y+r)};M.random=function(t,e,n,i){return new M(Za(t,e),Za(n,i))};M.prototype={type:Ut.Point,chooseClosest:function(t){var e=t.length;if(e===1)return new M(t[0]);for(var n=null,i=1/0,r=0;r<e;r++){var s=new M(t[r]),o=this.squaredDistance(s);o<i&&(n=s,i=o)}return n},adhereToRect:function(t){return t.containsPoint(this)?this:(this.x=Nm(Rm(this.x,t.x),t.x+t.width),this.y=Nm(Rm(this.y,t.y),t.y+t.height),this)},angleBetween:function(t,e){var n=this.equals(t)||this.equals(e)?NaN:this.theta(e)-this.theta(t);return n<0&&(n+=360),n},bearing:function(t){return dx(this,t)},changeInAngle:function(t,e,n){return this.clone().offset(-t,-e).theta(n)-this.theta(n)},clone:function(){return new M(this)},cross:function(t,e){return t&&e?(e.x-this.x)*(t.y-this.y)-(e.y-this.y)*(t.x-this.x):NaN},difference:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),new M(this.x-(t||0),this.y-(e||0))},distance:function(t){return fx(this,t)},dot:function(t){return t?this.x*t.x+this.y*t.y:NaN},equals:function(t){return!!t&&this.x===t.x&&this.y===t.y},lerp:function(t,e){var n=this.x,i=this.y;return new M((1-e)*n+e*t.x,(1-e)*i+e*t.y)},magnitude:function(){return Dm(this.x*this.x+this.y*this.y)||.01},manhattanDistance:function(t){return eu(t.x-this.x)+eu(t.y-this.y)},move:function(t,e){var n=un(new M(t).theta(this)),i=this.offset(Ud(n)*e,-jd(n)*e);return i},normalize:function(t){var e=(t||1)/this.magnitude();return this.scale(e,e)},offset:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),this.x+=t||0,this.y+=e||0,this},reflection:function(t){return new M(t).move(this,this.distance(t))},rotate:function(t,e){if(e===0)return this;t=t||new M(0,0),e=un(nn(-e));var n=Ud(e),i=jd(e),r=n*(this.x-t.x)-i*(this.y-t.y)+t.x,s=i*(this.x-t.x)+n*(this.y-t.y)+t.y;return this.x=r,this.y=s,this},round:function(t){let e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=UR(10,t);break}return this.x=$m(this.x*e)/e,this.y=$m(this.y*e)/e,this},scale:function(t,e,n){return n=n&&new M(n)||new M(0,0),this.x=n.x+t*(this.x-n.x),this.y=n.y+e*(this.y-n.y),this},snapToGrid:function(t,e){return this.x=pi(this.x,t),this.y=pi(this.y,e||t),this},squaredDistance:function(t){return xp(this,t)},theta:function(t){t=new M(t);var e=-(t.y-this.y),n=t.x-this.x,i=HR(e,n);return i<0&&(i=2*Bm+i),180*i/Bm},toJSON:function(){return{x:this.x,y:this.y}},toPolar:function(t){t=t&&new M(t)||new M(0,0);var e=this.x,n=this.y;return this.x=Dm((e-t.x)*(e-t.x)+(n-t.y)*(n-t.y)),this.y=un(t.theta(new M(e,n))),this},toString:function(){return this.x+"@"+this.y},serialize:function(){return this.x+","+this.y},update:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),this.x=t||0,this.y=e||0,this},vectorAngle:function(t){var e=new M(0,0);return e.angleBetween(this,t)}};M.prototype.translate=M.prototype.offset;const oe=M,{max:Gh,min:Hh}=Math,gt=function(t,e){if(!(this instanceof gt))return new gt(t,e);if(t instanceof gt)return new gt(t.start,t.end);this.start=new M(t),this.end=new M(e)};gt.prototype={type:Ut.Line,angle:function(){var t=new M(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)},bbox:function(){var t=Hh(this.start.x,this.end.x),e=Hh(this.start.y,this.end.y),n=Gh(this.start.x,this.end.x),i=Gh(this.start.y,this.end.y);return new Z(t,e,n-t,i-e)},bearing:function(){return dx(this.start,this.end)},clone:function(){return new gt(this.start,this.end)},closestPoint:function(t){return this.pointAt(this.closestPointNormalizedLength(t))},closestPointLength:function(t){return this.closestPointNormalizedLength(t)*this.length()},closestPointNormalizedLength:function(t){var e=this.vector().dot(new gt(this.start,t).vector()),n=Hh(1,Gh(0,e/this.squaredLength()));return n!==n?0:n},closestPointTangent:function(t){return this.tangentAt(this.closestPointNormalizedLength(t))},containsPoint:function(t){var e=this.start,n=this.end;if(e.cross(t,n)!==0)return!1;var i=this.length();return!(new gt(e,t).length()>i||new gt(t,n).length()>i)},divideAt:function(t){var e=this.pointAt(t);return[new gt(this.start,e),new gt(e,this.end)]},divideAtLength:function(t){var e=this.pointAtLength(t);return[new gt(this.start,e),new gt(e,this.end)]},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y},intersect:function(t,e){if(t&&t.intersectionWithLine){var n=t.intersectionWithLine(this,e);return n&&t instanceof gt&&(n=n[0]),n}return null},intersectionWithLine:function(t){var e=new M(this.end.x-this.start.x,this.end.y-this.start.y),n=new M(t.end.x-t.start.x,t.end.y-t.start.y),i=e.x*n.y-e.y*n.x,r=new M(t.start.x-this.start.x,t.start.y-this.start.y),s=r.x*n.y-r.y*n.x,o=r.x*e.y-r.y*e.x;if(i===0||s*i<0||o*i<0)return null;if(i>0){if(s>i||o>i)return null}else if(s<i||o<i)return null;return[new M(this.start.x+s*e.x/i,this.start.y+s*e.y/i)]},isDifferentiable:function(){return!this.start.equals(this.end)},length:function(){return fx(this.start,this.end)},midpoint:function(){return new M((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},parallel:function(t){const e=this.clone();if(!this.isDifferentiable())return e;const{start:n,end:i}=e,r=n.clone().rotate(i,270),s=i.clone().rotate(n,90);return n.move(s,t),i.move(r,t),e},pointAt:function(t){var e=this.start,n=this.end;return t<=0?e.clone():t>=1?n.clone():e.lerp(n,t)},pointAtLength:function(t){var e=this.start,n=this.end,i=!0;t<0&&(i=!1,t=-t);var r=this.length();return t>=r?i?n.clone():e.clone():this.pointAt((i?t:r-t)/r)},pointOffset:function(t){t=new M(t);var e=this.start,n=this.end,i=(n.x-e.x)*(t.y-e.y)-(n.y-e.y)*(t.x-e.x);return i/this.length()},rotate:function(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this},round:function(t){return this.start.round(t),this.end.round(t),this},scale:function(t,e,n){return this.start.scale(t,e,n),this.end.scale(t,e,n),this},setLength:function(t){var e=this.length();if(!e)return this;var n=t/e;return this.scale(n,n,this.start)},squaredLength:function(){return xp(this.start,this.end)},tangentAt:function(t){if(!this.isDifferentiable())return null;var e=this.start,n=this.end,i=this.pointAt(t),r=new gt(e,n);return r.translate(i.x-e.x,i.y-e.y),r},tangentAtLength:function(t){if(!this.isDifferentiable())return null;var e=this.start,n=this.end,i=this.pointAtLength(t),r=new gt(e,n);return r.translate(i.x-e.x,i.y-e.y),r},toString:function(){return this.start.toString()+" "+this.end.toString()},serialize:function(){return this.start.serialize()+" "+this.end.serialize()},translate:function(t,e){return this.start.translate(t,e),this.end.translate(t,e),this},vector:function(){return new M(this.end.x-this.start.x,this.end.y-this.start.y)}};gt.prototype.intersection=gt.prototype.intersect;const Ps=gt,{sqrt:Fm,round:oc,pow:jR}=Math,Bn=function(t,e,n){if(!(this instanceof Bn))return new Bn(t,e,n);if(t instanceof Bn)return new Bn(new M(t.x,t.y),t.a,t.b);t=new M(t),this.x=t.x,this.y=t.y,this.a=e,this.b=n};Bn.fromRect=function(t){return t=new Z(t),new Bn(t.center(),t.width/2,t.height/2)};Bn.prototype={type:Ut.Ellipse,bbox:function(){return new Z(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},center:function(){return new M(this.x,this.y)},clone:function(){return new Bn(this)},containsPoint:function(t){return this.normalizedDistance(t)<=1},equals:function(t){return!!t&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b},inflate:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.a+=2*t,this.b+=2*e,this},intersectionWithLine:function(t){var e=[],n=t.start,i=t.end,r=this.a,s=this.b,o=t.vector(),a=n.difference(new M(this)),l=new M(o.x/(r*r),o.y/(s*s)),c=new M(a.x/(r*r),a.y/(s*s)),h=o.dot(l),u=o.dot(c),d=a.dot(c)-1,f=u*u-h*d;if(f<0)return null;if(f>0){var p=Fm(f),g=(-u-p)/h,v=(-u+p)/h;if((g<0||1<g)&&(v<0||1<v))return null;0<=g&&g<=1&&e.push(n.lerp(i,g)),0<=v&&v<=1&&e.push(n.lerp(i,v))}else{var x=-u/h;if(0<=x&&x<=1)e.push(n.lerp(i,x));else return null}return e},intersectionWithLineFromCenterToPoint:function(t,e){t=new M(t),e&&t.rotate(new M(this.x,this.y),e);var n=t.x-this.x,i=t.y-this.y,r;if(n===0)return r=this.bbox().pointNearestToPoint(t),e?r.rotate(new M(this.x,this.y),-e):r;var s=i/n,o=s*s,a=this.a*this.a,l=this.b*this.b,c=Fm(1/(1/a+o/l));c=n<0?-c:c;var h=s*c;return r=new M(this.x+c,this.y+h),e?r.rotate(new M(this.x,this.y),-e):r},normalizedDistance:function(t){var e=t.x,n=t.y,i=this.a,r=this.b,s=this.x,o=this.y;return(e-s)*(e-s)/(i*i)+(n-o)*(n-o)/(r*r)},round:function(t){let e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=jR(10,t);break}return this.x=oc(this.x*e)/e,this.y=oc(this.y*e)/e,this.a=oc(this.a*e)/e,this.b=oc(this.b*e)/e,this},tangentTheta:function(t){var e=30,n=t.x,i=t.y,r=this.a,s=this.b,o=this.bbox().center(),a=o.x,l=o.y,c=n>o.x+r/2,h=n<o.x-r/2,u,d;return c||h?(u=n>o.x?i-e:i+e,d=r*r/(n-a)-r*r*(i-l)*(u-l)/(s*s*(n-a))+a):(d=i>o.y?n+e:n-e,u=s*s/(i-l)-s*s*(n-a)*(d-a)/(r*r*(i-l))+l),new M(d,u).theta(t)},toString:function(){return new M(this.x,this.y).toString()+" "+this.a+" "+this.b}};const WR=Bn,{abs:Vm,cos:YR,sin:XR,min:Ta,max:zm,round:ac,pow:qR}=Math,Z=function(t,e,n,i){if(!(this instanceof Z))return new Z(t,e,n,i);Object(t)===t&&(e=t.y,n=t.width,i=t.height,t=t.x),this.x=t===void 0?0:t,this.y=e===void 0?0:e,this.width=n===void 0?0:n,this.height=i===void 0?0:i};Z.fromEllipse=function(t){return t=new Bn(t),new Z(t.x-t.a,t.y-t.b,2*t.a,2*t.b)};Z.fromPointUnion=function(...t){if(t.length===0)return null;const e=new M;let n,i,r,s;n=i=1/0,r=s=-1/0;for(let o=0;o<t.length;o++){e.update(t[o]);const a=e.x,l=e.y;a<n&&(n=a),a>r&&(r=a),l<i&&(i=l),l>s&&(s=l)}return new Z(n,i,r-n,s-i)};Z.fromRectUnion=function(...t){if(t.length===0)return null;const e=new Z;let n,i,r,s;n=i=1/0,r=s=-1/0;for(let o=0;o<t.length;o++){e.update(t[o]);const a=e.x,l=e.y,c=a+e.width,h=l+e.height;a<n&&(n=a),c>r&&(r=c),l<i&&(i=l),h>s&&(s=h)}return new Z(n,i,r-n,s-i)};Z.prototype={type:Ut.Rect,bbox:function(t){return this.clone().rotateAroundCenter(t)},rotateAroundCenter:function(t){if(!t)return this;const{width:e,height:n}=this,i=un(t),r=Vm(XR(i)),s=Vm(YR(i)),o=e*s+n*r,a=e*r+n*s;return this.x+=(e-o)/2,this.y+=(n-a)/2,this.width=o,this.height=a,this},bottomLeft:function(){return new M(this.x,this.y+this.height)},bottomLine:function(){return new gt(this.bottomLeft(),this.bottomRight())},bottomMiddle:function(){return new M(this.x+this.width/2,this.y+this.height)},center:function(){return new M(this.x+this.width/2,this.y+this.height/2)},clone:function(){return new Z(this)},containsPoint:function(t){return t instanceof M||(t=new M(t)),t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height},containsRect:function(t){var e=new Z(this).normalize(),n=new Z(t).normalize(),i=e.width,r=e.height,s=n.width,o=n.height;if(!i||!r||!s||!o)return!1;var a=e.x,l=e.y,c=n.x,h=n.y;return s+=c,i+=a,o+=h,r+=l,a<=c&&s<=i&&l<=h&&o<=r},corner:function(){return new M(this.x+this.width,this.y+this.height)},equals:function(t){var e=new Z(this).normalize(),n=new Z(t).normalize();return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height},inflate:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},intersect:function(t){var e=this.origin(),n=this.corner(),i=t.origin(),r=t.corner();if(r.x<=e.x||r.y<=e.y||i.x>=n.x||i.y>=n.y)return null;var s=zm(e.x,i.x),o=zm(e.y,i.y);return new Z(s,o,Ta(n.x,r.x)-s,Ta(n.y,r.y)-o)},intersectionWithLine:function(t){var e=this,n=[e.topLine(),e.rightLine(),e.bottomLine(),e.leftLine()],i=[],r=[],s,o,a=n.length;for(o=0;o<a;o++)s=t.intersect(n[o]),s!==null&&r.indexOf(s.toString())<0&&(i.push(s),r.push(s.toString()));return i.length>0?i:null},intersectionWithLineFromCenterToPoint:function(t,e){t=new M(t);var n=new M(this.x+this.width/2,this.y+this.height/2),i;e&&t.rotate(n,e);for(var r=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()],s=new gt(n,t),o=r.length-1;o>=0;--o){var a=r[o].intersection(s);if(a!==null){i=a;break}}return i&&e&&i.rotate(n,-e),i},leftLine:function(){return new gt(this.topLeft(),this.bottomLeft())},leftMiddle:function(){return new M(this.x,this.y+this.height/2)},maxRectScaleToFit:function(t,e){t=new Z(t),e||(e=t.center());var n,i,r,s,o,a,l,c,h=e.x,u=e.y;n=i=r=s=o=a=l=c=1/0;var d=t.topLeft();d.x<h&&(n=(this.x-h)/(d.x-h)),d.y<u&&(o=(this.y-u)/(d.y-u));var f=t.bottomRight();f.x>h&&(i=(this.x+this.width-h)/(f.x-h)),f.y>u&&(a=(this.y+this.height-u)/(f.y-u));var p=t.topRight();p.x>h&&(r=(this.x+this.width-h)/(p.x-h)),p.y<u&&(l=(this.y-u)/(p.y-u));var g=t.bottomLeft();return g.x<h&&(s=(this.x-h)/(g.x-h)),g.y>u&&(c=(this.y+this.height-u)/(g.y-u)),{sx:Ta(n,i,r,s),sy:Ta(o,a,l,c)}},maxRectUniformScaleToFit:function(t,e){var n=this.maxRectScaleToFit(t,e);return Ta(n.sx,n.sy)},moveAndExpand:function(t){return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this},normalize:function(){var t=this.x,e=this.y,n=this.width,i=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,i=-this.height),this.x=t,this.y=e,this.width=n,this.height=i,this},offset:function(t,e){return M.prototype.offset.call(this,t,e)},origin:function(){return new M(this.x,this.y)},pointNearestToPoint:function(t){if(t=new M(t),this.containsPoint(t)){var e=this.sideNearestToPoint(t);switch(e){case"right":return new M(this.x+this.width,t.y);case"left":return new M(this.x,t.y);case"bottom":return new M(t.x,this.y+this.height);case"top":return new M(t.x,this.y)}}return t.adhereToRect(this)},rightLine:function(){return new gt(this.topRight(),this.bottomRight())},rightMiddle:function(){return new M(this.x+this.width,this.y+this.height/2)},round:function(t){let e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=qR(10,t);break}return this.x=ac(this.x*e)/e,this.y=ac(this.y*e)/e,this.width=ac(this.width*e)/e,this.height=ac(this.height*e)/e,this},scale:function(t,e,n){return n=this.origin().scale(t,e,n),this.x=n.x,this.y=n.y,this.width*=t,this.height*=e,this},sideNearestToPoint:function(t){t=new M(t);var e=t.x-this.x,n=this.x+this.width-t.x,i=t.y-this.y,r=this.y+this.height-t.y,s=e,o="left";return n<s&&(s=n,o="right"),i<s&&(s=i,o="top"),r<s&&(o="bottom"),o},snapToGrid:function(t,e){var n=this.origin().snapToGrid(t,e),i=this.corner().snapToGrid(t,e);return this.x=n.x,this.y=n.y,this.width=i.x-n.x,this.height=i.y-n.y,this},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},topLine:function(){return new gt(this.topLeft(),this.topRight())},topMiddle:function(){return new M(this.x+this.width/2,this.y)},topRight:function(){return new M(this.x+this.width,this.y)},toString:function(){return this.origin().toString()+" "+this.corner().toString()},union:function(t){return Z.fromRectUnion(this,t)},update:function(t,e,n,i){return Object(t)===t&&(e=t.y,n=t.width,i=t.height,t=t.x),this.x=t||0,this.y=e||0,this.width=n||0,this.height=i||0,this}};Z.prototype.bottomRight=Z.prototype.corner;Z.prototype.topLeft=Z.prototype.origin;Z.prototype.translate=Z.prototype.offset;const xr=Z;function px(t){const e=t.trim();if(e==="")return[];const n=[],i=e.split(/\b\s*,\s*|,\s*|\s+/),r=i.length;for(let s=0;s<r;s+=2)n.push({x:+i[s],y:+i[s+1]});return n}function gx(t){const e=t.length;if(e===0)return[];const n=[];for(let i=0;i<e;i++){const r=t[i].clone();n.push(r)}return n}function mx(t){const{abs:e}=Math;var n,i,r=t.length;if(r===0)return[];var s;for(n=0;n<r;n++)(s===void 0||t[n].y<s.y||t[n].y===s.y&&t[n].x>s.x)&&(s=t[n]);var o=[];for(n=0;n<r;n++){var a=s.theta(t[n]);a===0&&(a=360);var l=[t[n],n,a];o.push(l)}if(o.sort(function($,z){var j=$[2]-z[2];return j===0&&(j=z[1]-$[1]),j}),o.length>2){var c=o[o.length-1];o.unshift(c)}for(var h={},u=[],d,f,p,g,v,x;o.length!==0;)if(d=o.pop(),f=d[0],!h.hasOwnProperty(d[0]+"@@"+d[1]))for(var S=!1;!S;)if(u.length<2)u.push(d),S=!0;else{p=u.pop(),g=p[0],v=u.pop(),x=v[0];var C=x.cross(g,f);if(C<0)u.push(v),u.push(p),u.push(d),S=!0;else if(C===0){var P=1e-10,k=g.angleBetween(x,f);e(k-180)<P||g.equals(f)||x.equals(g)?(h[p[0]+"@@"+p[1]]=g,u.push(v)):e((k+1)%360-1)<P&&(u.push(v),o.push(p))}else h[p[0]+"@@"+p[1]]=g,u.push(v)}u.length>2&&u.pop();var N,m=-1;for(i=u.length,n=0;n<i;n++){var b=u[n][1];(N===void 0||b<N)&&(N=b,m=n)}var w=[];if(m>0){var T=u.slice(m),E=u.slice(0,m);w=T.concat(E)}else w=u;var D=[];for(i=w.length,n=0;n<i;n++)D.push(w[n][0]);return D}const _e=function(t){if(!(this instanceof _e))return new _e(t);if(typeof t=="string")return new _e.parse(t);this.points=Array.isArray(t)?t.map(M):[]};_e.parse=function(t){return new _e(px(t))};_e.fromRect=function(t){return new _e([t.topLeft(),t.topRight(),t.bottomRight(),t.bottomLeft(),t.topLeft()])};_e.prototype={type:Ut.Polyline,bbox:function(){var t=1/0,e=-1/0,n=1/0,i=-1/0,r=this.points,s=r.length;if(s===0)return null;for(var o=0;o<s;o++){var a=r[o],l=a.x,c=a.y;l<t&&(t=l),l>e&&(e=l),c<n&&(n=c),c>i&&(i=c)}return new Z(t,n,e-t,i-n)},clone:function(){return new _e(gx(this.points))},closestPoint:function(t){var e=this.closestPointLength(t);return this.pointAtLength(e)},closestPointLength:function(t){var e=this.lengthPoints(),n=e.length;if(n===0||n===1)return 0;for(var i,r=1/0,s=0,o=n-1,a=0;a<o;a++){var l=new gt(e[a],e[a+1]),c=l.length(),h=l.closestPointNormalizedLength(t),u=l.pointAt(h),d=u.squaredDistance(t);d<r&&(r=d,i=s+h*c),s+=c}return i},closestPointNormalizedLength:function(t){var e=this.closestPointLength(t);if(e===0)return 0;var n=this.length();return n===0?0:e/n},closestPointTangent:function(t){var e=this.closestPointLength(t);return this.tangentAtLength(e)},containsPoint:function(t){var e=this.points,n=e.length;if(n===0)return!1;for(var i=t.x,r=t.y,s=n-1,o=0,a=0,l=new gt,c=new gt,h=new M;o<n;o++){var u=e[s],d=e[o];if(t.equals(u)||(l.start=u,l.end=d,l.containsPoint(t)))return!0;if(r<=u.y&&r>d.y||r>u.y&&r<=d.y){var f=u.x-i>d.x-i?u.x-i:d.x-i;f>=0&&(h.x=i+f,h.y=r,c.start=t,c.end=h,l.intersect(c)&&a++)}s=o}return a%2===1},close:function(){const{start:t,end:e,points:n}=this;return t&&e&&!t.equals(e)&&n.push(t.clone()),this},lengthPoints:function(){return this.points},convexHull:function(){return new _e(mx(this.points))},equals:function(t){if(!t)return!1;var e=this.points,n=t.points,i=e.length;if(n.length!==i)return!1;for(var r=0;r<i;r++){var s=e[r],o=t.points[r];if(!s.equals(o))return!1}return!0},intersectionWithLine:function(t){for(var e=new gt(t),n=[],i=this.lengthPoints(),r=new gt,s=0,o=i.length-1;s<o;s++){r.start=i[s],r.end=i[s+1];var a=e.intersectionWithLine(r);a&&n.push(a[0])}return n.length>0?n:null},isDifferentiable:function(){var t=this.points,e=t.length;if(e===0)return!1;for(var n=new gt,i=e-1,r=0;r<i;r++)if(n.start=t[r],n.end=t[r+1],n.isDifferentiable())return!0;return!1},length:function(){var t=this.lengthPoints(),e=t.length;if(e===0)return 0;for(var n=0,i=e-1,r=0;r<i;r++)n+=t[r].distance(t[r+1]);return n},pointAt:function(t){var e=this.lengthPoints(),n=e.length;if(n===0)return null;if(n===1||t<=0)return e[0].clone();if(t>=1)return e[n-1].clone();var i=this.length(),r=i*t;return this.pointAtLength(r)},pointAtLength:function(t){var e=this.lengthPoints(),n=e.length;if(n===0)return null;if(n===1)return e[0].clone();var i=!0;t<0&&(i=!1,t=-t);for(var r=0,s=n-1,o=0;o<s;o++){var a=i?o:s-1-o,l=e[a],c=e[a+1],h=new gt(l,c),u=l.distance(c);if(t<=r+u)return h.pointAtLength((i?1:-1)*(t-r));r+=u}var d=i?e[n-1]:e[0];return d.clone()},round:function(t){for(var e=this.points,n=e.length,i=0;i<n;i++)e[i].round(t);return this},scale:function(t,e,n){for(var i=this.points,r=i.length,s=0;s<r;s++)i[s].scale(t,e,n);return this},simplify:function(t={}){const e=this.points;if(e.length<3)return this;const n=t.threshold||1e-10;let i=0;for(;e[i+2];){const r=i,s=i+1,o=i+2,a=e[r],l=e[s],c=e[o];new gt(a,c).closestPoint(l).distance(l)<=n?e.splice(s,1):i+=1}return this},tangentAt:function(t){var e=this.lengthPoints(),n=e.length;if(n===0||n===1)return null;t<0&&(t=0),t>1&&(t=1);var i=this.length(),r=i*t;return this.tangentAtLength(r)},tangentAtLength:function(t){var e=this.lengthPoints(),n=e.length;if(n===0||n===1)return null;var i=!0;t<0&&(i=!1,t=-t);for(var r,s=0,o=n-1,a=0;a<o;a++){var l=i?a:o-1-a,c=e[l],h=e[l+1],u=new gt(c,h),d=c.distance(h);if(u.isDifferentiable()){if(t<=s+d)return u.tangentAtLength((i?1:-1)*(t-s));r=u}s+=d}if(r){var f=i?1:0;return r.tangentAt(f)}return null},toString:function(){return this.points+""},translate:function(t,e){for(var n=this.points,i=n.length,r=0;r<i;r++)n[r].translate(t,e);return this},serialize:function(){var t=this.points,e=t.length;if(e===0)return"";for(var n="",i=0;i<e;i++){var r=t[i];n+=r.x+","+r.y+" "}return n.trim()}};Object.defineProperty(_e.prototype,"start",{configurable:!0,enumerable:!0,get:function(){var t=this.points,e=t.length;return e===0?null:this.points[0]}});Object.defineProperty(_e.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.points,e=t.length;return e===0?null:this.points[e-1]}});const{abs:lc,sqrt:KR,min:Gm,max:Hm,pow:Uh}=Math,le=function(t,e,n,i){if(!(this instanceof le))return new le(t,e,n,i);if(t instanceof le)return new le(t.start,t.controlPoint1,t.controlPoint2,t.end);this.start=new M(t),this.controlPoint1=new M(e),this.controlPoint2=new M(n),this.end=new M(i)};le.throughPoints=function(){function t(n){var i=[],r=[],s=n.length-1,o;if(s==1)return i[0]=new M((2*n[0].x+n[1].x)/3,(2*n[0].y+n[1].y)/3),r[0]=new M(2*i[0].x-n[0].x,2*i[0].y-n[0].y),[i,r];var a=[];for(o=1;o<s-1;o++)a[o]=4*n[o].x+2*n[o+1].x;a[0]=n[0].x+2*n[1].x,a[s-1]=(8*n[s-1].x+n[s].x)/2;var l=e(a);for(o=1;o<s-1;++o)a[o]=4*n[o].y+2*n[o+1].y;a[0]=n[0].y+2*n[1].y,a[s-1]=(8*n[s-1].y+n[s].y)/2;var c=e(a);for(o=0;o<s;o++)i.push(new M(l[o],c[o])),o<s-1?r.push(new M(2*n[o+1].x-l[o+1],2*n[o+1].y-c[o+1])):r.push(new M((n[s].x+l[s-1])/2,(n[s].y+c[s-1])/2));return[i,r]}function e(n){var i=n.length,r=[],s=[],o=2;r[0]=n[0]/o;for(var a=1;a<i;a++)s[a]=1/o,o=(a<i-1?4:3.5)-s[a],r[a]=(n[a]-r[a-1])/o;for(a=1;a<i;a++)r[i-a-1]-=s[i-a]*r[i-a];return r}return function(n){if(!n||Array.isArray(n)&&n.length<2)throw new Error("At least 2 points are required");for(var i=t(n),r=[],s=i[0].length,o=0;o<s;o++){var a=new M(i[0][o].x,i[0][o].y),l=new M(i[1][o].x,i[1][o].y);r.push(new le(n[o],a,l,n[o+1]))}return r}}();le.prototype={type:Ut.Curve,bbox:function(){for(var t=this.start,e=this.controlPoint1,n=this.controlPoint2,i=this.end,r=t.x,s=t.y,o=e.x,a=e.y,l=n.x,c=n.y,h=i.x,u=i.y,d=new Array,f=new Array,p=[new Array,new Array],g,v,x,S,C,P,k,N,m=0;m<2;++m){if(m===0?(v=6*r-12*o+6*l,g=-3*r+9*o-9*l+3*h,x=3*o-3*r):(v=6*s-12*a+6*c,g=-3*s+9*a-9*c+3*u,x=3*a-3*s),lc(g)<1e-12){if(lc(v)<1e-12)continue;S=-x/v,0<S&&S<1&&f.push(S);continue}k=v*v-4*x*g,N=KR(k),!(k<0)&&(C=(-v+N)/(2*g),0<C&&C<1&&f.push(C),P=(-v-N)/(2*g),0<P&&P<1&&f.push(P))}for(var b=f.length,w=b,T,E,D;b--;)S=f[b],T=1-S,E=T*T*T*r+3*T*T*S*o+3*T*S*S*l+S*S*S*h,p[0][b]=E,D=T*T*T*s+3*T*T*S*a+3*T*S*S*c+S*S*S*u,p[1][b]=D,d[b]={X:E,Y:D};f[w]=0,f[w+1]=1,d[w]={X:r,Y:s},d[w+1]={X:h,Y:u},p[0][w]=r,p[1][w]=s,p[0][w+1]=h,p[1][w+1]=u,f.length=w+2,p[0].length=w+2,p[1].length=w+2,d.length=w+2;var $=Gm.apply(null,p[0]),z=Gm.apply(null,p[1]),j=Hm.apply(null,p[0]),O=Hm.apply(null,p[1]);return new Z($,z,j-$,O-z)},clone:function(){return new le(this.start,this.controlPoint1,this.controlPoint2,this.end)},closestPoint:function(t,e){return this.pointAtT(this.closestPointT(t,e))},closestPointLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,r={precision:n,subdivisions:i};return this.lengthAtT(this.closestPointT(t,r),r)},closestPointNormalizedLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,r={precision:n,subdivisions:i},s=this.closestPointLength(t,r);if(!s)return 0;var o=this.length(r);return o===0?0:s/o},closestPointT:function(t,e){e=e||{};for(var n=e.precision===void 0?this.PRECISION:e.precision,i=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,r,s,o,a,l,c,h,u=i.length,d=u?1/u:0,f=0;f<u;f++){var p=i[f],g=p.start.distance(t),v=p.end.distance(t),x=g+v;(!h||x<h)&&(r=p,s=f*d,o=(f+1)*d,a=g,l=v,c=p.start.distance(p.end),h=x)}for(var S=Uh(10,-n);;){var C=a?lc(a-l)/a:0,P=l?lc(a-l)/l:0,k=C<S||P<S,N=a?a<c*S:!0,m=l?l<c*S:!0,b=N||m;if(k||b)return a<=l?s:o;var w=r.divide(.5);d/=2;var T=w[0].start.distance(t),E=w[0].end.distance(t),D=T+E,$=w[1].start.distance(t),z=w[1].end.distance(t),j=$+z;D<=j?(r=w[0],o-=d,a=T,l=E):(r=w[1],s+=d,a=$,l=z)}},closestPointTangent:function(t,e){return this.tangentAtT(this.closestPointT(t,e))},containsPoint:function(t,e){var n=this.toPolyline(e);return n.containsPoint(t)},divideAt:function(t,e){if(t<=0)return this.divideAtT(0);if(t>=1)return this.divideAtT(1);var n=this.tAt(t,e);return this.divideAtT(n)},divideAtLength:function(t,e){var n=this.tAtLength(t,e);return this.divideAtT(n)},divideAtT:function(t){var e=this.start,n=this.controlPoint1,i=this.controlPoint2,r=this.end;if(t<=0)return[new le(e,e,e,e),new le(e,n,i,r)];if(t>=1)return[new le(e,n,i,r),new le(r,r,r,r)];var s=this.getSkeletonPoints(t),o=s.startControlPoint1,a=s.startControlPoint2,l=s.divider,c=s.dividerControlPoint1,h=s.dividerControlPoint2;return[new le(e,o,a,l),new le(l,c,h,r)]},endpointDistance:function(){return this.start.distance(this.end)},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.controlPoint1.x===t.controlPoint1.x&&this.controlPoint1.y===t.controlPoint1.y&&this.controlPoint2.x===t.controlPoint2.x&&this.controlPoint2.y===t.controlPoint2.y&&this.end.x===t.end.x&&this.end.y===t.end.y},getSkeletonPoints:function(t){var e=this.start,n=this.controlPoint1,i=this.controlPoint2,r=this.end;if(t<=0)return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:i.clone()};if(t>=1)return{startControlPoint1:n.clone(),startControlPoint2:i.clone(),divider:r.clone(),dividerControlPoint1:r.clone(),dividerControlPoint2:r.clone()};var s=new gt(e,n).pointAt(t),o=new gt(n,i).pointAt(t),a=new gt(i,r).pointAt(t),l=new gt(s,o).pointAt(t),c=new gt(o,a).pointAt(t),h=new gt(l,c).pointAt(t),u={startControlPoint1:s,startControlPoint2:l,divider:h,dividerControlPoint1:c,dividerControlPoint2:a};return u},getSubdivisions:function(t){t=t||{};var e=t.precision===void 0?this.PRECISION:t.precision,n=this.start,i=this.controlPoint1,r=this.controlPoint2,s=this.end,o=[new le(n,i,r,s)];if(e===0)return o;var a=!this.isDifferentiable();if(a)return o;var l=this.endpointDistance(),c=Uh(10,-e),h=2,u=i.cross(n,s)===0&&r.cross(n,s)===0;u&&(h=2*e);for(var d=0;;){d+=1;for(var f=[],p=o.length,g=0;g<p;g++){var v=o[g],x=v.divide(.5);f.push(x[0],x[1])}for(var S=0,C=f.length,P=0;P<C;P++){var k=f[P];S+=k.endpointDistance()}if(d>=h){var N=S!==0?(S-l)/S:0;if(N<c)return f}o=f,l=S}},isDifferentiable:function(){var t=this.start,e=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(i))},length:function(t){t=t||{};for(var e=t.precision===void 0?this.PRECISION:t.precision,n=t.subdivisions===void 0?this.getSubdivisions({precision:e}):t.subdivisions,i=0,r=n.length,s=0;s<r;s++){var o=n[s];i+=o.endpointDistance()}return i},lengthAtT:function(t,e){if(t<=0)return 0;e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=this.divide(t)[0],r=i.length({precision:n});return r},pointAt:function(t,e){if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();var n=this.tAt(t,e);return this.pointAtT(n)},pointAtLength:function(t,e){var n=this.tAtLength(t,e);return this.pointAtT(n)},pointAtT:function(t){return t<=0?this.start.clone():t>=1?this.end.clone():this.getSkeletonPoints(t).divider},PRECISION:3,round:function(t){return this.start.round(t),this.controlPoint1.round(t),this.controlPoint2.round(t),this.end.round(t),this},scale:function(t,e,n){return this.start.scale(t,e,n),this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},tangentAt:function(t,e){if(!this.isDifferentiable())return null;t<0?t=0:t>1&&(t=1);var n=this.tAt(t,e);return this.tangentAtT(n)},tangentAtLength:function(t,e){if(!this.isDifferentiable())return null;var n=this.tAtLength(t,e);return this.tangentAtT(n)},tangentAtT:function(t){if(!this.isDifferentiable())return null;t<0?t=0:t>1&&(t=1);var e=this.getSkeletonPoints(t),n=e.startControlPoint2,i=e.dividerControlPoint1,r=e.divider,s=new gt(n,i);return s.translate(r.x-n.x,r.y-n.y),s},tAt:function(t,e){if(t<=0)return 0;if(t>=1)return 1;e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,r={precision:n,subdivisions:i},s=this.length(r),o=s*t;return this.tAtLength(o,r)},tAtLength:function(t,e){var n=!0;t<0&&(n=!1,t=-t),e=e||{};for(var i=e.precision===void 0?this.PRECISION:e.precision,r=e.subdivisions===void 0?this.getSubdivisions({precision:i}):e.subdivisions,s={precision:i,subdivisions:r},o,a,l,c,h,u=0,d=r.length,f=1/d,p=0;p<d;p++){var g=n?p:d-1-p,v=r[p],x=v.endpointDistance();if(t<=u+x){o=v,a=g*f,l=(g+1)*f,c=n?t-u:x+u-t,h=n?x+u-t:t-u;break}u+=x}if(!o)return n?1:0;for(var S=this.length(s),C=Uh(10,-i);;){var P;if(P=S!==0?c/S:0,P<C)return a;if(P=S!==0?h/S:0,P<C)return l;var k,N,m=o.divide(.5);f/=2;var b=m[0].endpointDistance(),w=m[1].endpointDistance();c<=b?(o=m[0],l-=f,k=c,N=b-k):(o=m[1],a+=f,k=c-b,N=w-k),c=k,h=N}},toPoints:function(t){t=t||{};for(var e=t.precision===void 0?this.PRECISION:t.precision,n=t.subdivisions===void 0?this.getSubdivisions({precision:e}):t.subdivisions,i=[n[0].start.clone()],r=n.length,s=0;s<r;s++){var o=n[s];i.push(o.end.clone())}return i},toPolyline:function(t){return new _e(this.toPoints(t))},toString:function(){return this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}};le.prototype.divide=le.prototype.divideAtT;function Pl(t){var e,n,i=[];for(n=arguments.length,e=1;e<n;e++)i.push(arguments[e]);if(!t)throw new Error("Missing a parent object.");var r=Object.create(t);for(n=i.length,e=0;e<n;e++){var s=i[e],o,a;for(a in s)s.hasOwnProperty(a)&&(delete r[a],o=Object.getOwnPropertyDescriptor(s,a),Object.defineProperty(r,a,o))}return r}const K=function(t){if(!(this instanceof K))return new K(t);if(typeof t=="string")return new K.parse(t);this.segments=[];var e,n;if(t)if(Array.isArray(t)&&t.length!==0)if(t=t.reduce(function(a,l){return a.concat(l)},[]),n=t.length,t[0].isSegment)for(e=0;e<n;e++){var i=t[e];this.appendSegment(i)}else{var r=null;for(e=0;e<n;e++){var s=t[e];if(!(s instanceof gt||s instanceof le))throw new Error("Cannot construct a path segment from the provided object.");e===0&&this.appendSegment(K.createSegment("M",s.start)),r&&!r.end.equals(s.start)&&this.appendSegment(K.createSegment("M",s.start)),s instanceof gt?this.appendSegment(K.createSegment("L",s.end)):s instanceof le&&this.appendSegment(K.createSegment("C",s.controlPoint1,s.controlPoint2,s.end)),r=s}}else if(t.isSegment)this.appendSegment(t);else if(t instanceof gt)this.appendSegment(K.createSegment("M",t.start)),this.appendSegment(K.createSegment("L",t.end));else if(t instanceof le)this.appendSegment(K.createSegment("M",t.start)),this.appendSegment(K.createSegment("C",t.controlPoint1,t.controlPoint2,t.end));else if(t instanceof _e){if(!(t.points&&t.points.length!==0))return;for(n=t.points.length,e=0;e<n;e++){var o=t.points[e];e===0?this.appendSegment(K.createSegment("M",o)):this.appendSegment(K.createSegment("L",o))}}else throw new Error("Cannot construct a path from the provided object.")};K.parse=function(t){if(!t)return new K;for(var e=new K,n=/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g,i=t.match(n),r=i.length,s=0;s<r;s++){var o=i[s],a=/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g,l=o.match(a),c=K.createSegment.apply(this,l);e.appendSegment(c)}return e};K.createSegment=function(t){if(!t)throw new Error("Type must be provided.");var e=K.segmentTypes[t];if(!e)throw new Error(t+" is not a recognized path segment type.");for(var n=[],i=arguments.length,r=1;r<i;r++)n.push(arguments[r]);return Wi(e,n)};K.prototype={type:Ut.Path,appendSegment:function(t){var e=this.segments,n=e.length,i,r=n!==0?e[n-1]:null,s=null;if(Array.isArray(t)){if(t=t.reduce(function(c,h){return c.concat(h)},[]),!t[0].isSegment)throw new Error("Segments required.");for(var o=t.length,a=0;a<o;a++){var l=t[a];i=this.prepareSegment(l,r,s),e.push(i),r=i}}else{if(!t||!t.isSegment)throw new Error("Segment required.");i=this.prepareSegment(t,r,s),e.push(i)}},bbox:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var n,i=0;i<e;i++){var r=t[i];if(r.isVisible){var s=r.bbox();n=n?n.union(s):s}}if(n)return n;var o=t[e-1];return new Z(o.end.x,o.end.y,0,0)},clone:function(){for(var t=this.segments,e=t.length,n=new K,i=0;i<e;i++){var r=t[i].clone();n.appendSegment(r)}return n},closestPoint:function(t,e){var n=this.closestPointT(t,e);return n?this.pointAtT(n):null},closestPointLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions,r={precision:n,segmentSubdivisions:i},s=this.closestPointT(t,r);return s?this.lengthAtT(s,r):0},closestPointNormalizedLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions,r={precision:n,segmentSubdivisions:i},s=this.closestPointLength(t,r);if(s===0)return 0;var o=this.length(r);return o===0?0:s/o},closestPointT:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;e=e||{};for(var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o,a=1/0,l=0;l<i;l++){var c=n[l],h=s[l];if(c.isVisible){var u=c.closestPointT(t,{precision:r,subdivisions:h}),d=c.pointAtT(u),f=new gt(d,t).squaredLength();f<a&&(o={segmentIndex:l,value:u},a=f)}}return o||{segmentIndex:i-1,value:1}},closestPointTangent:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;e=e||{};for(var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o,a=1/0,l=0;l<i;l++){var c=n[l],h=s[l];if(c.isDifferentiable()){var u=c.closestPointT(t,{precision:r,subdivisions:h}),d=c.pointAtT(u),f=new gt(d,t).squaredLength();f<a&&(o=c.tangentAtT(u),a=f)}}return o||null},containsPoint:function(t,e){var n=this.toPolylines(e);if(!n)return!1;for(var i=n.length,r=0,s=0;s<i;s++){var o=n[s];o.containsPoint(t)&&r++}return r%2===1},divideAt:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;t<0&&(t=0),t>1&&(t=1),e=e||{};var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o={precision:r,segmentSubdivisions:s},a=this.length(o),l=a*t;return this.divideAtLength(l,o)},divideAtLength:function(t,e){var n=this.segments.length;if(n===0)return null;var i=!0;t<0&&(i=!1,t=-t),e=e||{};var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o,a,l=0,c,h,u,d,f;for(o=0;o<n;o++){var p=i?o:n-1-o;a=this.getSegment(p);var g=s[p],v=a.length({precision:r,subdivisions:g});if(a.isDifferentiable()&&(u=a,d=p,t<=l+v)){h=p,c=a.divideAtLength((i?1:-1)*(t-l),{precision:r,subdivisions:g});break}l+=v}if(!u)return null;c||(h=d,f=i?1:0,c=u.divideAtT(f));var x=this.clone();x.replaceSegment(h,c);var S=h,C=h+1,P=h+2;c[0].isDifferentiable()||(x.removeSegment(S),C-=1,P-=1);var k=x.getSegment(C).start;x.insertSegment(C,K.createSegment("M",k)),P+=1,c[1].isDifferentiable()||(x.removeSegment(P-1),P-=1);var N=P-S-1;for(o=P;o<x.segments.length;o++){var m=this.getSegment(o-N);if(a=x.getSegment(o),a.type==="Z"&&!m.subpathStartSegment.end.equals(a.subpathStartSegment.end)){var b=K.createSegment("L",m.end);x.replaceSegment(o,b)}}var w=new K(x.segments.slice(0,C)),T=new K(x.segments.slice(C));return[w,T]},equals:function(t){if(!t)return!1;var e=this.segments,n=t.segments,i=e.length;if(n.length!==i)return!1;for(var r=0;r<i;r++){var s=e[r],o=n[r];if(s.type!==o.type||!s.equals(o))return!1}return!0},getSegment:function(t){var e=this.segments,n=e.length;if(n===0)throw new Error("Path has no segments.");if(t<0&&(t=n+t),t>=n||t<0)throw new Error("Index out of range.");return e[t]},getSegmentSubdivisions:function(t){var e=this.segments,n=e.length;t=t||{};for(var i=t.precision===void 0?this.PRECISION:t.precision,r=[],s=0;s<n;s++){var o=e[s],a=o.getSubdivisions({precision:i});r.push(a)}return r},getSubpaths:function(){const e=this.clone().validate().segments,n=e.length,i=[];for(let r=0;r<n;r++){const s=e[r];s.isSubpathStart?i.push(new K(s)):i[i.length-1].appendSegment(s)}return i},insertSegment:function(t,e){var n=this.segments,i=n.length;if(t<0&&(t=i+t+1),t>i||t<0)throw new Error("Index out of range.");var r,s=null,o=null;if(i!==0&&(t>=1?(s=n[t-1],o=s.nextSegment):o=n[0]),Array.isArray(e)){if(e=e.reduce(function(h,u){return h.concat(u)},[]),!e[0].isSegment)throw new Error("Segments required.");for(var a=e.length,l=0;l<a;l++){var c=e[l];r=this.prepareSegment(c,s,o),n.splice(t+l,0,r),s=r}}else{if(!e||!e.isSegment)throw new Error("Segment required.");r=this.prepareSegment(e,s,o),n.splice(t,0,r)}},intersectionWithLine:function(t,e){var n=null,i=this.toPolylines(e);if(!i)return null;for(var r=0,s=i.length;r<s;r++){var o=i[r],a=t.intersect(o);a&&(n||(n=[]),Array.isArray(a)?Array.prototype.push.apply(n,a):n.push(a))}return n},isDifferentiable:function(){for(var t=this.segments,e=t.length,n=0;n<e;n++){var i=t[n];if(i.isDifferentiable())return!0}return!1},isValid:function(){var t=this.segments,e=t.length===0||t[0].type==="M";return e},length:function(t){var e=this.segments,n=e.length;if(n===0)return 0;t=t||{};for(var i=t.precision===void 0?this.PRECISION:t.precision,r=t.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:i}):t.segmentSubdivisions,s=0,o=0;o<n;o++){var a=e[o],l=r[o];s+=a.length({subdivisions:l})}return s},lengthAtT:function(t,e){var n=this.segments,i=n.length;if(i===0)return 0;var r=t.segmentIndex;if(r<0)return 0;var s=t.value;r>=i?(r=i-1,s=1):s<0?s=0:s>1&&(s=1),e=e||{};for(var o=e.precision===void 0?this.PRECISION:e.precision,a=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,l,c=0,h=0;h<r;h++){var u=n[h];l=a[h],c+=u.length({precisison:o,subdivisions:l})}return u=n[r],l=a[r],c+=u.lengthAtT(s,{precisison:o,subdivisions:l}),c},pointAt:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();e=e||{};var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o={precision:r,segmentSubdivisions:s},a=this.length(o),l=a*t;return this.pointAtLength(l,o)},pointAtLength:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;if(t===0)return this.start.clone();var r=!0;t<0&&(r=!1,t=-t),e=e||{};for(var s=e.precision===void 0?this.PRECISION:e.precision,o=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,a,l=0,c=0;c<i;c++){var h=r?c:i-1-c,u=n[h],d=o[h],f=u.length({precision:s,subdivisions:d});if(u.isVisible){if(t<=l+f)return u.pointAtLength((r?1:-1)*(t-l),{precision:s,subdivisions:d});a=u}l+=f}if(a)return r?a.end:a.start;var p=n[i-1];return p.end.clone()},pointAtT:function(t){var e=this.segments,n=e.length;if(n===0)return null;var i=t.segmentIndex;if(i<0)return e[0].pointAtT(0);if(i>=n)return e[n-1].pointAtT(1);var r=t.value;return r<0?r=0:r>1&&(r=1),e[i].pointAtT(r)},PRECISION:3,prepareSegment:function(t,e,n){t.previousSegment=e,t.nextSegment=n,e&&(e.nextSegment=t),n&&(n.previousSegment=t);var i=t;return t.isSubpathStart&&(t.subpathStartSegment=t,i=n),i&&this.updateSubpathStartSegment(i),t},removeSegment:function(t){var e=this.segments,n=e.length;if(n===0)throw new Error("Path has no segments.");if(t<0&&(t=n+t),t>=n||t<0)throw new Error("Index out of range.");var i=e.splice(t,1)[0],r=i.previousSegment,s=i.nextSegment;r&&(r.nextSegment=s),s&&(s.previousSegment=r),i.isSubpathStart&&s&&this.updateSubpathStartSegment(s)},replaceSegment:function(t,e){var n=this.segments,i=n.length;if(i===0)throw new Error("Path has no segments.");if(t<0&&(t=i+t),t>=i||t<0)throw new Error("Index out of range.");var r,s=n[t],o=s.previousSegment,a=s.nextSegment,l=s.isSubpathStart;if(Array.isArray(e)){if(e=e.reduce(function(d,f){return d.concat(f)},[]),!e[0].isSegment)throw new Error("Segments required.");n.splice(t,1);for(var c=e.length,h=0;h<c;h++){var u=e[h];r=this.prepareSegment(u,o,a),n.splice(t+h,0,r),o=r,l&&r.isSubpathStart&&(l=!1)}}else{if(!e||!e.isSegment)throw new Error("Segment required.");r=this.prepareSegment(e,o,a),n.splice(t,1,r),l&&r.isSubpathStart&&(l=!1)}l&&a&&this.updateSubpathStartSegment(a)},round:function(t){for(var e=this.segments,n=e.length,i=0;i<n;i++){var r=e[i];r.round(t)}return this},scale:function(t,e,n){for(var i=this.segments,r=i.length,s=0;s<r;s++){var o=i[s];o.scale(t,e,n)}return this},segmentAt:function(t,e){var n=this.segmentIndexAt(t,e);return n?this.getSegment(n):null},segmentAtLength:function(t,e){var n=this.segmentIndexAtLength(t,e);return n?this.getSegment(n):null},segmentIndexAt:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;t<0&&(t=0),t>1&&(t=1),e=e||{};var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o={precision:r,segmentSubdivisions:s},a=this.length(o),l=a*t;return this.segmentIndexAtLength(l,o)},segmentIndexAtLength:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;var r=!0;t<0&&(r=!1,t=-t),e=e||{};for(var s=e.precision===void 0?this.PRECISION:e.precision,o=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,a=null,l=0,c=0;c<i;c++){var h=r?c:i-1-c,u=n[h],d=o[h],f=u.length({precision:s,subdivisions:d});if(u.isVisible){if(t<=l+f)return h;a=h}l+=f}return a},serialize:function(){if(!this.isValid())throw new Error("Invalid path segments.");return this.toString()},tangentAt:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;t<0&&(t=0),t>1&&(t=1),e=e||{};var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o={precision:r,segmentSubdivisions:s},a=this.length(o),l=a*t;return this.tangentAtLength(l,o)},tangentAtLength:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;var r=!0;t<0&&(r=!1,t=-t),e=e||{};for(var s=e.precision===void 0?this.PRECISION:e.precision,o=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,a,l=0,c=0;c<i;c++){var h=r?c:i-1-c,u=n[h],d=o[h],f=u.length({precision:s,subdivisions:d});if(u.isDifferentiable()){if(t<=l+f)return u.tangentAtLength((r?1:-1)*(t-l),{precision:s,subdivisions:d});a=u}l+=f}if(a){var p=r?1:0;return a.tangentAtT(p)}return null},tangentAtT:function(t){var e=this.segments,n=e.length;if(n===0)return null;var i=t.segmentIndex;if(i<0)return e[0].tangentAtT(0);if(i>=n)return e[n-1].tangentAtT(1);var r=t.value;return r<0?r=0:r>1&&(r=1),e[i].tangentAtT(r)},toPoints:function(t){var e=this.segments,n=e.length;if(n===0)return null;t=t||{};for(var i=t.precision===void 0?this.PRECISION:t.precision,r=t.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:i}):t.segmentSubdivisions,s=[],o=[],a=0;a<n;a++){var l=e[a];if(l.isVisible){var c=r[a];if(c.length>0){var h=c.map(function(u){return u.start});Array.prototype.push.apply(o,h)}else o.push(l.start)}else o.length>0&&(o.push(e[a-1].end),s.push(o),o=[])}return o.length>0&&(o.push(this.end),s.push(o)),s},toPolylines:function(t){var e=[],n=this.toPoints(t);if(!n)return null;for(var i=0,r=n.length;i<r;i++)e.push(new _e(n[i]));return e},toString:function(){for(var t=this.segments,e=t.length,n="",i=0;i<e;i++){var r=t[i];n+=r.serialize()+" "}return n.trim()},translate:function(t,e){for(var n=this.segments,i=n.length,r=0;r<i;r++){var s=n[r];s.translate(t,e)}return this},updateSubpathStartSegment:function(t){for(var e=t.previousSegment;t&&!t.isSubpathStart;)e?t.subpathStartSegment=e.subpathStartSegment:t.subpathStartSegment=null,e=t,t=t.nextSegment},validate:function(){return this.isValid()||this.insertSegment(0,K.createSegment("M",0,0)),this}};Object.defineProperty(K.prototype,"start",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var n=0;n<e;n++){var i=t[n];if(i.isVisible)return i.start}return t[e-1].end}});Object.defineProperty(K.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var n=e-1;n>=0;n--){var i=t[n];if(i.isVisible)return i.end}return t[e-1].end}});function Wi(t,e){return e.unshift(null),new(Function.prototype.bind.apply(t,e))}var Us={bbox:function(){throw new Error("Declaration missing for virtual function.")},clone:function(){throw new Error("Declaration missing for virtual function.")},closestPoint:function(){throw new Error("Declaration missing for virtual function.")},closestPointLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointNormalizedLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointT:function(t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither closestPointT() nor closestPointNormalizedLength() function is implemented.")},closestPointTangent:function(){throw new Error("Declaration missing for virtual function.")},divideAt:function(){throw new Error("Declaration missing for virtual function.")},divideAtLength:function(){throw new Error("Declaration missing for virtual function.")},divideAtT:function(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither divideAtT() nor divideAt() function is implemented.")},equals:function(){throw new Error("Declaration missing for virtual function.")},getSubdivisions:function(){throw new Error("Declaration missing for virtual function.")},isDifferentiable:function(){throw new Error("Declaration missing for virtual function.")},isSegment:!0,isSubpathStart:!1,isVisible:!0,length:function(){throw new Error("Declaration missing for virtual function.")},lengthAtT:function(t){if(t<=0)return 0;var e=this.length();return t>=1?e:e*t},nextSegment:null,pointAt:function(){throw new Error("Declaration missing for virtual function.")},pointAtLength:function(){throw new Error("Declaration missing for virtual function.")},pointAtT:function(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither pointAtT() nor pointAt() function is implemented.")},previousSegment:null,round:function(){throw new Error("Declaration missing for virtual function.")},subpathStartSegment:null,scale:function(){throw new Error("Declaration missing for virtual function.")},serialize:function(){throw new Error("Declaration missing for virtual function.")},tangentAt:function(){throw new Error("Declaration missing for virtual function.")},tangentAtLength:function(){throw new Error("Declaration missing for virtual function.")},tangentAtT:function(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither tangentAtT() nor tangentAt() function is implemented.")},toString:function(){throw new Error("Declaration missing for virtual function.")},translate:function(){throw new Error("Declaration missing for virtual function.")}};Object.defineProperty(Us,"end",{configurable:!0,enumerable:!0,writable:!0});Object.defineProperty(Us,"start",{configurable:!0,enumerable:!0,get:function(){if(!this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)");return this.previousSegment.end}});Object.defineProperty(Us,"type",{configurable:!0,enumerable:!0,get:function(){throw new Error("Bad segment declaration. No type specified.")}});var Sn=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof Sn))return Wi(Sn,t);if(e===0)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates (none provided).");var i;if(t[0]instanceof gt){if(e===1)return this.end=t[0].end.clone(),this;throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+e+" lines provided).")}else if(typeof t[0]=="string"||typeof t[0]=="number"){if(e===2)return this.end=new M(+t[0],+t[1]),this;if(e<2)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+e+" coordinates provided).");var r;for(i=[],n=0;n<e;n+=2)r=t.slice(n,n+2),i.push(Wi(Sn,r));return i}else{if(e===1)return this.end=new M(t[0]),this;var s;for(i=[],n=0;n<e;n+=1)s=t[n],i.push(new Sn(s));return i}},vx={clone:function(){return new Sn(this.end)},divideAt:function(t){var e=new gt(this.start,this.end),n=e.divideAt(t);return[new Sn(n[0]),new Sn(n[1])]},divideAtLength:function(t){var e=new gt(this.start,this.end),n=e.divideAtLength(t);return[new Sn(n[0]),new Sn(n[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return this.previousSegment?!this.start.equals(this.end):!1},round:function(t){return this.end.round(t),this},scale:function(t,e,n){return this.end.scale(t,e,n),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(vx,"type",{configurable:!0,enumerable:!0,value:"L"});Sn.prototype=Pl(Us,gt.prototype,vx);var ni=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof ni))return Wi(ni,t);if(e===0)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates (none provided).");var i;if(t[0]instanceof le){if(e===1)return this.controlPoint1=t[0].controlPoint1.clone(),this.controlPoint2=t[0].controlPoint2.clone(),this.end=t[0].end.clone(),this;throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+e+" curves provided).")}else if(typeof t[0]=="string"||typeof t[0]=="number"){if(e===6)return this.controlPoint1=new M(+t[0],+t[1]),this.controlPoint2=new M(+t[2],+t[3]),this.end=new M(+t[4],+t[5]),this;if(e<6)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+e+" coordinates provided).");var r;for(i=[],n=0;n<e;n+=6)r=t.slice(n,n+6),i.push(Wi(ni,r));return i}else{if(e===3)return this.controlPoint1=new M(t[0]),this.controlPoint2=new M(t[1]),this.end=new M(t[2]),this;if(e<3)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+e+" points provided).");var s;for(i=[],n=0;n<e;n+=3)s=t.slice(n,n+3),i.push(Wi(ni,s));return i}},yx={clone:function(){return new ni(this.controlPoint1,this.controlPoint2,this.end)},divideAt:function(t,e){var n=new le(this.start,this.controlPoint1,this.controlPoint2,this.end),i=n.divideAt(t,e);return[new ni(i[0]),new ni(i[1])]},divideAtLength:function(t,e){var n=new le(this.start,this.controlPoint1,this.controlPoint2,this.end),i=n.divideAtLength(t,e);return[new ni(i[0]),new ni(i[1])]},divideAtT:function(t){var e=new le(this.start,this.controlPoint1,this.controlPoint2,this.end),n=e.divideAtT(t);return[new ni(n[0]),new ni(n[1])]},isDifferentiable:function(){if(!this.previousSegment)return!1;var t=this.start,e=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(i))},round:function(t){return this.controlPoint1.round(t),this.controlPoint2.round(t),this.end.round(t),this},scale:function(t,e,n){return this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},serialize:function(){var t=this.controlPoint1,e=this.controlPoint2,n=this.end;return this.type+" "+t.x+" "+t.y+" "+e.x+" "+e.y+" "+n.x+" "+n.y},toString:function(){return this.type+" "+this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}};Object.defineProperty(yx,"type",{configurable:!0,enumerable:!0,value:"C"});ni.prototype=Pl(Us,le.prototype,yx);var bs=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof bs))return Wi(bs,t);if(e===0)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (none provided).");var i;if(t[0]instanceof gt){if(e===1)return this.end=t[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+e+" lines provided).")}else if(t[0]instanceof le){if(e===1)return this.end=t[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+e+" curves provided).")}else if(typeof t[0]=="string"||typeof t[0]=="number"){if(e===2)return this.end=new M(+t[0],+t[1]),this;if(e<2)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+e+" coordinates provided).");var r;for(i=[],n=0;n<e;n+=2)r=t.slice(n,n+2),n===0?i.push(Wi(bs,r)):i.push(Wi(Sn,r));return i}else{if(e===1)return this.end=new M(t[0]),this;var s;for(i=[],n=0;n<e;n+=1)s=t[n],n===0?i.push(new bs(s)):i.push(new Sn(s));return i}},wp={bbox:function(){return null},clone:function(){return new bs(this.end)},closestPoint:function(){return this.end.clone()},closestPointNormalizedLength:function(){return 0},closestPointLength:function(){return 0},closestPointT:function(){return 1},closestPointTangent:function(){return null},divideAt:function(){return[this.clone(),this.clone()]},divideAtLength:function(){return[this.clone(),this.clone()]},equals:function(t){return this.end.equals(t.end)},getSubdivisions:function(){return[]},isDifferentiable:function(){return!1},isSubpathStart:!0,isVisible:!1,length:function(){return 0},lengthAtT:function(){return 0},pointAt:function(){return this.end.clone()},pointAtLength:function(){return this.end.clone()},pointAtT:function(){return this.end.clone()},round:function(t){return this.end.round(t),this},scale:function(t,e,n){return this.end.scale(t,e,n),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},tangentAt:function(){return null},tangentAtLength:function(){return null},tangentAtT:function(){return null},toString:function(){return this.type+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(wp,"start",{configurable:!0,enumerable:!0,get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")}});Object.defineProperty(wp,"type",{configurable:!0,enumerable:!0,value:"M"});bs.prototype=Pl(Us,wp);var $o=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof $o))return Wi($o,t);if(e>0)throw new Error("Closepath constructor expects no arguments.");return this},_p={clone:function(){return new $o},divideAt:function(t){var e=new gt(this.start,this.end),n=e.divideAt(t);return[n[1].isDifferentiable()?new Sn(n[0]):this.clone(),new Sn(n[1])]},divideAtLength:function(t){var e=new gt(this.start,this.end),n=e.divideAtLength(t);return[n[1].isDifferentiable()?new Sn(n[0]):this.clone(),new Sn(n[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return!this.previousSegment||!this.subpathStartSegment?!1:!this.start.equals(this.end)},round:function(){return this},scale:function(){return this},serialize:function(){return this.type},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(){return this}};Object.defineProperty(_p,"end",{configurable:!0,enumerable:!0,get:function(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. Moveto); OR segment has not yet been added to a path.)");return this.subpathStartSegment.end}});Object.defineProperty(_p,"type",{configurable:!0,enumerable:!0,value:"Z"});$o.prototype=Pl(Us,gt.prototype,_p);var ZR=K.segmentTypes={L:Sn,C:ni,M:bs,Z:$o,z:$o};K.regexSupportedData=new RegExp("^[\\s\\d"+Object.keys(ZR).join("")+",.]*$");K.isDataSupported=function(t){return typeof t!="string"?!1:this.regexSupportedData.test(t)};const JR={curveThroughPoints:function(t){return console.warn("deprecated"),new K(le.throughPoints(t)).serialize()},getCurveControlPoints:function(t){console.warn("deprecated");var e=[],n=[],i=t.length-1,r;if(i==1)return e[0]=new M((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3),n[0]=new M(2*e[0].x-t[0].x,2*e[0].y-t[0].y),[e,n];var s=[];for(r=1;r<i-1;r++)s[r]=4*t[r].x+2*t[r+1].x;s[0]=t[0].x+2*t[1].x,s[i-1]=(8*t[i-1].x+t[i].x)/2;var o=this.getFirstControlPoints(s);for(r=1;r<i-1;++r)s[r]=4*t[r].y+2*t[r+1].y;s[0]=t[0].y+2*t[1].y,s[i-1]=(8*t[i-1].y+t[i].y)/2;var a=this.getFirstControlPoints(s);for(r=0;r<i;r++)e.push(new M(o[r],a[r])),r<i-1?n.push(new M(2*t[r+1].x-o[r+1],2*t[r+1].y-a[r+1])):n.push(new M((t[i].x+o[i-1])/2,(t[i].y+a[i-1])/2));return[e,n]},getCurveDivider:function(t,e,n,i){console.warn("deprecated");var r=new le(t,e,n,i);return function(o){var a=r.divide(o);return[{p0:a[0].start,p1:a[0].controlPoint1,p2:a[0].controlPoint2,p3:a[0].end},{p0:a[1].start,p1:a[1].controlPoint1,p2:a[1].controlPoint2,p3:a[1].end}]}},getFirstControlPoints:function(t){console.warn("deprecated");var e=t.length,n=[],i=[],r=2;n[0]=t[0]/r;for(var s=1;s<e;s++)i[s]=1/r,r=(s<e-1?4:3.5)-i[s],n[s]=(t[s]-n[s-1])/r;for(s=1;s<e;s++)n[e-s-1]-=i[e-s]*n[e-s];return n},getInversionSolver:function(t,e,n,i){console.warn("deprecated");var r=new le(t,e,n,i);return function(o){return r.closestPointT(o)}}},Kn=function(t){if(!(this instanceof Kn))return new Kn(t);if(typeof t=="string")return new Kn.parse(t);this.points=Array.isArray(t)?t.map(M):[]};Kn.parse=function(t){return new Kn(px(t))};Kn.fromRect=function(t){return new Kn([t.topLeft(),t.topRight(),t.bottomRight(),t.bottomLeft()])};Kn.prototype=Pl(_e.prototype,{type:Ut.Polygon,clone:function(){return new Kn(gx(this.points))},convexHull:function(){return new Kn(mx(this.points))},lengthPoints:function(){const{start:t,end:e,points:n}=this;return n.length<=1||t.equals(e)?n:[...n,t.clone()]}});function bx(t,e,n,i){switch(t.type){case Ut.Line:{switch(e.type){case Ut.Line:return xs(t,e)}break}case Ut.Ellipse:{switch(e.type){case Ut.Line:return Sp(t,e);case Ut.Ellipse:return xx(t,e)}break}case Ut.Rect:{switch(e.type){case Ut.Line:return wx(t,e);case Ut.Ellipse:return _x(t,e);case Ut.Rect:return Ep(t,e)}break}case Ut.Polyline:{switch(e.type){case Ut.Line:return ju(t,e);case Ut.Ellipse:return Tp(t,e);case Ut.Rect:return Sx(t,e);case Ut.Polyline:return Ex(t,e)}break}case Ut.Polygon:{switch(e.type){case Ut.Line:return Ap(t,e);case Ut.Ellipse:return Wu(t,e);case Ut.Rect:return Tx(t,e);case Ut.Polyline:return Ax(t,e);case Ut.Polygon:return Cx(t,e)}break}case Ut.Path:{switch(e.type){case Ut.Line:return Px(t,e,n);case Ut.Ellipse:return Ix(t,e,n);case Ut.Rect:return kx(t,e,n);case Ut.Polyline:return Cp(t,e,n);case Ut.Polygon:return Yu(t,e,n);case Ut.Path:return Ox(t,e,n,i)}break}}switch(e.type){case Ut.Ellipse:case Ut.Rect:case Ut.Polyline:case Ut.Polygon:case Ut.Path:return bx(e,t,i,n);default:throw Error(`The intersection for ${t} and ${e} could not be found.`)}}function xs(t,e){const n=t.start.x,i=t.start.y,r=t.end.x,s=t.end.y,o=e.start.x,a=e.start.y,l=e.end.x,c=e.end.y,h=r-n,u=s-i,d=l-o,f=c-a,p=n-o,g=i-a,v=h*f-d*u,x=(h*g-u*p)/v,S=(d*g-f*p)/v;return x>=0&&x<=1&&S>=0&&S<=1}function Sp(t,e){const n=t.a,i=t.b,r=t.x,s=t.y,o=e.start.x-r,a=e.end.x-r,l=e.start.y-s,c=e.end.y-s,h=n*n,u=i*i,d=a-o,f=c-l,p=d*d/h+f*f/u,g=2*o*d/h+2*l*f/u,v=o*o/h+l*l/u-1,x=g*g-4*p*v;if(x===0){const S=-g/2/p;return S>=0&&S<=1}else if(x>0){const S=Math.sqrt(x),C=(-g+S)/2/p,P=(-g-S)/2/p;return C>=0&&C<=1||P>=0&&P<=1}return!1}function xx(t,e){return QR(t,0,e,0)}function wx(t,e){const{start:n,end:i}=e,{x:r,y:s,width:o,height:a}=t;return n.x>r+o&&i.x>r+o||n.x<r&&i.x<r||n.y>s+a&&i.y>s+a||n.y<s&&i.y<s?!1:t.containsPoint(e.start)||t.containsPoint(e.end)?!0:xs(t.topLine(),e)||xs(t.rightLine(),e)||xs(t.bottomLine(),e)||xs(t.leftLine(),e)}function _x(t,e){return Ep(t,Z.fromEllipse(e))?Wu(Kn.fromRect(t),e):!1}function Ep(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function ju(t,e){return Lx(t,e,{interior:!1})}function Tp(t,e){return Mx(t,e,{interior:!1})}function Sx(t,e){return Dx(t,e,{interior:!1})}function Ex(t,e){return Xu(t,e,{interior:!1})}function Ap(t,e){return Lx(t,e,{interior:!0})}function Wu(t,e){return Mx(t,e,{interior:!0})}function Tx(t,e){return Dx(t,e,{interior:!0})}function Ax(t,e){return Xu(t,e,{interior:!0})}function Cx(t,e){return Pp(t,e,{interior:!0})}function Px(t,e,n){return t.getSubpaths().some(i=>{const[r]=i.toPolylines(n),{type:s}=i.getSegment(-1);return s==="Z"?Ap(r,e):ju(r,e)})}function Ix(t,e,n){return t.getSubpaths().some(i=>{const[r]=i.toPolylines(n),{type:s}=i.getSegment(-1);return s==="Z"?Wu(r,e):Tp(r,e)})}function kx(t,e,n){return Yu(t,Kn.fromRect(e),n)}function Cp(t,e,n){return Nx(t,e,n,{interior:!1})}function Yu(t,e,n){return Nx(t,e,n,{interior:!0})}function Ox(t,e,n,i){return t.getSubpaths().some(r=>{const[s]=r.toPolylines(n),{type:o}=r.getSegment(-1);return o==="Z"?Yu(e,s,i):Cp(e,s,i)})}function Lx(t,e,n={}){const{interior:i=!1}=n;let r;if(i){if(t.containsPoint(e.start))return!0;const{start:a,end:l,points:c}=t;r=l.equals(a)?c:[...c,a]}else r=t.points;const{length:s}=r,o=new gt;for(let a=0;a<s-1;a++)if(o.start=r[a],o.end=r[a+1],xs(e,o))return!0;return!1}function Mx(t,e,n={}){const{start:i,end:r,points:s}=t;if(e.containsPoint(i))return!0;let o;const{interior:a=!1}=n;if(a){if(t.containsPoint(e.center()))return!0;o=r.equals(i)?s:[...s,i]}else o=s;const{length:l}=o,c=new gt;for(let h=0;h<l-1;h++)if(c.start=o[h],c.end=o[h+1],Sp(e,c))return!0;return!1}function Dx(t,e,n){const i=Kn.fromRect(e);return Pp(t,i,n)}function Nx(t,e,n,i){return t.getSubpaths().some(r=>{const[s]=r.toPolylines(n),{type:o}=r.getSegment(-1);return o==="Z"?Pp(e,s,i):Xu(e,s,i)})}function Xu(t,e,n={}){const{interior:i=!1}=n;let r;if(i){const{start:l}=e;if(t.containsPoint(l))return!0;r=t.clone().close()}else r=t;const s=e.points,{length:o}=s,a=new gt;for(let l=0;l<o-1;l++)if(a.start=s[l],a.end=s[l+1],ju(r,a))return!0;return!1}function Pp(t,e,n){return e.containsPoint(t.start)||Xu(t,e.clone().close(),n)}function QR(t,e,n,i){const{cos:r,sin:s}=Math,o=s(e),a=r(e),l=s(i),c=r(i),h=o*o,u=a*a,d=o*a,f=l*l,p=c*c,g=l*c,v=t.a*t.a,x=t.b*t.b,S=n.a*n.a,C=n.b*n.b,P=v*h+x*u,k=S*f+C*p,N=v*u+x*h,m=S*p+C*f;let b=2*(x-v)*d,w=2*(C-S)*g,T=-2*P*t.x-b*t.y,E=-2*k*n.x-w*n.y,D=-b*t.x-2*N*t.y,$=-w*n.x-2*m*n.y;const z=P*t.x*t.x+N*t.y*t.y+b*t.x*t.y-v*x,j=k*n.x*n.x+m*n.y*n.y+w*n.x*n.y-S*C;b=b/2,w=w/2,T=T/2,E=E/2,D=D/2,$=$/2;const O=Br([[P,b,T],[b,N,D],[T,D,z]]),B=Br([[k,w,E],[w,m,$],[E,$,j]]),V=.33333333*(Br([[k,b,T],[w,N,D],[E,D,z]])+Br([[P,w,T],[b,m,D],[T,$,z]])+Br([[P,b,E],[b,N,$],[T,D,j]])),F=.33333333*(Br([[P,w,E],[b,m,$],[T,$,j]])+Br([[k,b,E],[w,N,$],[E,D,j]])+Br([[k,w,T],[w,m,D],[E,$,z]])),At=cc([[O,V],[V,F]]),vt=cc([[O,F],[V,B]]),zt=cc([[V,F],[F,B]]);return!(cc([[2*At,vt],[vt,2*zt]])>0&&(F>0||V>0))}function cc(t){return t[0][0]*t[1][1]-t[0][1]*t[1][0]}function Br(t){return t[0][0]*t[1][1]*t[2][2]-t[0][0]*t[1][2]*t[2][1]-t[0][1]*t[1][0]*t[2][2]+t[0][1]*t[1][2]*t[2][0]+t[0][2]*t[1][0]*t[2][1]-t[0][2]*t[1][1]*t[2][0]}const t$=Object.freeze(Object.defineProperty({__proto__:null,ellipseWithEllipse:xx,ellipseWithLine:Sp,exists:bx,lineWithLine:xs,pathWithEllipse:Ix,pathWithLine:Px,pathWithPath:Ox,pathWithPolygon:Yu,pathWithPolyline:Cp,pathWithRect:kx,polygonWithEllipse:Wu,polygonWithLine:Ap,polygonWithPolygon:Cx,polygonWithPolyline:Ax,polygonWithRect:Tx,polylineWithEllipse:Tp,polylineWithLine:ju,polylineWithPolyline:Ex,polylineWithRect:Sx,rectWithEllipse:_x,rectWithLine:wx,rectWithRect:Ep},Symbol.toStringTag,{value:"Module"})),gs=t$,e$=Object.freeze(Object.defineProperty({__proto__:null,Curve:le,Ellipse:Bn,Line:gt,Path:K,Point:M,Polygon:Kn,Polyline:_e,Rect:Z,bezier:JR,ellipse:WR,intersection:gs,line:Ps,normalizeAngle:nn,point:oe,random:Za,rect:xr,scale:Ze,snapToGrid:pi,toDeg:Uu,toRad:un,types:Ut},Symbol.toStringTag,{value:"Module"})),n$=function(){var t=typeof window=="object"&&!!window.SVGAngle;if(!t)return function(){throw new Error("SVG is required to use Vectorizer.")};var e={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},n="1.1",i=Math,r=i.PI,s=i.atan2,o=i.sqrt,a=i.min,l=i.max,c=i.cos,h=i.sin,u=function(m,b,w){if(!(this instanceof u))return u.apply(Object.create(u.prototype),arguments);if(m){if(u.isV(m)&&(m=m.node),b=b||{},u.isString(m)){if(m=m.trim(),m.toLowerCase()==="svg")m=u.createSvgDocument();else if(m[0]==="<"){var T=u.createSvgDocument(m);if(T.childNodes.length>1){var E=[],D,$;for(D=0,$=T.childNodes.length;D<$;D++){var z=T.childNodes[D];E.push(new u(document.importNode(z,!0)))}return E}m=document.importNode(T.firstChild,!0)}else m=document.createElementNS(e.svg,m);u.ensureId(m)}return this.node=m,this.setAttributes(b),w&&this.append(w),this}},d=u.prototype;Object.defineProperty(d,"id",{enumerable:!0,get:function(){return this.node.id},set:function(m){this.node.id=m}}),d.getTransformToElement=function(m){var b=this.node;if(u.isSVGGraphicsElement(m)&&u.isSVGGraphicsElement(b)){var w=u.toNode(m).getScreenCTM(),T=b.getScreenCTM();if(w&&T)return w.inverse().multiply(T)}return u.createSVGMatrix()},d.transform=function(m,b){var w=this.node;if(u.isUndefined(m))return u.transformStringToMatrix(this.attr("transform"));if(b&&b.absolute)return this.attr("transform",u.matrixToTransformString(m));var T=u.createSVGTransform(m);return w.transform.baseVal.appendItem(T),this},d.translate=function(m,b,w){w=w||{},b=b||0;var T=this.attr("transform")||"",E=u.parseTransformString(T);if(T=E.value,u.isUndefined(m))return E.translate;T=T.replace(/translate\([^)]*\)/g,"").trim();var D=w.absolute?m:E.translate.tx+m,$=w.absolute?b:E.translate.ty+b,z="translate("+D+","+$+")";return this.attr("transform",(z+" "+T).trim()),this},d.rotate=function(m,b,w,T){T=T||{};var E=this.attr("transform")||"",D=u.parseTransformString(E);if(E=D.value,u.isUndefined(m))return D.rotate;E=E.replace(/rotate\([^)]*\)/g,"").trim(),m%=360;var $=T.absolute?m:D.rotate.angle+m,z=b!==void 0&&w!==void 0?","+b+","+w:"",j="rotate("+$+z+")";return this.attr("transform",(E+" "+j).trim()),this},d.scale=function(m,b){b=u.isUndefined(b)?m:b;var w=this.attr("transform")||"",T=u.parseTransformString(w);if(w=T.value,u.isUndefined(m))return T.scale;w=w.replace(/scale\([^)]*\)/g,"").trim();var E="scale("+m+","+b+")";return this.attr("transform",(w+" "+E).trim()),this},d.bbox=function(m,b){var w,T=this.node,E=T.ownerSVGElement;if(!E)return new Z(0,0,0,0);try{w=T.getBBox()}catch{w={x:T.clientLeft,y:T.clientTop,width:T.clientWidth,height:T.clientHeight}}if(m)return new Z(w);var D=this.getTransformToElement(b||E);return u.transformRect(w,D)},d.getBBox=function(m){var b={},w,T=this.node,E=T.ownerSVGElement;if(!E||!u.isSVGGraphicsElement(T))return new Z(0,0,0,0);if(m&&(m.target&&(b.target=u.toNode(m.target)),m.recursive&&(b.recursive=m.recursive)),b.recursive){var $=this.children(),z=$.length;if(z===0)return this.getBBox({target:b.target,recursive:!1});b.target||(b.target=this);for(var j=0;j<z;j++){var O=$[j],B;O.children().length===0?B=O.getBBox({target:b.target,recursive:!1}):B=O.getBBox({target:b.target,recursive:!0}),w?w=w.union(B):w=B}return w}else{try{w=T.getBBox()}catch{w={x:T.clientLeft,y:T.clientTop,width:T.clientWidth,height:T.clientHeight}}if(b.target){var D=this.getTransformToElement(b.target);return u.transformRect(w,D)}else return new Z(w)}};function f(m,b){m||(m={});var w=u("textPath"),T=m.d;if(T&&m["xlink:href"]===void 0){var E=u("path").attr("d",T).appendTo(b.defs());w.attr("xlink:href","#"+E.id)}return u.isObject(m)&&w.attr(m),w.node}function p(m,b,w){w||(w={});for(var T=w.includeAnnotationIndices,E=w.eol,D=w.lineHeight,$=w.baseSize,z=0,j={},O=b.length-1,B=0;B<=O;B++){var V=b[B],F=null;if(u.isObject(V)){var At=V.attrs,vt=u("tspan",At),zt=vt.node,re=V.t;E&&B===O&&(re+=E),zt.textContent=re;var wt=At.class;wt&&vt.addClass(wt),T&&vt.attr("annotations",V.annotations),F=parseFloat(At["font-size"]),isFinite(F)||(F=$),F&&F>z&&(z=F)}else E&&B===O&&(V+=E),zt=document.createTextNode(V||" "),$&&$>z&&(z=$);m.appendChild(zt)}return z&&(j.maxFontSize=z),D?j.lineHeight=D:z&&(j.lineHeight=z*1.2),j}var g=/em$/;function v(m,b){var w=parseFloat(m);return g.test(m)?w*b:w}function x(m,b,w,T){if(!Array.isArray(b))return 0;var E=b.length;if(!E)return 0;for(var D=b[0],$=v(D.maxFontSize,w)||w,z=0,j=v(T,w),O=1;O<E;O++){D=b[O];var B=v(D.lineHeight,w)||j;z+=B}var V=v(D.maxFontSize,w)||w,F;switch(m){case"middle":F=$/2-.15*V-z/2;break;case"bottom":F=-(.25*V)-z;break;default:case"top":F=.8*$;break}return F}d.text=function(m,b){if(m&&typeof m!="string")throw new Error("Vectorizer: text() expects the first argument to be a string.");m=u.sanitizeText(m),b||(b={});var w=b.displayEmpty,T=b.eol,E=b.textPath,D=b.textVerticalAnchor,$=D==="middle"||D==="bottom"||D==="top",z=b.x;z===void 0&&(z=this.attr("x")||0);var j=b.includeAnnotationIndices,O=b.annotations;O&&!u.isArray(O)&&(O=[O]);var B=b.lineHeight,V=B==="auto",F=V?"1.5em":B||"1em";this.empty(),this.attr({"xml:space":"preserve",display:m||w?null:"none"});var At=parseFloat(this.attr("font-size"));At||(At=16,($||O)&&this.attr("font-size",At));var vt=document,zt;E?(typeof E=="string"&&(E={d:E}),zt=f(E,this)):zt=vt.createDocumentFragment();for(var re=0,wt=m.split(`
`),Tt=[],Pt,It=0,mt=wt.length-1;It<=mt;It++){var Bt=F,Ct="v-line",W=vt.createElementNS(e.svg,"tspan"),Y=wt[It],tt;if(Y)if(O){var St=u.annotateString(Y,O,{offset:-re,includeAnnotationIndices:j});tt=p(W,St,{includeAnnotationIndices:j,eol:It!==mt&&T,lineHeight:V?null:F,baseSize:At});var se=tt.lineHeight;se&&V&&It!==0&&(Bt=se),It===0&&(Pt=tt.maxFontSize*.8)}else T&&It!==mt&&(Y+=T),W.textContent=Y;else{W.textContent="-",Ct+=" v-empty-line";var Dt=W.style;if(Dt.fillOpacity=0,Dt.strokeOpacity=0,O){tt={},St=u.findAnnotationsAtIndex(O,re);let Me=At;for(let We=St.length;We>0;We--){const he=St[We-1].attrs;if(!he||!("font-size"in he))continue;const ir=parseFloat(he["font-size"]);if(isFinite(ir)){Me=ir;break}}V&&(It>0?Bt=Me*1.2:Pt=Me*.8),W.setAttribute("font-size",Me),tt.maxFontSize=Me}}tt&&Tt.push(tt),It>0&&W.setAttribute("dy",Bt),(It>0||E)&&W.setAttribute("x",z),W.className.baseVal=Ct,zt.appendChild(W),re+=Y.length+1}if($)if(O)Bt=x(D,Tt,At,F);else if(D==="top")Bt="0.8em";else{var yt;switch(mt>0?(yt=parseFloat(F)||1,yt*=mt,g.test(F)||(yt/=At)):yt=0,D){case"middle":Bt=.3-yt/2+"em";break;case"bottom":Bt=-yt-.3+"em";break}}else D===0?Bt="0em":D?Bt=D:(Bt=0,this.attr("y")===null&&this.attr("y",Pt||"0.8em"));return zt.firstChild.setAttribute("dy",Bt),this.append(zt),this},d.removeAttr=function(m){const b=k[m],{ns:w,local:T}=u.qualifyAttr(b),E=this.node;return w?E.hasAttributeNS(w,T)&&E.removeAttributeNS(w,T):E.hasAttribute(b)&&E.removeAttribute(b),this},d.attr=function(m,b){if(u.isUndefined(m)){for(var w=this.node.attributes,T={},E=0;E<w.length;E++)T[w[E].name]=w[E].value;return T}if(u.isString(m)&&u.isUndefined(b))return this.node.getAttribute(k[m]);if(typeof m=="object")for(var D in m)m.hasOwnProperty(D)&&this.setAttribute(D,m[D]);else this.setAttribute(m,b);return this},d.normalizePath=function(){var m=this.tagName();return m==="PATH"&&this.attr("d",u.normalizePathData(this.attr("d"))),this},d.remove=function(){return this.node.parentNode&&this.node.parentNode.removeChild(this.node),this},d.empty=function(){for(;this.node.firstChild;)this.node.removeChild(this.node.firstChild);return this},d.setAttributes=function(m){for(var b in m)m.hasOwnProperty(b)&&this.setAttribute(b,m[b]);return this},d.append=function(m){u.isArray(m)||(m=[m]);for(var b=0,w=m.length;b<w;b++)this.node.appendChild(u.toNode(m[b]));return this},d.prepend=function(m){var b=this.node.firstChild;return b?u(b).before(m):this.append(m)},d.before=function(m){var b=this.node,w=b.parentNode;if(w){u.isArray(m)||(m=[m]);for(var T=0,E=m.length;T<E;T++)w.insertBefore(u.toNode(m[T]),b)}return this},d.appendTo=function(m){return u.toNode(m).appendChild(this.node),this},d.svg=function(){return this.node instanceof window.SVGSVGElement?this:u(this.node.ownerSVGElement)},d.tagName=function(){return this.node.tagName.toUpperCase()},d.defs=function(){var m=this.svg()||this,b=m.node.getElementsByTagName("defs")[0];return b?u(b):u("defs").appendTo(m)},d.clone=function(){var m=u(this.node.cloneNode(!0));return m.node.id=u.uniqueId(),m},d.findOne=function(m){var b=this.node.querySelector(m);return b?u(b):void 0},d.find=function(m){var b=[],w=this.node.querySelectorAll(m);if(w)for(var T=0;T<w.length;T++)b.push(u(w[T]));return b},d.children=function(){for(var m=this.node.childNodes,b=[],w=0;w<m.length;w++){var T=m[w];T.nodeType===1&&b.push(u(m[w]))}return b},d.parent=function(){return u(this.node.parentNode)||null},d.index=function(){for(var m=0,b=this.node.previousSibling;b;)b.nodeType===1&&m++,b=b.previousSibling;return m},d.findParentByClass=function(m,b){for(var w=this.node.ownerSVGElement,T=this.node.parentNode;T&&T!==b&&T!==w;){var E=u(T);if(E.hasClass(m))return E;T=T.parentNode}return null},d.contains=function(m){var b=this.node,w=u.toNode(m),T=w&&w.parentNode;return b===T||!!(T&&T.nodeType===1&&b.compareDocumentPosition(T)&16)},d.toLocalPoint=function(m,b){var w=this.svg().node,T=w.createSVGPoint();T.x=m,T.y=b;try{var E=T.matrixTransform(w.getScreenCTM().inverse()),D=this.getTransformToElement(w).inverse()}catch{return T}return E.matrixTransform(D)},d.translateCenterToPoint=function(m){var b=this.getBBox({target:this.svg()}),w=b.center();return this.translate(m.x-w.x,m.y-w.y),this},d.translateAndAutoOrient=function(m,b,w){m=new M(m),b=new M(b),w||(w=this.svg());var T=this.scale();this.attr("transform","");var E=this.getBBox({target:w}).scale(T.sx,T.sy),D=u.createSVGTransform();D.setTranslate(-E.x-E.width/2,-E.y-E.height/2);var $=u.createSVGTransform(),z=m.angleBetween(b,m.clone().offset(1,0));z&&$.setRotate(z,0,0);var j=u.createSVGTransform(),O=m.clone().move(b,E.width/2);j.setTranslate(2*m.x-O.x,2*m.y-O.y);var B=this.getTransformToElement(w),V=u.createSVGTransform();return V.setMatrix(j.matrix.multiply($.matrix.multiply(D.matrix.multiply(B.scale(T.sx,T.sy))))),this.attr("transform",u.matrixToTransformString(V.matrix)),this},d.animateAlongPath=function(m,b){b=u.toNode(b);var w=u.ensureId(b),T=u("animateMotion",m),E=u("mpath",{"xlink:href":"#"+w});T.append(E),this.append(T);try{T.node.beginElement()}catch{if(document.documentElement.getAttribute("smiling")==="fake"){var D=T.node;D.animators=[];var $=D.getAttribute("id");$&&(id2anim[$]=D);for(var z=getTargets(D),j=0,O=z.length;j<O;j++){var B=z[j],V=new Animator(D,B,j);animators.push(V),D.animators[j]=V,V.register()}}}return this};const S=/[^\x20\t\r\n\f]+/g;function C(m){return u.isString(m)?m.trim().match(S)||[]:[]}d.hasClass=function(m){return u.isString(m)?this.node.classList.contains(m.trim()):!1},d.addClass=function(m){return this.node.classList.add(...C(m)),this},d.removeClass=function(m){return this.node.classList.remove(...C(m)),this},d.toggleClass=function(m,b){const w=C(m);for(let T=0;T<w.length;T++)this.node.classList.toggle(w[T],b);return this},d.sample=function(m){m=m||1;for(var b=this.node,w=b.getTotalLength(),T=[],E=0,D;E<w;)D=b.getPointAtLength(E),T.push({x:D.x,y:D.y,distance:E}),E+=m;return T},d.convertToPath=function(){var m=u("path");m.attr(this.attr());var b=this.convertToPathData();return b&&m.attr("d",b),m},d.convertToPathData=function(){var m=this.tagName();switch(m){case"PATH":return this.attr("d");case"LINE":return u.convertLineToPathData(this.node);case"POLYGON":return u.convertPolygonToPathData(this.node);case"POLYLINE":return u.convertPolylineToPathData(this.node);case"ELLIPSE":return u.convertEllipseToPathData(this.node);case"CIRCLE":return u.convertCircleToPathData(this.node);case"RECT":return u.convertRectToPathData(this.node)}throw new Error(m+" cannot be converted to PATH.")},u.prototype.toGeometryShape=function(){var m,b,w,T,E,D,$,z,j,O,B,V,F,At,vt;switch(this.tagName()){case"RECT":return m=parseFloat(this.attr("x"))||0,b=parseFloat(this.attr("y"))||0,w=parseFloat(this.attr("width"))||0,T=parseFloat(this.attr("height"))||0,new Z(m,b,w,T);case"CIRCLE":return E=parseFloat(this.attr("cx"))||0,D=parseFloat(this.attr("cy"))||0,$=parseFloat(this.attr("r"))||0,new Bn({x:E,y:D},$,$);case"ELLIPSE":return E=parseFloat(this.attr("cx"))||0,D=parseFloat(this.attr("cy"))||0,z=parseFloat(this.attr("rx"))||0,j=parseFloat(this.attr("ry"))||0,new Bn({x:E,y:D},z,j);case"POLYLINE":return O=u.getPointsFromSvgNode(this),new _e(O);case"POLYGON":return O=u.getPointsFromSvgNode(this),O.length>1&&O.push(O[0]),new _e(O);case"PATH":return B=this.attr("d"),K.isDataSupported(B)||(B=u.normalizePathData(B)),new K(B);case"LINE":return V=parseFloat(this.attr("x1"))||0,At=parseFloat(this.attr("y1"))||0,F=parseFloat(this.attr("x2"))||0,vt=parseFloat(this.attr("y2"))||0,new gt({x:V,y:At},{x:F,y:vt})}return this.getBBox()},d.findIntersection=function(m,b){var w=this.svg().node;b=b||w;var T=this.getBBox({target:b}),E=T.center();if(T.intersectionWithLineFromCenterToPoint(m)){var D,$=this.tagName();if($==="RECT"){var z=new Z(parseFloat(this.attr("x")||0),parseFloat(this.attr("y")||0),parseFloat(this.attr("width")),parseFloat(this.attr("height"))),j=this.getTransformToElement(b),O=u.decomposeMatrix(j),B=w.createSVGTransform();B.setRotate(-O.rotation,E.x,E.y);var V=u.transformRect(z,B.matrix.multiply(j));D=new Z(V).intersectionWithLineFromCenterToPoint(m,O.rotation)}else if($==="PATH"||$==="POLYGON"||$==="POLYLINE"||$==="CIRCLE"||$==="ELLIPSE"){var F=$==="PATH"?this:this.convertToPath(),At=F.sample(),vt=1/0,zt=[],re,wt,Tt,Pt,It,mt;for(re=0;re<At.length;re++)wt=At[re],Tt=u.createSVGPoint(wt.x,wt.y),Tt=Tt.matrixTransform(this.getTransformToElement(b)),wt=new M(Tt),Pt=wt.distance(E),It=wt.distance(m)*1.1,mt=Pt+It,mt<vt?(vt=mt,zt=[{sample:wt,refDistance:It}]):mt<vt+1&&zt.push({sample:wt,refDistance:It});zt.sort(function(Bt,Ct){return Bt.refDistance-Ct.refDistance}),zt[0]&&(D=zt[0].sample)}return D}},d.setAttribute=function(m,b){const w=this.node;if(b===null)return this.removeAttr(m),this;const T=k[m],{ns:E}=u.qualifyAttr(T);return E?w.setAttributeNS(E,T,b):T==="id"?w.id=b:w.setAttribute(T,b),this},u.createSvgDocument=function(m){if(m){const w=`<svg xmlns="${e.svg}" xmlns:xlink="${e.xlink}" version="${n}">${m}</svg>`,{documentElement:T}=u.parseXML(w,{async:!1});return T}const b=document.createElementNS(e.svg,"svg");return b.setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),b.setAttribute("version",n),b},u.createSVGStyle=function(m){const{node:b}=u("style",{type:"text/css"},[u.createCDATASection(m)]);return b},u.createCDATASection=function(m=""){return document.implementation.createDocument(null,"xml",null).createCDATASection(m)},u.idCounter=0,u.uniqueId=function(){return"v-"+ ++u.idCounter},u.toNode=function(m){return u.isV(m)?m.node:m.nodeName&&m||m[0]},u.ensureId=function(m){return m=u.toNode(m),m.id||(m.id=u.uniqueId())},u.sanitizeText=function(m){return(m||"").replace(/ /g,"")},u.isUndefined=function(m){return typeof m>"u"},u.isString=function(m){return typeof m=="string"},u.isObject=function(m){return m&&typeof m=="object"},u.isArray=Array.isArray,u.parseXML=function(m,b){b=b||{};var w;try{var T=new DOMParser;u.isUndefined(b.async)||(T.async=b.async),w=T.parseFromString(m,"text/xml")}catch{w=void 0}if(!w||w.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+m);return w};const P=Object.create(null);["baseFrequency","baseProfile","clipPathUnits","contentScriptType","contentStyleType","diffuseConstant","edgeMode","externalResourcesRequired","filterRes","filterUnits","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].forEach(m=>P[m]=m),P.xlinkShow="xlink:show",P.xlinkRole="xlink:role",P.xlinkActuate="xlink:actuate",P.xlinkHref="xlink:href",P.xlinkType="xlink:type",P.xlinkTitle="xlink:title",P.xmlBase="xml:base",P.xmlLang="xml:lang",P.xmlSpace="xml:space";const k=new Proxy(P,{get(m,b){return u.supportCamelCaseAttributes?b in m?m[b]:m[b]=b.replace(/[A-Z]/g,"-$&").toLowerCase():b}});Object.defineProperty(u,"attributeNames",{enumerable:!0,value:k,writable:!1}),Object.defineProperty(u,"supportCamelCaseAttributes",{enumerable:!0,value:!0,writable:!0}),u.qualifyAttr=function(m){if(m.indexOf(":")!==-1){var b=m.split(":");return{ns:e[b[0]],local:b[1]}}return{ns:null,local:m}},u.transformSeparatorRegex=/[ ,]+/,u.transformRegex=/\b\w+\([^()]+\)/g,u.transformFunctionRegex=/\b(\w+)\(([^()]+)\)/,u.transformTranslateRegex=/\btranslate\(([^()]+)\)/,u.transformRotateRegex=/\brotate\(([^()]+)\)/,u.transformScaleRegex=/\bscale\(([^()]+)\)/,u.transformStringToMatrix=function(m){let b=u.createSVGMatrix();const w=m&&m.match(u.transformRegex);if(!w)return b;const T=w.length;for(let E=0;E<T;E++){const $=w[E].match(u.transformFunctionRegex);if($){let z,j,O,B,V,F=u.createSVGMatrix();const At=$[1].toLowerCase(),vt=$[2].split(u.transformSeparatorRegex);switch(At){case"scale":z=parseFloat(vt[0]),j=vt[1]===void 0?z:parseFloat(vt[1]),F=F.scaleNonUniform(z,j);break;case"translate":O=parseFloat(vt[0]),B=parseFloat(vt[1]),F=F.translate(O,B);break;case"rotate":V=parseFloat(vt[0]),O=parseFloat(vt[1])||0,B=parseFloat(vt[2])||0,O!==0||B!==0?F=F.translate(O,B).rotate(V).translate(-O,-B):F=F.rotate(V);break;case"skewx":V=parseFloat(vt[0]),F=F.skewX(V);break;case"skewy":V=parseFloat(vt[0]),F=F.skewY(V);break;case"matrix":F.a=parseFloat(vt[0]),F.b=parseFloat(vt[1]),F.c=parseFloat(vt[2]),F.d=parseFloat(vt[3]),F.e=parseFloat(vt[4]),F.f=parseFloat(vt[5]);break;default:continue}b=b.multiply(F)}}return b},u.matrixToTransformString=function(m){return m||(m=!0),"matrix("+(m.a!==void 0?m.a:1)+","+(m.b!==void 0?m.b:0)+","+(m.c!==void 0?m.c:0)+","+(m.d!==void 0?m.d:1)+","+(m.e!==void 0?m.e:0)+","+(m.f!==void 0?m.f:0)+")"},u.parseTransformString=function(m){var b,w,T;if(m){var E=u.transformSeparatorRegex;if(m.trim().indexOf("matrix")>=0){var D=u.transformStringToMatrix(m),$=u.decomposeMatrix(D);b=[$.translateX,$.translateY],T=[$.scaleX,$.scaleY],w=[$.rotation];var z=[];(b[0]!==0||b[1]!==0)&&z.push("translate("+b+")"),(T[0]!==1||T[1]!==1)&&z.push("scale("+T+")"),w[0]!==0&&z.push("rotate("+w+")"),m=z.join(" ")}else{const O=m.match(u.transformTranslateRegex);O&&(b=O[1].split(E));const B=m.match(u.transformRotateRegex);B&&(w=B[1].split(E));const V=m.match(u.transformScaleRegex);V&&(T=V[1].split(E))}}var j=T&&T[0]?parseFloat(T[0]):1;return{value:m,translate:{tx:b&&b[0]?parseInt(b[0],10):0,ty:b&&b[1]?parseInt(b[1],10):0},rotate:{angle:w&&w[0]?parseInt(w[0],10):0,cx:w&&w[1]?parseInt(w[1],10):void 0,cy:w&&w[2]?parseInt(w[2],10):void 0},scale:{sx:j,sy:T&&T[1]?parseFloat(T[1]):j}}},u.deltaTransformPoint=function(m,b){var w=b.x*m.a+b.y*m.c+0,T=b.x*m.b+b.y*m.d+0;return{x:w,y:T}},u.decomposeMatrix=function(m){var b=u.deltaTransformPoint(m,{x:0,y:1}),w=u.deltaTransformPoint(m,{x:1,y:0}),T=180/r*s(b.y,b.x)-90,E=180/r*s(w.y,w.x);return{translateX:m.e,translateY:m.f,scaleX:o(m.a*m.a+m.b*m.b),scaleY:o(m.c*m.c+m.d*m.d),skewX:T,skewY:E,rotation:T}},u.matrixToScale=function(m){var b,w,T,E;return m?(b=u.isUndefined(m.a)?1:m.a,E=u.isUndefined(m.d)?1:m.d,w=m.b,T=m.c):b=E=1,{sx:w?o(b*b+w*w):b,sy:T?o(T*T+E*E):E}},u.matrixToRotate=function(m){var b={x:0,y:1};return m&&(b=u.deltaTransformPoint(m,b)),{angle:nn(Uu(s(b.y,b.x))-90)}},u.matrixToTranslate=function(m){return{tx:m&&m.e||0,ty:m&&m.f||0}},u.isV=function(m){return m instanceof u},u.isVElement=u.isV,u.isSVGGraphicsElement=function(m){return m?(m=u.toNode(m),m instanceof SVGElement&&typeof m.getScreenCTM=="function"):!1};var N=u("svg").node;return u.createSVGMatrix=function(m){var b=N.createSVGMatrix();for(var w in m)b[w]=m[w];return b},u.createSVGTransform=function(m){return u.isUndefined(m)?N.createSVGTransform():(m instanceof SVGMatrix||(m=u.createSVGMatrix(m)),N.createSVGTransformFromMatrix(m))},u.createSVGPoint=function(m,b){var w=N.createSVGPoint();return w.x=m,w.y=b,w},u.transformRect=function(m,b){var w=N.createSVGPoint();w.x=m.x,w.y=m.y;var T=w.matrixTransform(b);w.x=m.x+m.width,w.y=m.y;var E=w.matrixTransform(b);w.x=m.x+m.width,w.y=m.y+m.height;var D=w.matrixTransform(b);w.x=m.x,w.y=m.y+m.height;var $=w.matrixTransform(b),z=a(T.x,E.x,D.x,$.x),j=l(T.x,E.x,D.x,$.x),O=a(T.y,E.y,D.y,$.y),B=l(T.y,E.y,D.y,$.y);return new Z(z,O,j-z,B-O)},u.transformPoint=function(m,b){return new M(u.createSVGPoint(m.x,m.y).matrixTransform(b))},u.transformLine=function(m,b){return new gt(u.transformPoint(m.start,b),u.transformPoint(m.end,b))},u.transformPolyline=function(m,b){var w=m instanceof _e?m.points:m;u.isArray(w)||(w=[]);for(var T=[],E=0,D=w.length;E<D;E++)T[E]=u.transformPoint(w[E],b);return new _e(T)},u.styleToObject=function(m){for(var b={},w=m.split(";"),T=0;T<w.length;T++){var E=w[T],D=E.split("=");b[D[0].trim()]=D[1].trim()}return b},u.createSlicePathData=function(m,b,w,T){var E=2*r-1e-6,D=m,$=b,z=w,j=T,O=(j<z&&(O=z,z=j,j=O),j-z),B=O<r?"0":"1",V=c(z),F=h(z),At=c(j),vt=h(j);return O>=E?D?"M0,"+$+"A"+$+","+$+" 0 1,1 0,"+-$+"A"+$+","+$+" 0 1,1 0,"+$+"M0,"+D+"A"+D+","+D+" 0 1,0 0,"+-D+"A"+D+","+D+" 0 1,0 0,"+D+"Z":"M0,"+$+"A"+$+","+$+" 0 1,1 0,"+-$+"A"+$+","+$+" 0 1,1 0,"+$+"Z":D?"M"+$*V+","+$*F+"A"+$+","+$+" 0 "+B+",1 "+$*At+","+$*vt+"L"+D*At+","+D*vt+"A"+D+","+D+" 0 "+B+",0 "+D*V+","+D*F+"Z":"M"+$*V+","+$*F+"A"+$+","+$+" 0 "+B+",1 "+$*At+","+$*vt+"L0,0Z"},u.mergeAttrs=function(m,b){for(var w in b)w==="class"?m[w]=m[w]?m[w]+" "+b[w]:b[w]:w==="style"?u.isObject(m[w])&&u.isObject(b[w])?m[w]=u.mergeAttrs(m[w],b[w]):u.isObject(m[w])?m[w]=u.mergeAttrs(m[w],u.styleToObject(b[w])):u.isObject(b[w])?m[w]=u.mergeAttrs(u.styleToObject(m[w]),b[w]):m[w]=u.mergeAttrs(u.styleToObject(m[w]),u.styleToObject(b[w])):m[w]=b[w];return m},u.annotateString=function(m,b,w){b=b||[],w=w||{};for(var T=w.offset||0,E=[],D,$=[],z,j,O=0;O<m.length;O++){z=$[O]=m[O];for(var B=0;B<b.length;B++){var V=b[B],F=V.start+T,At=V.end+T;O>=F&&O<At&&(u.isObject(z)?z.attrs=u.mergeAttrs(u.mergeAttrs({},z.attrs),V.attrs):z=$[O]={t:m[O],attrs:V.attrs},w.includeAnnotationIndices&&(z.annotations||(z.annotations=[])).push(B))}j=$[O-1],j?u.isObject(z)&&u.isObject(j)?JSON.stringify(z.attrs)===JSON.stringify(j.attrs)?D.t+=z.t:(E.push(D),D=z):u.isObject(z)||u.isObject(j)?(E.push(D),D=z):D=(D||"")+z:D=z}return D&&E.push(D),E},u.findAnnotationsAtIndex=function(m,b){var w=[];return m&&m.forEach(function(T){T.start<b&&b<=T.end&&w.push(T)}),w},u.findAnnotationsBetweenIndexes=function(m,b,w){var T=[];return m&&m.forEach(function(E){(b>=E.start&&b<E.end||w>E.start&&w<=E.end||E.start>=b&&E.end<w)&&T.push(E)}),T},u.shiftAnnotations=function(m,b,w){return m&&m.forEach(function(T){T.start<b&&T.end>=b?T.end+=w:T.start>=b&&(T.start+=w,T.end+=w)}),m},u.convertLineToPathData=function(m){m=u(m);var b=["M",m.attr("x1"),m.attr("y1"),"L",m.attr("x2"),m.attr("y2")].join(" ");return b},u.convertPolygonToPathData=function(m){var b=u.getPointsFromSvgNode(m);return b.length===0?null:u.svgPointsToPath(b)+" Z"},u.convertPolylineToPathData=function(m){var b=u.getPointsFromSvgNode(m);return b.length===0?null:u.svgPointsToPath(b)},u.svgPointsToPath=function(m){for(var b=0,w=m.length;b<w;b++)m[b]=m[b].x+" "+m[b].y;return"M "+m.join(" L")},u.getPointsFromSvgNode=function(m){m=u.toNode(m);var b=[],w=m.points;if(w)for(var T=0,E=w.numberOfItems;T<E;T++)b.push(w.getItem(T));return b},u.KAPPA=.551784,u.convertCircleToPathData=function(m){m=u(m);var b=parseFloat(m.attr("cx"))||0,w=parseFloat(m.attr("cy"))||0,T=parseFloat(m.attr("r")),E=T*u.KAPPA,D=["M",b,w-T,"C",b+E,w-T,b+T,w-E,b+T,w,"C",b+T,w+E,b+E,w+T,b,w+T,"C",b-E,w+T,b-T,w+E,b-T,w,"C",b-T,w-E,b-E,w-T,b,w-T,"Z"].join(" ");return D},u.convertEllipseToPathData=function(m){m=u(m);var b=parseFloat(m.attr("cx"))||0,w=parseFloat(m.attr("cy"))||0,T=parseFloat(m.attr("rx")),E=parseFloat(m.attr("ry"))||T,D=T*u.KAPPA,$=E*u.KAPPA,z=["M",b,w-E,"C",b+D,w-E,b+T,w-$,b+T,w,"C",b+T,w+$,b+D,w+E,b,w+E,"C",b-D,w+E,b-T,w+$,b-T,w,"C",b-T,w-$,b-D,w-E,b,w-E,"Z"].join(" ");return z},u.convertRectToPathData=function(m){return m=u(m),u.rectToPath({x:parseFloat(m.attr("x"))||0,y:parseFloat(m.attr("y"))||0,width:parseFloat(m.attr("width"))||0,height:parseFloat(m.attr("height"))||0,rx:parseFloat(m.attr("rx"))||0,ry:parseFloat(m.attr("ry"))||0})},u.rectToPath=function(m){var b,w=m.x,T=m.y,E=m.width,D=m.height,$=a(m.rx||m["top-rx"]||0,E/2),z=a(m.rx||m["bottom-rx"]||0,E/2),j=a(m.ry||m["top-ry"]||0,D/2),O=a(m.ry||m["bottom-ry"]||0,D/2);return $||z||j||O?b=["M",w,T+j,"v",D-j-O,"a",z,O,0,0,0,z,O,"h",E-2*z,"a",z,O,0,0,0,z,-O,"v",-(D-O-j),"a",$,j,0,0,0,-$,-j,"h",-(E-2*$),"a",$,j,0,0,0,-$,j,"Z"]:b=["M",w,T,"H",w+E,"V",T+D,"H",w,"V",T,"Z"],b.join(" ")},u.normalizePathData=function(){var m=`	
\v\f\r \u2028\u2029`,b=new RegExp("([a-z])["+m+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+m+"]*,?["+m+"]*)+)","ig"),w=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+m+"]*,?["+m+"]*","ig"),T=Math,E=T.PI,D=T.sin,$=T.cos,z=T.tan,j=T.asin,O=T.sqrt,B=T.abs;function V(wt,Tt,Pt,It,mt,Bt){var Ct=.3333333333333333,W=2/3;return[Ct*wt+W*Pt,Ct*Tt+W*It,Ct*mt+W*Pt,Ct*Bt+W*It,mt,Bt]}function F(wt,Tt,Pt){var It=wt*$(Pt)-Tt*D(Pt),mt=wt*D(Pt)+Tt*$(Pt);return{x:It,y:mt}}function At(wt,Tt,Pt,It,mt,Bt,Ct,W,Y,tt){var St=E*120/180,se=E/180*(+mt||0),Dt=[],yt;if(tt)dn=tt[0],He=tt[1],ls=tt[2],$r=tt[3];else{yt=F(wt,Tt,-se),wt=yt.x,Tt=yt.y,yt=F(W,Y,-se),W=yt.x,Y=yt.y;var Me=(wt-W)/2,We=(Tt-Y)/2,he=Me*Me/(Pt*Pt)+We*We/(It*It);he>1&&(he=O(he),Pt=he*Pt,It=he*It);var ir=Pt*Pt,no=It*It,fa=(Bt==Ct?-1:1)*O(B((ir*no-ir*We*We-no*Me*Me)/(ir*We*We+no*Me*Me)));if(!Number.isFinite(fa))return[wt,Tt,W,Y,W,Y];var ls=fa*Pt*We/It+(wt+W)/2,$r=fa*-It*Me/Pt+(Tt+Y)/2,dn=j(((Tt-$r)/It).toFixed(9)),He=j(((Y-$r)/It).toFixed(9));dn=wt<ls?E-dn:dn,He=W<ls?E-He:He,dn<0&&(dn=E*2+dn),He<0&&(He=E*2+He),Ct&&dn>He&&(dn=dn-E*2),!Ct&&He>dn&&(He=He-E*2)}var pa=He-dn;if(B(pa)>St){var Sh=He,jl=W,Wl=Y;He=dn+St*(Ct&&He>dn?1:-1),W=ls+Pt*$(He),Y=$r+It*D(He),Dt=At(W,Y,Pt,It,mt,0,Ct,jl,Wl,[He,Sh,ls,$r])}pa=He-dn;var Yl=$(dn),Xl=D(dn),ga=$(He),Eh=D(He),ql=z(pa/4),ma=4/3*(Pt*ql),Kl=4/3*(It*ql),Zl=[wt,Tt],sn=[wt+ma*Xl,Tt-Kl*Yl],va=[W+ma*Eh,Y-Kl*ga],ya=[W,Y];if(sn[0]=2*Zl[0]-sn[0],sn[1]=2*Zl[1]-sn[1],tt)return[sn,va,ya].concat(Dt);Dt=[sn,va,ya].concat(Dt).join().split(",");for(var ba=[],Th=Dt.length,Ni=0;Ni<Th;Ni++)ba[Ni]=Ni%2?F(Dt[Ni-1],Dt[Ni],se).y:F(Dt[Ni],Dt[Ni+1],se).x;return ba}function vt(wt){if(!wt)return null;var Tt={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},Pt=[];return String(wt).replace(b,function(It,mt,Bt){var Ct=[],W=mt.toLowerCase();for(Bt.replace(w,function(Y,tt){tt&&Ct.push(+tt)}),W==="m"&&Ct.length>2&&(Pt.push([mt].concat(Ct.splice(0,2))),W="l",mt=mt==="m"?"l":"L");Ct.length>=Tt[W]&&(Pt.push([mt].concat(Ct.splice(0,Tt[W]))),!!Tt[W]););}),Pt}function zt(wt){if((!Array.isArray(wt)||!Array.isArray(wt&&wt[0]))&&(wt=vt(wt)),!wt||!wt.length)return[["M",0,0]];for(var Tt=[],Pt=0,It=0,mt=0,Bt=0,Ct=0,W,Y=wt.length,tt=Ct;tt<Y;tt++){var St=[];Tt.push(St);var se=wt[tt];if(W=se[0],W!=W.toUpperCase()){St[0]=W.toUpperCase();var Dt,yt;switch(St[0]){case"A":St[1]=se[1],St[2]=se[2],St[3]=se[3],St[4]=se[4],St[5]=se[5],St[6]=+se[6]+Pt,St[7]=+se[7]+It;break;case"V":St[1]=+se[1]+It;break;case"H":St[1]=+se[1]+Pt;break;case"M":for(mt=+se[1]+Pt,Bt=+se[2]+It,Dt=se.length,yt=1;yt<Dt;yt++)St[yt]=+se[yt]+(yt%2?Pt:It);break;default:for(Dt=se.length,yt=1;yt<Dt;yt++)St[yt]=+se[yt]+(yt%2?Pt:It);break}}else for(var Me=se.length,We=0;We<Me;We++)St[We]=se[We];switch(St[0]){case"Z":Pt=+mt,It=+Bt;break;case"H":Pt=St[1];break;case"V":It=St[1];break;case"M":mt=St[St.length-2],Bt=St[St.length-1],Pt=St[St.length-2],It=St[St.length-1];break;default:Pt=St[St.length-2],It=St[St.length-1];break}}return Tt}function re(wt){var Tt=zt(wt),Pt={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function It(Dt,yt,Me){var We,he;if(!Dt)return["C",yt.x,yt.y,yt.x,yt.y,yt.x,yt.y];switch(Dt[0]in{T:1,Q:1}||(yt.qx=null,yt.qy=null),Dt[0]){case"M":yt.X=Dt[1],yt.Y=Dt[2];break;case"A":parseFloat(Dt[1])===0||parseFloat(Dt[2])===0?Dt=["L",Dt[6],Dt[7]]:Dt=["C"].concat(At.apply(0,[yt.x,yt.y].concat(Dt.slice(1))));break;case"S":Me==="C"||Me==="S"?(We=yt.x*2-yt.bx,he=yt.y*2-yt.by):(We=yt.x,he=yt.y),Dt=["C",We,he].concat(Dt.slice(1));break;case"T":Me==="Q"||Me==="T"?(yt.qx=yt.x*2-yt.qx,yt.qy=yt.y*2-yt.qy):(yt.qx=yt.x,yt.qy=yt.y),Dt=["C"].concat(V(yt.x,yt.y,yt.qx,yt.qy,Dt[1],Dt[2]));break;case"Q":yt.qx=Dt[1],yt.qy=Dt[2],Dt=["C"].concat(V(yt.x,yt.y,Dt[1],Dt[2],Dt[3],Dt[4]));break;case"H":Dt=["L"].concat(Dt[1],yt.y);break;case"V":Dt=["L"].concat(yt.x,Dt[1]);break}return Dt}function mt(Dt,yt){if(Dt[yt].length>7){Dt[yt].shift();for(var Me=Dt[yt];Me.length;)Bt[yt]="A",Dt.splice(yt++,0,["C"].concat(Me.splice(0,6)));Dt.splice(yt,1),Y=Tt.length}}for(var Bt=[],Ct="",W="",Y=Tt.length,tt=0;tt<Y;tt++){Tt[tt]&&(Ct=Tt[tt][0]),Ct!=="C"&&(Bt[tt]=Ct,tt>0&&(W=Bt[tt-1])),Tt[tt]=It(Tt[tt],Pt,W),Bt[tt]!=="A"&&Ct==="C"&&(Bt[tt]="C"),mt(Tt,tt);var St=Tt[tt],se=St.length;Pt.x=St[se-2],Pt.y=St[se-1],Pt.bx=parseFloat(St[se-4])||Pt.x,Pt.by=parseFloat(St[se-3])||Pt.y}return(!Tt[0][0]||Tt[0][0]!=="M")&&Tt.unshift(["M",0,0]),Tt}return function(wt){return re(wt).join(",").split(",").join(" ")}}(),u.namespace=e,u.g=e$,u}(),L=n$,Ja="[object Arguments]",Wd="[object Array]",qu="[object Boolean]",Ip="[object Date]",Rx="[object Error]",i$="[object Function]",Il="[object Map]",Ku="[object Number]",r$="[object Null]",bo="[object Object]",kp="[object RegExp]",kl="[object Set]",Zu="[object String]",Ju="[object Symbol]",s$="[object Undefined]",o$="[object WeakMap]",Op="[object ArrayBuffer]",Lp="[object DataView]",$x="[object Float32Array]",Bx="[object Float64Array]",Fx="[object Int8Array]",Vx="[object Int16Array]",zx="[object Int32Array]",Gx="[object Uint8Array]",Hx="[object Uint8ClampedArray]",Ux="[object Uint16Array]",jx="[object Uint32Array]",a$={[Ja]:!0,[Wd]:!0,[Op]:!0,[Lp]:!0,[qu]:!0,[Ip]:!0,[$x]:!0,[Bx]:!0,[Fx]:!0,[Vx]:!0,[zx]:!0,[Il]:!0,[Ku]:!0,[bo]:!0,[kp]:!0,[kl]:!0,[Zu]:!0,[Ju]:!0,[Gx]:!0,[Hx]:!0,[Ux]:!0,[jx]:!0,[Rx]:!1,[i$]:!1,[o$]:!1},Mp="\\ud800-\\udfff",l$="\\u0300-\\u036f",c$="\\ufe20-\\ufe2f",u$="\\u20d0-\\u20ff",h$="\\u1ab0-\\u1aff",d$="\\u1dc0-\\u1dff",f$=l$+c$+u$+h$+d$,Wx="\\u2700-\\u27bf",Yx="a-z\\xdf-\\xf6\\xf8-\\xff",p$="\\xac\\xb1\\xd7\\xf7",g$="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",m$="\\u2000-\\u206f",v$=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Xx="A-Z\\xc0-\\xd6\\xd8-\\xde",y$="\\ufe0e\\ufe0f",qx=p$+g$+m$+v$,Kx="[']",Um=`[${qx}]`,Dp=`[${f$}]`,Zx="\\d",b$=`[${Wx}]`,Jx=`[${Yx}]`,Qx=`[^${Mp}${qx+Zx+Wx+Yx+Xx}]`,Yd="\\ud83c[\\udffb-\\udfff]",x$=`(?:${Dp}|${Yd})`,tw=`[^${Mp}]`,Np="(?:\\ud83c[\\udde6-\\uddff]){2}",Rp="[\\ud800-\\udbff][\\udc00-\\udfff]",po=`[${Xx}]`,w$="\\u200d",jm=`(?:${Jx}|${Qx})`,_$=`(?:${po}|${Qx})`,Wm=`(?:${Kx}(?:d|ll|m|re|s|t|ve))?`,Ym=`(?:${Kx}(?:D|LL|M|RE|S|T|VE))?`,ew=`${x$}?`,nw=`[${y$}]?`,S$=`(?:${w$}(?:${[tw,Np,Rp].join("|")})${nw+ew})*`,E$="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",T$="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",iw=nw+ew+S$,A$=`(?:${[b$,Np,Rp].join("|")})${iw}`,C$=RegExp([`${po}?${Jx}+${Wm}(?=${[Um,po,"$"].join("|")})`,`${_$}+${Ym}(?=${[Um,po+jm,"$"].join("|")})`,`${po}?${jm}+${Wm}`,`${po}+${Ym}`,T$,E$,`${Zx}+`,A$].join("|"),"g"),$p=200,Xd="__hash_undefined__",P$=/^\[object (?:Float(?:32|64)|(?:Int|Uint)(?:8|16|32)|Uint8Clamped)Array\]$/,I$=`[${Mp}]`,k$=`${tw}${Dp}?`,O$=`(?:${[k$,Dp,Np,Rp,I$].join("|")})`,rw=RegExp(`${Yd}(?=${Yd})|${O$+iw}`,"g"),L$=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,M$=/^\w*$/,D$=".".charCodeAt(0),N$=/\\(\\)?/g,R$=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g"),$$=/^(?:0|[1-9]\d*)$/,B$=RegExp.prototype.test.bind(/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/),F$=4294967295-1,V$=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,sw=t=>rw.test(t),z$=t=>t.match(rw)||[],G$=t=>t.split(""),ow=t=>sw(t)?z$(t):G$(t),H$=t=>t==null?[]:Ol(t).map(e=>t[e]),Ol=t=>si(t)?aw(t):Object.keys(Object(t)),U$=t=>{if(!Qu(t))return Object.keys(t);var e=[];for(var n in Object(t))hasOwnProperty.call(t,n)&&n!="constructor"&&e.push(n);return e},aw=(t,e)=>{const n=Array.isArray(t),i=!n&&vi(t)&&yi(t)===Ja,r=!n&&!i&&Ml(t),s=n||i||r,o=t.length,a=new Array(s?o:0);let l=s?-1:o;for(;++l<o;)a[l]=`${l}`;for(const c in t)(e||hasOwnProperty.call(t,c))&&!(s&&(c==="length"||Gp(c,o)))&&a.push(c);return a},uc=(t,e)=>{let{length:n}=t;for(;n--;)if(oa(t[n][0],e))return n;return-1},oa=(t,e)=>t===e||t!==t&&e!==e,vi=t=>t!=null&&typeof t=="object",nu=(t,e,n)=>{if(!Vt(n))return!1;const i=typeof e;return(i=="number"?si(n)&&e>-1&&e<n.length:i=="string"&&e in n)?oa(n[e],t):!1},j$=t=>vi(t)&&yi(t)==kl,W$=t=>vi(t)&&yi(t)==Il,Qu=t=>{const e=t&&t.constructor,n=typeof e=="function"&&e.prototype||Object.prototype;return t===n},js=(t,e,n)=>{const i=t[e];(!(hasOwnProperty.call(t,e)&&oa(i,n))||n===void 0&&!(e in t))&&(t[e]=n)},Ll=(t,e,n)=>{let i=-1;const r=e.length;for(;++i<r;){const s=e[i];js(n,s,t[s])}return n},si=t=>t!=null&&typeof t!="function"&&typeof t.length=="number"&&t.length>-1&&t.length%1===0,Bo=t=>typeof t=="symbol"||vi(t)&&yi(t)===Ju,Y$=t=>{const e=t.length;let n=new t.constructor(e);return e&&typeof t[0]=="string"&&hasOwnProperty.call(t,"index")&&(n.index=t.index,n.input=t.input),n},Bp=(t,e)=>{let n=-1;const i=t.length;for(e||(e=new Array(i));++n<i;)e[n]=t[n];return e},yi=t=>t==null?t===void 0?s$:r$:Object.prototype.toString.call(t),Fp=t=>{const e=new t.constructor(t.byteLength);return new Uint8Array(e).set(new Uint8Array(t)),e},lw=(t,e)=>{const n=e?Fp(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)},X$=t=>{const e=new t.constructor(t.source,/\w*$/.exec(t));return e.lastIndex=t.lastIndex,e},cw=t=>typeof t.constructor=="function"&&!Qu(t)?Object.create(Object.getPrototypeOf(t)):{},Vp=t=>t==null?[]:(t=Object(t),Object.getOwnPropertySymbols(t).filter(n=>propertyIsEnumerable.call(t,n))),q$=(t,e)=>Ll(t,Vp(t),e);function K$(t,e){const n=e?Fp(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}const Z$=(t,e,n)=>{const i=t.constructor;switch(e){case Op:return Fp(t);case qu:case Ip:return new i(+t);case Lp:return K$(t,n);case $x:case Bx:case Fx:case Vx:case zx:case Gx:case Hx:case Ux:case jx:return lw(t,n);case Il:return new i(t);case Ku:case Zu:return new i(t);case kp:return X$(t);case kl:return new i;case Ju:return Symbol.prototype.valueOf?Object(Symbol.prototype.valueOf.call(t)):{}}},Ml=t=>vi(t)&&P$.test(yi(t)),qd=t=>{const e=Object.keys(t);return!Array.isArray(t)&&t!=null&&e.push(...Vp(Object(t))),e},uw=t=>{const e=[];for(;t;)e.push(...Vp(t)),t=Object.getPrototypeOf(Object(t));return e},hw=t=>{const e=[];for(const n in t)e.push(n);return Array.isArray(t)||e.push(...uw(t)),e},hc=({__data__:t},e)=>{const n=t;return u3(e)?n[typeof e=="string"?"string":"hash"]:n.map},J$=(t,e,n,i)=>{const r=qd(t),s=r.length,a=qd(e).length;if(s!=a)return!1;let l,c=s;for(;c--;)if(l=r[c],!hasOwnProperty.call(e,l))return!1;const h=i.get(t),u=i.get(e);if(h&&u)return h==e&&u==t;let d=!0;i.set(t,e),i.set(e,t);let f;for(;++c<s;){l=r[c];const p=t[l],g=e[l];if(!(p===g||n(p,g,i))){d=!1;break}f||(f=l=="constructor")}if(d&&!f){const p=t.constructor,g=e.constructor;p!=g&&"constructor"in t&&"constructor"in e&&!(typeof p=="function"&&p instanceof p&&typeof g=="function"&&g instanceof g)&&(d=!1)}return i.delete(t),i.delete(e),d},th=(t,e,n)=>t===e?!0:t==null||e==null||!vi(t)&&!vi(e)?t!==t&&e!==e:Q$(t,e,th,n),Q$=(t,e,n,i)=>{let r=Array.isArray(t);const s=Array.isArray(e);let o=r?Wd:yi(t),a=s?Wd:yi(e);o=o==Ja?bo:o,a=a==Ja?bo:a;let l=o==bo;const c=a==bo,h=o==a;if(h&&!l)return i||(i=new To),r||Ml(t)?dw(t,e,!1,n,i):n3(t,e,o,n,i);const u=l&&hasOwnProperty.call(t,"__wrapped__"),d=c&&hasOwnProperty.call(e,"__wrapped__");if(u||d){const f=u?t.value():t,p=d?e.value():e;return i||(i=new To),n(f,p,i)}return h?(i||(i=new To),J$(t,e,n,i)):!1},dw=(t,e,n,i,r)=>{const o=t.length,a=e.length;if(o!=a)return!1;const l=r.get(t),c=r.get(e);if(l&&c)return l==e&&c==t;let h=-1,u=!0;const d=n?new Fo:void 0;for(r.set(t,e),r.set(e,t);++h<o;){const f=t[h],p=e[h];if(d){if(!t3(e,(g,v)=>{if(!e3(d,v)&&(f===g||i(f,g,r)))return d.push(v)})){u=!1;break}}else if(!(f===p||i(f,p,r))){u=!1;break}}return r.delete(t),r.delete(e),u},t3=(t,e)=>{let n=-1;const i=t==null?0:t.length;for(;++n<i;)if(e(t[n],n,t))return!0;return!1},e3=(t,e)=>t.has(e),Xm=(t,e,n,i)=>!(t.byteLength!=e.byteLength||!n(new Uint8Array(t),new Uint8Array(e),i)),n3=(t,e,n,i,r)=>{switch(n){case Lp:return t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset?!1:(t=t.buffer,e=e.buffer,Xm(t,e,i,r));case Op:return Xm(t,e,i,r);case qu:case Ip:case Ku:return oa(+t,+e);case Rx:return t.name==e.name&&t.message==e.message;case kp:case Zu:return t==`${e}`;case Il:let s=fw;case kl:if(s||(s=eh),t.size!=e.size)return!1;const o=r.get(t);if(o)return o==e;r.set(t,e);const a=dw(s(t),s(e),!0,i,r);return r.delete(t),a;case Ju:return Symbol.prototype.valueOf.call(t)==Symbol.prototype.valueOf.call(e)}return!1},fw=t=>{let e=-1,n=Array(t.size);return t.forEach((i,r)=>{n[++e]=[r,i]}),n},eh=t=>{let e=-1;const n=new Array(t.size);return t.forEach(i=>{n[++e]=i}),n},zp=(t,e)=>{if(Array.isArray(t))return!1;const n=typeof t;return n==="number"||n==="boolean"||t==null||Bo(t)?!0:M$.test(t)||!L$.test(t)||e!=null&&t in Object(e)},i3=t=>{const e=[];return t.charCodeAt(0)===D$&&e.push(""),t.replace(R$,(n,i,r,s)=>{let o=n;r?o=s.replace(N$,"$1"):i&&(o=i.trim()),e.push(o)}),e},ss=(t,e)=>Array.isArray(t)?t:zp(t,e)?[t]:i3(`${t}`),Dl=(t,e)=>{e=ss(e,t);let n=0;const i=e.length;for(;t!=null&&n<i;)t=t[Mr(e[n])],n++;return n&&n==i?t:void 0};function r3(t,e){if(t!==e){const n=t!==void 0,i=t===null,r=t===t,s=Bo(t),o=e!==void 0,a=e===null,l=e===e,c=Bo(e);if(!a&&!c&&!s&&t>e||s&&o&&l&&!a&&!c||i&&o&&l||!n&&l||!r)return 1;if(!i&&!s&&!c&&t<e||c&&n&&r&&!i&&!s||a&&n&&r||!o&&r||!l)return-1}return 0}function s3(t,e,n){let i=-1;const r=t.criteria,s=e.criteria,o=r.length,a=n.length;for(;++i<o;){const l=i<a?n[i]:null,h=(l&&typeof l=="function"?l:r3)(r[i],s[i]);if(h)return l&&typeof l!="function"?h*(l=="desc"?-1:1):h}return t.index-e.index}const pw=(t,e)=>{let n=(o,a)=>!!(o==null?0:o.length)&&o.indexOf(a)>-1,i=!0;const r=[],s=e.length;if(!t.length)return r;e.length>=$p&&(n=(o,a)=>o.has(a),i=!1,e=new Fo(e));t:for(let o in t){let a=t[o];const l=a;if(a=a!==0?a:0,i&&l===l){let c=s;for(;c--;)if(e[c]===l)continue t;r.push(a)}else n(e,l)||r.push(a)}return r},o3=t=>{const e=(d,f)=>!!(d==null?0:d.length)&&d.indexOf(f)>-1,n=(d,f)=>d.has(f),i=t[0].length,r=t.length,s=new Array(r),o=[];let a,l=1/0,c=r;for(;c--;)a=t[c],l=Math.min(a.length,l),s[c]=i>=120&&a.length>=120?new Fo(c&&a):void 0;a=t[0];let h=-1;const u=s[0];t:for(;++h<i&&o.length<l;){let d=a[h];const f=d;if(d=d!==0?d:0,!(u?n(u,f):e(o,f))){for(c=r;--c;){const p=s[c];if(!(p?n(p,f):e(t[c],f)))continue t}u&&u.push(f),o.push(d)}}return o},Mr=t=>{if(typeof t=="string"||Bo(t))return t;const e=`${t}`;return e=="0"&&1/t==-1/0?"-0":e},Is=(t,e=!1,n=!1,i=!0,r,s,o,a)=>{let l;if(r&&(l=o?r(t,s,o,a):r(t)),l!==void 0)return l;if(!Vt(t))return t;const c=Array.isArray(t),h=yi(t);if(c){if(l=Y$(t),!e)return Bp(t,l)}else{const p=typeof t=="function";if(h===bo||h===Ja||p&&!o){if(l=n||p?{}:cw(t),!e)return n?a3(t,Ll(t,Object.keys(t),l)):q$(t,Object.assign(l,t))}else{if(p||!a$[h])return o?t:{};l=Z$(t,h,e)}}a||(a=new To);const u=a.get(t);if(u)return u;if(a.set(t,l),W$(t))return t.forEach((p,g)=>{l.set(g,Is(p,e,n,i,r,g,t,a))}),l;if(j$(t))return t.forEach(p=>{l.add(Is(p,e,n,i,r,p,t,a))}),l;if(Ml(t))return l;const f=c?void 0:(i?n?hw:qd:n?mw:Ol)(t);return(f||t).forEach((p,g)=>{f&&(g=p,p=t[g]),js(l,g,Is(p,e,n,i,r,g,t,a))}),l},a3=(t,e)=>Ll(t,uw(t),e),gw=(t,e)=>e.length<2?t:Dl(t,e.slice(0,-1)),l3=(t,e,n)=>{if(!Vt(t))return t;e=ss(e,t);const i=e.length,r=i-1;let s=-1,o=t;for(;o!=null&&++s<i;){const a=Mr(e[s]);let l=n;if(s!=r){const c=o[a];l=void 0,l===void 0&&(l=Vt(c)?c:Gp(e[s+1])?[]:{})}js(o,a,l),o=o[a]}return t},Gp=(t,e)=>{const n=typeof t;return e=e??Number.MAX_SAFE_INTEGER,!!e&&(n==="number"||n!=="symbol"&&$$.test(t))&&t>-1&&t%1==0&&t<e},c3=(t,e)=>{e=ss(e,t),t=gw(t,e);const n=e[e.length-1];return t==null||delete t[Mr(n)]},u3=t=>{const e=typeof t;return e==="string"||e==="number"||e==="symbol"||e==="boolean"?t!=="__proto__":t===null},mw=t=>{const e=[];for(const n in t)e.push(n);return e},h3=t=>{t=Object(t);const e={};for(const n in t)e[n]=t[n];return e},qm=(t,e)=>{if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]};function vw(t,e=!1){return(n,...i)=>{let r=-1,s=i.length,o=s>1?i[s-1]:void 0;const a=s>2?i[2]:void 0;for(o=t.length>3&&typeof o=="function"?(s--,o):e?(l,c)=>{if(Array.isArray(l)&&!Array.isArray(c))return c}:void 0,a&&nu(i[0],i[1],a)&&(o=s<3?void 0:o,s=1),n=Object(n);++r<s;){const l=i[r];l&&t(n,l,r,o)}return n}}const Hp=(t,e,n,i,r)=>{t!==e&&Jt(e,(s,o)=>{if(Vt(s))r||(r=new To),d3(t,e,o,n,Hp,i,r);else{let a=i?i(t[o],s,`${o}`,t,e,r):void 0;a===void 0&&(a=s),Kd(t,o,a)}})},d3=(t,e,n,i,r,s,o)=>{const a=qm(t,n),l=qm(e,n),c=o.get(l);if(c){Kd(t,n,c);return}let h=s?s(a,l,`${n}`,t,e,o):void 0,u=h===void 0;if(u){const d=Array.isArray(l),f=!d&&Ml(l);h=l,d||f?Array.isArray(a)?h=a:vi(a)&&si(a)?h=Bp(a):f?(u=!1,h=lw(l,!0)):h=[]:Ce(l)||Qa(l)?(h=a,Qa(a)?h=h3(a):(typeof a=="function"||!Vt(a))&&(h=cw(l))):u=!1}u&&(o.set(l,h),r(h,l,i,s,o),o.delete(l)),Kd(t,n,h)},Kd=(t,e,n)=>{(n!==void 0&&!oa(t[e],n)||n===void 0&&!(e in t))&&js(t,e,n)};function f3(t,e,n){const i=Object(t),r=n(t);let{length:s}=r,o=-1;for(;s--;){const a=r[++o];if(e(i[a],a,i)===!1)break}return t}const p3=(t,e)=>t&&f3(t,e,Ol),Up=(t,e)=>{if(t==null)return t;if(!si(t))return p3(t,e);const n=t.length,i=Object(t);let r=-1;for(;++r<n&&e(i[r],r,i)!==!1;);return t};function g3(t){const e=t==null?0:t.length;return e?t[e-1]:void 0}const m3=Set&&1/eh(new Set([void 0,-0]))[1]==1/0?t=>new Set(t):()=>{};function yw(t,e,n,i,r,s){return Vt(t)&&Vt(e)&&(s.set(e,t),Hp(t,e,void 0,yw,s),s.delete(e)),t}function v3(t,e,n){e.length?e=e.map(o=>Array.isArray(o)?a=>Dl(a,o.length===1?o[0]:o):o):e=[o=>o];let i=-1,r=-1;const s=si(t)?new Array(t.length):[];return Up(t,o=>{const a=e.map(l=>l(o));s[++r]={criteria:a,index:++i,value:o}}),y3(s,(o,a)=>s3(o,a,n))}function y3(t,e){let{length:n}=t;for(t.sort(e);n--;)t[n]=t[n].value;return t}function bw(t){return t===t&&!Vt(t)}function xw(t,e){return n=>n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}function ww(t,e){return t!=null&&D3(t,e,M3)}function b3(t,e){return zp(t)&&bw(e)?xw(Mr(t),e):n=>{const i=Dl(n,t);return i===void 0&&i===e?ww(n,t):th(e,i)}}function _w(t){const e=x3(t);return e.length===1&&e[0][2]?xw(e[0][0],e[0][1]):n=>n===t||w3(n,t,e)}function x3(t){const e=Ol(t);let n=e.length;for(;n--;){const i=e[n],r=t[i];e[n]=[i,r,bw(r)]}return e}function w3(t,e,n,i){let r=n.length;const s=r,o=!i;if(t==null)return!s;let a,l;for(t=Object(t);r--;)if(a=n[r],o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1;for(;++r<s;){a=n[r];const c=a[0],h=t[c],u=a[1];if(o&&a[2]){if(h===void 0&&!(c in t))return!1}else{const d=new To;if(i&&(l=i(h,u,c,t,e,d)),!(l===void 0?th(u,h,d):l))return!1}}return!0}function _3(t){return zp(t)?S3(Mr(t)):E3(t)}function S3(t){return e=>e==null?void 0:e[t]}function E3(t){return e=>Dl(e,t)}function T3(t){return typeof t=="function"?t:t==null?e=>e:typeof t=="object"?Array.isArray(t)?b3(t[0],t[1]):_w(t):_3(t)}function nh(){const t=T3;return arguments.length?t(arguments[0]):t}const A3=(t,e,n,i)=>{let r=-1;const s=t==null?0:t.length;for(i&&s&&(n=t[++r]);++r<s;)n=e(n,t[r],r,t);return n},C3=(t,e,n,i,r)=>(r(t,(s,o,a)=>{n=i?(i=!1,s):e(n,s,o,a)}),n);function P3(t,e,n){const i=Array.isArray(t)?A3:C3,r=arguments.length<3;return i(t,e,n,r,Up)}const I3=t=>Array.isArray(t)||Qa(t)||!!(t&&t[Symbol.isConcatSpreadable]);function Sw(t,e,n,i,r){let s=-1;const o=t.length;for(n||(n=I3),r||(r=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?Sw(a,e-1,n,i,r):r.push(...a):i||(r[r.length]=a)}return r}const Qa=t=>vi(t)&&yi(t)=="[object Arguments]",k3=(t,e)=>O3(t,e,(n,i)=>ww(t,i)),O3=(t,e,n)=>{let i=-1;const r=e.length,s={};for(;++i<r;){const o=e[i],a=Dl(t,o);n(a,o)&&l3(s,ss(o,t),a)}return s},L3=t=>typeof t=="number"&&t>-1&&t%1==0&&t<=Number.MAX_SAFE_INTEGER,M3=(t,e)=>t!=null&&e in Object(t),D3=(t,e,n)=>{e=ss(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var o=Mr(e[i]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&L3(r)&&Gp(o,r)&&(Array.isArray(t)||Qa(t)))},N3=t=>t.match(V$),R3=t=>t.match(C$),$3=(t,e)=>e===void 0?(B$(t)?R3(t):N3(t))||[]:t.match(e)||[],B3=(t,e,n)=>{const{length:i}=t;return n=n===void 0?i:n,!e&&n>=i?t:t.slice(e,n)},F3=V3("toUpperCase");function V3(t){return e=>{if(!e)return"";const n=sw(e)?ow(e):void 0,i=n?n[0]:e[0],r=n?B3(n,1).join(""):e.slice(1);return i[t]()+r}}function z3(t){return _w(Is(t,!0))}let To=class{constructor(e){const n=this.__data__=new jh(e);this.size=n.size}clear(){this.__data__=new jh,this.size=0}delete(e){const n=this.__data__,i=n.delete(e);return this.size=n.size,i}get(e){return this.__data__.get(e)}has(e){return this.__data__.has(e)}set(e,n){let i=this.__data__;if(i instanceof jh){const r=i.__data__;if(r.length<$p-1)return r.push([e,n]),this.size=++i.size,this;i=this.__data__=new Ew(r)}return i.set(e,n),this.size=i.size,this}};class jh{constructor(e){let n=-1;const i=e==null?0:e.length;for(this.clear();++n<i;){const r=e[n];this.set(r[0],r[1])}}clear(){this.__data__=[],this.size=0}delete(e){const n=this.__data__,i=uc(n,e);if(i<0)return!1;const r=n.length-1;return i==r?n.pop():n.splice(i,1),--this.size,!0}get(e){const n=this.__data__,i=uc(n,e);return i<0?void 0:n[i][1]}has(e){return uc(this.__data__,e)>-1}set(e,n){const i=this.__data__,r=uc(i,e);return r<0?(++this.size,i.push([e,n])):i[r][1]=n,this}}class Ew{constructor(e){let n=-1;const i=e==null?0:e.length;for(this.clear();++n<i;){const r=e[n];this.set(r[0],r[1])}}clear(){this.size=0,this.__data__={hash:new Km,map:new Map,string:new Km}}delete(e){const n=hc(this,e).delete(e);return this.size-=n?1:0,n}get(e){return hc(this,e).get(e)}has(e){return hc(this,e).has(e)}set(e,n){const i=hc(this,e),r=i.size;return i.set(e,n),this.size+=i.size==r?0:1,this}}class Km{constructor(e){let n=-1;const i=e==null?0:e.length;for(this.clear();++n<i;){const r=e[n];this.set(r[0],r[1])}}clear(){this.__data__=Object.create(null),this.size=0}delete(e){const n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}get(e){const i=this.__data__[e];return i===Xd?void 0:i}has(e){return this.__data__[e]!==void 0}set(e,n){const i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=n===void 0?Xd:n,this}}let Fo=class{constructor(e){let n=-1;const i=e==null?0:e.length;for(this.__data__=new Ew;++n<i;)this.add(e[n])}add(e){return this.__data__.set(e,Xd),this}has(e){return this.__data__.has(e)}};Fo.prototype.push=Fo.prototype.add;const jp=function(t){var e=Object.prototype.toString;return t===!0||t===!1||!!t&&typeof t=="object"&&e.call(t)===qu},Vt=function(t){return!!t&&(typeof t=="object"||typeof t=="function")},Nt=function(t){var e=Object.prototype.toString;return typeof t=="number"||!!t&&typeof t=="object"&&e.call(t)===Ku},ne=function(t){var e=Object.prototype.toString;return typeof t=="string"||!!t&&typeof t=="object"&&e.call(t)===Zu},H=vw((t,e)=>{if(Qu(e)||si(e)){Ll(e,Ol(e),t);return}for(var n in e)hasOwnProperty.call(e,n)&&js(t,n,e[n])}),Tw=H,G3=Tw,Aw=(t,...e)=>{let n=-1,i=e.length;const r=i>2?e[2]:void 0;for(r&&nu(e[0],e[1],r)&&(i=1);++n<i;){const s=e[n];if(s==null)continue;const o=Object.keys(s),a=o.length;let l=-1;for(;++l<a;){const c=o[l],h=t[c];(h===void 0||oa(h,Object.prototype[c])&&!hasOwnProperty.call(t,c))&&(t[c]=s[c])}}return t},me=Aw,Cw=function(...e){return e.push(void 0,yw),Te.apply(void 0,e)},er=Cw,Ue=(t,e,...n)=>{let i=-1;const r=typeof e=="function",s=si(t)?new Array(t.length):[];return Up(t,o=>{s[++i]=r?e.apply(o,n):Pw(o,e,...n)}),s},Pw=(t,e,...n)=>{e=ss(e,t),t=gw(t,e);const i=t==null?t:t[Mr(g3(e))];return i==null?void 0:i.apply(t,n)},ih=(t,e,n)=>{let i=0,r=t==null?0:t.length;if(r==0)return 0;n=nh(n,2),e=n(e);const s=e!==e,o=e===null,a=Bo(e),l=e===void 0;for(;i<r;){let c;const h=Math.floor((i+r)/2),u=n(t[h]),d=u!==void 0,f=u===null,p=u===u,g=Bo(u);s?c=p:l?c=p&&d:o?c=p&&d&&!f:a?c=p&&d&&!f&&!g:f||g?c=!1:c=u<e,c?i=h+1:r=h}return Math.min(r,F$)},Ii=(t,e)=>{let n=-1,i=(l,c)=>!!(l==null?0:l.length)&&l.indexOf(c)>-1;e=nh(e,2);let r=!0;const{length:s}=t,o=[];let a=o;if(s>=$p){const l=e?null:m3(t);if(l)return eh(l);r=!1,i=(c,h)=>c.has(h),a=new Fo}else a=e?[]:o;t:for(;++n<s;){let l=t[n];const c=e?e(l):l;if(l=l!==0?l:0,r&&c===c){let h=a.length;for(;h--;)if(a[h]===c)continue t;e&&a.push(c),o.push(l)}else i(a,c)||(a!==o&&a.push(c),o.push(l))}return o},we=t=>Is(t),Le=t=>Is(t,!0),En=t=>{if(t==null)return!0;if(si(t)&&(Array.isArray(t)||typeof t=="string"||typeof t.splice=="function"||Ml(t)||Qa(t)))return!t.length;const e=yi(t);if(e=="[object Map]"||e=="[object Set]")return!t.size;if(Qu(t))return!U$(t).length;for(const n in t)if(hasOwnProperty.call(t,n))return!1;return!0},ke=(t,e)=>th(t,e),_t=t=>typeof t=="function",Ce=t=>{if(!vi(t)||yi(t)!="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},pt=t=>{if(!t)return[];if(si(t))return ne(t)?ow(t):Bp(t);if(Symbol.iterator&&Symbol.iterator in Object(t)){const i=t[Symbol.iterator]();let r;const s=[];for(;!(r=i.next()).done;)s.push(r.value);return s}const e=yi(t);return(e==Il?fw:e==kl?eh:H$)(t)};function Nl(t,e,n){if(typeof t!="function")throw new TypeError("Expected a function");let i,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;const f=!e&&e!==0&&window&&typeof window.requestAnimationFrame=="function";e=+e||0,Vt(n)&&(h=!!n.leading,u="maxWait"in n,s=u?Math.max(+n.maxWait||0,e):s,d="trailing"in n?!!n.trailing:d);function p(m){const b=i,w=r;return i=r=void 0,c=m,o=t.apply(w,b),o}function g(m,b){return f?(window.cancelAnimationFrame(a),window.requestAnimationFrame(m)):setTimeout(m,b)}function v(m){if(f)return window.cancelAnimationFrame(m);clearTimeout(m)}function x(m){return c=m,a=g(P,e),h?p(m):o}function S(m){const b=m-l,w=m-c,T=e-b;return u?Math.min(T,s-w):T}function C(m){const b=m-l,w=m-c;return l===void 0||b>=e||b<0||u&&w>=s}function P(){const m=Date.now();if(C(m))return k(m);a=g(P,S(m))}function k(m){return a=void 0,d&&i?p(m):(i=r=void 0,o)}function N(...m){const b=Date.now(),w=C(b);if(i=m,r=this,l=b,w){if(a===void 0)return x(l);if(u)return a=g(P,e),p(l)}return a===void 0&&(a=g(P,e)),o}return N.cancel=()=>{a!==void 0&&v(a),c=0,i=l=r=a=void 0},N.flush=()=>a===void 0?o:k(Date.now()),N.pending=()=>a!==void 0,N}const Wp=(t,e)=>(e=nh(e,2),P3(t,(n,i,r)=>(r=e(i),hasOwnProperty.call(n,r)?n[r].push(i):js(n,r,[i]),n),{})),tn=(t,e=[])=>{if(t==null)return[];const n=e.length;return n>1&&nu(t,e[0],e[1])?e=[]:n>2&&nu(e[0],e[1],e[2])&&(e=[e[0]]),Array.isArray(e)||(e=[nh(e,2)]),v3(t,e.flat(1),[])},Iw=t=>(t==null?0:t.length)?Sw(t,1/0):[],Vo=(t,...e)=>si(t)?pw(t,e):[],kw=(t,...e)=>vi(t)&&si(t)?pw(t,e.flat(1)):[],Zd=(...t)=>{const e=t.map(n=>vi(n)&&si(n)?n:[]);return e.length&&e[0]===t[0]?o3(e):[]},iu=(...t)=>{const e=t.flat(1);return Ii(e)},di=(t,e)=>{if(t==null)return!1;typeof e=="string"&&(e=e.split("."));let n=-1,i=t;for(;++n<e.length;){if(!i||!hasOwnProperty.call(i,e[n]))return!1;i=i[e[n]]}return!0},ee=(t,e,n)=>{e=ss(e,t);let i=-1,r=e.length;for(r||(r=1,t=void 0);++i<r;){let s=t==null?void 0:t[Mr(e[i])];s===void 0&&(i=r,s=n),t=typeof s=="function"?s.call(t):s}return t},Qe=(t,...e)=>{let n={};if(t==null)return n;let i=!1;e=e.flat(1).map(s=>(s=ss(s,t),i||(i=s.length>1),s)),Ll(t,hw(t),n),i&&(n=Is(n,!0,!0,!0,s=>Ce(s)?void 0:s));let r=e.length;for(;r--;)c3(n,e[r]);return n},tl=(t,...e)=>t==null?{}:k3(t,e.flat(1/0)),hn=(t,...e)=>(e.flat(1).forEach(n=>{n=Mr(n),js(t,n,t[n].bind(t))}),t),Jt=(t,e=n=>n)=>{let n=-1;const i=Object(t),r=si(t)?aw(t,!0):mw(t);let s=r.length;for(;s--;){const o=r[++n];if(e(i[o],o,i)===!1)break}},Rl=(t="")=>$3(`${t}`.replace(/['\u2019]/g,"")).reduce((e,n,i)=>(n=n.toLowerCase(),e+(i?F3(n):n)),"");let H3=0;const es=(t="")=>{const e=++H3;return`${t}`+e},Te=vw((t,e,n,i)=>{Hp(t,e,n,i)},!0);class U3{constructor(){this.map=new WeakMap}has(e,n){return n===void 0?this.map.has(e):n in this.map.get(e)}create(e){return this.has(e)||this.map.set(e,Object.create(null)),this.get(e)}get(e,n){if(!this.has(e))return;const i=this.map.get(e);return n===void 0?i:i[n]}set(e,n,i){if(n===void 0)return;const r=this.create(e);typeof n=="string"?r[n]=i:Object.assign(r,n)}remove(e,n){if(this.has(e))if(n===void 0)this.map.delete(e);else{const i=this.map.get(e);delete i[n]}}}const Ow=U3,gi=new Ow,Lw=new Ow,Ds=function(t,e){if(!(this instanceof Ds))return new Ds(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?Rc:$c,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&Object.assign(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this.envelope=!0};Ds.prototype={constructor:Ds,isDefaultPrevented:$c,isPropagationStopped:$c,isImmediatePropagationStopped:$c,preventDefault:function(){const t=this.originalEvent;this.isDefaultPrevented=Rc,t&&t.preventDefault()},stopPropagation:function(){const t=this.originalEvent;this.isPropagationStopped=Rc,t&&t.stopPropagation()},stopImmediatePropagation:function(){const t=this.originalEvent;this.isImmediatePropagationStopped=Rc,t&&t.stopImmediatePropagation(),this.stopPropagation()}};["altKey","bubbles","cancelable","changedTouches","ctrlKey","detail","eventPhase","metaKey","pageX","pageY","shiftKey","view","char","code","charCode","key","keyCode","button","buttons","clientX","clientY","offsetX","offsetY","pointerId","pointerType","screenX","screenY","targetTouches","toElement","touches","which"].forEach(t=>j3(t));function j3(t){Object.defineProperty(Ds.prototype,t,{enumerable:!0,configurable:!0,get:function(){return this.originalEvent?this.originalEvent[t]:void 0},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})}function Rc(){return!0}function $c(){return!1}const zo=typeof window<"u"?window.document:null,W3=zo&&zo.documentElement,Mw=/^([^.]*)(?:\.(.+)|)/,Dw=/[^\x20\t\r\n\f]+/g,q=function(t){return new q.Dom(t)};q.fn=q.prototype={constructor:q,length:0};q.guid=1;q.data=Lw;q.merge=function(t,e){let n=+e.length,i=t.length;for(let r=0;r<n;r++)t[i++]=e[r];return t.length=i,t};q.parseHTML=function(t){const e=zo.implementation.createHTMLDocument(),n=e.createElement("base");n.href=zo.location.href,e.head.appendChild(n),e.body.innerHTML=t;const i=e.getElementsByTagName("script");for(let r=0;r<i.length;r++)i[r].remove();return Array.from(e.body.childNodes)};typeof Symbol=="function"&&(q.fn[Symbol.iterator]=Array.prototype[Symbol.iterator]);q.fn.toArray=function(){return Array.from(this)};q.fn.pushStack=function(t){const e=q.merge(this.constructor(),t);return e.prevObject=this,e};q.fn.find=function(t){const[e]=this,n=this.pushStack([]);if(!e)return n;const{nodeType:i}=e;return i!==1&&i!==9&&i!==11||(typeof t!="string"?e!==t&&e.contains(t)&&q.merge(n,[t]):q.merge(n,e.querySelectorAll(t))),n};q.fn.add=function(t,e){const n=q(t).toArray(),i=this.toArray(),r=this.pushStack([]);return q.merge(r,Ii(i.concat(n))),r};q.fn.addBack=function(){return this.add(this.prevObject)};q.fn.filter=function(t){const e=[];for(let n=0;n<this.length;n++){const i=this[n];i.matches(t)&&e.push(i)}return this.pushStack(e)};const Y3=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;function X3(t){return t[0]==="<"&&t[t.length-1]===">"&&t.length>=3}const Nw=function(t){if(!t)return this;if(typeof t=="function")throw new Error("function not supported");if(arguments.length>1)throw new Error("selector with context not supported");if(t.nodeType)return this[0]=t,this.length=1,this;let e;if(X3(t+""))e=[null,t,null];else if(typeof t=="string")e=Y3.exec(t);else return q.merge(this,t);if(!e||!e[1])return q3.find(t);if(e[1])return q.merge(this,q.parseHTML(e[1])),this;const n=zo.getElementById(e[2]);return n&&(this[0]=n,this.length=1),this};q.Dom=Nw;Nw.prototype=q.fn;q.Event=Ds;q.event={special:Object.create(null)};q.event.has=function(t,e){const n=gi.get(t,"events");return n?e?Array.isArray(n[e])&&n[e].length>0:!0:!1};q.event.on=function(t,e,n,i,r,s){if(typeof e=="object"){typeof n!="string"&&(i=i||n,n=void 0);for(let o in e)q.event.on(t,o,n,i,e[o],s);return t}if(i==null&&r==null?(r=n,i=n=void 0):r==null&&(typeof n=="string"?(r=i,i=void 0):(r=i,i=n,n=void 0)),!r)return t;if(s===1){const o=r;r=function(a){return q().off(a),o.apply(this,arguments)},r.guid=o.guid||(o.guid=q.guid++)}for(let o=0;o<t.length;o++)q.event.add(t[o],e,r,i,n)};q.event.add=function(t,e,n,i,r){if(typeof t!="object")return;const s=gi.create(t);let o;n.handler&&(o=n,n=o.handler,r=o.selector),r&&W3.matches(r),n.guid||(n.guid=q.guid++);let a;(a=s.events)||(a=s.events=Object.create(null));let l;(l=s.handle)||(l=s.handle=function(u){return typeof q<"u"?q.event.dispatch.apply(t,arguments):void 0});const c=(e||"").match(Dw)||[""];let h=c.length;for(;h--;){const[,u,d=""]=Mw.exec(c[h]);if(!u)continue;const f=d.split(".").sort();let p=q.event.special[u];const g=p&&(r?p.delegateType:p.bindType)||u;p=q.event.special[g];const v=Object.assign({type:g,origType:u,data:i,handler:n,guid:n.guid,selector:r,namespace:f.join(".")},o);let x;(x=a[g])||(x=a[g]=[],x.delegateCount=0,(!p||!p.setup||p.setup.call(t,i,f,l)===!1)&&t.addEventListener&&t.addEventListener(g,l)),p&&p.add&&(p.add.call(t,v),v.handler.guid||(v.handler.guid=n.guid)),r?x.splice(x.delegateCount++,0,v):x.push(v)}};q.event.remove=function(t,e,n,i,r){const s=gi.get(t);if(!s||!s.events)return;const o=s.events,a=(e||"").match(Dw)||[""];let l=a.length;for(;l--;){const[,c,h=""]=Mw.exec(a[l]);if(!c){for(const S in o)q.event.remove(t,S+a[l],n,i,!0);continue}const u=q.event.special[c],d=u&&(i?u.delegateType:u.bindType)||c,f=o[d];if(!f||f.length===0)continue;const p=h.split(".").sort(),g=h?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,v=f.length;let x=v;for(;x--;){const S=f[x];(r||c===S.origType)&&(!n||n.guid===S.guid)&&(!g||g.test(S.namespace))&&(!i||i===S.selector||i==="**"&&S.selector)&&(f.splice(x,1),S.selector&&f.delegateCount--,u&&u.remove&&u.remove.call(t,S))}v&&f.length===0&&((!u||!u.teardown||u.teardown.call(t,p,s.handle)===!1)&&t.removeEventListener&&t.removeEventListener(d,s.handle),delete o[d])}En(o)&&(gi.remove(t,"handle"),gi.remove(t,"events"))};q.event.dispatch=function(t){const e=this,n=q.event.fix(t);n.delegateTarget=e;const i=Array.from(arguments);i[0]=n;const r=gi.get(e,"events"),s=r&&r[n.type]||[],o=q.event.special[n.type];if(o&&o.preDispatch&&o.preDispatch.call(e,n)===!1)return;const a=q.event.handlers.call(e,n,s);let l=0,c;for(;(c=a[l++])&&!n.isPropagationStopped();){n.currentTarget=c.elem;let h=0,u;for(;(u=c.handlers[h++])&&!n.isImmediatePropagationStopped();){n.handleObj=u,n.data=u.data;const d=q.event.special[u.origType];let f;d&&d.handle?f=d.handle:f=u.handler;const p=f.apply(c.elem,i);p!==void 0&&(n.result=p)===!1&&(n.preventDefault(),n.stopPropagation())}}return o&&o.postDispatch&&o.postDispatch.call(e,n),n.result};q.event.handlers=function(t,e){const n=e.delegateCount,i=[];if(n&&!(t.type==="click"&&t.button>=1)){for(let r=t.target;r!==this;r=r.parentNode||this)if(r.nodeType===1&&!(t.type==="click"&&r.disabled===!0)){const s=[],o={};for(let a=0;a<n;a++){const l=e[a],c=l.selector+" ";o[c]===void 0&&(o[c]=r.matches(c)),o[c]&&s.push(l)}s.length&&i.push({elem:r,handlers:s})}}return n<e.length&&i.push({elem:this,handlers:e.slice(n)}),i};q.event.fix=function(t){return t.envelope?t:new Ds(t)};const q3=q(zo);function Yp(t){let e=t.length;for(;e--;)Rw(t[e])}function Rw(t){q.event.remove(t),gi.remove(t),Lw.remove(t)}function $w(t){for(let e=0;e<t.length;e++){const n=t[e];n.parentNode&&n.parentNode.removeChild(n)}}function K3(){for(let t=0;t<this.length;t++){const e=this[t];Rw(e),Yp(e.getElementsByTagName("*"))}return $w(this),this}function Z3(){return $w(this),this}function J3(){for(let t=0;t<this.length;t++){const e=this[t];e.nodeType===1&&(Yp(e.getElementsByTagName("*")),e.textContent="")}return this}function Q3(){const t=[];for(let e=0;e<this.length;e++)t.push(this[e].cloneNode(!0));return this.pushStack(t)}function tB(t){const[e]=this;if(!e)return null;if(arguments.length===0)return e.innerHTML;if(t===void 0)return this;if(Yp(gi,e.getElementsByTagName("*")),typeof t=="string"||typeof t=="number")e.innerHTML=t;else return e.innerHTML="",this.append(t);return this}function eB(...t){const[e]=this;return e?(t.forEach(n=>{n&&(typeof n=="string"?e.append(...q.parseHTML(n)):n.toString()==="[object Object]"?this.append(...Array.from(n)):Array.isArray(n)?this.append(...n):e.appendChild(n))}),this):this}function nB(...t){const[e]=this;return e?(t.forEach(n=>{n&&(typeof n=="string"?e.prepend(...q.parseHTML(n)):n.toString()==="[object Object]"?this.prepend(...Array.from(n)):Array.isArray(n)?this.prepend(...n):e.insertBefore(n,e.firstChild))}),this):this}function iB(t){return q(t).append(this),this}function rB(t){return q(t).prepend(this),this}const Bw={};["width","height","top","bottom","left","right","padding","paddingTop","paddingBottom","paddingLeft","paddingRight","margin","marginTop","marginBottom","marginLeft","marginRight"].forEach(t=>{Bw[t]=!0});function sB(t,e,n){typeof n=="number"&&Bw[Rl(e)]&&(n+="px"),t.style[e]=n}function oB(t,e){let n;if(typeof t=="string")if(e===void 0){const[i]=this;return i?i.style[t]:null}else n={[t]:e};else if(t)n=t;else throw new Error("no styles provided");for(let i in n)if(n.hasOwnProperty(i))for(let r=0;r<this.length;r++)sB(this[r],i,n[i]);return this}function aB(t,e){if(arguments.length<2){const[n]=this;return n?t===void 0?n.dataset:n.dataset[t]:null}for(let n=0;n<this.length;n++)this[n].dataset[t]=e;return this}function Xp(t,e,n){for(let i=0;i<e.length;i++){const r=e[i];L.prototype[t].apply({node:r},n)}}function lB(){return Xp("removeClass",this,arguments),this}function cB(){return Xp("addClass",this,arguments),this}function uB(){return Xp("toggleClass",this,arguments),this}function hB(){const[t]=this;return t?L.prototype.hasClass.apply({node:t},arguments):!1}function dB(t){const e=[];for(let n=0;n<this.length;n++){const i=this[n];let r=Array.from(i.children);typeof t=="string"&&(r=r.filter(s=>s.matches(t))),e.push(...r)}return this.pushStack(e)}function fB(t){const e=[];for(let n=0;n<this.length;n++){const i=this[n];if(typeof t=="string"){const r=i.closest(t);r&&e.push(r)}else{const[r]=q(t);r&&r.contains(i)&&e.push(r)}}return this.pushStack(e)}function pB(t,e,n,i){return q.event.on(this,t,e,n,i),this}function gB(t,e,n,i){return q.event.on(this,t,e,n,i,1),this}function mB(t,e,n){if(t&&t.preventDefault&&t.handleObj){const i=t.handleObj;return q(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this}if(typeof t=="object"){for(let i in t)this.off(i,e,t[i]);return this}(e===!1||typeof e=="function")&&(n=e,e=void 0);for(let i=0;i<this.length;i++)q.event.remove(this[i],t,n,e);return this}function vB(){const[t]=this;if(t===window)return t.document.documentElement.clientWidth;if(!t)return;const e=window.getComputedStyle(t),n=t.offsetWidth,i=parseFloat(e.borderTopWidth),r=parseFloat(e.borderBottomWidth),s=parseFloat(e.paddingTop),o=parseFloat(e.paddingBottom);return n-r-i-s-o}function yB(){const[t]=this;if(t===window)return t.document.documentElement.clientHeight;if(!t)return;const e=window.getComputedStyle(t),n=t.offsetHeight,i=parseFloat(e.borderLeftWidth),r=parseFloat(e.borderRightWidth),s=parseFloat(e.paddingLeft),o=parseFloat(e.paddingRight);return n-i-r-s-o}function bB(){const[t]=this;if(!t)return;let e=q(t),n,i,r,s={top:0,left:0};if(e.css("position")==="fixed")i=t.getBoundingClientRect();else{i=e.offset(),r=t.ownerDocument,n=t.offsetParent||r.documentElement;const l=q(n),c=l.css("position")||"static";for(;n&&(n===r.body||n===r.documentElement)&&c==="static";)n=n.parentNode;if(n&&n!==t&&n.nodeType===1){const h=window.getComputedStyle(n),u=parseFloat(h.borderTopWidth)||0,d=parseFloat(h.borderLeftWidth)||0;s=l.offset(),s.top+=u,s.left+=d}}const o=parseFloat(window.getComputedStyle(t).marginTop)||0,a=parseFloat(window.getComputedStyle(t).marginLeft)||0;return{top:i.top-s.top-o,left:i.left-s.left-a}}function xB(t){const[e]=this;if(t===void 0){if(!e)return null;if(!e.getClientRects().length)return{top:0,left:0};const o=e.getBoundingClientRect();return{top:o.top+window.scrollY,left:o.left+window.scrollX}}if(!e)return this;const n=window.getComputedStyle(e);n.position==="static"&&this.css("position","relative");const i=this.offset(),r=t.top-i.top,s=t.left-i.left;return this.css({top:(parseFloat(n.top)||0)+r+"px",left:(parseFloat(n.left)||0)+s+"px"}),this}const wB=Object.freeze(Object.defineProperty({__proto__:null,addClass:cB,append:eB,appendTo:iB,children:dB,clone:Q3,closest:fB,css:oB,data:aB,detach:Z3,empty:J3,hasClass:hB,height:yB,html:tB,off:mB,offset:xB,on:pB,one:gB,position:bB,prepend:nB,prependTo:rB,remove:K3,removeClass:lB,toggleClass:uB,width:vB},Symbol.toStringTag,{value:"Module"})),ru="animationFrameId",Fi={};Fi["transition-property"]=Fi["transition-duration"]=Fi["transition-delay"]=Fi["transition-timing-function"]=Fi["animation-name"]=Fi["animation-duration"]=Fi["animation-delay"]=Fi["animation-timing-function"]="";function _B(t,e={}){this.stop();for(let n=0;n<this.length;n++)SB(this[n],t,e);return this}function SB(t,e,n={}){let{duration:i=400,easing:r="ease-in-out",delay:s=0,complete:o}=n;const a=setTimeout(function(){const l=q(t);let c=!1,h="transitionend";i=i/1e3,s=s/1e3;const u={};if(typeof e=="string")u["animation-name"]=e,u["animation-duration"]=i+"s",u["animation-delay"]=s+"s",u["animation-timing-function"]=r,h="animationend";else{const p=[];for(var d in e)e.hasOwnProperty(d)&&(u[d]=e[d],p.push(d));i>0&&(u["transition-property"]=p.join(", "),u["transition-duration"]=i+"s",u["transition-delay"]=s+"s",u["transition-timing-function"]=r)}const f=function(p){if(p){if(p.target!==p.currentTarget)return;p.target.removeEventListener(h,f)}else t.removeEventListener(h,f);c=!0,l.css(Fi),o&&o.call(t)};if(i>0){t.addEventListener(h,f);const p=setTimeout(function(){c||f(null)},(i+s)*1e3+25);gi.set(t,ru,{id:p,stop:()=>{clearTimeout(p),t.removeEventListener(h,f)}})}l.css(u),i<=0&&f(null)});gi.set(t,ru,{stop:()=>clearTimeout(a)})}function EB(){for(let t=0;t<this.length;t++){const e=this[t],n=gi.get(e,ru);n&&(n.stop(),gi.remove(e,ru))}return this.css(Fi),this}const TB=Object.freeze(Object.defineProperty({__proto__:null,animate:_B,stop:EB},Symbol.toStringTag,{value:"Module"})),Zm={outerWidth:"offsetWidth",outerHeight:"offsetHeight",innerWidth:"clientWidth",innerHeight:"clientHeight",scrollLeft:"scrollLeft",scrollTop:"scrollTop",val:"value",text:"textContent"},Jm={disabled:"disabled",value:"value",text:"textContent"};function AB(t,e){if(!t)throw new Error("no property provided");if(arguments.length===1){const[n]=this;return n?n[t]:null}if(e===void 0)return this;for(let n=0;n<this.length;n++)this[n][t]=e;return this}function CB(t,e){let n;if(typeof t=="string")if(e===void 0){const[i]=this;return i?i.getAttribute(t):null}else n={[t]:e};else if(t)n=t;else throw new Error("no attributes provided");for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];if(Jm[i]){this.prop(Jm[i],r);continue}for(let s=0;s<this.length;s++)r===null?this[s].removeAttribute(i):this[s].setAttribute(i,r)}return this}const Fw={prop:AB,attr:CB};Object.keys(Zm).forEach(t=>{Fw[t]=function(...e){return this.prop(Zm[t],...e)}});const PB=Fw,Tr={useCSSSelectors:!1,classNamePrefix:"joint-",defaultTheme:"default",doubleTapInterval:300},rh=Object.create(null),IB=rh;rh.load={noBubble:!0};[["mouseenter","mouseover"],["mouseleave","mouseout"],["pointerenter","pointerover"],["pointerleave","pointerout"]].forEach(([t,e])=>{rh[t]={delegateType:e,bindType:e,handle:function(n){const i=this,r=n.relatedTarget,s=n.handleObj;let o;return(!r||!i.contains(r))&&(n.type=s.origType,o=s.handler.apply(i,arguments),n.type=e),o}}});const kB=Tr.doubleTapInterval,OB=30;rh.dbltap={bindType:"touchend",delegateType:"touchend",handle:function(t,...e){const{handleObj:n,target:i}=t,r=q.data.create(i),s=new Date().getTime(),o="lastTouch"in r?s-r.lastTouch:0;o<kB&&o>OB?(r.lastTouch=null,t.type=n.origType,n.handler.call(this,t,...e)):r.lastTouch=s}};Object.assign(q.fn,wB);Object.assign(q.fn,TB);Object.assign(q.fn,PB);Object.assign(q.event.special,IB);const kn=function(t){return t&&t.toString().split(" ").map(function(e){return e.substr(0,Tr.classNamePrefix.length)!==Tr.classNamePrefix&&(e=Tr.classNamePrefix+e),e}).join(" ")},LB=function(t){return t&&t.toString().split(" ").map(function(e){return e.substr(0,Tr.classNamePrefix.length)===Tr.classNamePrefix&&(e=e.substr(Tr.classNamePrefix.length)),e}).join(" ")},el=function(t,e){const n={},i={},r=L.namespace.svg,s=e||r,o=document.createDocumentFragment(),a=function(l,c,h){for(let u=0;u<l.length;u++){const d=l[u];if(typeof d=="string"){const P=document.createTextNode(d);c.appendChild(P);continue}if(!d.hasOwnProperty("tagName"))throw new Error("json-dom-parser: missing tagName");const f=d.tagName;let p;d.hasOwnProperty("namespaceURI")&&(h=d.namespaceURI),p=document.createElementNS(h,f);const g=h===r,v=g?L(p):q(p),x=d.attributes;x&&v.attr(x);const S=d.style;if(S&&q(p).css(S),d.hasOwnProperty("className")){const P=d.className;g?p.className.baseVal=P:p.className=P}if(d.hasOwnProperty("textContent")&&(p.textContent=d.textContent),d.hasOwnProperty("selector")){const P=d.selector;if(n[P])throw new Error("json-dom-parser: selector must be unique");n[P]=p,v.attr("joint-selector",P)}if(d.hasOwnProperty("groupSelector")){let P=d.groupSelector;Array.isArray(P)||(P=[P]);for(let k=0;k<P.length;k++){const N=P[k];let m=i[N];m||(m=i[N]=[]),m.push(p)}}c.appendChild(p);const C=d.children;Array.isArray(C)&&a(C,p,h)}};return a(t,o,s),{fragment:o,selectors:n,groupSelectors:i}},Da=function(t){let e=0;if(t.length===0)return e;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);e=(e<<5)-e+i,e=e&e}return e},yn=function(t,e,n){for(var i=Array.isArray(e)?e:e.split(n||"/"),r,s=0,o=i.length;s<o;)if(r=i[s++],Object(t)===t&&r in t)t=t[r];else return;return t},Vw=function(t,e){return typeof e!="string"&&typeof e!="number"&&(e=String(e)),!(e==="constructor"&&typeof t[e]=="function"||e==="__proto__")},Go=function(t,e,n,i){const r=Array.isArray(e)?e:e.split(i||"/"),s=r.length-1;let o=t,a=0;for(;a<s;a++){const l=r[a];if(!Vw(o,l))return t;o=o[l]||(o[l]={})}return o[r[s]]=n,t},Jd=function(t,e,n){const i=Array.isArray(e)?e:e.split(n||"/"),r=i.length-1;let s=t,o=0;for(;o<r;o++){const a=i[o];if(!Vw(s,a))return t;const l=s[a];if(!l)return t;s=l}return delete s[i[r]],t},qp=function(t,e,n){e=e||"/";var i={};for(var r in t)if(t.hasOwnProperty(r)){var s=typeof t[r]=="object";if(s&&n&&n(t[r])&&(s=!1),s){var o=qp(t[r],e,n);for(var a in o)o.hasOwnProperty(a)&&(i[r+e+a]=o[a])}else i[r]=t[r]}return i},Kp=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0,n=t==="x"?e:e&3|8;return n.toString(16)})},Jr=function(t){return Jr.id=Jr.id||1,t===void 0?"j_"+Jr.id++:(t.id=t.id===void 0?"j_"+Jr.id++:t.id,t.id)},zw=function(t){return t.replace(/[A-Z]/g,"-$&").toLowerCase()},at=function(t){if(t.normalized)return t;const{originalEvent:e,target:n}=t,i=e&&e.changedTouches&&e.changedTouches[0];if(i)for(let r in i)t[r]===void 0&&(t[r]=i[r]);if(n){const r=n.correspondingUseElement;r&&(t.target=r)}return t.normalized=!0,t},Gw=function(t){let r=0,s=0,o=0,a=0;return"detail"in t&&(s=t.detail),"wheelDelta"in t&&(s=-t.wheelDelta/120),"wheelDeltaY"in t&&(s=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(r=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(r=s,s=0),o="deltaX"in t?t.deltaX:r*10,a="deltaY"in t?t.deltaY:s*10,(o||a)&&t.deltaMode&&(t.deltaMode==1?(o*=40,a*=40):(o*=800,a*=800)),t.deltaX===0&&t.deltaY!==0&&t.shiftKey&&(o=a,a=0,r=s,s=0),o&&!r&&(r=o<1?-1:1),a&&!s&&(s=a<1?-1:1),{spinX:r,spinY:s,deltaX:o,deltaY:a}},Hw=function(t,e){return t>e?e:t<-e?-e:t},Ho=function(){var t;if(typeof window<"u"&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame),!t){var e=0;t=function(n){var i=new Date().getTime(),r=Math.max(0,16-(i-e)),s=setTimeout(function(){n(i+r)},r);return e=i+r,s}}return function(n,i,...r){return t(i!==void 0?n.bind(i,...r):n)}}(),ks=function(){var t,e=typeof window<"u";return e&&(t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame),t=t||clearTimeout,e?t.bind(window):t}(),je=function(t){return ne(t)&&t.slice(-1)==="%"},Uw=function(t,e){function n(a){var l=new RegExp("(?:\\d+(?:\\.\\d+)*)("+a+")$").exec(t);return l?l[1]:null}var i=parseFloat(t);if(Number.isNaN(i))return null;var r={};r.value=i;var s;if(e==null)s="[A-Za-z]*";else if(Array.isArray(e)){if(e.length===0)return null;s=e.join("|")}else ne(e)&&(s=e);var o=n(s);return o===null?null:(r.unit=o,r)},Ha=0;function MB(t,e){const n=t.split(e);let i=1;for(let r=0,s=n.length-1;r<s;r++){const o=[];(r>0||n[0]!=="")&&o.push(Ha),o.push(e),(r<s-1||n[s]!=="")&&o.push(Ha),n.splice(i,0,...o),i+=o.length+1}return n.filter(r=>r!=="")}function Qm(t,e){if(t===null)return e.getBBox().height;switch(t.unit){case"em":return e.getBBox().height*t.value;case"px":case"":return t.value}}const jw=function(t,e,n={},i={}){var r=e.width,s=e.height,o=i.svgDocument||L("svg").node,a=L("tspan").node,l=L("text").attr(n).append(a).node,c=document.createTextNode("");l.style.opacity=0,l.style.display="block",a.style.display="block",a.appendChild(c),o.appendChild(l),i.svgDocument||document.body.appendChild(o);const h=i.preserveSpaces,u=" ",d=i.separator||i.separator===""?i.separator:u,f=typeof d=="string"?d:u;var p=i.eol||`
`,g=i.hyphen?new RegExp(i.hyphen):/[^\w\d\u00C0-\u1FFF\u2800-\uFFFD]/,v=i.maxLineCount;Nt(v)||(v=1/0);var x=t.split(d),S=[],C=[],P,k,N;h&&L(a).attr("xml:space","preserve");for(var m=0,b=0,w=x.length;m<w;m++){var T=x[m];if(!(!T&&!h)&&typeof T=="string"){var E=!1;if(p&&T.indexOf(p)>=0)if(T.length>1){const At=MB(x[m],p);x.splice(m,1,...At),m--,w=x.length;continue}else{if(h&&typeof x[m-1]=="string"){x.splice(m,Ha,"",Ha),w+=2,m--;continue}C[++b]=!h||typeof x[m+1]=="string"?"":void 0,E=!0}if(!E){let At;if(h?At=C[b]!==void 0?C[b]+f+T:T:At=C[b]?C[b]+f+T:T,c.data=At,a.getComputedTextLength()<=r)C[b]=At,(P||k)&&(S[b++]=!0,P=0,k=0);else{if(!C[b]||P){var D=!!P;if(P=T.length-1,D||!P){if(!P){if(!C[b]){C=[];break}x.splice(m,2,T+x[m+1]),w--,S[b++]=!0,m--;continue}x[m]=T.substring(0,P);const vt=x[m+1];x[m+1]=T.substring(P)+(vt===void 0||vt===Ha?"":vt)}else{if(k)x.splice(m,2,x[m]+x[m+1]),k=0;else{var $=T.search(g);$>-1&&$!==T.length-1&&$!==0&&(k=$+1,P=0),x.splice(m,1,T.substring(0,k||P),T.substring(k||P)),w++}b&&!S[b-1]&&b--}(!h||C[b]!=="")&&m--;continue}b++,m--}}var z=null;if(C.length>v)z=v-1;else if(s!==void 0){if(N===void 0&&c.data!=="")if(n.lineHeight==="auto")N=Qm({value:1.5,unit:"em"},l);else{const At=Uw(n.lineHeight,["em","px",""]);N=Qm(At,l)}N*C.length>s&&(z=Math.floor(s/N)-1)}if(z!==null){C.splice(z+1);var j=i.ellipsis;if(!j||z<0)break;typeof j!="string"&&(j="");var O=C[z];if(!O&&!E)break;var B=O.length,V,F;do{if(F=O[B],V=O.substring(0,B),F?F.match(d)&&(V+=F):V+=f,V+=j,c.data=V,a.getComputedTextLength()<=r){C[z]=V;break}B--}while(B>=0);break}}}return i.svgDocument?o.removeChild(l):document.body.removeChild(o),C.join(p)},Ww=function(t){const[e]=q.parseHTML("<div>"+t+"</div>");return Array.from(e.getElementsByTagName("*")).forEach(function(n){n.getAttributeNames().forEach(function(r){const s=n.getAttribute(r);(r.startsWith("on")||s.startsWith("javascript:"))&&n.removeAttribute(r)})}),e.innerHTML},Yw=function(t,e){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(t,e);else{var n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n)}},Xw=function(t,e){const n=qw(t);Yw(n,e)},qw=function(t){t=t.replace(/\s/g,""),t=decodeURIComponent(t);var e=t.indexOf(","),n=t.slice(0,e),i=n.split(":")[1].split(";")[0],r=t.slice(e+1),s;n.indexOf("base64")>=0?s=atob(r):s=unescape(encodeURIComponent(r));for(var o=new Uint8Array(s.length),a=0;a<s.length;a++)o[a]=s.charCodeAt(a);return new Blob([o],{type:i})},Zp=function(t,e){if(!t||t.substr(0,5)==="data:")return setTimeout(function(){e(null,t)},0);var n=function(s,o){if(s.status===200){var a=new FileReader;a.onload=function(l){var c=l.target.result;o(null,c)},a.onerror=function(){o(new Error("Failed to load image "+t))},a.readAsDataURL(s.response)}else o(new Error("Failed to load image "+t))},i=function(s,o){var a=function(f){for(var p=32768,g=[],v=0;v<f.length;v+=p)g.push(String.fromCharCode.apply(null,f.subarray(v,v+p)));return g.join("")};if(s.status===200){var l=new Uint8Array(s.response),c=t.split(".").pop()||"png",h={svg:"svg+xml"},u="data:image/"+(h[c]||c)+";base64,",d=u+btoa(a(l));o(null,d)}else o(new Error("Failed to load image "+t))},r=new XMLHttpRequest;r.open("GET",t,!0),r.addEventListener("error",function(){e(new Error("Failed to load image "+t))}),r.responseType=window.FileReader?"blob":"arraybuffer",r.addEventListener("load",function(){window.FileReader?n(r,e):i(r,e)}),r.send()},ws=function(t){var e=q(t);if(e.length===0)throw new Error("Element not found");var n=e[0],i=n.ownerDocument,r=n.getBoundingClientRect(),s=0,o=0;if(n.ownerSVGElement){var a=L(n),l=a.getBBox({target:a.svg()});s=r.width-l.width,o=r.height-l.height}return{x:r.left+window.pageXOffset-i.documentElement.offsetLeft+s/2,y:r.top+window.pageYOffset-i.documentElement.offsetTop+o/2,width:r.width-s,height:r.height-o}},Kw=function(t,e){t=q(t).toArray();var n=t.map(function(r){var s=r.parentNode,o=s.insertBefore(document.createTextNode(""),r.nextSibling);return function(){if(s===this)throw new Error("You can't sort elements if any one is a descendant of another.");s.insertBefore(this,o),s.removeChild(o)}});t.sort(e);for(var i=0;i<n.length;i++)n[i].call(t[i]);return t},Ns=function(t,e){var n=q(t);Jt(e,function(i,r){var s=n.find(r).addBack().filter(r);di(i,"class")&&(s.addClass(i.class),i=Qe(i,"class")),s.attr(i)})},Re=function(t){if(Object(t)!==t){var e=0;return isFinite(t)&&(e=+t),{top:e,right:e,bottom:e,left:e}}var n,i,r,s;return n=i=r=s=0,isFinite(t.vertical)&&(n=r=+t.vertical),isFinite(t.horizontal)&&(i=s=+t.horizontal),isFinite(t.top)&&(n=+t.top),isFinite(t.right)&&(i=+t.right),isFinite(t.bottom)&&(r=+t.bottom),isFinite(t.left)&&(s=+t.left),{top:n,right:i,bottom:r,left:s}},Zw={linear:function(t){return t},quad:function(t){return t*t},cubic:function(t){return t*t*t},inout:function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)},exponential:function(t){return Math.pow(2,10*(t-1))},bounce:function(t){for(var e=0,n=1;;e+=n,n/=2)if(t>=(7-4*e)/11){var i=(11-6*e-11*t)/4;return-i*i+n*n}},reverse:function(t){return function(e){return 1-t(1-e)}},reflect:function(t){return function(e){return .5*(e<.5?t(2*e):2-t(2-2*e))}},clamp:function(t,e,n){return e=e||0,n=n||1,function(i){var r=t(i);return r<e?e:r>n?n:r}},back:function(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}},elastic:function(t){return t||(t=1.5),function(e){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}}},Jp={number:function(t,e){var n=e-t;return function(i){return t+n*i}},object:function(t,e){var n=Object.keys(t);return function(i){var r,s,o={};for(r=n.length-1;r!=-1;r--)s=n[r],o[s]=t[s]+(e[s]-t[s])*i;return o}},hexColor:function(t,e){var n=parseInt(t.slice(1),16),i=parseInt(e.slice(1),16),r=n&255,s=(i&255)-r,o=n&65280,a=(i&65280)-o,l=n&16711680,c=(i&16711680)-l;return function(h){var u=r+s*h&255,d=o+a*h&65280,f=l+c*h&16711680;return"#"+(1<<24|u|d|f).toString(16).slice(1)}},unit:function(t,e){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,i=n.exec(t),r=n.exec(e),s=r[1].indexOf("."),o=s>0?r[1].length-s-1:0;t=+i[1];var a=+r[1]-t,l=i[2];return function(c){return(t+a*c).toFixed(o)+l}}},Jw={outline:function(t){var e='<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${outerRadius}" /><feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${innerRadius}" /><feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/><feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/><feMerge><feMergeNode in="outline"/><feMergeNode in="SourceGraphic"/></feMerge></filter>',n=Number.isFinite(t.margin)?t.margin:2,i=Number.isFinite(t.width)?t.width:1;return Xn(e)({color:t.color||"blue",opacity:Number.isFinite(t.opacity)?t.opacity:1,outerRadius:n+i,innerRadius:n})},highlight:function(t){var e='<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${width}"/><feComposite result="composed" in="colored" in2="morphed" operator="in"/><feGaussianBlur result="blured" in="composed" stdDeviation="${blur}"/><feBlend in="SourceGraphic" in2="blured" mode="normal"/></filter>';return Xn(e)({color:t.color||"red",width:Number.isFinite(t.width)?t.width:1,blur:Number.isFinite(t.blur)?t.blur:0,opacity:Number.isFinite(t.opacity)?t.opacity:1})},blur:function(t){var e=Number.isFinite(t.x)?t.x:2;return Xn('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>')({stdDeviation:Number.isFinite(t.y)?[e,t.y]:e})},dropShadow:function(t){var e="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return Xn(e)({dx:t.dx||0,dy:t.dy||0,opacity:Number.isFinite(t.opacity)?t.opacity:1,color:t.color||"black",blur:Number.isFinite(t.blur)?t.blur:4})},grayscale:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Xn('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>')({a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},sepia:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Xn('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>')({a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},saturate:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Xn('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>')({amount:1-e})},hueRotate:function(t){return Xn('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>')({angle:t.angle||0})},invert:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Xn('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:1-e})},brightness:function(t){return Xn('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>')({amount:Number.isFinite(t.amount)?t.amount:1})},contrast:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Xn('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:.5-e/2})}},nl={number:function(t,e,n){n=n||{currency:["$",""],decimal:".",thousands:",",grouping:[3]};var i=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,r=i.exec(t),s=r[1]||" ",o=r[2]||">",a=r[3]||"",l=r[4]||"",c=r[5],h=+r[6],u=r[7],d=r[8],f=r[9],p=1,g="",v="",x=!1;switch(d&&(d=+d.substring(1)),(c||s==="0"&&o==="=")&&(c=s="0",o="=",u&&(h-=Math.floor((h-1)/4))),f){case"n":u=!0,f="g";break;case"%":p=100,v="%",f="f";break;case"p":p=100,v="%",f="r";break;case"b":case"o":case"x":case"X":l==="#"&&(g="0"+f.toLowerCase());break;case"c":case"d":x=!0,d=0;break;case"s":p=-1,f="r";break}l==="$"&&(g=n.currency[0],v=n.currency[1]),f=="r"&&!d&&(f="g"),d!=null&&(f=="g"?d=Math.max(1,Math.min(21,d)):(f=="e"||f=="f")&&(d=Math.max(0,Math.min(20,d))));var S=c&&u;if(x&&e%1)return"";var C=e<0||e===0&&1/e<0?(e=-e,"-"):a,P=v;if(p<0){var k=this.prefix(e,d);e=k.scale(e),P=k.symbol+v}else e*=p;e=this.convert(f,e,d);var N=e.lastIndexOf("."),m=N<0?e:e.substring(0,N),b=N<0?"":n.decimal+e.substring(N+1);function w(D){for(var $=D.length,z=[],j=0,O=n.grouping[0];$>0&&O>0;)z.push(D.substring($-=O,$+O)),O=n.grouping[j=(j+1)%n.grouping.length];return z.reverse().join(n.thousands)}!c&&u&&n.grouping&&(m=w(m));var T=g.length+m.length+b.length+(S?0:C.length),E=T<h?new Array(T=h-T+1).join(s):"";return S&&(m=w(E+m)),C+=g,e=m+b,(o==="<"?C+e+E:o===">"?E+C+e:o==="^"?E.substring(0,T>>=1)+C+e+E.substring(T):C+(S?e:E+e))+P},string:function(t,e){for(var n,i="{",r=!1,s=[];(n=t.indexOf(i))!==-1;){var o,a,l;if(o=t.slice(0,n),r){a=o.split(":"),l=a.shift().split("."),o=e;for(var c=0;c<l.length;c++)o=o[l[c]];a.length&&(o=this.number(a,o))}s.push(o),t=t.slice(n+1),r=!r,i=r?"}":"{"}return s.push(t),s.join("")},convert:function(t,e,n){switch(t){case"b":return e.toString(2);case"c":return String.fromCharCode(e);case"o":return e.toString(8);case"x":return e.toString(16);case"X":return e.toString(16).toUpperCase();case"g":return e.toPrecision(n);case"e":return e.toExponential(n);case"f":return e.toFixed(n);case"r":return(e=this.round(e,this.precision(e,n))).toFixed(Math.max(0,Math.min(20,this.precision(e*(1+1e-15),n))));default:return e+""}},round:function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},precision:function(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)},prefix:function(t,e){var n=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(function(r,s){var o=Math.pow(10,Math.abs(8-s)*3);return{scale:s>8?function(a){return a/o}:function(a){return a*o},symbol:r}}),i=0;return t&&(t<0&&(t*=-1),e&&(t=this.round(t,this.precision(t,e))),i=1+Math.floor(1e-12+Math.log(t)/Math.LN10),i=Math.max(-24,Math.min(24,Math.floor((i<=0?i+1:i-1)/3)*3))),n[8+i/3]}},Xn=function(t){var e=/<%= ([^ ]+) %>|\$\{ ?([^{} ]+) ?\}|\{\{([^{} ]+)\}\}/g;return function(n){return n=n||{},t.replace(e,function(i){for(var r=Array.from(arguments),s=r.slice(1,4).find(function(l){return!!l}),o=s.split("."),a=n[o.shift()];a!==void 0&&o.length;)a=a[o.shift()];return a!==void 0?a:""})}},Qw=function(t){var e=window.top.document;t=t||e.body;function n(i,r){for(var s=["webkit","moz","ms","o",""],o=0;o<s.length;o++){var a=s[o],l=a?a+r:r.substr(0,1).toLowerCase()+r.substr(1);if(i[l]!==void 0)return _t(i[l])?i[l]():i[l]}}n(e,"FullscreenElement")||n(e,"FullScreenElement")?n(e,"ExitFullscreen")||n(e,"CancelFullScreen"):n(t,"RequestFullscreen")||n(t,"RequestFullScreen")},go=function(){};var rn={},tv=/\s+/,Ur,Ws=function(t,e,n,i,r){var s=0,o;if(n&&typeof n=="object")for(i!==void 0&&("context"in r)&&r.context===void 0&&(r.context=i),o=Object.keys(n);s<o.length;s++)e=Ws(t,e,o[s],n[o[s]],r);else if(n&&tv.test(n))for(o=n.split(tv);s<o.length;s++)e=t(e,o[s],i,r);else e=t(e,n,i,r);return e};rn.on=function(t,e,n){if(this._events=Ws(DB,this._events||{},t,e,{context:n,ctx:this,listening:Ur}),Ur){var i=this._listeners||(this._listeners={});i[Ur.id]=Ur,Ur.interop=!1}return this};rn.listenTo=function(t,e,n){if(!t)return this;var i=t._listenId||(t._listenId=es("l")),r=this._listeningTo||(this._listeningTo={}),s=Ur=r[i];s||(this._listenId||(this._listenId=es("l")),s=Ur=r[i]=new sh(this,t));var o=NB(t,e,n,this);if(Ur=void 0,o)throw o;return s.interop&&s.on(e,n),this};var DB=function(t,e,n,i){if(n){var r=t[e]||(t[e]=[]),s=i.context,o=i.ctx,a=i.listening;a&&a.count++,r.push({callback:n,context:s,ctx:s||o,listening:a})}return t},NB=function(t,e,n,i){try{t.on(e,n,i)}catch(r){return r}};rn.off=function(t,e,n){return this._events?(this._events=Ws(t_,this._events,t,e,{context:n,listeners:this._listeners}),this):this};rn.stopListening=function(t,e,n){var i=this._listeningTo;if(!i)return this;for(var r=t?[t._listenId]:Object.keys(i),s=0;s<r.length;s++){var o=i[r[s]];if(!o)break;o.obj.off(e,n,this),o.interop&&o.off(e,n)}return En(i)&&(this._listeningTo=void 0),this};var t_=function(t,e,n,i){if(t){var r=i.context,s=i.listeners,o=0,a;if(!e&&!r&&!n){if(s!=null)for(a=Object.keys(s);o<a.length;o++)s[a[o]].cleanup();return}for(a=e?[e]:Object.keys(t);o<a.length;o++){e=a[o];var l=t[e];if(!l)break;for(var c=[],h=0;h<l.length;h++){var u=l[h];if(n&&n!==u.callback&&n!==u.callback._callback||r&&r!==u.context)c.push(u);else{var d=u.listening;d&&d.off(e,n)}}c.length?t[e]=c:delete t[e]}return t}};rn.once=function(t,e,n){var i=Ws(e_,{},t,e,this.off.bind(this));return typeof t=="string"&&n==null&&(e=void 0),this.on(i,e,n)};rn.listenToOnce=function(t,e,n){var i=Ws(e_,{},e,n,this.stopListening.bind(this,t));return this.listenTo(t,i)};var e_=function(t,e,n,i){if(n){var r=t[e]=RB(function(){i(e,r),n.apply(this,arguments)});r._callback=n}return t},RB=function(t){var e;if(typeof t!="function")throw new TypeError("Expected a function");var n=2;return function(){return--n>0&&(e=t.apply(this,arguments)),n<=1&&(t=void 0),e}};rn.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),i=0;i<e;i++)n[i]=arguments[i+1];return Ws($B,this._events,t,void 0,n),this};var $B=function(t,e,n,i){if(t){var r=t[e],s=t.all;r&&s&&(s=s.slice()),r&&ev(r,i),s&&ev(s,[e].concat(i))}return t},ev=function(t,e){var n,i=-1,r=t.length,s=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o,a);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}},sh=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0};sh.prototype.on=rn.on;sh.prototype.off=function(t,e){var n;this.interop?(this._events=Ws(t_,this._events,t,e,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=this.count===0),n&&this.cleanup()};sh.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]};rn.bind=rn.on;rn.unbind=rn.off;var Qp=function(t,e){var n=this,i;return t&&di(t,"constructor")?i=t.constructor:i=function(){return n.apply(this,arguments)},H(i,n,e),i.prototype=Object.assign(Object.create(n.prototype),t),i.prototype.constructor=i,i.__super__=n.prototype,i},BB=function(t,e,n,i){switch(e){case 1:return function(){return t[n](this[i])};case 2:return function(r){return t[n](this[i],r)};case 3:return function(r,s){return t[n](this[i],nv(r,this),s)};case 4:return function(r,s,o){return t[n](this[i],nv(r,this),s,o)};default:return function(){var r=Array.prototype.slice.call(arguments);return r.unshift(this[i]),t[n].apply(t,r)}}},FB=function(t,e,n,i){Jt(n,function(r,s){e[s]&&(t.prototype[s]=BB(e,r,s,i))})},nv=function(t,e){return _t(t)?t:Vt(t)&&!e._isModel(t)?VB(t):ne(t)?function(n){return n.get(t)}:t},VB=function(t){var e=z3(t);return function(n){return e(n.attributes)}},gn=function(t,e){var n=t||{};e||(e={}),this.preinitialize.apply(this,arguments),this.cid=es(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection);var i=ee(this,"defaults");n=me(H({},i,n),i),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};H(gn.prototype,rn,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(t){return we(this.attributes)},get:function(t){return this.attributes[t]},has:function(t){return this.get(t)!=null},set:function(t,e,n){if(t==null)return this;var i;if(typeof t=="object"?(i=t,n=e):(i={})[t]=e,n||(n={}),!this._validate(i,n))return!1;var r=n.unset,s=n.silent,o=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=we(this.attributes),this.changed={});var l=this.attributes,c=this.changed,h=this._previousAttributes;for(var u in i)e=i[u],ke(l[u],e)||o.push(u),ke(h[u],e)?delete c[u]:c[u]=e,r?delete l[u]:l[u]=e;if(this.idAttribute in i){var d=this.id;this.id=this.get(this.idAttribute),this.trigger("changeId",this,d,n)}if(!s){o.length&&(this._pending=n);for(var f=0;f<o.length;f++)this.trigger("change:"+o[f],this,l[o[f]],n)}if(a)return this;if(!s)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,H({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,H({},t,{unset:!0}))},hasChanged:function(t){return t==null?!En(this.changed):di(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?we(this.changed):!1;var e=this._changing?this._previousAttributes:this.attributes,n={},i;for(var r in t){var s=t[r];ke(e[r],s)||(n[r]=s,i=!0)}return i?n:!1},previous:function(t){return t==null||!this._previousAttributes?null:this._previousAttributes[t]},previousAttributes:function(){return we(this._previousAttributes)},clone:function(){return new this.constructor(this.attributes)},isValid:function(t){return this._validate({},H({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=H({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,H(e,{validationError:n})),!1):!0}});gn.extend=Qp;function tg(t){t=Ii(t);const e=pt(t).reduce(function(n,i){return n[i.id]=i.clone(),n},{});return pt(t).forEach(function(n){const i=e[n.id];if(i.isLink()){const o=i.source(),a=i.target();o.id&&e[o.id]&&i.prop("source/id",e[o.id].id),a.id&&e[a.id]&&i.prop("target/id",e[a.id].id)}const r=n.get("parent");r&&e[r]&&i.set("parent",e[r].id);const s=pt(n.get("embeds")).reduce(function(o,a){return e[a]&&o.push(e[a].id),o},[]);En(s)||i.set("embeds",s)}),e}const zB=["checked","selected","disabled","readOnly","contentEditable","value","indeterminate"],GB=zB.reduce((t,e)=>(t[e]=!0,t),{}),HB={qualify:function(t){return Ce(t)},set:function(t,e,n){Object.keys(t).forEach(function(i){if(GB[i]&&i in n){const r=t[i];n.tagName==="SELECT"&&Array.isArray(r)?Array.from(n.options).forEach(function(s,o){s.selected=r.includes(s.value)}):n[i]=r}})}},UB=HB;function dc(t,e,n){return function(i,r){var s=je(i);i=parseFloat(i),s&&(i/=100);var o;if(isFinite(i)){var a=r[n]();s||i>0&&i<1?o=a[t]+r[e]*i:o=a[t]+i}var l=M();return l[t]=o||0,l}}function Fr(t,e){return function(n,i){var r=je(n);n=parseFloat(n),r&&(n/=100);var s={};if(isFinite(n)){var o=r||n>=0&&n<=1?n*i[e]:Math.max(n+i[e],0);s[t]=o}return s}}const zn={"ref-x":{position:dc("x","width","origin")},"ref-y":{position:dc("y","height","origin")},"ref-dx":{position:dc("x","width","corner")},"ref-dy":{position:dc("y","height","corner")},"ref-width":{set:Fr("width","width")},"ref-height":{set:Fr("height","height")},"ref-rx":{set:Fr("rx","width")},"ref-ry":{set:Fr("ry","height")},"ref-cx":{set:Fr("cx","width")},"ref-cy":{set:Fr("cy","height")},"ref-r-inscribed":{set:function(t){var e=Fr(t,"width"),n=Fr(t,"height");return function(i,r){var s=r.height>r.width?e:n;return s(i,r)}}("r")},"ref-r-circumscribed":{set:function(t,e){var n=je(t);t=parseFloat(t),n&&(t/=100);var i=Math.sqrt(e.height*e.height+e.width*e.width),r;return isFinite(t)&&(n||t>=0&&t<=1?r=t*i:r=Math.max(t+i,0)),{r}}}};zn.refX=zn["ref-x"];zn.refY=zn["ref-y"];zn["ref-x2"]=zn["ref-x"];zn["ref-y2"]=zn["ref-y"];zn["ref-width2"]=zn["ref-width"];zn["ref-height2"]=zn["ref-height"];zn["ref-r"]=zn["ref-r-inscribed"];const jB=zn,ur={x:"x",y:"y",width:"w",height:"h",minimum:"s",maximum:"l",diagonal:"d"},WB=Object.keys(ur).map(t=>ur[t]).join(""),Wh="[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?",YB=/\s/g,iv=new RegExp(`^(${Wh}\\*)?([${WB}])(/${Wh})?([-+]{1,2}${Wh})?$`,"g");function n_(t){throw new Error(`Invalid calc() expression: ${t}`)}function XB(t,e){const n=iv.exec(t.replace(YB,""));n||n_(t),iv.lastIndex=0;const[,i,r,s,o]=n,{x:a,y:l,width:c,height:h}=e;let u=0;switch(r){case ur.width:{u=c;break}case ur.height:{u=h;break}case ur.x:{u=a;break}case ur.y:{u=l;break}case ur.minimum:{u=Math.min(h,c);break}case ur.maximum:{u=Math.max(h,c);break}case ur.diagonal:{u=Math.sqrt(h*h+c*c);break}}return i&&(u*=parseFloat(i)),s&&(u/=parseFloat(s.slice(1))),o&&(u+=qB(o)),u}function qB(t){if(!t)return 0;const[e]=t;switch(e){case"+":return parseFloat(t.substr(1));case"-":return-parseFloat(t.substr(1))}return parseFloat(t)}function Pr(t){return typeof t=="string"&&t.includes("calc")}const i_="calc(",rv=i_.length;function Ir(t,e){let n=t,i=0;do{let r=n.indexOf(i_,i);if(r===-1)return n;let s=r+rv,o=1;t:do{switch(n[s]){case"(":{o++;break}case")":{if(o--,o===0)break t;break}case void 0:n_(n)}s++}while(!0);let a=n.slice(r+rv,s);Pr(a)&&(a=Ir(a,e));const l=String(XB(a,e));n=n.slice(0,r)+l+n.slice(s+1),i=r+l.length}while(!0)}function oo(t,e,n){return n.text!==void 0}const r_={"line-height":{qualify:oo},"text-vertical-anchor":{qualify:oo},"text-path":{qualify:oo},annotations:{qualify:oo},eol:{qualify:oo},"display-empty":{qualify:oo},text:{qualify:function(t,e,n){const i=n["text-wrap"];return!i||!Ce(i)},set:function(t,e,n,i){const r="joint-text",s=q.data.get(n,r),o=i["line-height"],a=i["text-vertical-anchor"],l=i["display-empty"],c=i["font-size"],h=i.annotations,u=i.eol,d=i.x;let f=i["text-path"];const p=JSON.stringify([t,o,h,a,u,l,f,d,c]);if(s===void 0||s!==p){if(c&&n.setAttribute("font-size",c),Vt(f)){const g=f.selector;if(typeof g=="string"){const v=this.findNode(g);v instanceof SVGPathElement&&(f=H({"xlink:href":"#"+v.id},f))}}L(n).text(""+t,{lineHeight:o,annotations:h,textPath:f,x:d,textVerticalAnchor:a,eol:u,displayEmpty:l}),q.data.set(n,r,p)}}},"text-wrap":{qualify:Ce,set:function(t,e,n,i){var r={},s=t.width||0;je(s)?r.width=e.width*parseFloat(s)/100:Pr(s)?r.width=Number(Ir(s,e)):t.width===null?r.width=1/0:s<=0?r.width=e.width+s:r.width=s;var o=t.height||0;je(o)?r.height=e.height*parseFloat(o)/100:Pr(o)?r.height=Number(Ir(o,e)):t.height===null||(o<=0?r.height=e.height+o:r.height=o);var a,l=t.text;if(l===void 0&&(l=i.text),l!==void 0){const c=t.breakText||jw,h=getComputedStyle(n);a=c(""+l,r,{"font-weight":h.fontWeight,"font-family":h.fontFamily,"text-transform":h.textTransform,"font-size":h.fontSize,"letter-spacing":h.letterSpacing,lineHeight:i["line-height"]},{svgDocument:this.paper.svg,ellipsis:t.ellipsis,hyphen:t.hyphen,separator:t.separator,maxLineCount:t.maxLineCount,preserveSpaces:t.preserveSpaces})}else a="";r_.text.set.call(this,a,e,n,i)}},title:{qualify:function(t,e){return e instanceof SVGElement},set:function(t,e,n){var i="joint-title",r=q.data.get(n,i);if(r===void 0||r!==t){if(q.data.set(n,i,t),n.tagName==="title"){n.textContent=t;return}var s=n.firstElementChild;if(s&&s.tagName==="title")s.textContent=t;else{var o=document.createElementNS(n.namespaceURI,"title");o.textContent=t,n.insertBefore(o,s)}}}}},KB=r_;function fc(t,e){var n=new M(1,0);return function(i){var r,s,o=this[t](i);return o?(s=e.rotate?o.vector().vectorAngle(n):0,r=o.start):(r=this.path.start,s=0),s===0?{transform:"translate("+r.x+","+r.y+")"}:{transform:"translate("+r.x+","+r.y+") rotate("+s+")"}}}function Aa(){return this.model.isLink()}const il={connection:{qualify:Aa,set:function({stubs:t=0}){let e;if(isFinite(t)&&t!==0){let n;t<0?n=(this.getConnectionLength()+t)/2:n=t;const i=this.getConnection(),r=this.getConnectionSubdivisions(),s=i.divideAtLength(n,{segmentSubdivisions:r}),o=i.divideAtLength(-n,{segmentSubdivisions:r});s&&o&&(e=`${s[0].serialize()} ${o[1].serialize()}`)}return{d:e||this.getSerializedConnection()}}},"at-connection-length-keep-gradient":{qualify:Aa,set:fc("getTangentAtLength",{rotate:!0})},"at-connection-length-ignore-gradient":{qualify:Aa,set:fc("getTangentAtLength",{rotate:!1})},"at-connection-ratio-keep-gradient":{qualify:Aa,set:fc("getTangentAtRatio",{rotate:!0})},"at-connection-ratio-ignore-gradient":{qualify:Aa,set:fc("getTangentAtRatio",{rotate:!1})}};il["at-connection-length"]=il["at-connection-length-keep-gradient"];il["at-connection-ratio"]=il["at-connection-ratio-keep-gradient"];const ZB=il;function s_(t,e){var n="joint-shape",i=e&&e.resetOffset;return function(r,s,o){var a=q.data.get(o,n);if(!a||a.value!==r){var l=t(r);a={value:r,shape:l,shapeBBox:l.bbox()},q.data.set(o,n,a)}var c=a.shape.clone(),h=a.shapeBBox.clone(),u=h.origin(),d=s.origin();h.x=d.x,h.y=d.y;var f=s.maxRectScaleToFit(h,d),p=h.width===0||s.width===0?1:f.sx,g=h.height===0||s.height===0?1:f.sy;return c.scale(p,g,u),i&&c.translate(-u.x,-u.y),c}}function sv(t){function e(i){return new K(L.normalizePathData(i))}var n=s_(e,t);return function(i,r,s){var o=n(i,r,s);return{d:o.serialize()}}}function ov(t){var e=s_(_e,t);return function(n,i,r){var s=e(n,i,r);return{points:s.serialize()}}}const rl={"ref-d-reset-offset":{set:sv({resetOffset:!0})},"ref-d-keep-offset":{set:sv({resetOffset:!1})},"ref-points-reset-offset":{set:ov({resetOffset:!0})},"ref-points-keep-offset":{set:ov({resetOffset:!1})}};rl["ref-d"]=rl["ref-d-reset-offset"];rl["ref-points"]=rl["ref-points-reset-offset"];const JB=rl;function Yh(t){var e={},n=t.stroke;typeof n=="string"&&(e.stroke=n,e.fill=n);var i=t["stroke-opacity"];return i===void 0&&(i=t.opacity),i!==void 0&&(e["stroke-opacity"]=i,e["fill-opacity"]=i),e}function av(t){const{paper:e}=this;return`url(#${t.type==="pattern"?e.definePattern(t):e.defineGradient(t)})`}const QB={"source-marker":{qualify:Ce,set:function(t,e,n,i){return t=H(Yh(i),t),{"marker-start":"url(#"+this.paper.defineMarker(t)+")"}}},"target-marker":{qualify:Ce,set:function(t,e,n,i){return t=H(Yh(i),{transform:"rotate(180)"},t),{"marker-end":"url(#"+this.paper.defineMarker(t)+")"}}},"vertex-marker":{qualify:Ce,set:function(t,e,n,i){return t=H(Yh(i),t),{"marker-mid":"url(#"+this.paper.defineMarker(t)+")"}}},fill:{qualify:Ce,set:av},stroke:{qualify:Ce,set:av},filter:{qualify:Ce,set:function(t){return"url(#"+this.paper.defineFilter(t)+")"}}},tF=QB;function lv(t,e,n){return function(i,r){var s;i==="middle"?s=r[e]/2:i===n?s=r[e]:isFinite(i)?s=i>-1&&i<1?-r[e]*i:-i:je(i)?s=r[e]*parseFloat(i)/100:s=0;var o=new M;return o[t]=-(r[t]+s),o}}const eF={"x-alignment":{offset:lv("x","width","right")},"y-alignment":{offset:lv("y","height","bottom")},"reset-offset":{offset:function(t,e){return t?{x:-e.x,y:-e.y}:{x:0,y:0}}}},nF=eF;function cv(t){return function(n,i,r){const s=L(r);s.attr(t)!==n&&s.attr(t,n)}}const Ys={ref:{},href:{set:cv("href")},"xlink:href":{set:cv("xlink:href")},port:{set:function(t){return t===null||t.id===void 0?t:t.id}},style:{qualify:Ce,set:function(t,e,n){q(n).css(t)}},html:{set:function(t,e,n){q(n).html(t+"")}},props:UB};H(Ys,jB);H(Ys,KB);H(Ys,ZB);H(Ys,JB);H(Ys,tF);H(Ys,nF);const aa=Ys,iF=function(t,e){if(Array.isArray(t))return e},an=gn.extend({constructor:function(t,e){var n,i=t||{};if(typeof this.preinitialize=="function"&&this.preinitialize.apply(this,arguments),this.cid=es("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(i=this.parse(i,e)||{}),n=ee(this,"defaults")){const r=e&&e.mergeArrays===!0?!1:iF;i=Te({},n,i,r)}this.set(i,e),this.changed={},this.initialize.apply(this,arguments)},translate:function(t,e,n){throw new Error("Must define a translate() method.")},toJSON:function(){const e=ee(this.constructor.prototype,"defaults").attrs||{},n=this.attributes.attrs,i={};Jt(n,function(s,o){const a=e[o];Jt(s,function(l,c){Vt(l)&&!Array.isArray(l)?Jt(l,function(h,u){(!a||!a[c]||!ke(a[c][u],h))&&(i[o]=i[o]||{},(i[o][c]||(i[o][c]={}))[u]=h)}):(!a||!ke(a[c],l))&&(i[o]=i[o]||{},i[o][c]=l)})});const r=Le(Qe(this.attributes,"attrs"));return r.attrs=i,r},initialize:function(t){const e=this.getIdAttribute();(!t||t[e]===void 0)&&this.set(e,this.generateId(),{silent:!0}),this._transitionIds={},this._scheduledTransitionIds={},this.processPorts(),this.on("change:attrs",this.processPorts,this)},getIdAttribute:function(){return this.idAttribute||"id"},generateId:function(){return Kp()},processPorts:function(){var t=this.ports,e={};Jt(this.get("attrs"),function(s,o){s&&s.port&&(s.port.id!==void 0?e[s.port.id]=s.port:e[s.port]={id:s.port})});var n={};if(Jt(t,function(s,o){e[o]||(n[o]=!0)}),this.graph&&!En(n)){var i=this.graph.getConnectedLinks(this,{inbound:!0});i.forEach(function(s){n[s.get("target").port]&&s.remove()});var r=this.graph.getConnectedLinks(this,{outbound:!0});r.forEach(function(s){n[s.get("source").port]&&s.remove()})}this.ports=e},remove:function(t={}){const{graph:e,collection:n}=this;if(!e)return n&&n.remove(this,t),this;e.startBatch("remove");const i=this.getParentCell();i&&i.unembed(this,t);const r=this.getEmbeddedCells();for(let s=0,o=r.length;s<o;s++){const a=r[s];a&&a.remove(t)}return this.trigger("remove",this,e.attributes.cells,t),e.stopBatch("remove"),this},toFront:function(t){var e=this.graph;if(e){t=me(t||{},{foregroundEmbeds:!0});let n;t.deep?(n=this.getEmbeddedCells({deep:!0,breadthFirst:t.breadthFirst!==!1,sortSiblings:t.foregroundEmbeds}),n.unshift(this)):n=[this];const i=t.foregroundEmbeds?n:tn(n,l=>l.z());let s=e.maxZIndex()-n.length+1;const o=e.get("cells");let a=o.toArray().indexOf(i[0])!==o.length-n.length;a||(a=i.some(function(l,c){return l.z()!==s+c})),a&&(this.startBatch("to-front"),s=s+n.length,i.forEach(function(l,c){l.set("z",s+c,t)}),this.stopBatch("to-front"))}return this},toBack:function(t){var e=this.graph;if(e){t=me(t||{},{foregroundEmbeds:!0});let i;t.deep?(i=this.getEmbeddedCells({deep:!0,breadthFirst:t.breadthFirst!==!1,sortSiblings:t.foregroundEmbeds}),i.unshift(this)):i=[this];const r=t.foregroundEmbeds?i:tn(i,a=>a.z());let s=e.minZIndex();var n=e.get("cells");let o=n.toArray().indexOf(r[0])!==0;o||(o=r.some(function(a,l){return a.z()!==s+l})),o&&(this.startBatch("to-back"),s-=i.length,r.forEach(function(a,l){a.set("z",s+l,t)}),this.stopBatch("to-back"))}return this},parent:function(t,e){return t===void 0?this.get("parent"):this.set("parent",t,e)},embed:function(t,e){const n=Array.isArray(t)?t:[t];if(!this.canEmbed(n))throw new Error("Recursive embedding not allowed.");if(n.some(i=>i.isEmbedded()&&this.id!==i.parent()))throw new Error("Embedding of already embedded cells is not allowed.");return this._embedCells(n,e),this},unembed:function(t,e){const n=Array.isArray(t)?t:[t];return this._unembedCells(n,e),this},canEmbed:function(t){return(Array.isArray(t)?t:[t]).every(n=>this!==n&&!this.isEmbeddedIn(n))},_embedCells:function(t,e){const n="embed";this.startBatch(n);const i=H([],this.get("embeds"));t.forEach(r=>{i[r.isLink()?"unshift":"push"](r.id),r.parent(this.id,e)}),this.set("embeds",Ii(i),e),this.stopBatch(n)},_unembedCells:function(t,e){const n="unembed";this.startBatch(n),t.forEach(i=>i.unset("parent",e)),this.set("embeds",Vo(this.get("embeds"),...t.map(i=>i.id)),e),this.stopBatch(n)},getParentCell:function(){var t=this.parent(),e=this.graph;return t&&e&&e.getCell(t)||null},getAncestors:function(){var t=[];if(!this.graph)return t;for(var e=this.getParentCell();e;)t.push(e),e=e.getParentCell();return t},getEmbeddedCells:function(t){if(t=t||{},!this.graph)return[];if(t.deep)return t.breadthFirst?this._getEmbeddedCellsBfs(t.sortSiblings):this._getEmbeddedCellsDfs(t.sortSiblings);const e=this.get("embeds");if(En(e))return[];let n=e.map(this.graph.getCell,this.graph);return t.sortSiblings&&(n=tn(n,i=>i.z())),n},_getEmbeddedCellsBfs:function(t){const e=[],n=[];for(n.push(this);n.length>0;){const i=n.shift();e.push(i);const r=i.getEmbeddedCells({sortSiblings:t});n.push(...r)}return e.shift(),e},_getEmbeddedCellsDfs:function(t){const e=[],n=[];for(n.push(this);n.length>0;){const i=n.pop();e.push(i);const r=i.getEmbeddedCells({sortSiblings:t});for(let s=r.length-1;s>=0;--s)n.push(r[s])}return e.shift(),e},isEmbeddedIn:function(t,e){var n=ne(t)?t:t.id,i=this.parent();if(e=H({deep:!0},e),this.graph&&e.deep){for(;i;){if(i===n)return!0;i=this.graph.getCell(i).parent()}return!1}else return i===n},isEmbedded:function(){return!!this.parent()},clone:function(t){if(t=t||{},t.deep)return pt(tg([this].concat(this.getEmbeddedCells({deep:!0}))));var e=gn.prototype.clone.apply(this,arguments);return e.set(this.getIdAttribute(),this.generateId()),e.unset("embeds"),e.unset("parent"),e},prop:function(t,e,n){var i="/",r=ne(t);if(r||Array.isArray(t))if(arguments.length>1){var s,o;r?(s=t,o=s.split("/")):(s=t.join(i),o=t.slice());var a=o[0],l=o.length;const C=n||{};C.propertyPath=s,C.propertyValue=e,C.propertyPathArray=o,"rewrite"in C||(C.rewrite=!1);for(var c={},h=c,u=a,d=1;d<l;d++){var f=o[d],p=Number.isFinite(r?Number(f):f);h=h[u]=p?[]:{},u=f}c=Go(c,o,e,"/");var g=Te({},this.attributes);C.rewrite&&Jd(g,s,"/");var v=Te(g,c);return this.set(a,v[a],C)}else return yn(this.attributes,t,i);const x=e||{};x.propertyPath=null,x.propertyValue=t,x.propertyPathArray=[],"rewrite"in x||(x.rewrite=!1);const S={};for(const C in t){const{changedValue:P}=Te({},{changedValue:this.attributes[C]},{changedValue:t[C]});S[C]=P}return this.set(S,x)},removeProp:function(t,e){e=e||{};var n=Array.isArray(t)?t:t.split("/"),i=n[0];if(i==="attrs"&&(e.dirty=!0),n.length===1)return this.unset(t,e);var r=n.slice(1),s=this.get(i);return s==null?this:(s=Le(s),Jd(s,r,"/"),this.set(i,s,e))},attr:function(t,e,n){var i=Array.from(arguments);return i.length===0?this.get("attrs"):(Array.isArray(t)?i[0]=["attrs"].concat(t):ne(t)?i[0]="attrs/"+t:i[0]={attrs:t},this.prop.apply(this,i))},removeAttr:function(t,e){return Array.isArray(t)?this.removeProp(["attrs"].concat(t)):this.removeProp("attrs/"+t,e)},transition:function(t,e,n,i){i=i||"/";var r={duration:100,delay:10,timingFunction:Zw.linear,valueFunction:Jp.number};n=H(r,n);var s=0,o,a=(function(u){var d,f,p;s=s||u,u-=s,f=u/n.duration,f<1?this._transitionIds[t]=d=Ho(a):(f=1,delete this._transitionIds[t]),p=o(n.timingFunction(f)),n.transitionId=d,this.prop(t,p,n),d||this.trigger("transition:end",this,t)}).bind(this);const{_scheduledTransitionIds:l}=this;let c;var h=u=>{l[t]&&(l[t]=Vo(l[t],c),l[t].length===0&&delete l[t]),this.stopPendingTransitions(t,i),o=n.valueFunction(yn(this.attributes,t,i),e),this._transitionIds[t]=Ho(u),this.trigger("transition:start",this,t)};return c=setTimeout(h,n.delay,a),l[t]||(l[t]=[]),l[t].push(c),c},getTransitions:function(){return iu(Object.keys(this._transitionIds),Object.keys(this._scheduledTransitionIds))},stopScheduledTransitions:function(t,e="/"){const{_scheduledTransitionIds:n={}}=this;let i=Object.keys(n);if(t){const r=t.split(e);i=i.filter(s=>ke(r,s.split(e).slice(0,r.length)))}return i.forEach(r=>{n[r].forEach(o=>clearTimeout(o)),delete n[r]}),this},stopPendingTransitions(t,e="/"){const{_transitionIds:n={}}=this;let i=Object.keys(n);if(t){const r=t.split(e);i=i.filter(s=>ke(r,s.split(e).slice(0,r.length)))}i.forEach(r=>{const s=n[r];ks(s),delete n[r],this.trigger("transition:end",this,r)})},stopTransitions:function(t,e="/"){return this.stopScheduledTransitions(t,e),this.stopPendingTransitions(t,e),this},addTo:function(t,e){return t.addCell(this,e),this},findView:function(t){return t.findViewByModel(this)},isElement:function(){return!1},isLink:function(){return!1},startBatch:function(t,e){return this.graph&&this.graph.startBatch(t,H({},e,{cell:this})),this},stopBatch:function(t,e){return this.graph&&this.graph.stopBatch(t,H({},e,{cell:this})),this},getChangeFlag:function(t){var e=0;if(!t)return e;for(var n in t)!t.hasOwnProperty(n)||!this.hasChanged(n)||(e|=t[n]);return e},angle:function(){return 0},position:function(){return new M(0,0)},z:function(){return this.get("z")||0},getPointFromConnectedLink:function(){return new M},getBBox:function(){return new Z(0,0,0,0)},getPointRotatedAroundCenter(t,e,n){const i=new M(e,n);return t&&i.rotate(this.getBBox().center(),t),i},getAbsolutePointFromRelative(t,e){return this.getPointRotatedAroundCenter(-this.angle(),this.position().offset(t,e))},getRelativePointFromAbsolute(t,e){return this.getPointRotatedAroundCenter(this.angle(),t,e).difference(this.position())}},{getAttributeDefinition:function(t){var e=this.attributes,n=aa;return e&&e[t]||n[t]},define:function(t,e,n,i){n=H({defaults:er({type:t},e,this.prototype.defaults)},n);var r=this.extend(n,i);return typeof joint<"u"&&di(joint,"shapes")&&Go(joint.shapes,t,r,"."),r}}),o_=function(t,e,n){if(ne(n)){if(!su[n])throw new Error('Unknown wrapper: "'+n+'"');n=su[n]}if(!_t(n))throw new Error("Wrapper must be a function.");pt(e).forEach(function(i){t[i]=n(t[i])})},su={cells:function(t){return function(){var e=Array.from(arguments),n=e.length,i=n>0&&e[0]||[],r=n>1&&e[n-1]||{};return Array.isArray(i)||(r instanceof an?i=e:i instanceof an&&(e.length>1&&e.pop(),i=e)),r instanceof an&&(r={}),t.call(this,i,r)}}};function rF(t,...e){const n=[];return t.forEach((r,s)=>{n.push(r),s in e&&n.push(e[s])}),sF(n.join(""))}function sF(t){const e=new DOMParser,n=`<svg>${t.trim()}</svg>`;if(e.parseFromString(n.replace(/@/g,""),"application/xml").getElementsByTagName("parsererror")[0])throw new Error("Invalid SVG markup");const s=e.parseFromString(n,"text/html").querySelector("svg");return oF(s)}function a_(t){const e={},{tagName:n,attributes:i,namespaceURI:r,style:s,childNodes:o}=t;e.namespaceURI=r,e.tagName=r===L.namespace.xhtml?n.toLowerCase():n;const a={};for(var l=s.length;l--;){var c=s[l];a[c]=s.getPropertyValue(c)}e.style=a;const h=i.getNamedItem("@selector");h&&(e.selector=h.value,i.removeNamedItem("@selector"));const u=i.getNamedItem("@group-selector");if(u){const g=u.value.split(",");e.groupSelector=g.map(v=>v.trim()),i.removeNamedItem("@group-selector")}const d=i.getNamedItem("class");d&&(e.className=d.value);const f=[];o.forEach(g=>{switch(g.nodeType){case Node.TEXT_NODE:{const v=g.data.replace(/\s\s+/g," ");v.trim()&&f.push(v);break}case Node.ELEMENT_NODE:{f.push(a_(g));break}}}),f.length&&(e.children=f);const p={};return Array.from(i).forEach(g=>{const{name:v,value:x}=g;p[v]=x}),Object.keys(p).length>0&&(e.attributes=p),e}function oF(t){const e=[];return Array.from(t.children).forEach(n=>{e.push(a_(n))}),e}const Xe={TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left",TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",CENTER:"center"};function Os(t,e){const n=new Z(t);switch(e){case void 0:throw new Error("Position required");case Xe.LEFT:case"leftMiddle":return n.leftMiddle();case Xe.RIGHT:case"rightMiddle":return n.rightMiddle();case Xe.TOP:case"topMiddle":return n.topMiddle();case Xe.BOTTOM:case"bottomMiddle":return n.bottomMiddle();case Xe.TOP_LEFT:case"topLeft":case"origin":return n.topLeft();case Xe.TOP_RIGHT:case"topRight":return n.topRight();case Xe.BOTTOM_LEFT:case"bottomLeft":return n.bottomLeft();case Xe.BOTTOM_RIGHT:case"bottomRight":case"corner":return n.bottomRight();case Xe.CENTER:return n.center();default:throw new Error(`Unknown position: ${e}`)}}const aF=Object.freeze(Object.defineProperty({__proto__:null,addClassNamePrefix:kn,assign:H,bindAll:hn,breakText:jw,camelCase:Rl,cancelFrame:ks,cap:Hw,clone:we,cloneCells:tg,cloneDeep:Le,dataUriToBlob:qw,debounce:Nl,deepMixin:G3,deepSupplement:Cw,defaults:me,defaultsDeep:er,difference:kw,downloadBlob:Yw,downloadDataUri:Xw,filter:Jw,flattenDeep:Iw,flattenObject:qp,forIn:Jt,format:nl,getByPath:yn,getElementBBox:ws,getRectPoint:Os,groupBy:Wp,guid:Jr,has:di,hashCode:Da,imageToDataUri:Zp,interpolate:Jp,intersection:Zd,invoke:Ue,invokeProperty:Pw,isBoolean:jp,isEmpty:En,isEqual:ke,isFunction:_t,isNumber:Nt,isObject:Vt,isPercentage:je,isPlainObject:Ce,isString:ne,merge:Te,mixin:Tw,nextFrame:Ho,noop:go,normalizeEvent:at,normalizeSides:Re,normalizeWheel:Gw,omit:Qe,parseCssNumeric:Uw,parseDOMJSON:el,pick:tl,removeClassNamePrefix:LB,result:ee,sanitizeHTML:Ww,setAttributesBySelector:Ns,setByPath:Go,sortBy:tn,sortElements:Kw,sortedIndex:ih,supplement:Aw,svg:rF,template:Xn,timing:Zw,toArray:pt,toKebabCase:zw,toggleFullScreen:Qw,union:iu,uniq:Ii,uniqueId:es,unsetByPath:Jd,uuid:Kp,without:Vo,wrapWith:o_,wrappers:su},Symbol.toStringTag,{value:"Module"}));function l_(t,e,n){var i=t.toJSON();return i.angle=e||0,me({},n,i)}function $l(t,e,n,i){return t.map(function(r,s,o){var a=this.pointAt((s+.5)/o.length);return(r.dx||r.dy)&&a.offset(r.dx||0,r.dy||0),l_(a.round(),0,eg(i,r))},Ps(e,n))}function c_(t,e,n,i){var r=e.center(),s=e.width/e.height,o=e.topMiddle(),a=Bn.fromRect(e);return t.map(function(l,c,h){var u=n+i(c,h.length),d=o.clone().rotate(r,-u).scale(s,1,r),f=l.compensateRotation?-a.tangentTheta(d):0;return(l.dx||l.dy)&&d.offset(l.dx||0,l.dy||0),l.dr&&d.move(r,l.dr),l_(d.round(),f,eg(e,l))})}function eg(t,e){let{x:n,y:i,angle:r}=e;return je(n)?n=parseFloat(n)/100*t.width:Pr(n)&&(n=Number(Ir(n,t))),je(i)?i=parseFloat(i)/100*t.height:Pr(i)&&(i=Number(Ir(i,t))),{x:n,y:i,angle:r}}function Qd(t,e){const{x:n,y:i}=eg(t,e);return new M(n||0,i||0)}const lF=function(t,e){return t.map(n=>{const i=Qd(e,n).round().toJSON();return i.angle=n.angle||0,i})},cF=function(t,e,n){return n.fn(t,e,n)},uF=function(t,e,n){var i=Qd(e,n.start||e.origin()),r=Qd(e,n.end||e.corner());return $l(t,i,r,e)},hF=function(t,e,n){return $l(t,e.origin(),e.bottomLeft(),e)},dF=function(t,e,n){return $l(t,e.topRight(),e.corner(),e)},fF=function(t,e,n){return $l(t,e.origin(),e.topRight(),e)},pF=function(t,e,n){return $l(t,e.bottomLeft(),e.corner(),e)},gF=function(t,e,n){var i=n.startAngle||0,r=n.step||360/t.length;return c_(t,e,i,function(s){return s*r})},mF=function(t,e,n){var i=n.startAngle||0,r=n.step||20;return c_(t,e,i,function(s,o){return(s+.5-o/2)*r})},u_=Object.freeze(Object.defineProperty({__proto__:null,absolute:lF,bottom:pF,ellipse:mF,ellipseSpread:gF,fn:cF,left:hF,line:uF,right:dF,top:fF},Symbol.toStringTag,{value:"Module"}));function os(t,e){return er({},t,e,{x:0,y:0,angle:0,attrs:{}})}function h_(t){var e=t.center(),n=e.theta(t.origin()),i=e.theta(t.bottomLeft()),r=e.theta(t.corner()),s=e.theta(t.topRight());return[n,s,r,i]}function d_(t,e,n,i){i=me({},i,{offset:15});var r=e.center().theta(t),s,o,a,l,c=i.offset,h=0;const[u,d,f,p]=h_(e);r<d||r>f?(a=".3em",s=c,o=0,l="start"):r<u?(s=0,o=-c,n?(h=-90,l="start",a=".3em"):(l="middle",a="0")):r<p?(a=".3em",s=-c,o=0,l="end"):(s=0,o=c,n?(h=90,l="start",a=".3em"):(l="middle",a=".6em"));var g=Math.round;return os(i,{x:g(s),y:g(o),angle:h,attrs:{labelText:{y:a,textAnchor:l}}})}function f_(t,e,n,i){i=me({},i,{offset:15});var r=e.center().theta(t),s,o,a,l,c=i.offset,h=0;const[u,d,f,p]=h_(e);r<d||r>f?(a=".3em",s=-c,o=0,l="end"):r<u?(s=0,o=c,n?(h=90,l="start",a=".3em"):(l="middle",a=".6em")):r<p?(a=".3em",s=c,o=0,l="start"):(s=0,o=-c,n?(h=-90,l="start",a=".3em"):(l="middle",a="0"));var g=Math.round;return os(i,{x:g(s),y:g(o),angle:h,attrs:{labelText:{y:a,textAnchor:l}}})}function p_(t,e,n){n=me({},n,{offset:20});var i=oe(0,0),r=-t.theta(i),s=r,o=t.clone().move(i,n.offset).difference(t).round(),a=".3em",l;(r+90)%180===0?(l=e?"end":"middle",!e&&r===-270&&(a="0em")):r>-270&&r<-90?(l="start",s=r-180):l="end";var c=Math.round;return os(n,{x:c(o.x),y:c(o.y),angle:e?s:0,attrs:{labelText:{y:a,textAnchor:l}}})}const vF=function(t,e,n){return os(n)},yF=function(t,e,n){return os(n,{x:-15,attrs:{labelText:{y:".3em",textAnchor:"end"}}})},bF=function(t,e,n){return os(n,{x:15,attrs:{labelText:{y:".3em",textAnchor:"start"}}})},xF=function(t,e,n){return os(n,{y:-15,attrs:{labelText:{y:"0",textAnchor:"middle"}}})},wF=function(t,e,n){return os(n,{y:15,attrs:{labelText:{y:".6em",textAnchor:"middle"}}})},_F=function(t,e,n){return d_(t,e,!0,n)},SF=function(t,e,n){return d_(t,e,!1,n)},EF=function(t,e,n){return f_(t,e,!0,n)},TF=function(t,e,n){return f_(t,e,!1,n)},AF=function(t,e,n){return p_(t.difference(e.center()),!1,n)},CF=function(t,e,n){return p_(t.difference(e.center()),!0,n)},g_=Object.freeze(Object.defineProperty({__proto__:null,bottom:wF,inside:TF,insideOriented:EF,left:yF,manual:vF,outside:SF,outsideOriented:_F,radial:AF,radialOriented:CF,right:bF,top:xF},Symbol.toStringTag,{value:"Module"}));var m_=function(t){var e=Le(t)||{};this.ports=[],this.groups={},this.portLayoutNamespace=u_,this.portLabelLayoutNamespace=g_,this._init(e)};m_.prototype={getPorts:function(){return this.ports},getGroup:function(t){return this.groups[t]||{}},getPortsByGroup:function(t){return this.ports.filter(function(e){return e.group===t})},getGroupPortsMetrics:function(t,e){var n=this.getGroup(t),i=this.getPortsByGroup(t),r=n.position||{},s=r.name,o=this.portLayoutNamespace;o[s]||(s="left");var a=r.args||{},l=i.map(function(u){return u&&u.position&&u.position.args}),c=o[s](l,e,a),h={ports:i,result:[]};return pt(c).reduce((function(u,d,f){var p=u.ports[f];return u.result.push({portId:p.id,portTransformation:d,labelTransformation:this._getPortLabelLayout(p,M(d),e),portAttrs:p.attrs,portSize:p.size,labelSize:p.label.size}),u}).bind(this),h),h.result},_getPortLabelLayout:function(t,e,n){var i=this.portLabelLayoutNamespace,r=t.label.position.name||"left";return i[r]?i[r](e,n,t.label.position.args):null},_init:function(t){if(Vt(t.groups))for(var e=Object.keys(t.groups),n=0,i=e.length;n<i;n++){var r=e[n];this.groups[r]=this._evaluateGroup(t.groups[r])}for(var s=pt(t.items),o=0,a=s.length;o<a;o++)this.ports.push(this._evaluatePort(s[o]))},_evaluateGroup:function(t){return Te(t,{position:this._getPosition(t.position,!0),label:this._getLabel(t,!0)})},_evaluatePort:function(t){var e=H({},t),n=this.getGroup(t.group);return e.markup=e.markup||n.markup,e.attrs=Te({},n.attrs,e.attrs),e.position=this._createPositionNode(n,e),e.label=Te({},n.label,this._getLabel(e)),e.z=this._getZIndex(n,e),e.size=H({},n.size,e.size),e},_getZIndex:function(t,e){return Nt(e.z)?e.z:Nt(t.z)||t.z==="auto"?t.z:"auto"},_createPositionNode:function(t,e){return Te({name:"left",args:{}},t.position,{args:e.args})},_getPosition:function(t,e){var n={},i;_t(t)?(i="fn",n.fn=t):ne(t)?i=t:t===void 0?i=e?"left":null:Array.isArray(t)?(i="absolute",n.x=t[0],n.y=t[1]):Vt(t)&&(i=t.name,H(n,t.args));var r={args:n};return i&&(r.name=i),r},_getLabel:function(t,e){var n=t.label||{},i=n;return i.position=this._getPosition(n.position,e),i}};const PF={_initializePorts:function(){this._createPortData(),this.on("change:ports",function(){this._processRemovedPort(),this._createPortData()},this)},_processRemovedPort:function(){var t=this.get("ports")||{},e={};pt(t.items).forEach(function(a){e[a.id]=!0});var n=this.previous("ports")||{},i={};pt(n.items).forEach(function(a){e[a.id]||(i[a.id]=!0)});var r=this.graph;if(r&&!En(i)){var s=r.getConnectedLinks(this,{inbound:!0});s.forEach(function(a){i[a.get("target").port]&&a.remove()});var o=r.getConnectedLinks(this,{outbound:!0});o.forEach(function(a){i[a.get("source").port]&&a.remove()})}},hasPorts:function(){var t=this.prop("ports/items");return Array.isArray(t)&&t.length>0},hasPort:function(t){return this.getPortIndex(t)!==-1},getPorts:function(){return Le(this.prop("ports/items"))||[]},getGroupPorts:function(t){const e=pt(this.prop(["ports","items"])).filter(n=>n.group===t);return Le(e)},getPort:function(t){return Le(pt(this.prop("ports/items")).find(function(e){return e.id&&e.id===t}))},getPortsPositions:function(t){var e=this._portSettingsData.getGroupPortsMetrics(t,Z(this.size()));return e.reduce(function(n,i){var r=i.portTransformation;return n[i.portId]={x:r.x,y:r.y,angle:r.angle},n},{})},getPortIndex:function(t){var e=Vt(t)?t.id:t;return this._isValidPortId(e)?pt(this.prop("ports/items")).findIndex(function(n){return n.id===e}):-1},addPort:function(t,e){if(!Vt(t)||Array.isArray(t))throw new Error("Element: addPort requires an object.");var n=H([],this.prop("ports/items"));return n.push(t),this.prop("ports/items",n,e),this},insertPort:function(t,e,n){const i=typeof t=="number"?t:this.getPortIndex(t);if(!Vt(e)||Array.isArray(e))throw new Error("dia.Element: insertPort requires an object.");const r=H([],this.prop("ports/items"));return r.splice(i,0,e),this.prop("ports/items",r,n),this},portProp:function(t,e,n,i){var r=this.getPortIndex(t);if(r===-1)throw new Error("Element: unable to find port with id "+t);var s=Array.prototype.slice.call(arguments,1);return Array.isArray(e)?s[0]=["ports","items",r].concat(e):ne(e)?s[0]=["ports/items/",r,"/",e].join(""):(s=["ports/items/"+r],Ce(e)&&(s.push(e),s.push(n))),this.prop.apply(this,s)},_validatePorts:function(){var t=this.get("ports")||{},e=[];t=t||{};var n=pt(t.items);return n.forEach(function(i){typeof i!="object"&&e.push("Element: invalid port ",i),this._isValidPortId(i.id)||(i.id=this.generatePortId())},this),Ii(n,"id").length!==n.length&&e.push("Element: found id duplicities in ports."),e},generatePortId:function(){return this.generateId()},_isValidPortId:function(t){return t!=null&&!Vt(t)},addPorts:function(t,e){return t.length&&this.prop("ports/items",H([],this.prop("ports/items")).concat(t),e),this},removePort:function(t,e){const n=e||{},i=this.getPortIndex(t);if(i!==-1){const r=H([],this.prop(["ports","items"]));r.splice(i,1),n.rewrite=!0,this.startBatch("port-remove"),this.prop(["ports","items"],r,n),this.stopBatch("port-remove")}return this},removePorts:function(t,e){let n,i;if(Array.isArray(t)){if(n=e||{},t.length===0)return this.this;i=H([],this.prop(["ports","items"])).filter(function(s){return!t.some(function(o){const a=Vt(o)?o.id:o;return s.id===a})})}else n=t||{},i=[];return this.startBatch("port-remove"),n.rewrite=!0,this.prop(["ports","items"],i,n),this.stopBatch("port-remove"),this},_createPortData:function(){var t=this._validatePorts();if(t.length>0)throw this.set("ports",this.previous("ports")),new Error(t.join(" "));var e;this._portSettingsData&&(e=this._portSettingsData.getPorts()),this._portSettingsData=new m_(this.get("ports"));var n=this._portSettingsData.getPorts();if(e){var i=n.filter(function(s){if(!e.find(function(o){return o.id===s.id}))return s}),r=e.filter(function(s){if(!n.find(function(o){return o.id===s.id}))return s});r.length>0&&this.trigger("ports:remove",this,r),i.length>0&&this.trigger("ports:add",this,i)}}},IF={portContainerMarkup:"g",portMarkup:[{tagName:"circle",selector:"circle",attributes:{r:10,fill:"#FFFFFF",stroke:"#000000"}}],portLabelMarkup:[{tagName:"text",selector:"text",attributes:{fill:"#000000"}}],_portElementsCache:null,_initializePorts:function(){this._cleanPortsCache()},_refreshPorts:function(){this._removePorts(),this._cleanPortsCache(),this._renderPorts()},_cleanPortsCache:function(){this._portElementsCache={}},_renderPorts:function(){for(var t=[],e=this._getContainerElement(),n=0,i=e.node.childNodes.length;n<i;n++)t.push(e.node.childNodes[n]);var r=Wp(this.model._portSettingsData.getPorts(),"z"),s="auto";pt(r[s]).forEach(function(h){var u=this._getPortElement(h);e.append(u),t.push(u)},this);for(var o=Object.keys(r),a=0;a<o.length;a++){var l=o[a];if(l!==s){var c=parseInt(l,10);this._appendPorts(r[l],c,t)}}this._updatePorts()},_getContainerElement:function(){return this.rotatableNode||this.vel},_appendPorts:function(t,e,n){var i=this._getContainerElement(),r=pt(t).map(this._getPortElement,this);n[e]||e<0?L(n[Math.max(e,0)]).before(r):i.append(r)},_getPortElement:function(t){return this._portElementsCache[t.id]?this._portElementsCache[t.id].portElement:this._createPortElement(t)},findPortNodes:function(t,e){const n=this._portElementsCache[t];if(!n)return[];if(!e)return[n.portContentElement.node];const i=n.portElement.node,r=n.portSelectors;return this.findBySelector(e,i,r)},findPortNode:function(t,e){const[n=null]=this.findPortNodes(t,e);return n},_updatePorts:function(){this._updatePortGroup(void 0);var t=Object.keys(this.model._portSettingsData.groups);t.forEach(this._updatePortGroup,this)},_removePorts:function(){Ue(this._portElementsCache,"portElement.remove")},_createPortElement:function(t){let e,n,i,r;var s=L(this.portContainerMarkup).addClass("joint-port"),o=this._getPortMarkup(t);if(Array.isArray(o)){var a=this.parseDOMJSON(o,s.node),l=a.fragment;l.childNodes.length>1?e=L("g").append(l):e=L(l.firstChild),r=a.selectors}else e=L(o),Array.isArray(e)&&(e=L("g").append(e));if(!e)throw new Error("ElementView: Invalid port markup.");e.attr({port:t.id,"port-group":t.group}),Nt(t.id)&&e.attr("port-id-type","number");const c=this._getPortLabelMarkup(t.label);if(Array.isArray(c)){const{fragment:g,selectors:v}=this.parseDOMJSON(c,s.node),x=g.childNodes.length;x>0&&(i=v,n=x===1?L(g.firstChild):L("g").append(g))}else n=L(c),Array.isArray(n)&&(n=L("g").append(n));var h;if(r&&i){for(var u in i)if(r[u]&&u!==this.selector)throw new Error("ElementView: selectors within port must be unique.");h=H({},r,i)}else h=r||i||{};const d="portRoot",f="labelRoot",p="labelText";if(d in h||(h[d]=e.node),n){const g=n.node;if(f in h||(h[f]=g),!(p in h)){const v=n.tagName()==="TEXT"?g:Array.from(g.querySelectorAll("text"));h[p]=v,i||(i={}),i[p]=v}}return s.append(e.addClass("joint-port-body")),n&&s.append(n.addClass("joint-port-label")),this._portElementsCache[t.id]={portElement:s,portLabelElement:n,portSelectors:h,portLabelSelectors:i,portContentElement:e,portContentSelectors:r},s},_updatePortGroup:function(t){for(var e=Z(this.model.size()),n=this.model._portSettingsData.getGroupPortsMetrics(t,e),i=0,r=n.length;i<r;i++){var s=n[i],o=s.portId,a=this._portElementsCache[o]||{},l=s.portTransformation,c=s.labelTransformation;c&&a.portLabelElement&&(this.updateDOMSubtreeAttributes(a.portLabelElement.node,c.attrs,{rootBBox:new Z(s.labelSize),selectors:a.portLabelSelectors}),this.applyPortTransform(a.portLabelElement,c,-l.angle||0)),this.updateDOMSubtreeAttributes(a.portElement.node,s.portAttrs,{rootBBox:new Z(s.portSize),selectors:a.portSelectors}),this.applyPortTransform(a.portElement,l)}},applyPortTransform:function(t,e,n){var i=L.createSVGMatrix().rotate(n||0).translate(e.x||0,e.y||0).rotate(e.angle||0);t.transform(i,{absolute:!0})},_getPortMarkup:function(t){return t.markup||this.model.get("portMarkup")||this.model.portMarkup||this.portMarkup},_getPortLabelMarkup:function(t){return t.markup||this.model.get("portLabelMarkup")||this.model.portLabelMarkup||this.portLabelMarkup}},Kt=an.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},initialize:function(){this._initializePorts(),an.prototype.initialize.apply(this,arguments)},_initializePorts:function(){},_refreshPorts:function(){},isElement:function(){return!0},position:function(t,e,n){const i=Nt(e);n=(i?n:t)||{};const{parentRelative:r,deep:s,restrictedArea:o}=n;let a;if(r){if(!this.graph)throw new Error("Element must be part of a graph.");const l=this.getParentCell();l&&!l.isLink()&&(a=l.get("position"))}if(i){if(a&&(t+=a.x,e+=a.y),s||o){const{x:l,y:c}=this.get("position");this.translate(t-l,e-c,n)}else this.set("position",{x:t,y:e},n);return this}else{const l=M(this.get("position"));return r?l.difference(a):l}},translate:function(t,e,n){if(t=t||0,e=e||0,t===0&&e===0)return this;n=n||{},n.translateBy=n.translateBy||this.id;var i=this.get("position")||{x:0,y:0},r=n.restrictedArea;if(r&&n.translateBy===this.id)if(typeof r=="function"){var s=r.call(this,i.x+t,i.y+e,n);t=s.x-i.x,e=s.y-i.y}else{var o=this.getBBox({deep:!0}),a=i.x-o.x,l=i.y-o.y,c=Math.max(r.x+a,Math.min(r.x+r.width+a-o.width,i.x+t)),h=Math.max(r.y+l,Math.min(r.y+r.height+l-o.height,i.y+e));t=c-i.x,e=h-i.y}var u={x:i.x+t,y:i.y+e};return n.tx=t,n.ty=e,n.transition?(Vt(n.transition)||(n.transition={}),this.transition("position",u,H({},n.transition,{valueFunction:Jp.object})),Ue(this.getEmbeddedCells(),"translate",t,e,n)):(this.startBatch("translate",n),this.set("position",u,n),Ue(this.getEmbeddedCells(),"translate",t,e,n),this.stopBatch("translate",n)),this},size:function(t,e,n){var i=this.get("size");return t===void 0?{width:i.width,height:i.height}:(Vt(t)&&(n=e,e=Nt(t.height)?t.height:i.height,t=Nt(t.width)?t.width:i.width),this.resize(t,e,n))},resize:function(t,e,n){if(n=n||{},this.startBatch("resize",n),n.direction){var i=this.get("size");switch(n.direction){case"left":case"right":e=i.height;break;case"top":case"bottom":t=i.width;break}var r=nn(this.get("angle")||0),s=this.getBBox(),o;if(r){var a={"top-right":0,right:0,"top-left":1,top:1,"bottom-left":2,left:2,"bottom-right":3,bottom:3}[n.direction];n.absolute&&(a+=Math.floor((r+45)/90),a%=4);var l=s[["bottomLeft","corner","topRight","origin"][a]](),c=M(l).rotate(s.center(),-r),h=Math.sqrt(t*t+e*e)/2,u=a*Math.PI/2;u+=Math.atan(a%2==0?e/t:t/e),u-=un(r);var d=M.fromPolar(h,u,c);o=M(d).offset(t/-2,e/-2)}else switch(o=s.topLeft(),n.direction){case"top":case"top-right":o.offset(0,s.height-e);break;case"left":case"bottom-left":o.offset(s.width-t,0);break;case"top-left":o.offset(s.width-t,s.height-e);break}this.set("size",{width:t,height:e},n),this.position(o.x,o.y,n)}else this.set("size",{width:t,height:e},n);return this.stopBatch("resize",n),this},scale:function(t,e,n,i){var r=this.getBBox().scale(t,e,n);return this.startBatch("scale",i),this.position(r.x,r.y,i),this.resize(r.width,r.height,i),this.stopBatch("scale"),this},fitEmbeds:function(t){return this.fitToChildren(t)},fitToChildren:function(t={}){const{graph:e}=this;if(!e)throw new Error("Element must be part of a graph.");const n=this.getEmbeddedCells().filter(i=>i.isElement());return n.length===0?this:(this.startBatch("fit-embeds",t),t.deep&&Ue(n,"fitToChildren",t),this._fitToElements(Object.assign({elements:n},t)),this.stopBatch("fit-embeds"),this)},fitParent:function(t={}){const{graph:e}=this;if(!e)throw new Error("Element must be part of a graph.");if(t.deep&&t.terminator&&(t.terminator===this||t.terminator===this.id))return this;const n=this.getParentCell();if(!n||!n.isElement())return this;const i=n.getEmbeddedCells().filter(r=>r.isElement());return i.length===0?this:(this.startBatch("fit-parent",t),n._fitToElements(Object.assign({elements:i},t)),t.deep&&n.fitParent(t),this.stopBatch("fit-parent"),this)},_fitToElements:function(t={}){const e=this.graph.getCellsBBox(t.elements);if(!e)return;const{expandOnly:n,shrinkOnly:i}=t;if(n&&i)return;let{x:r,y:s,width:o,height:a}=e;const{left:l,right:c,top:h,bottom:u}=Re(t.padding);r-=l,s-=h,o+=l+c,a+=u+h;let d=new Z(r,s,o,a);if(n)d=this.getBBox().union(d);else if(i){const f=this.getBBox().intersect(d);if(!f)return;d=f}this.set({position:{x:d.x,y:d.y},size:{width:d.width,height:d.height}},t)},rotate:function(t,e,n,i){if(n){var r=this.getBBox().center(),s=this.get("size"),o=this.get("position");r.rotate(n,this.get("angle")-t);var a=r.x-s.width/2-o.x,l=r.y-s.height/2-o.y;this.startBatch("rotate",{angle:t,absolute:e,origin:n}),this.position(o.x+a,o.y+l,i),this.rotate(t,e,null,i),this.stopBatch("rotate")}else this.set("angle",e?t:(this.get("angle")+t)%360,i);return this},angle:function(){return nn(this.get("angle")||0)},getBBox:function(t={}){const{graph:e,attributes:n}=this,{deep:i,rotate:r}=t;if(i&&e){const u=this.getEmbeddedCells({deep:!0,breadthFirst:!0});return u.push(this),e.getCellsBBox(u,t)}const{angle:s=0,position:{x:o,y:a},size:{width:l,height:c}}=n,h=new Z(o,a,l,c);return r&&h.rotateAroundCenter(s),h},getPointFromConnectedLink:function(t,e){var n=this.getBBox(),i=n.center(),r=t.get(e);if(!r)return i;var s=r.port;if(!s||!this.hasPort(s))return i;var o=this.portProp(s,["group"]),a=this.getPortsPositions(o),l=new M(a[s]).offset(n.origin()),c=this.angle();return c&&l.rotate(i,-c),l}});H(Kt.prototype,PF);const Dr=an.extend({defaultLabel:void 0,labelMarkup:void 0,_builtins:{defaultLabel:{markup:[{tagName:"rect",selector:"rect"},{tagName:"text",selector:"text"}],attrs:{text:{fill:"#000000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"text",fill:"#ffffff",rx:3,ry:3,x:"calc(x)",y:"calc(y)",width:"calc(w)",height:"calc(h)"}},position:{distance:.5}}},defaults:{source:{},target:{}},isLink:function(){return!0},disconnect:function(t){return this.set({source:{x:0,y:0},target:{x:0,y:0}},t)},source:function(t,e,n){if(t===void 0)return we(this.get("source"));var i,r,s=t instanceof an;if(s)return i=we(e)||{},i.id=t.id,r=n,this.set("source",i,r);var o=!Ce(t);return o?(i=we(e)||{},i.x=t.x,i.y=t.y,r=n,this.set("source",i,r)):(i=t,r=e,this.set("source",i,r))},target:function(t,e,n){if(t===void 0)return we(this.get("target"));var i,r,s=t instanceof an;if(s)return i=we(e)||{},i.id=t.id,r=n,this.set("target",i,r);var o=!Ce(t);return o?(i=we(e)||{},i.x=t.x,i.y=t.y,r=n,this.set("target",i,r)):(i=t,r=e,this.set("target",i,r))},router:function(t,e,n){if(t===void 0){var i=this.get("router");return i?typeof i=="object"?we(i):i:null}var r=typeof t=="object"||typeof t=="function",s=r?t:{name:t,args:e},o=r?e:n;return this.set("router",s,o)},connector:function(t,e,n){if(t===void 0){var i=this.get("connector");return i?typeof i=="object"?we(i):i:null}var r=typeof t=="object"||typeof t=="function",s=r?t:{name:t,args:e},o=r?e:n;return this.set("connector",s,o)},label:function(t,e,n){var i=this.labels();return t=isFinite(t)&&t!==null?t|0:0,t<0&&(t=i.length+t),arguments.length<=1?this.prop(["labels",t]):this.prop(["labels",t],e,n)},labels:function(t,e){return arguments.length===0?(t=this.get("labels"),Array.isArray(t)?t.slice():[]):(Array.isArray(t)||(t=[]),this.set("labels",t,e))},hasLabels:function(){const{labels:t}=this.attributes;return Array.isArray(t)&&t.length>0},insertLabel:function(t,e,n){if(!e)throw new Error("dia.Link: no label provided");var i=this.labels(),r=i.length;return t=isFinite(t)&&t!==null?t|0:r,t<0&&(t=r+t+1),i.splice(t,0,e),this.labels(i,n)},appendLabel:function(t,e){return this.insertLabel(-1,t,e)},removeLabel:function(t,e){var n=this.labels();return t=isFinite(t)&&t!==null?t|0:-1,n.splice(t,1),this.labels(n,e)},vertex:function(t,e,n){var i=this.vertices();if(t=isFinite(t)&&t!==null?t|0:0,t<0&&(t=i.length+t),arguments.length<=1)return this.prop(["vertices",t]);var r=this._normalizeVertex(e);return this.prop(["vertices",t],r,n)},vertices:function(t,e){if(arguments.length===0)return t=this.get("vertices"),Array.isArray(t)?t.slice():[];Array.isArray(t)||(t=[]);for(var n=[],i=0;i<t.length;i++){var r=t[i],s=this._normalizeVertex(r);n.push(s)}return this.set("vertices",n,e)},insertVertex:function(t,e,n){if(!e)throw new Error("dia.Link: no vertex provided");var i=this.vertices(),r=i.length;t=isFinite(t)&&t!==null?t|0:r,t<0&&(t=r+t+1);var s=this._normalizeVertex(e);return i.splice(t,0,s),this.vertices(i,n)},removeVertex:function(t,e){var n=this.vertices();return t=isFinite(t)&&t!==null?t|0:-1,n.splice(t,1),this.vertices(n,e)},_normalizeVertex:function(t){var e=!Ce(t);return e?{x:t.x,y:t.y}:t},translate:function(t,e,n){return n=n||{},n.translateBy=n.translateBy||this.id,n.tx=t,n.ty=e,this.applyToPoints(function(i){return{x:(i.x||0)+t,y:(i.y||0)+e}},n)},scale:function(t,e,n,i){return this.applyToPoints(function(r){return M(r).scale(t,e,n).toJSON()},i)},applyToPoints:function(t,e){if(!_t(t))throw new TypeError("dia.Link: applyToPoints expects its first parameter to be a function.");var n={},{source:i,target:r}=this.attributes;i.id||(n.source=t(i)),r.id||(n.target=t(r));var s=this.vertices();return s.length>0&&(n.vertices=s.map(t)),this.set(n,e)},getSourcePoint:function(){var t=this.getSourceCell();return t?t.getPointFromConnectedLink(this,"source"):new M(this.source())},getTargetPoint:function(){var t=this.getTargetCell();return t?t.getPointFromConnectedLink(this,"target"):new M(this.target())},getPointFromConnectedLink:function(){return this.getPolyline().pointAt(.5)},getPolyline:function(){const t=[this.getSourcePoint(),...this.vertices().map(M),this.getTargetPoint()];return new _e(t)},getBBox:function(){return this.getPolyline().bbox()},reparent:function(t){var e;if(this.graph){var n=this.getSourceElement(),i=this.getTargetElement(),r=this.getParentCell();n&&i&&(n===i||n.isEmbeddedIn(i)?e=i:i.isEmbeddedIn(n)?e=n:e=this.graph.getCommonAncestor(n,i)),r&&(!e||e.id!==r.id)&&r.unembed(this,t),e&&e.embed(this,t)}return e},hasLoop:function(t){t=t||{};var{source:e,target:n}=this.attributes,i=e.id,r=n.id;if(!i||!r)return!1;var s=i===r;if(!s&&t.deep&&this.graph){var o=this.getSourceCell(),a=this.getTargetCell();s=o.isEmbeddedIn(a)||a.isEmbeddedIn(o)}return s},getSourceCell:function(){const{graph:t,attributes:e}=this;var n=e.source;return n&&n.id&&t&&t.getCell(n.id)||null},getSourceElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getSourceCell()}while(t&&t.isLink());return t},getTargetCell:function(){const{graph:t,attributes:e}=this;var n=e.target;return n&&n.id&&t&&t.getCell(n.id)||null},getTargetElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getTargetCell()}while(t&&t.isLink());return t},getRelationshipAncestor:function(){var t;if(this.graph){var e=[this,this.getSourceElement(),this.getTargetElement()].filter(function(n){return!!n});t=this.graph.getCommonAncestor.apply(this.graph,e)}return t||null},isRelationshipEmbeddedIn:function(t){var e=ne(t)||Nt(t)?t:t.id,n=this.getRelationshipAncestor();return!!n&&(n.id===e||n.isEmbeddedIn(e))},_getDefaultLabel:function(){var t=this.get("defaultLabel")||this.defaultLabel||{},e={};return e.markup=t.markup||this.get("labelMarkup")||this.labelMarkup,e.position=t.position,e.attrs=t.attrs,e.size=t.size,e}},{endsEqual:function(t,e){var n=t.port===e.port||!t.port&&!e.port;return t.id===e.id&&n}}),_s={_results:{},_tests:{svgforeignobject:function(){return!!document.createElementNS&&/SVGForeignObject/.test({}.toString.call(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")))}},addTest:function(t,e){return this._tests[t]=e},test:function(t){var e=this._tests[t];if(!e)throw new Error('Test not defined ("'+t+'"). Use `joint.env.addTest(name, fn) to add a new test.`');var n=this._results[t];if(typeof n<"u")return n;try{n=e()}catch{n=!1}return this._results[t]=n,n}},kF=Kt.define("standard.Rectangle",{attrs:{root:{cursor:"move"},body:{width:"calc(w)",height:"calc(h)",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}]}),OF=Kt.define("standard.Circle",{attrs:{root:{cursor:"move"},body:{cx:"calc(s/2)",cy:"calc(s/2)",r:"calc(s/2)",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}]}),LF=Kt.define("standard.Ellipse",{attrs:{root:{cursor:"move"},body:{cx:"calc(w/2)",cy:"calc(h/2)",rx:"calc(w/2)",ry:"calc(h/2)",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"body"},{tagName:"text",selector:"label"}]}),MF=Kt.define("standard.Path",{attrs:{root:{cursor:"move"},body:{d:"M 0 0 H calc(w) V calc(h) H 0 Z",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}]}),DF=Kt.define("standard.Polygon",{attrs:{root:{cursor:"move"},body:{points:"0 0 calc(w) 0 calc(w) calc(h) 0 calc(h)",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"}]}),NF=Kt.define("standard.Polyline",{attrs:{root:{cursor:"move"},body:{points:"0 0 calc(w) 0 calc(w) calc(h) 0 calc(h)",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polyline",selector:"body"},{tagName:"text",selector:"label"}]}),RF=Kt.define("standard.Image",{attrs:{root:{cursor:"move"},image:{width:"calc(w)",height:"calc(h)"},label:{textVerticalAnchor:"top",textAnchor:"middle",x:"calc(w/2)",y:"calc(h+10)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),$F=Kt.define("standard.BorderedImage",{attrs:{root:{cursor:"move"},border:{width:"calc(w)",height:"calc(h)",stroke:"#333333",strokeWidth:2},background:{width:"calc(w-1)",height:"calc(h-1)",x:.5,y:.5,fill:"#FFFFFF"},image:{width:"calc(w-1)",height:"calc(h-1)",x:.5,y:.5},label:{textVerticalAnchor:"top",textAnchor:"middle",x:"calc(w/2)",y:"calc(h+10)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"background",attributes:{stroke:"none"}},{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),BF=Kt.define("standard.EmbeddedImage",{attrs:{root:{cursor:"move"},body:{width:"calc(w)",height:"calc(h)",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{width:"calc(0.3*w)",height:"calc(h-20)",x:10,y:10,preserveAspectRatio:"xMidYMin"},label:{textVerticalAnchor:"top",textAnchor:"left",x:"calc(0.3*w+20)",y:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),FF=Kt.define("standard.InscribedImage",{attrs:{root:{cursor:"move"},border:{rx:"calc(w/2)",ry:"calc(h/2)",cx:"calc(w/2)",cy:"calc(h/2)",stroke:"#333333",strokeWidth:2},background:{rx:"calc(w/2)",ry:"calc(h/2)",cx:"calc(w/2)",cy:"calc(h/2)",fill:"#FFFFFF"},image:{width:"calc(0.68*w)",height:"calc(0.68*h)",x:"calc(0.16*w)",y:"calc(0.16*h)",preserveAspectRatio:"xMidYMid"},label:{textVerticalAnchor:"top",textAnchor:"middle",x:"calc(w/2)",y:"calc(h+10)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"image"},{tagName:"ellipse",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),VF=Kt.define("standard.HeaderedRectangle",{attrs:{root:{cursor:"move"},body:{width:"calc(w)",height:"calc(h)",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},header:{width:"calc(w)",height:30,strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},headerText:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:15,fontSize:16,fill:"#333333"},bodyText:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2+15)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}]});var Xh=10;const zF=Kt.define("standard.Cylinder",{attrs:{root:{cursor:"move"},body:{lateralArea:Xh,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},top:{cx:"calc(w/2)",cy:Xh,rx:"calc(w/2)",ry:Xh,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h+15)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],topRy:function(t,e){if(t===void 0)return this.attr("body/lateralArea");var n={lateralArea:t},i=je(t),r=i?`calc(${parseFloat(t)/100}*h)`:t,s={cy:r,ry:r};return this.attr({body:n,top:s},e)}},{attributes:{"lateral-area":{set:function(t,e){var n=je(t);n&&(t=parseFloat(t)/100);var i=e.x,r=e.y,s=e.width,o=e.height,a=s/2,l=n?o*t:t,c=L.KAPPA,h=c*a,u=c*(n?o*t:t),d=i,f=i+s/2,p=i+s,g=r+l,v=g-l,x=r+o-l,S=r+o,C=["M",d,g,"L",d,x,"C",i,x+u,f-h,S,f,S,"C",f+h,S,p,x+u,p,x,"L",p,g,"C",p,g-u,f+h,v,f,v,"C",f-h,v,d,g-u,d,g,"Z"];return{d:C.join(" ")}}}}});var GF={tagName:"foreignObject",selector:"foreignObject",attributes:{overflow:"hidden"},children:[{tagName:"div",namespaceURI:"http://www.w3.org/1999/xhtml",selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]},HF={tagName:"text",selector:"label",attributes:{"text-anchor":"middle"}},UF=_s.test("svgforeignobject")?GF:HF;const jF=Kt.define("standard.TextBlock",{attrs:{root:{cursor:"move"},body:{width:"calc(w)",height:"calc(h)",stroke:"#333333",fill:"#ffffff",strokeWidth:2},foreignObject:{width:"calc(w)",height:"calc(h)"},label:{style:{fontSize:14}}}},{markup:[{tagName:"rect",selector:"body"},UF]},{attributes:{text:{set:function(t,e,n,i){if(n instanceof HTMLElement)n.textContent=t;else{var r=i.style||{},s={text:t,width:-5,height:"100%"},o=H({"text-vertical-anchor":"middle"},r);return aa["text-wrap"].set.call(this,s,e,n,o),{fill:r.color||null}}},position:function(t,e,n){if(n instanceof SVGElement)return e.center()}}}}),WF=Dr.define("standard.Link",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 10 -5 0 0 10 5 z"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),YF=Dr.define("standard.DoubleLink",{attrs:{line:{connection:!0,stroke:"#DDDDDD",strokeWidth:4,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:!0,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"outline",attributes:{fill:"none",cursor:"pointer"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),XF=Dr.define("standard.ShadowLink",{attrs:{line:{connection:!0,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}},shadow:{connection:!0,transform:"translate(3,6)",stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}}}},{markup:[{tagName:"path",selector:"shadow",attributes:{fill:"none","pointer-events":"none"}},{tagName:"path",selector:"line",attributes:{fill:"none",cursor:"pointer"}}]}),qF=Object.freeze(Object.defineProperty({__proto__:null,BorderedImage:$F,Circle:OF,Cylinder:zF,DoubleLink:YF,Ellipse:LF,EmbeddedImage:BF,HeaderedRectangle:VF,Image:RF,InscribedImage:FF,Link:WF,Path:MF,Polygon:DF,Polyline:NF,Rectangle:kF,ShadowLink:XF,TextBlock:jF},Symbol.toStringTag,{value:"Module"})),mo={POINT:"point",CUBIC:"cubic",LINE:"line",GAP:"gap"},KF=Object.values(mo),ZF=10,JF=1,ng=function(t,e,n=[],i={}){const{cornerType:r=mo.POINT,cornerRadius:s=ZF,cornerPreserveAspectRatio:o=!1,precision:a=JF,raw:l=!1}=i;if(KF.indexOf(r)===-1)throw new Error("Invalid `cornerType` provided to `straight` connector.");let c;if(r===mo.POINT||!s){const h=[t].concat(n).concat([e]),u=new _e(h);c=new K(u)}else{c=new K,c.appendSegment(K.createSegment("M",t));let h;const u=n.length;for(let d=0;d<u;d++){const f=new M(n[d]),p=n[d-1]||t,g=n[d+1]||e,v=h||f.distance(p)/2;h=f.distance(g)/2;let x,S;o?x=S=-Math.min(s,v,h):(x=-Math.min(s,v),S=-Math.min(s,h));const C=f.clone().move(p,x).round(a),P=f.clone().move(g,S).round(a);switch(c.appendSegment(K.createSegment("L",C)),r){case mo.CUBIC:{const k=.3333333333333333,N=2/3,m=new M(k*C.x+N*f.x,N*f.y+k*C.y),b=new M(k*P.x+N*f.x,N*f.y+k*P.y);c.appendSegment(K.createSegment("C",m,b,P));break}case mo.LINE:{c.appendSegment(K.createSegment("L",P));break}case mo.GAP:{c.appendSegment(K.createSegment("M",P));break}}}c.appendSegment(K.createSegment("L",e))}return l?c:c.serialize()};var QF=5,uv=["arc","gap","cubic"],t5=0,hv=1,e5=["smooth"],pc=1/3,gc=2/3;function dv(t,e){let{x:n,y:i}=t,{x:r,y:s}=e;if(n>r){let o=n;n=r,r=o,o=i,i=s,s=o}if(i>s){let o=n;n=r,r=o,o=i,i=s,s=o}return[new M(n,i),new M(r,s)]}function n5(t,e){const[{x:n,y:i},{x:r,y:s}]=dv(t.start,t.end),[{x:o,y:a},{x:l,y:c}]=dv(e.start,e.end),h=n<=l&&o<=r,u=i<=c&&a<=s;return h&&u}function qh(t,e,n){var i=[].concat(t,n,e);return i.reduce(function(r,s,o){var a=i[o+1];return a!=null&&(r[o]=Ps(s,a)),r},[])}function i5(t){var e=t.paper,n=e._jumpOverUpdateList;if(n==null){n=e._jumpOverUpdateList=[];var i=e.model;i.on("batch:stop",function(){this.hasActiveBatch()||r5(e)}),i.on("reset",function(){n=e._jumpOverUpdateList=[]})}n.indexOf(t)<0&&(n.push(t),t.listenToOnce(t.model,"change:connector remove",function(){n.splice(n.indexOf(t),1)}))}function r5(t){for(var e=t._jumpOverUpdateList,n=0;n<e.length;n++){const i=e[n],r=i.getFlag(i.constructor.Flags.CONNECTOR);i.requestUpdate(r)}}function s5(t,e){return pt(e).reduce(function(n,i){var r=t.intersection(i);return r&&n.push(r),n},[])}function fv(t,e){return Ps(t,e).squaredLength()}function o5(t,e,n){return e.reduce(function(i,r,s){if(r.skip===!0)return i;var o=i.pop()||t,a=oe(r).move(o.start,-n),l=oe(r).move(o.start,+n),c=e[s+1];if(c!=null){var h=l.distance(c);h<=n&&(l=c.move(o.start,h),c.skip=!0)}else{var u=a.distance(o.end);if(u<n*2+hv)return i.push(o),i}var d=l.distance(o.start);if(d<n*2+hv)return i.push(o),i;var f=Ps(a,l);return f.isJump=!0,i.push(Ps(o.start,a),f,Ps(l,o.end)),i},[])}function pv(t,e,n,i){var r=new K,s;return s=K.createSegment("M",t[0].start),r.appendSegment(s),pt(t).forEach(function(o,a){if(o.isJump){var l,c,h,u;if(n==="arc"){l=-90,c=o.start.difference(o.end);var d=+(c.x<0||c.x===0&&c.y<0);d&&(l+=180);var f=o.midpoint(),p=new gt(f,o.end).rotate(f,l),g;g=new gt(o.start,f),h=g.pointAt(2/3).rotate(o.start,l),u=p.pointAt(1/3).rotate(p.end,-l),s=K.createSegment("C",h,u,p.end),r.appendSegment(s),g=new gt(f,o.end),h=p.pointAt(1/3).rotate(p.end,l),u=g.pointAt(1/3).rotate(o.end,-l),s=K.createSegment("C",h,u,o.end),r.appendSegment(s)}else if(n==="gap")s=K.createSegment("M",o.end),r.appendSegment(s);else if(n==="cubic"){l=o.start.theta(o.end);var v=e*.6,x=e*1.35;c=o.start.difference(o.end),d=+(c.x<0||c.x===0&&c.y<0),d&&(x*=-1),h=M(o.start.x+v,o.start.y+x).rotate(o.start,l),u=M(o.end.x-v,o.end.y+x).rotate(o.end,l),s=K.createSegment("C",h,u,o.end),r.appendSegment(s)}}else{var S=t[a+1];i==0||!S||S.isJump?(s=K.createSegment("L",o.end),r.appendSegment(s)):a5(i,r,o.end,o.start,S.end)}}),r}function a5(t,e,n,i,r){var s=n.distance(i)/2,o=n.distance(r)/2,a=-Math.min(t,s),l=-Math.min(t,o),c=n.clone().move(i,a).round(),h=n.clone().move(r,l).round(),u=new M(pc*c.x+gc*n.x,gc*n.y+pc*c.y),d=new M(pc*h.x+gc*n.x,gc*n.y+pc*h.y),f;f=K.createSegment("L",c),e.appendSegment(f),f=K.createSegment("C",u,d,h),e.appendSegment(f)}const l5=function(t,e,n,i){i5(this);var r=i.raw,s=i.size||QF,o=i.jump&&(""+i.jump).toLowerCase(),a=i.radius||t5,l=i.ignoreConnectors||e5;uv.indexOf(o)===-1&&(o=uv[0]);var c=this.paper,h=c.model,u=h.getLinks();if(u.length===1)return pv(qh(t,e,n),s,o,a);var d=this.model,f=u.indexOf(d),p=c.options.defaultConnector||{},g=u.filter(function(k,N){var m=k.get("connector")||p;return pt(l).includes(m.name)?!1:N>f?m.name!=="jumpover":!0}),v=g.map(function(k){return c.findViewByModel(k)}),x=qh(t,e,n),S=v.map(function(k){return k==null?[]:k===this?x:qh(k.sourcePoint,k.targetPoint,k.route)},this),C=x.reduce(function(k,N){var m=g.reduce(function(b,w,T){if(w!==d){const E=S[T].slice(),D=E.findIndex(z=>n5(N,z));D>-1&&N.containsPoint(E[D].end)&&E.splice(D+1,1);const $=s5(N,E);b.push.apply(b,$)}return b},[]).sort(function(b,w){return fv(N.start,b)-fv(N.start,w)});return m.length>0?k.push.apply(k,o5(N,m,s)):k.push(N),k},[]),P=pv(C,s,o,a);return r?P:P.serialize()},c5=function(t,e,n=[],i={}){const{raw:r}=i;return ng(t,e,n,{cornerType:"point",raw:r})},u5=10,h5=0,v_=function(t,e,n=[],i={}){const{radius:r=u5,raw:s}=i;return ng(t,e,n,{cornerType:"cubic",cornerRadius:r,precision:h5,raw:s})},d5=function(t,e,n,i){var r=i&&i.raw,s;if(n&&n.length!==0){var o=[t].concat(n).concat([e]),a=le.throughPoints(o);s=new K(a)}else{s=new K;var l;if(l=K.createSegment("M",t),s.appendSegment(l),Math.abs(t.x-e.x)>=Math.abs(t.y-e.y)){var c=(t.x+e.x)/2;l=K.createSegment("C",c,t.y,c,e.y,e.x,e.y),s.appendSegment(l)}else{var h=(t.y+e.y)/2;l=K.createSegment("C",t.x,h,e.x,h,e.x,e.y),s.appendSegment(l)}}return r?s:s.serialize()},ui={AUTO:"auto",HORIZONTAL:"horizontal",VERTICAL:"vertical",CLOSEST_POINT:"closest-point",OUTWARDS:"outwards"},Rn={UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right",AUTO:"auto",CLOSEST_POINT:"closest-point",OUTWARDS:"outwards"},ig=function(t,e,n=[],i={},r){const s=!!i.raw,{direction:o=ui.AUTO,precision:a=3}=i,l={coeff:i.distanceCoefficient||.6,angleTangentCoefficient:i.angleTangentCoefficient||80,tau:i.tension||.5,sourceTangent:i.sourceTangent?new M(i.sourceTangent):null,targetTangent:i.targetTangent?new M(i.targetTangent):null,rotate:!!i.rotate};typeof i.sourceDirection=="string"?l.sourceDirection=i.sourceDirection:typeof i.sourceDirection=="number"?l.sourceDirection=new M(1,0).rotate(null,i.sourceDirection):l.sourceDirection=i.sourceDirection?new M(i.sourceDirection).normalize():null,typeof i.targetDirection=="string"?l.targetDirection=i.targetDirection:typeof i.targetDirection=="number"?l.targetDirection=new M(1,0).rotate(null,i.targetDirection):l.targetDirection=i.targetDirection?new M(i.targetDirection).normalize():null;const c=[t,...n,e].map(g=>new M(g));let h;if(l.sourceTangent)h=l.sourceTangent;else{const g=v5(r,c,o,l),v=c[0].distance(c[1])*l.coeff,x=c[1].difference(c[0]).normalize(),S=tf(g,x);if(S>Math.PI/4){const C=v+(S-Math.PI/4)*l.angleTangentCoefficient;h=g.clone().scale(C,C)}else h=g.clone().scale(v,v)}let u;if(l.targetTangent)u=l.targetTangent;else{const g=y5(r,c,o,l),v=c.length-1,x=c[v-1].distance(c[v])*l.coeff,S=c[v-1].difference(c[v]).normalize(),C=tf(g,S);if(C>Math.PI/4){const P=x+(C-Math.PI/4)*l.angleTangentCoefficient;u=g.clone().scale(P,P)}else u=g.clone().scale(x,x)}const f=x5(c,h,u,l).map(g=>w5(g,l)),p=new K(f).round(a);return s?p:p.serialize()};ig.Directions=ui;ig.TangentDirections=Rn;function f5(t,e,n){const{sourceBBox:i}=t;let r,s;if(!t.sourceView)i.x>e[1].x?r="right":r="left";else if(s=t.sourceView.model.angle(),n.rotate&&s){const a=t.sourceView.getNodeUnrotatedBBox(t.sourceView.el),l=e[0].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[0]);let o;switch(r){case"left":o=new M(-1,0);break;case"right":default:o=new M(1,0);break}return n.rotate&&s&&o.rotate(null,-s),o}function p5(t,e,n){const{targetBBox:i}=t;let r,s;if(!t.targetView)i.x>e[e.length-2].x?r="left":r="right";else if(s=t.targetView.model.angle(),n.rotate&&s){const a=t.targetView.getNodeUnrotatedBBox(t.targetView.el),l=e[e.length-1].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[e.length-1]);let o;switch(r){case"left":o=new M(-1,0);break;case"right":default:o=new M(1,0);break}return n.rotate&&s&&o.rotate(null,-s),o}function g5(t,e,n){const{sourceBBox:i}=t;let r,s;if(!t.sourceView)i.y>e[1].y?r="bottom":r="top";else if(s=t.sourceView.model.angle(),n.rotate&&s){const a=t.sourceView.getNodeUnrotatedBBox(t.sourceView.el),l=e[0].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[0]);let o;switch(r){case"top":o=new M(0,-1);break;case"bottom":default:o=new M(0,1);break}return n.rotate&&s&&o.rotate(null,-s),o}function m5(t,e,n){const{targetBBox:i}=t;let r,s;if(!t.targetView)i.y>e[e.length-2].y?r="top":r="bottom";else if(s=t.targetView.model.angle(),n.rotate&&s){const a=t.targetView.getNodeUnrotatedBBox(t.targetView.el),l=e[e.length-1].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[e.length-1]);let o;switch(r){case"top":o=new M(0,-1);break;case"bottom":default:o=new M(0,1);break}return n.rotate&&s&&o.rotate(null,-s),o}function gv(t,e,n){const{sourceBBox:i}=t;let r,s;if(!t.sourceView)r=i.sideNearestToPoint(e[1]);else if(s=t.sourceView.model.angle(),n.rotate&&s){const a=t.sourceView.getNodeUnrotatedBBox(t.sourceView.el),l=e[0].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[0]);let o;switch(r){case"top":o=new M(0,-1);break;case"bottom":o=new M(0,1);break;case"right":o=new M(1,0);break;case"left":o=new M(-1,0);break}return n.rotate&&s&&o.rotate(null,-s),o}function mv(t,e,n){const{targetBBox:i}=t;let r,s;if(!t.targetView)r=i.sideNearestToPoint(e[e.length-2]);else if(s=t.targetView.model.angle(),n.rotate&&s){const a=t.targetView.getNodeUnrotatedBBox(t.targetView.el),l=e[e.length-1].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[e.length-1]);let o;switch(r){case"top":o=new M(0,-1);break;case"bottom":o=new M(0,1);break;case"right":o=new M(1,0);break;case"left":o=new M(-1,0);break}return n.rotate&&s&&o.rotate(null,-s),o}function vv(t,e,n){return e[1].difference(e[0]).normalize()}function yv(t,e,n){const i=e.length-1;return e[i-1].difference(e[i]).normalize()}function bv(t,e,n){const{sourceBBox:i}=t,r=i.center();return e[0].difference(r).normalize()}function xv(t,e,n){const{targetBBox:i}=t,r=i.center();return e[e.length-1].difference(r).normalize()}function v5(t,e,n,i){if(i.sourceDirection)switch(i.sourceDirection){case Rn.UP:return new M(0,-1);case Rn.DOWN:return new M(0,1);case Rn.LEFT:return new M(-1,0);case Rn.RIGHT:return new M(1,0);case Rn.AUTO:return gv(t,e,i);case Rn.CLOSEST_POINT:return vv(t,e);case Rn.OUTWARDS:return bv(t,e);default:return i.sourceDirection}switch(n){case ui.HORIZONTAL:return f5(t,e,i);case ui.VERTICAL:return g5(t,e,i);case ui.CLOSEST_POINT:return vv(t,e);case ui.OUTWARDS:return bv(t,e);case ui.AUTO:default:return gv(t,e,i)}}function y5(t,e,n,i){if(i.targetDirection)switch(i.targetDirection){case Rn.UP:return new M(0,-1);case Rn.DOWN:return new M(0,1);case Rn.LEFT:return new M(-1,0);case Rn.RIGHT:return new M(1,0);case Rn.AUTO:return mv(t,e,i);case Rn.CLOSEST_POINT:return yv(t,e);case Rn.OUTWARDS:return xv(t,e);default:return i.targetDirection}switch(n){case ui.HORIZONTAL:return p5(t,e,i);case ui.VERTICAL:return m5(t,e,i);case ui.CLOSEST_POINT:return yv(t,e);case ui.OUTWARDS:return xv(t,e);case ui.AUTO:default:return mv(t,e,i)}}function b5(t,e){const n=Math.cos(e),i=Math.sin(e),r=n*t.x-i*t.y,s=i*t.x+n*t.y;t.x=r,t.y=s}function tf(t,e){let n=t.dot(e)/(t.magnitude()*e.magnitude());return n<-1&&(n=-1),n>1&&(n=1),Math.acos(n)}function wv(t,e){return t.x*e.y-t.y*e.x}function x5(t,e,n,i){const{tau:r,coeff:s}=i,o=[],a=[],l=[],c=t.length-1;for(let h=0;h<c;h++)o[h]=t[h].distance(t[h+1]);a[0]=e,a[c]=n;for(let h=1;h<c;h++){let u,d;h===1?u=t[h-1].clone().offset(a[h-1].x,a[h-1].y):u=t[h-1].clone(),h===c-1?d=t[h+1].clone().offset(a[h+1].x,a[h+1].y):d=t[h+1].clone();const f=u.difference(t[h]).normalize(),p=d.difference(t[h]).normalize(),g=tf(f,p);let v=(Math.PI-g)/2,x;const S=wv(f,p);let C;C=wv(t[h].difference(t[h+1]),t[h].difference(t[h-1])),S<0&&(v=-v),g<Math.PI/2&&(v<0&&C<0||v>0&&C>0)&&(v=v-Math.PI),x=p.clone(),b5(x,v);const P=x.clone(),k=x.clone(),N=o[h-1]*s,m=o[h]*s;P.scale(N,N),k.scale(m,m),a[h]=[P,k]}for(let h=0;h<c;h++){let u,d;h===0?u=t[h+1].difference(a[h].x/r,a[h].y/r):u=t[h+1].difference(a[h][1].x/r,a[h][1].y/r),h===c-1?d=t[h].clone().offset(a[h+1].x/r,a[h+1].y/r):d=t[h].difference(a[h+1][0].x/r,a[h+1][0].y/r),l[h]=[u,t[h],t[h+1],d]}return l}function w5(t,e){const{tau:n}=e,i=new M;i.x=t[1].x+(t[2].x-t[0].x)/(6*n),i.y=t[1].y+(t[2].y-t[0].y)/(6*n);const r=new M;return r.x=t[2].x+(t[3].x-t[1].x)/(6*n),r.y=t[2].y+(t[3].y-t[1].y)/(6*n),new le(t[1],i,r,t[2])}const _5=Object.freeze(Object.defineProperty({__proto__:null,curve:ig,jumpover:l5,normal:c5,rounded:v_,smooth:d5,straight:ng},Symbol.toStringTag,{value:"Module"}));var Ss=function(t){this.cid=es("view"),this.preinitialize.apply(this,arguments),H(this,tl(t,E5)),this._ensureElement(),this.initialize.apply(this,arguments)},S5=/^(\S+)\s*(.*)$/,E5=["model","collection","el","id","attributes","className","tagName","events"];H(Ss.prototype,rn,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof q?t:q(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=ee(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var n=t[e];if(_t(n)||(n=this[n]),!!n){var i=e.match(S5);this.delegate(i[1],i[2],n.bind(this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.cid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.cid,e,n),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(ee(this,"el"));else{var t=H({},ee(this,"attributes"));this.id&&(t.id=ee(this,"id")),this.className&&(t.class=ee(this,"className")),this.setElement(this._createElement(ee(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}});Ss.extend=Qp;const jr={},ce=Ss.extend({options:{},theme:null,themeClassNamePrefix:kn("theme-"),requireSetThemeOverride:!1,defaultTheme:Tr.defaultTheme,children:null,childNodes:null,DETACHABLE:!0,UPDATE_PRIORITY:2,FLAG_INSERT:1<<30,FLAG_REMOVE:1<<29,FLAG_INIT:1<<28,constructor:function(t){this.requireSetThemeOverride=t&&!!t.theme,this.options=H({},this.options,t),Ss.call(this,t)},initialize:function(){jr[this.cid]=this,this.setTheme(this.options.theme||this.defaultTheme),this.init()},unmount:function(){this.svgElement?this.vel.remove():this.$el.remove()},isMounted:function(){return this.el.parentNode!==null},renderChildren:function(t){if(t||(t=ee(this,"children")),t){var e=this.svgElement,n=L.namespace[e?"svg":"xhtml"],i=el(t,n);(e?this.vel:this.$el).empty().append(i.fragment),this.childNodes=i.selectors}return this},findAttributeNode:function(t,e){let n=e;for(;n&&n.nodeType===1;){if(n.getAttribute(t))return n;if(n===this.el)return null;n=n.parentNode}return null},findAttribute:function(t,e){const n=this.findAttributeNode(t,e);return n&&n.getAttribute(t)},_ensureElement:function(){if(this.el)this.setElement(ee(this,"el"));else{var t=ee(this,"tagName"),e=H({},ee(this,"attributes")),n=H({},ee(this,"style"));this.id&&(e.id=ee(this,"id")),this.setElement(this._createElement(t)),this._setAttributes(e),this._setStyle(n)}this._ensureElClassName()},_setAttributes:function(t){this.svgElement?this.vel.attr(t):this.$el.attr(t)},_setStyle:function(t){this.$el.css(t)},_createElement:function(t){return this.svgElement?document.createElementNS(L.namespace.svg,t):document.createElement(t)},_setElement:function(t){this.$el=t instanceof q?t:q(t),this.el=this.$el[0],this.svgElement&&(this.vel=L(this.el))},_ensureElClassName:function(){var t=ee(this,"className");if(t){var e=kn(t);this.svgElement?this.vel.removeClass(t).addClass(e):this.$el.removeClass(t).addClass(e)}},init:function(){},onRender:function(){},confirmUpdate:function(){return 0},setTheme:function(t,e){return e=e||{},this.theme&&this.requireSetThemeOverride&&!e.override?this:(this.removeThemeClassName(),this.addThemeClassName(t),this.onSetTheme(this.theme,t),this.theme=t,this)},addThemeClassName:function(t){if(t=t||this.theme,!t)return this;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.addClass(e):this.$el.addClass(e),this},removeThemeClassName:function(t){t=t||this.theme;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.removeClass(e):this.$el.removeClass(e),this},onSetTheme:function(t,e){},remove:function(){return this.onRemove(),this.undelegateDocumentEvents(),jr[this.cid]=null,Ss.prototype.remove.apply(this,arguments),this},onRemove:function(){},getEventNamespace:function(){return".joint-event-ns-"+this.cid},delegateElementEvents:function(t,e,n){if(!e)return this;n||(n={});var i=this.getEventNamespace();for(var r in e){var s=e[r];typeof s!="function"&&(s=this[s]),s&&q(t).on(r+i,n,s.bind(this))}return this},undelegateElementEvents:function(t){return q(t).off(this.getEventNamespace()),this},delegateDocumentEvents:function(t,e){return t||(t=ee(this,"documentEvents")),this.delegateElementEvents(document,t,e)},undelegateDocumentEvents:function(){return this.undelegateElementEvents(document)},eventData:function(t,e){if(!t)throw new Error("eventData(): event object required.");var n=t.data,i="__"+this.cid+"__";return e===void 0?n?n[i]||{}:{}:(n||(n=t.data={}),n[i]||(n[i]={}),H(n[i],e),this)},stopPropagation:function(t){return this.eventData(t,{propagationStopped:!0}),this},isPropagationStopped:function(t){return!!this.eventData(t).propagationStopped}},{extend:function(){var t=Array.from(arguments),e=t[0]&&H({},t[0])||{},n=t[1]&&H({},t[1])||{},i=e.render||this.prototype&&this.prototype.render||null;return e.render=function(){return typeof i=="function"&&i.apply(this,arguments),this.render.__render__===i&&this.onRender(),this},e.render.__render__=i,Ss.extend.call(this,e,n)}});var kr=function(t,e){e||(e={}),this.preinitialize.apply(this,arguments),e.model&&(this.model=e.model),e.comparator!==void 0&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,H({silent:!0},e))},T5={add:!0,remove:!0,merge:!0},A5={add:!0,remove:!1},_v=function(t,e,n){n=Math.min(Math.max(n,0),t.length);var i=Array(t.length-n),r=e.length,s;for(s=0;s<i.length;s++)i[s]=t[s+n];for(s=0;s<r;s++)t[s+n]=e[s];for(s=0;s<i.length;s++)t[s+r+n]=i[s]};H(kr.prototype,rn,{model:gn,preinitialize:function(){},initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},add:function(t,e){return this.set(t,H({merge:!1},e,A5))},remove:function(t,e){e=H({},e);var n=!Array.isArray(t);t=n?[t]:t.slice();var i=this._removeModels(t,e);return!e.silent&&i.length&&(e.changes={added:[],merged:[],removed:i},this.trigger("update",this,e)),n?i[0]:i},set:function(t,e){if(t!=null){e=H({},T5,e);var n=!Array.isArray(t);t=n?[t]:t.slice();var i=e.at;i!=null&&(i=+i),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);var r=[],s=[],o=[],a=[],l={},c=e.add,h=e.merge,u=e.remove,d=!1,f=this.comparator&&i==null&&e.sort!==!1,p=ne(this.comparator)?this.comparator:null,g,v;for(v=0;v<t.length;v++){g=t[v];var x=this.get(g);if(x){if(h&&g!==x){var S=this._isModel(g)?g.attributes:g;x.set(S,e),o.push(x),f&&!d&&(d=x.hasChanged(p))}l[x.cid]||(l[x.cid]=!0,r.push(x)),t[v]=x}else c&&(g=t[v]=this._prepareModel(g,e),g&&(s.push(g),this._addReference(g,e),l[g.cid]=!0,r.push(g)))}if(u){for(v=0;v<this.length;v++)g=this.models[v],l[g.cid]||a.push(g);a.length&&this._removeModels(a,e)}var C=!1,P=!f&&c&&u;if(r.length&&P?(C=this.length!==r.length||this.models.some(function(k,N){return k!==r[N]}),this.models.length=0,_v(this.models,r,0),this.length=this.models.length):s.length&&(f&&(d=!0),_v(this.models,s,i??this.length),this.length=this.models.length),d&&this.sort({silent:!0}),!e.silent){for(v=0;v<s.length;v++)i!=null&&(e.index=i+v),g=s[v],g.trigger("add",g,this,e);(d||C)&&this.trigger("sort",this,e),(s.length||a.length||o.length)&&(e.changes={added:s,removed:a,merged:o},this.trigger("update",this,e))}return n?t[0]:t}},reset:function(t,e){e=e?we(e):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,H({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,H({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,H({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return Array.prototype.slice.apply(this.models,arguments)},get:function(t){if(t!=null)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t,t.idAttribute)]||t.cid&&this._byId[t.cid]},has:function(t){return this.get(t)!=null},at:function(t){return t<0&&(t+=this.length),this.models[t]},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var n=e.length;return _t(e)&&(e=e.bind(this)),n===1||ne(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t,e){return t[e||this.model.prototype.idAttribute||"id"]},values:function(){return new Ua(this,y_)},keys:function(){return new Ua(this,b_)},entries:function(){return new Ua(this,C5)},each:function(t,e){this.models.forEach(t,e)},filter:function(t,e){return this.models.filter(t,e)},find:function(t,e){return this.models.find(t,e)},findIndex:function(t,e){return this.models.findIndex(t,e)},first:function(){return this.models[0]},includes:function(t){return this.models.includes(t)},last:function(){return this.models[this.models.length-1]},isEmpty:function(){return!this.models.length},map:function(t,e){return this.models.map(t,e)},reduce:function(t,e=this.first()){return this.models.reduce(t,e)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?we(e):{},e.collection=this;var n;return this.model.prototype?n=new this.model(t,e):n=this.model(t,e),n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_removeModels:function(t,e){for(var n=[],i=0;i<t.length;i++){var r=this.get(t[i]);if(r){var s=this.models.indexOf(r);this.models.splice(s,1),this.length--,delete this._byId[r.cid];var o=this.modelId(r.attributes,r.idAttribute);o!=null&&delete this._byId[o],e.silent||(e.index=s,r.trigger("remove",r,this,e)),n.push(r),this._removeReference(r,e)}}return t.length>0&&!e.silent&&delete e.index,n},_isModel:function(t){return t instanceof gn},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.modelId(t.attributes,t.idAttribute);n!=null&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var n=this.modelId(t.attributes,t.idAttribute);n!=null&&delete this._byId[n],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if(e){if((t==="add"||t==="remove")&&n!==this)return;if(t==="changeId"){var r=this.modelId(e.previousAttributes(),e.idAttribute),s=this.modelId(e.attributes,e.idAttribute);r!=null&&delete this._byId[r],s!=null&&(this._byId[s]=e)}}this.trigger.apply(this,arguments)}});var ou=typeof Symbol=="function"&&Symbol.iterator;ou&&(kr.prototype[ou]=kr.prototype.values);var Ua=function(t,e){this._collection=t,this._kind=e,this._index=0},y_=1,b_=2,C5=3;ou&&(Ua.prototype[ou]=function(){return this});Ua.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var t=this._collection.at(this._index);this._index++;var e;if(this._kind===y_)e=t;else{var n=this._collection.modelId(t.attributes,t.idAttribute);this._kind===b_?e=n:e=[n,t]}return{value:e,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var P5={toArray:1,sortBy:3},I5=[kr,P5,"models"];function k5(t){var e=t[0],n=t[1],i=t[2];FB(e,{sortBy:tn,toArray:pt},n,i)}k5(I5);kr.extend=Qp;function Ca(t){return t?Array.isArray(t)?t:[t]:[]}const hi=ce.extend({tagName:"g",svgElement:!0,className:"highlight",HIGHLIGHT_FLAG:1,UPDATE_PRIORITY:3,DETACHABLE:!1,UPDATABLE:!0,MOUNTABLE:!0,cellView:null,nodeSelector:null,node:null,updateRequested:!1,postponedUpdate:!1,transformGroup:null,detachedTransformGroup:null,requestUpdate(t,e){const{paper:n}=t;this.cellView=t,this.nodeSelector=e,n&&(this.updateRequested=!0,n.requestViewUpdate(this,this.HIGHLIGHT_FLAG,this.UPDATE_PRIORITY))},confirmUpdate(){this.updateRequested=!1;const{cellView:t,nodeSelector:e}=this;return t.isMounted()?(this.update(t,e),this.mount(),this.transform(),0):(this.postponedUpdate=!0,0)},findNode(t,e=null){let n;if(typeof e=="string")n=t.findNode(e);else if(Ce(e)){const i=t.model.isLink(),{label:r=null,port:s,selector:o}=e;i&&r!==null?n=t.findLabelNode(r,o):!i&&s?n=t.findPortNode(s,o):n=t.findNode(o)}else e&&(n=L.toNode(e),n instanceof SVGElement||(n=null));return n||null},getNodeMatrix(t,e){const{options:n}=this,{layer:i}=n,{rotatableNode:r}=t,s=t.getNodeMatrix(e);return r?i?r.contains(e)?s:t.getRootRotateMatrix().inverse().multiply(s):t.getNodeRotateMatrix(e).multiply(s):s},mount(){const{MOUNTABLE:t,cellView:e,el:n,options:i,transformGroup:r,detachedTransformGroup:s,postponedUpdate:o,nodeSelector:a}=this;if(!t||r)return;if(o){this.update(e,a),this.transform();return}const{vel:l,paper:c}=e,{layer:h}=i;if(h){let u;s?(u=s,this.detachedTransformGroup=null):u=L("g").addClass("highlight-transform").append(n),this.transformGroup=u,c.getLayerView(h).insertSortedNode(u.node,i.z)}else(!n.parentNode||n.nextSibling)&&l.append(n)},unmount(){const{MOUNTABLE:t,transformGroup:e,vel:n}=this;t&&(e?(this.transformGroup=null,this.detachedTransformGroup=e,e.remove()):n.remove())},transform(){const{transformGroup:t,cellView:e,updateRequested:n}=this;if(!t||e.model.isLink()||n)return;const i=e.getRootTranslateMatrix(),r=e.getRootRotateMatrix(),s=i.multiply(r);t.attr("transform",L.matrixToTransformString(s))},update(){const{node:t,cellView:e,nodeSelector:n,updateRequested:i,id:r}=this;if(i)return;this.postponedUpdate=!1;const s=this.node=this.findNode(e,n);t&&this.unhighlight(e,t),s?(this.highlight(e,s),this.mount()):(this.unmount(),e.notify("cell:highlight:invalid",r,this))},onRemove(){const{node:t,cellView:e,id:n,constructor:i}=this;t&&this.unhighlight(e,t),this.unmount(),i._removeRef(e,n)},highlight(t,e){},unhighlight(t,e){},listenToUpdateAttributes(t){const e=ee(this,"UPDATE_ATTRIBUTES");!Array.isArray(e)||e.length===0||this.listenTo(t.model,"change",this.onCellAttributeChange)},onCellAttributeChange(){const{cellView:t}=this;if(!t)return;const{model:e,paper:n}=t;ee(this,"UPDATE_ATTRIBUTES").some(r=>e.hasChanged(r))&&n.requestViewUpdate(this,this.HIGHLIGHT_FLAG,this.UPDATE_PRIORITY)}},{_views:{},highlight:function(t,e,n){const i=this.uniqueId(e,n);this.add(t,e,i,n)},unhighlight:function(t,e,n){const i=this.uniqueId(e,n);this.remove(t,i)},get(t,e=null){const{cid:n}=t,{_views:i}=this,r=i[n];if(e===null){const s=[];if(!r)return s;for(let o in r){const a=r[o];a instanceof this&&s.push(a)}return s}else{if(!r)return null;if(e in r){const s=r[e];if(s instanceof this)return s}return null}},add(t,e,n,i={}){if(!n)throw new Error("dia.HighlighterView: An ID required.");const r=hi.get(t,n);r&&r.remove();const s=new this(i);return s.id=n,this._addRef(t,n,s),s.requestUpdate(t,e),s.listenToUpdateAttributes(t),s},_addRef(t,e,n){const{cid:i}=t,{_views:r}=this;let s=r[i];s||(s=r[i]={}),s[e]=n},_removeRef(t,e){const{cid:n}=t,{_views:i}=this,r=i[n];if(r){e&&delete r[e];for(let s in r)return;delete i[n]}},remove(t,e=null){Ca(this.get(t,e)).forEach(n=>{n.remove()})},removeAll(t,e=null){const{_views:n}=this;for(let i in n)for(let r in n[i]){const s=n[i][r];s.cellView.paper===t&&s instanceof this&&(e===null||r===e)&&s.remove()}},update(t,e=null,n=!1){Ca(this.get(t,e)).forEach(i=>{(n||i.UPDATABLE)&&i.update()})},transform(t,e=null){Ca(this.get(t,e)).forEach(n=>{n.UPDATABLE&&n.transform()})},unmount(t,e=null){Ca(this.get(t,e)).forEach(n=>n.unmount())},mount(t,e=null){Ca(this.get(t,e)).forEach(n=>n.mount())},uniqueId(t,e=""){return L.ensureId(t)+JSON.stringify(e)}}),O5=hi.extend({tagName:"path",className:"highlight-stroke",attributes:{"pointer-events":"none",fill:"none"},options:{padding:3,rx:0,ry:0,useFirstSubpath:!1,attrs:{"stroke-width":3,stroke:"#FEB663"}},getPathData(t,e){const{options:n}=this,{useFirstSubpath:i}=n;let r;try{const s=L(e);if(r=s.convertToPathData().trim(),s.tagName()==="PATH"&&i){const o=r.search(/.M/i)+1;o>0&&(r=r.substr(0,o))}}catch{const o=t.getNodeBoundingRect(e);r=L.rectToPath(H({},n,o.toJSON()))}return r},highlightConnection(t){this.vel.attr("d",t.getSerializedConnection())},highlightNode(t,e){const{vel:n,options:i}=this,{padding:r,layer:s}=i;let o=this.getNodeMatrix(t,e);if(r){!s&&e===t.el&&n.remove();let a=t.getNodeBoundingRect(e);const l=a.x+a.width/2,c=a.y+a.height/2;a=L.transformRect(a,o);const h=Math.max(a.width,1),u=Math.max(a.height,1),d=(h+r)/h,f=(u+r)/u,p=L.createSVGMatrix({a:d,b:0,c:0,d:f,e:l-d*l,f:c-f*c});o=o.multiply(p)}n.attr({d:this.getPathData(t,e),transform:L.matrixToTransformString(o)})},highlight(t,e){const{vel:n,options:i}=this;n.attr(i.attrs),i.nonScalingStroke&&n.attr("vector-effect","non-scaling-stroke"),t.isNodeConnection(e)?this.highlightConnection(t):this.highlightNode(t,e)}}),Sv=20;function L5(t,e){const n=t.children();for(;n.length>0;){const i=n.shift();e(i)&&n.push(...i.children())}}const M5=hi.extend({tagName:"rect",className:"highlight-mask",attributes:{"pointer-events":"none"},options:{padding:3,maskClip:Sv,deep:!1,attrs:{stroke:"#FEB663","stroke-width":3,"stroke-linecap":"butt","stroke-linejoin":"miter"}},VISIBLE:"white",INVISIBLE:"black",MASK_ROOT_ATTRIBUTE_BLACKLIST:["marker-start","marker-end","marker-mid","transform","stroke-dasharray","class"],MASK_CHILD_ATTRIBUTE_BLACKLIST:["stroke","fill","stroke-width","stroke-opacity","stroke-dasharray","fill-opacity","marker-start","marker-end","marker-mid","class"],MASK_REPLACE_TAGS:["FOREIGNOBJECT","IMAGE","USE","TEXT","TSPAN","TEXTPATH"],MASK_REMOVE_TAGS:["TEXT","TSPAN","TEXTPATH"],transformMaskChild(t,e){const{MASK_CHILD_ATTRIBUTE_BLACKLIST:n,MASK_REPLACE_TAGS:i,MASK_REMOVE_TAGS:r}=this,s=e.tagName();if(!L.isSVGGraphicsElement(e)||r.includes(s))return e.remove(),!1;if(i.includes(s)){const o=t.vel.findOne(`#${e.id}`);if(o){const{node:a}=o;let l=t.getNodeBoundingRect(a);t.model.isElement()&&(l=L.transformRect(l,t.getNodeMatrix(a)));const c=L("rect",l.toJSON()),{x:h,y:u}=l.center(),{angle:d,cx:f=h,cy:p=u}=o.rotate();d&&c.rotate(d,f,p),e.parent().append(c)}return e.remove(),!1}return n.forEach(o=>{o==="fill"&&e.attr("fill")==="none"||e.removeAttr(o)}),!0},transformMaskRoot(t,e){const{MASK_ROOT_ATTRIBUTE_BLACKLIST:n}=this;n.forEach(i=>{e.removeAttr(i)})},getMaskShape(t,e){const{options:n,MASK_REPLACE_TAGS:i}=this,{deep:r}=n,s=e.tagName();let o;if(s==="G"){if(!r)return null;o=e.clone(),L5(o,a=>this.transformMaskChild(t,a))}else{if(i.includes(s))return null;o=e.clone()}return this.transformMaskRoot(t,o),o},getMaskId(){return`highlight-mask-${this.cid}`},getMask(t,e){const{VISIBLE:n,INVISIBLE:i,options:r}=this,{padding:s,attrs:o}=r,a=parseFloat(L("g").attr(o).attr("stroke-width")),l=e.attr("fill")!=="none";let c=parseFloat(e.attr("stroke-width"));isNaN(c)&&(c=1);const h=c+s*2,u=h+a*2;let d=this.getMaskShape(t,e);if(!d){const f=t.getNodeBoundingRect(e.node);f.inflate(f.width?0:.5,f.height?0:.5),d=L("rect",f.toJSON())}return d.attr(o),L("mask",{id:this.getMaskId()}).append([d.clone().attr({fill:l?n:"none",stroke:n,"stroke-width":u}),d.clone().attr({fill:l?i:"none",stroke:i,"stroke-width":h})])},removeMask(t){const e=t.svg.getElementById(this.getMaskId());e&&t.defs.removeChild(e)},addMask(t,e){t.defs.appendChild(e.node)},highlight(t,e){const{options:n,vel:i}=this,{padding:r,attrs:s,maskClip:o=Sv,layer:a}=n,l="stroke"in s?s.stroke:"#000000";!a&&e===t.el&&i.remove();const c=t.getNodeBoundingRect(e).inflate(r+o),h=this.getNodeMatrix(t,e),u=this.getMask(t,L(e));this.addMask(t.paper,u),i.attr(c.toJSON()),i.attr({transform:L.matrixToTransformString(h),mask:`url(#${u.id})`,fill:l})},unhighlight(t){this.removeMask(t.paper)}}),D5=hi.extend({UPDATABLE:!1,MOUNTABLE:!1,highlight:function(t,e){const{alphaValue:n=.3}=this.options;e.style.opacity=n},unhighlight:function(t,e){e.style.opacity=""}}),Ev=kn("highlighted"),N5=hi.extend({UPDATABLE:!1,MOUNTABLE:!1,options:{className:Ev},highlight:function(t,e){L(e).addClass(this.options.className)},unhighlight:function(t,e){L(e).removeClass(this.options.className)}},{className:Ev}),Kh={ROW:"row",COLUMN:"column"},R5=hi.extend({tagName:"g",MOUNTABLE:!0,UPDATE_ATTRIBUTES:function(){return[this.options.attribute]},_prevItems:null,highlight(t,e){const n=t.model,{attribute:i,size:r=20,gap:s=5,direction:o=Kh.ROW}=this.options;if(!i)throw new Error("List: attribute is required");const a=typeof r=="number"?{width:r,height:r}:r,l=o===Kh.ROW,c=l?a.width:a.height;let h=n.get(i);Array.isArray(h)||(h=[]);const u=this._prevItems||[],d=h.map((v,x)=>ke(u[x],h[x]));if(u.length!==h.length||d.some(v=>!v)){const v=this.vel.children(),x=h.map((S,C)=>{const P=C in v?v[C].node:null;if(d[C])return P;const k=this.createListItem(S,a,P);if(!k)return null;if(!(k instanceof SVGElement))throw new Error("List: item must be an SVGElement");k.dataset.index=C,k.dataset.attribute=i;const N=C*(c+s);return k.setAttribute("transform",l?`translate(${N}, 0)`:`translate(0, ${N})`),k});this.vel.empty().append(x),this._prevItems=h}const f=h.length,p=f===0?0:f*c+(f-1)*s,g=l?{width:p,height:a.height}:{width:a.width,height:p};this.position(n,g)},position(t,e){const{vel:n,options:i}=this,{margin:r=5,position:s="top-left"}=i,{width:o,height:a}=t.size(),{left:l,right:c,top:h,bottom:u}=Re(r),d=new Z(l,h,o-(l+c),a-(h+u));let{x:f,y:p}=Os(d,s);switch(s){case Xe.CENTER:case Xe.TOP:case Xe.BOTTOM:{f-=e.width/2;break}case Xe.RIGHT:case Xe.BOTTOM_RIGHT:case Xe.TOP_RIGHT:{f-=e.width;break}}switch(s){case Xe.CENTER:case Xe.RIGHT:case Xe.LEFT:{p-=e.height/2;break}case Xe.BOTTOM:case Xe.BOTTOM_RIGHT:case Xe.BOTTOM_LEFT:{p-=e.height;break}}n.attr("transform",`translate(${f}, ${p})`)}},{Directions:Kh,Positions:Xe}),$5=Object.freeze(Object.defineProperty({__proto__:null,addClass:N5,list:R5,mask:M5,opacity:D5,stroke:O5},Symbol.toStringTag,{value:"Module"}));function oh(t,e,n){if(Ce(n)){const{x:r,y:s}=n;if(isFinite(s)){const o=new gt(e,t),{start:a,end:l}=o.parallel(s);e=a,t=l}n=r}if(!isFinite(n))return t;var i=t.distance(e);return n===0&&i>0?t:t.move(e,-Math.min(n,i-1))}function rg(t){var e=t.getAttribute("stroke-width");return e===null?0:parseFloat(e)||0}function B5(t,e,n=0){let i,r,s,o;const{start:a,end:l}=t;switch(e){case"left":i="x",r=l,s=a,o=-1;break;case"right":i="x",r=a,s=l,o=1;break;case"top":i="y",r=l,s=a,o=-1;break;case"bottom":i="y",r=a,s=l,o=1;break;default:return}a[i]<l[i]?r[i]=s[i]:s[i]=r[i],isFinite(n)&&(r[i]+=o*n,s[i]+=o*n)}function F5(t,e,n,i){let{offset:r,alignOffset:s,align:o}=i;return o&&B5(t,o,s),oh(t.end,t.start,r)}function x_(t,e,n,i){var r=e.getNodeBBox(n);i.stroke&&r.inflate(rg(n)/2);var s=t.intersect(r),o=s?t.start.chooseClosest(s):t.end;return oh(o,t.start,i.offset)}function V5(t,e,n,i){var r=e.model.angle();if(r===0)return x_(t,e,n,i);var s=e.getNodeUnrotatedBBox(n);i.stroke&&s.inflate(rg(n)/2);var o=s.center(),a=t.clone().rotate(o,r),l=a.setLength(1e6).intersect(s),c=l?a.start.chooseClosest(l).rotate(o,-r):t.end;return oh(c,t.start,i.offset)}function z5(t){if(!t)return null;var e=t;do{var n=e.tagName;if(typeof n!="string")return null;if(n=n.toUpperCase(),n==="G")e=e.firstElementChild;else if(n==="TITLE")e=e.nextElementSibling;else break}while(e);return e}var Zh="segmentSubdivisons",Jh="shapeBBox";function G5(t,e,n,i){var r,s,o=i.selector,a=t.end;if(typeof o=="string"?r=e.findNode(o):o===!1?r=n:Array.isArray(o)?r=yn(n,o):r=z5(n),!L.isSVGGraphicsElement(r)){if(r===n||!L.isSVGGraphicsElement(n))return a;r=n}var l=e.getNodeShape(r),c=e.getNodeMatrix(r),h=e.getRootTranslateMatrix(),u=e.getRootRotateMatrix(),d=h.multiply(u).multiply(c),f=d.inverse(),p=L.transformLine(t,f),g=p.start.clone(),v=e.getNodeData(r);if(i.insideout===!1){v[Jh]||(v[Jh]=l.bbox());var x=v[Jh];if(x.containsPoint(g))return a}var S;if(l instanceof K){var C=i.precision||2;v[Zh]||(v[Zh]=l.getSegmentSubdivisions({precision:C})),S={precision:C,segmentSubdivisions:v[Zh]}}i.extrapolate===!0&&p.setLength(1e6),s=p.intersect(l,S),s?L.isArray(s)&&(s=g.chooseClosest(s)):i.sticky===!0&&(l instanceof Z?s=l.pointNearestToPoint(g):l instanceof Bn?s=l.intersectionWithLineFromCenterToPoint(g):s=l.closestPoint(g,S));var P=s?L.transformPoint(s,d):a,k=i.offset||0;return i.stroke&&(k+=rg(r)/2),oh(P,t.start,k)}const H5=F5,U5=x_,j5=V5,W5=G5,Y5=Object.freeze(Object.defineProperty({__proto__:null,anchor:H5,bbox:U5,boundary:W5,rectangle:j5},Symbol.toStringTag,{value:"Module"}));function Tv(t,e){if(e===0)return"0%";const n=1e3;return`${Math.round(t/e*100*n)/n}%`}function X5(t){return function(e,n,i,r){var s=n.isNodeConnection(i)?K5:q5;return s(t,e,n,i,r)}}function q5(t,e,n,i,r){var s=n.model.angle(),o=n.getNodeUnrotatedBBox(i),a=n.model.getBBox().center();r.rotate(a,s);var l=r.x-o.x,c=r.y-o.y;return t&&(l=Tv(l,o.width),c=Tv(c,o.height)),e.anchor={name:"topLeft",args:{dx:l,dy:c,rotate:!0}},e}function K5(t,e,n,i,r){var s=n.getConnection();if(!s)return e;var o=s.closestPointLength(r);if(t){var a=s.length();e.anchor={name:"connectionRatio",args:{ratio:o/a}}}else e.anchor={name:"connectionLength",args:{length:o}};return e}const Z5=X5(!0),J5=function(t,e,n){return t},Q5=function(t,e,n){var i=e.side||"bottom",r=Re(e.padding||40),s=n.sourceBBox,o=n.targetBBox,a=s.center(),l=o.center(),c,h,u;switch(i){case"bottom":u=1,c="y",h="height";break;case"top":u=-1,c="y",h="height";break;case"left":u=-1,c="x",h="width";break;case"right":u=1,c="x",h="width";break;default:throw new Error("Router: invalid side")}return a[c]+=u*(s[h]/2+r[i]),l[c]+=u*(o[h]/2+r[i]),u*(a[c]-l[c])>0?l[c]=a[c]:a[c]=l[c],[a].concat(t,l)};var tV={N:"S",S:"N",E:"W",W:"E"},eV={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function au(t,e,n){var i=new M(t.x,e.y);return n.containsPoint(i)&&(i=new M(e.x,t.y)),i}function ef(t,e){return t[e==="W"||e==="E"?"width":"height"]}function Fn(t,e){return t.x===e.x?t.y>e.y?"N":"S":t.y===e.y?t.x>e.x?"W":"E":null}function mc(t){return new Z(t.x,t.y,0,0)}function lu(t){var e=Re(t.padding||t.elementPadding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function w_(t,e){return t.sourceBBox.clone().moveAndExpand(lu(e))}function __(t,e){return t.targetBBox.clone().moveAndExpand(lu(e))}function nV(t,e){if(t.sourceAnchor)return t.sourceAnchor;var n=w_(t,e);return n.center()}function iV(t,e){if(t.targetAnchor)return t.targetAnchor;var n=__(t,e);return n.center()}function S_(t,e,n){var i=new M(t.x,e.y),r=new M(e.x,t.y),s=Fn(t,i),o=Fn(t,r),a=tV[n],l=s===n||s!==a&&(o===a||o!==n)?i:r;return{points:[l],direction:Fn(l,e)}}function Bc(t,e,n){var i=au(t,e,n);return{points:[i],direction:Fn(i,e)}}function rV(t,e,n,i){var r={},s=[new M(t.x,e.y),new M(e.x,t.y)],o=s.filter(function(u){return!n.containsPoint(u)}),a=o.filter(function(u){return Fn(u,t)!==i}),l;if(a.length>0)l=a.filter(function(u){return Fn(t,u)===i}).pop(),l=l||a[0],r.points=[l],r.direction=Fn(l,e);else{l=kw(s,o)[0];var c=new M(e).move(l,-ef(n,i)/2),h=au(c,t,n);r.points=[h,c],r.direction=Fn(c,e)}return r}function sV(t,e,n,i){var r=Bc(e,t,i),s=r.points[0];if(n.containsPoint(s)){r=Bc(t,e,n);var o=r.points[0];if(i.containsPoint(o)){var a=new M(t).move(o,-ef(n,Fn(t,o))/2),l=new M(e).move(s,-ef(i,Fn(e,s))/2),c=new gt(a,l).midpoint(),h=Bc(t,c,n),u=S_(c,e,h.direction);r.points=[h.points[0],u.points[0]],r.direction=u.direction}}return r}function Qh(t,e,n,i,r){var s={},o=n.union(i).inflate(1),a=o.center().distance(e)>o.center().distance(t),l=a?e:t,c=a?t:e,h,u,d;return r?(h=M.fromPolar(o.width+o.height,eV[r],l),h=o.pointNearestToPoint(h).move(h,-1)):h=o.pointNearestToPoint(l).move(l,1),u=au(h,c,o),h.round().equals(u.round())?(u=M.fromPolar(o.width+o.height,un(h.theta(l))+Math.PI/2,c),u=o.pointNearestToPoint(u).move(c,1).round(),d=au(h,u,o),s.points=a?[u,d,h]:[h,d,u]):s.points=a?[u,h]:[h,u],s.direction=Fn(a?h:u,e),s}function nf(t,e,n){var i=w_(n,e),r=__(n,e),s=nV(n,e),o=iV(n,e);i=i.union(mc(s)),r=r.union(mc(o)),t=pt(t).map(M),t.unshift(s),t.push(o);for(var a,l=[],c=0,h=t.length-1;c<h;c++){var u=null,d=t[c],f=t[c+1],p=!!Fn(d,f);if(c===0)c+1===h?i.intersect(r.clone().inflate(1))?u=Qh(d,f,i,r):p||(u=sV(d,f,i,r)):i.containsPoint(f)?u=Qh(d,f,i,mc(f).moveAndExpand(lu(e))):p||(u=Bc(d,f,i));else if(c+1===h){var g=p&&Fn(f,d)===a;r.containsPoint(d)||g?u=Qh(d,f,mc(d).moveAndExpand(lu(e)),r,a):p||(u=rV(d,f,r,a))}else p||(u=S_(d,f,a));u?(Array.prototype.push.apply(l,u.points),a=u.direction):a=Fn(d,f),c+1<h&&l.push(f)}return l}var E_={step:10,maximumLoops:2e3,precision:1,maxAllowedDirectionChange:90,perpendicular:!0,excludeEnds:[],excludeTypes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost:function(){return this.step},directions:function(){var t=this.step,e=this.cost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:-t,offsetY:0,cost:e},{offsetX:0,offsetY:t,cost:e},{offsetX:0,offsetY:-t,cost:e}]},penalties:function(){return{0:0,45:this.step/2,90:this.step/2}},paddingBox:function(){var t=this.step;return{x:-t,y:-t,width:2*t,height:2*t}},isPointObstacle:null,fallbackRouter:function(t,e,n){if(!_t(nf))throw new Error("Manhattan requires the orthogonal router as default fallback.");return nf(t,H({},E_,e),n)},fallbackRoute:function(t,e,n){return null},draggingRoute:null};function sg(t){this.map={},this.options=t,this.mapGridSize=100}sg.prototype.build=function(t,e){var n=this.options,i=pt(n.excludeEnds).reduce(function(l,c){var h=e.get(c);if(h){var u=t.getCell(h.id);u&&l.push(u)}return l},[]),r=[],s=t.getCell(e.get("source").id);s&&(r=iu(r,s.getAncestors().map(function(l){return l.id})));var o=t.getCell(e.get("target").id);o&&(r=iu(r,o.getAncestors().map(function(l){return l.id})));var a=this.mapGridSize;return t.getElements().reduce(function(l,c){var h=pt(n.excludeTypes).includes(c.get("type")),u=i.find(function(P){return P.id===c.id}),d=r.includes(c.id),f=h||u||d;if(!f)for(var p=c.getBBox().moveAndExpand(n.paddingBox),g=p.origin().snapToGrid(a),v=p.corner().snapToGrid(a),x=g.x;x<=v.x;x+=a)for(var S=g.y;S<=v.y;S+=a){var C=x+"@"+S;l[C]=l[C]||[],l[C].push(p)}return l},this.map),this};sg.prototype.isPointAccessible=function(t){var e=t.clone().snapToGrid(this.mapGridSize).toString();return pt(this.map[e]).every(function(n){return!n.containsPoint(t)})};function Xs(){this.items=[],this.hash={},this.values={},this.OPEN=1,this.CLOSE=2}Xs.prototype.add=function(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=this.OPEN,this.values[t]=e;var n=ih(this.items,t,(function(i){return this.values[i]}).bind(this));this.items.splice(n,0,t)};Xs.prototype.remove=function(t){this.hash[t]=this.CLOSE};Xs.prototype.isOpen=function(t){return this.hash[t]===this.OPEN};Xs.prototype.isClose=function(t){return this.hash[t]===this.CLOSE};Xs.prototype.isEmpty=function(){return this.items.length===0};Xs.prototype.pop=function(){var t=this.items.shift();return this.remove(t),t};function T_(t,e){return e&&e.paddingBox?t.sourceBBox.clone().moveAndExpand(e.paddingBox):t.sourceBBox.clone()}function A_(t,e){return e&&e.paddingBox?t.targetBBox.clone().moveAndExpand(e.paddingBox):t.targetBBox.clone()}function C_(t,e){if(t.sourceAnchor)return t.sourceAnchor;var n=T_(t,e);return n.center()}function oV(t,e){if(t.targetAnchor)return t.targetAnchor;var n=A_(t,e);return n.center()}function td(t,e,n,i,r){var s=360/n,o=t.theta(aV(t,e,i,r)),a=nn(o+s/2);return s*Math.floor(a/s)}function aV(t,e,n,i){var r=i.step,s=e.x-t.x,o=e.y-t.y,a=s/n.x,l=o/n.y,c=a*r,h=l*r;return new M(t.x+c,t.y+h)}function Av(t,e){var n=Math.abs(t-e);return n>180?360-n:n}function lV(t,e,n){var i=n.step;pt(n.directions).forEach(function(r){r.gridOffsetX=r.offsetX/i*e.x,r.gridOffsetY=r.offsetY/i*e.y})}function cV(t,e,n){return{source:e.clone(),x:Cv(n.x-e.x,t),y:Cv(n.y-e.y,t)}}function Cv(t,e){if(!t)return e;var n=Math.abs(t),i=Math.round(n/e);if(!i)return n;var r=i*e,s=n-r,o=s/i;return e+o}function uV(t,e){var n=e.source,i=pi(t.x-n.x,e.x)+n.x,r=pi(t.y-n.y,e.y)+n.y;return new M(i,r)}function Na(t,e){return t.round(e)}function Fc(t,e,n){return Na(uV(t.clone(),e),n)}function ja(t){return t.clone().toString()}function ed(t){return new M(t.x===0?0:Math.abs(t.x)/t.x,t.y===0?0:Math.abs(t.y)/t.y)}function hV(t,e,n,i,r,s,o){for(var a=[],l=ed(r.difference(n)),c=ja(n),h=t[c],u;h;){u=e[c];var d=ed(u.difference(h));d.equals(l)||(a.unshift(u),l=d),c=ja(h),h=t[c]}var f=e[c],p=ed(f.difference(i));return p.equals(l)||a.unshift(f),a}function Pv(t,e){for(var n=1/0,i=0,r=e.length;i<r;i++){var s=t.manhattanDistance(e[i]);s<n&&(n=s)}return n}function Iv(t,e,n,i,r){var s=r.precision,o=r.directionMap,a=t.difference(e.center()),l=Vt(o)?Object.keys(o):[],c=pt(n),h=l.reduce(function(u,d){if(c.includes(d)){for(var f=o[d],p=new M(t.x+f.x*(Math.abs(a.x)+e.width),t.y+f.y*(Math.abs(a.y)+e.height)),g=new gt(t,p),v=g.intersect(e)||[],x=v.length,S,C=null,P=0;P<x;P++){var k=v[P],N=t.squaredDistance(k);(S===void 0||N>S)&&(S=N,C=k)}if(C){var m=Fc(C,i,s);e.containsPoint(m)&&(m=Fc(m.offset(f.x*i.x,f.y*i.y),i,s)),u.push(m)}}return u},[]);return e.containsPoint(t)||h.push(Fc(t,i,s)),h}function dV(t,e,n,i){var r=i.precision,s,o;t instanceof Z?s=Na(C_(this,i).clone(),r):s=Na(t.clone(),r),e instanceof Z?o=Na(oV(this,i).clone(),r):o=Na(e.clone(),r);var a=cV(i.step,s,o),l,c,h,u;if(t instanceof Z?(l=s,h=Iv(l,t,i.startDirections,a,i)):(l=s,h=[l]),e instanceof Z?(c=o,u=Iv(o,e,i.endDirections,a,i)):(c=o,u=[c]),h=h.filter(W=>!n(W)),u=u.filter(W=>!n(W)),h.length>0&&u.length>0){for(var d=new Xs,f={},p={},g={},v=0,x=h.length;v<x;v++){var S=h[v],C=ja(S);d.add(C,Pv(S,u)),f[C]=S,g[C]=0}var P=i.previousDirectionAngle,k=P===void 0,N,m,b=i.directions;lV(b,a,i);for(var w=b.length,T=pt(u).reduce(function(W,Y){var tt=ja(Y);return W.push(tt),W},[]),E=i.maximumLoops;!d.isEmpty()&&E>0;){var D=d.pop(),$=f[D],z=p[D],j=g[D],O=z===void 0,B=$.equals(l),V;O?k?B?V=null:V=td(l,$,w,a,i):V=P:V=td(z,$,w,a,i);var F=h.length===u.length;if(F){for(var At=0;At<h.length;At++)if(!h[At].equals(u[At])){F=!1;break}}var vt=O&&F;if(!vt&&T.indexOf(D)>=0)return i.previousDirectionAngle=V,hV(p,f,$,l,c);for(v=0;v<w;v++){N=b[v];var zt=N.angle;if(m=Av(V,zt),!(!(k&&B)&&m>i.maxAllowedDirectionChange)){var re=Fc($.clone().offset(N.gridOffsetX,N.gridOffsetY),a,r),wt=ja(re);if(!(d.isClose(wt)||n(re))){if(T.indexOf(wt)>=0){var Tt=re.equals(c);if(!Tt){var Pt=td(re,c,w,a,i),It=Av(zt,Pt);if(It>i.maxAllowedDirectionChange)continue}}var mt=N.cost,Bt=B?0:i.penalties[m],Ct=j+mt+Bt;(!d.isOpen(wt)||Ct<g[wt])&&(f[wt]=re,p[wt]=$,g[wt]=Ct,d.add(wt,Ct+Pv(re,u)))}}}E--}}return i.fallbackRoute.call(this,l,c,i)}function fV(t){if(t.directions=ee(t,"directions"),t.penalties=ee(t,"penalties"),t.paddingBox=ee(t,"paddingBox"),t.padding=ee(t,"padding"),t.padding){var e=Re(t.padding);t.paddingBox={x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}pt(t.directions).forEach(function(n){var i=new M(0,0),r=new M(n.offsetX,n.offsetY);n.angle=nn(i.theta(r))})}function pV(t,e,n){fV(e),n.options.perpendicular=!!e.perpendicular;var i=T_(n,e),r=A_(n,e),s=C_(n,e);let o;if(typeof e.isPointObstacle=="function")o=e.isPointObstacle;else{const C=new sg(e);C.build(n.paper.model,n.model),o=P=>!C.isPointAccessible(P)}for(var a=pt(t).map(M),l=[],c=s,h,u,d=0,f=a.length;d<=f;d++){var p=null;if(u=h||i,h=a[d],!h){h=r;var g=!n.model.get("source").id||!n.model.get("target").id;if(g&&_t(e.draggingRoute)){var v=u===i?s:u,x=h.origin();p=e.draggingRoute.call(n,v,x,e)}}if(p=p||dV.call(n,u,h,o,e),p===null)return e.fallbackRouter(t,e,n);var S=p[0];S&&S.equals(c)&&p.shift(),c=p[p.length-1]||c,Array.prototype.push.apply(l,p)}return l}const rf=function(t,e,n){return pV(t,H({},E_,e),n)};var gV={maxAllowedDirectionChange:45,diagonalCost:function(){var t=this.step;return Math.ceil(Math.sqrt(t*t<<1))},directions:function(){var t=this.step,e=this.cost(),n=this.diagonalCost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:t,offsetY:t,cost:n},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:t,cost:n},{offsetX:-t,offsetY:0,cost:e},{offsetX:-t,offsetY:-t,cost:n},{offsetX:0,offsetY:-t,cost:e},{offsetX:t,offsetY:-t,cost:n}]},fallbackRoute:function(t,e,n){var i=t.theta(e),r=[],s={x:e.x,y:t.y},o={x:t.x,y:e.y};if(i%180>90){var a=s;s=o,o=a}var l=i%90<45?s:o,c=new gt(t,l),h=90*Math.ceil(i/90),u=M.fromPolar(c.squaredLength(),un(h+135),l),d=new gt(e,u),f=c.intersection(d),p=f||e,g=f?p:t,v=360/n.directions.length,x=g.theta(e),S=nn(x+v/2),C=v*Math.floor(S/v);return n.previousDirectionAngle=C,p&&r.push(p.round()),r.push(e),r}};const mV=function(t,e,n){if(!_t(rf))throw new Error("Metro requires the manhattan router.");return rf(t,H({},gV,e),n)},Q={AUTO:"auto",LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom",ANCHOR_SIDE:"anchor-side",MAGNET_SIDE:"magnet-side"},kv=[Q.LEFT,Q.RIGHT,Q.TOP,Q.BOTTOM],xo={[Q.LEFT]:Q.RIGHT,[Q.RIGHT]:Q.LEFT,[Q.TOP]:Q.BOTTOM,[Q.BOTTOM]:Q.TOP},vV=[Q.TOP,Q.BOTTOM],vc={0:Q.RIGHT,180:Q.LEFT,270:Q.TOP,90:Q.BOTTOM};function Ra(t){return t.angle()}function yc(t){return new _e(t).simplify({threshold:1}).points}function cu(t,e){const{point:n,x0:i,y0:r,view:s,bbox:o,direction:a}=t,{point:l,x0:c,y0:h,view:u,bbox:d,direction:f}=e;let p;if(s)s.model.isLink()?p=Ov(l,n,s):a===Q.ANCHOR_SIDE?p=o.sideNearestToPoint(n):a===Q.MAGNET_SIDE?p=s.model.getBBox().sideNearestToPoint(n):p=a;else{const v=new Z(i,r,0,0);p=kv.includes(a)?a:v.sideNearestToPoint(l)}let g;if(u)u.model.isLink()?g=Ov(n,l,u):f===Q.ANCHOR_SIDE?g=d.sideNearestToPoint(l):f===Q.MAGNET_SIDE?g=u.model.getBBox().sideNearestToPoint(l):g=f;else{const v=new Z(c,h,0,0);g=kv.includes(f)?f:v.sideNearestToPoint(n)}return[p,g]}function yV(t,e,n){const{x0:i,y0:r,width:s,height:o,point:a,margin:l}=t,c=i+s,h=r+o,u=i-l,d=c+l,f=r-l,{x:p}=a,{x0:g,y0:v}=e;return g===p&&v<r?Q.BOTTOM:g<p&&v<f?n.point.x===p?Q.BOTTOM:Q.RIGHT:g>p&&v<f?n.point.x===p?Q.BOTTOM:Q.LEFT:g<u&&v>=r||g>d&&v>=r?Q.TOP:g>=u&&g<=p&&v>h||g<=d&&g>=p&&v>h?n.point.x<g?Q.RIGHT:Q.LEFT:Q.TOP}function bV(t,e,n){const{x0:i,y0:r,width:s,height:o,point:a,margin:l}=t,c=i+s,h=r+o,u=i-l,d=c+l,f=h+l,{x:p}=a,{x0:g,y0:v}=e;return g===p&&v>h?Q.TOP:g<p&&v>f?n.point.x===p?Q.TOP:Q.RIGHT:g>p&&v>f?n.point.x===p?Q.TOP:Q.LEFT:g<u&&v<=h||g>d&&v<=h?Q.BOTTOM:g>=u&&g<=p&&v<r||g<=d&&g>=p&&v<r?n.point.x<g?Q.RIGHT:Q.LEFT:Q.BOTTOM}function xV(t,e,n){const{y0:i,x0:r,width:s,height:o,point:a,margin:l}=t,c=r+s,h=i+o,u=r-l,d=i-l,f=h+l,{x:p,y:g}=a,{x0:v,y0:x}=e;return v<p&&x===g?Q.RIGHT:v<=u&&x<g?Q.BOTTOM:v<=u&&x>g?Q.TOP:v>=r&&x<=d||v>=r&&x>=f?Q.LEFT:v>c&&x>=d&&x<=g||v>c&&x<=f&&x>=g?n.point.y<x?Q.BOTTOM:Q.TOP:Q.LEFT}function wV(t,e,n){const{y0:i,x0:r,width:s,height:o,point:a,margin:l}=t,c=r+s,h=i+o,u=c+l,d=i-l,f=h+l,{x:p,y:g}=a,{x0:v,y0:x}=e;return v>p&&x===g?Q.LEFT:v>=u&&x<g?Q.BOTTOM:v>=u&&x>g?Q.TOP:v<=c&&x<=d||v<=c&&x>=f?Q.RIGHT:v<r&&x>=d&&x<=g||v<r&&x<=f&&x>=g?n.point.y<x?Q.BOTTOM:Q.TOP:Q.RIGHT}function _V(t,e,n){const[i]=cu(t,e);switch(i){case Q.TOP:return yV(t,e,n);case Q.RIGHT:return wV(t,e,n);case Q.BOTTOM:return bV(t,e,n);case Q.LEFT:return xV(t,e,n)}}function Ov(t,e,n){const i=n.getTangentAtLength(n.getClosestPointLength(e)),r=Math.round(Ra(i)/90)*90;if(r%180===0&&t.y===e.y)return t.x<e.x?Q.LEFT:Q.RIGHT;if(t.x===e.x)return t.y<e.y?Q.TOP:Q.BOTTOM;switch(r){case 0:case 180:case 360:return t.y<e.y?Q.TOP:Q.BOTTOM;case 90:case 270:return t.x<e.x?Q.LEFT:Q.RIGHT}}function Lv(t,e,n,i,r,s,o){i===Q.AUTO&&(i=r?Q.MAGNET_SIDE:Q.ANCHOR_SIDE);const a=t&&t.model.isElement(),{x:l,y:c,width:h=0,height:u=0}=a?Z.fromRectUnion(n,t.model.getBBox()):s;return{point:e,x0:l,y0:c,view:t,bbox:n,width:h,height:u,direction:i,margin:a?o:0}}function nd({x:t,y:e}){const n=new M(t,e);return{point:n,x0:n.x,y0:n.y,view:null,bbox:new Z(t,e,0,0),width:0,height:0,direction:null,margin:0}}function Mv(t,e,n){const i=e.point.clone(),{x0:r,y0:s,width:o,height:a}=e;switch(t){case"left":i.x=r-n;break;case"right":i.x=r+o+n;break;case"top":i.y=s-n;break;case"bottom":i.y=s+a+n;break}return i}function Vr(t,e,n={}){const{point:i,x0:r,y0:s,width:o,height:a,margin:l}=t,{point:c,x0:h,y0:u,width:d,height:f,margin:p}=e,{targetInSourceBBox:g=!1}=n,v=h+d,x=u+f,S=r+o,C=s+a,P=r-l,k=S+l,N=s-l,m=C+l,b=h-p,w=v+p,T=u-p,E=x+p,[D,$]=cu(t,e),z=Mv(D,{point:i,x0:r,y0:s,width:o,height:a},l),j=Mv($,{point:c,x0:h,y0:u,width:d,height:f},p),{x:O,y:B}=z,{x:V,y:F}=j,At=(h+v)/2,vt=(u+x)/2,zt=(r+S)/2,re=(s+C)/2,wt=(zt<At?S+h:v+r)/2,Tt=(re<vt?C+u:x+s)/2,Pt=new Z(r,s,o,a),It=new Z(h,u,d,f),mt=Pt.clone().inflate(l),Bt=It.clone().inflate(p);if(D==="left"&&$==="right"){if(P<=w){let W=Tt;return O<=b&&(x>=N&&F<B?W=Math.min(T,N):u<=m&&F>=B&&(W=Math.max(E,m))),[{x:O,y:B},{x:O,y:W},{x:V,y:W},{x:V,y:F}]}const Ct=(O+V)/2;return[{x:Ct,y:B},{x:Ct,y:F}]}else if(D==="right"&&$==="left"){if(O>=b){let W=Tt;return O>v&&(x>=N&&F<B?W=Math.min(T,N):u<=m&&F>=B&&(W=Math.max(E,m))),[{x:O,y:B},{x:O,y:W},{x:V,y:W},{x:V,y:F}]}const Ct=(O+V)/2;return[{x:Ct,y:B},{x:Ct,y:F}]}else if(D==="top"&&$==="bottom"){const Ct=gs.rectWithRect(mt,It);if(B<F){let Y=wt,tt=B;return Ct&&(tt=Math.min(tt,T)),v>=P&&V<O?Y=Math.min(b,P):h<=k&&V>=O&&(Y=Math.max(w,k)),[{x:O,y:tt},{x:Y,y:tt},{x:Y,y:F},{x:V,y:F}]}const W=(B+F)/2;return[{x:O,y:W},{x:V,y:W}]}else if(D==="bottom"&&$==="top"){const Ct=gs.rectWithRect(mt,It);if(B>F){let Y=wt,tt=B;return Ct&&(tt=Math.max(tt,E)),v>=P&&V<O?Y=Math.min(b,P):h<=k&&V>=O&&(Y=Math.max(w,k)),[{x:O,y:tt},{x:Y,y:tt},{x:Y,y:F},{x:V,y:F}]}const W=(B+F)/2;return[{x:O,y:W},{x:V,y:W}]}else if(D==="top"&&$==="top"){if(g||gs.rectWithRect(mt,It)||B<=u&&(mt.bottomRight().x<=V||mt.bottomLeft().x>=V)||B>=u&&(Bt.bottomRight().x<=O||Bt.bottomLeft().x>=O))return[{x:O,y:Math.min(B,F)},{x:V,y:Math.min(B,F)}];let W,Y=Math.min((C+u)/2,F),tt=Math.min((s+x)/2,B);return F<B?V>O?W=Math.min(O,b):W=Math.max(O,w):V>=O?W=Math.max(V,k):W=Math.min(V,P),[{x:O,y:tt},{x:W,y:tt},{x:W,y:Y},{x:V,y:Y}]}else if(D==="bottom"&&$==="bottom"){if(g||gs.rectWithRect(mt,It)||B>=F&&(mt.topRight().x<=V||mt.topLeft().x>=V)||B<=F&&(Bt.topRight().x<=O||Bt.topLeft().x>=O))return[{x:O,y:Math.max(B,F)},{x:V,y:Math.max(B,F)}];let W,Y=Math.max((s+x)/2,F),tt=Math.max((C+u)/2,B);return F>B?V>O?W=Math.min(O,b):W=Math.max(O,w):V>=O?W=Math.max(V,k):W=Math.min(V,P),[{x:O,y:tt},{x:W,y:tt},{x:W,y:Y},{x:V,y:Y}]}else if(D==="left"&&$==="left"){if(g||gs.rectWithRect(mt,It)||O<=V&&(mt.bottomRight().y<=F||mt.topRight().y>=F)||O>=V&&(Bt.bottomRight().y<=B||Bt.topRight().y>=B))return[{x:Math.min(O,V),y:B},{x:Math.min(O,V),y:F}];let W,Y=Math.min((S+h)/2,V),tt=Math.min((r+v)/2,O);return V>O?F<=B?W=Math.min(N,F):W=Math.max(m,F):F>=B?W=Math.min(T,B):W=Math.max(E,B),[{x:tt,y:B},{x:tt,y:W},{x:Y,y:W},{x:Y,y:F}]}else if(D==="right"&&$==="right"){if(g||gs.rectWithRect(mt,It)||O>=V&&(mt.bottomLeft().y<=F||mt.topLeft().y>=F)||O<=V&&(Bt.bottomLeft().y<=B||Bt.topLeft().y>=B))return[{x:Math.max(O,V),y:B},{x:Math.max(O,V),y:F}];let W,Y=Math.max((r+v)/2,V),tt=Math.max((S+h)/2,O);return V<=O?F<=B?W=Math.min(N,F):W=Math.max(m,F):F>=B?W=Math.min(T,B):W=Math.max(E,B),[{x:tt,y:B},{x:tt,y:W},{x:Y,y:W},{x:Y,y:F}]}else if(D==="top"&&$==="right"){if(mt.containsPoint(c)){if(O<=w){const tt=Math.max(O+l,V),St=Math.min(N,T);return[{x:O,y:St},{x:tt,y:St},{x:tt,y:F}]}const Y=(O-l+V)/2;return[{x:O,y:B},{x:Y,y:B},{x:Y,y:F}]}if(N>F){if(O<V){let Y=T;return E<=N&&w>=O&&(Y=Tt),[{x:O,y:Y},{x:V,y:Y},{x:V,y:F}]}return[{x:O,y:F}]}const W=Math.max(wt,w);if(O>V&&C>=F)return[{x:O,y:B},{x:W,y:B},{x:W,y:F}];if(W>P&&B<x){const Y=Math.min(N,T),tt=Math.max(k,w);return[{x:O,y:Y},{x:tt,y:Y},{x:tt,y:F}]}return[{x:O,y:B},{x:W,y:B},{x:W,y:F}]}else if(D==="top"&&$==="left"){if(mt.containsPoint(c)){if(O>=b){const tt=Math.min(O-l,V),St=Math.min(N,T);return[{x:O,y:St},{x:tt,y:St},{x:tt,y:F}]}const Y=(O+l+V)/2;return[{x:O,y:B},{x:Y,y:B},{x:Y,y:F}]}if(N>F){if(O>V){let Y=T;return E<=N&&b<=O&&(Y=Tt),[{x:O,y:Y},{x:V,y:Y},{x:V,y:F}]}return[{x:O,y:F}]}const W=Math.min(b,wt);if(O<V&&C>=F)return[{x:O,y:B},{x:W,y:B},{x:W,y:F}];if(W<k&&B<x){const Y=Math.min(N,T),tt=Math.min(P,b);return[{x:O,y:Y},{x:tt,y:Y},{x:tt,y:F}]}return[{x:O,y:B},{x:W,y:B},{x:W,y:F}]}else if(D==="bottom"&&$==="right"){if(mt.containsPoint(c)){if(O<=w){const tt=Math.max(O+l,V),St=Math.max(m,E);return[{x:O,y:St},{x:tt,y:St},{x:tt,y:F}]}const Y=(O-l+V)/2;return[{x:O,y:B},{x:Y,y:B},{x:Y,y:F}]}if(m<F){if(O<V){let Y=E;return T>=m&&w>=O&&(Y=Tt),[{x:O,y:Y},{x:V,y:Y},{x:V,y:F}]}return[{x:O,y:F}]}const W=Math.max(wt,w);if(O>V&&s<=F)return[{x:O,y:B},{x:W,y:B},{x:W,y:F}];if(W>P&&B>u){const Y=Math.max(m,E),tt=Math.max(k,w);return[{x:O,y:Y},{x:tt,y:Y},{x:tt,y:F}]}return[{x:O,y:B},{x:W,y:B},{x:W,y:F}]}else if(D==="bottom"&&$==="left"){if(mt.containsPoint(c)){if(O>=b){const tt=Math.min(O-l,V),St=Math.max(m,E);return[{x:O,y:St},{x:tt,y:St},{x:tt,y:F}]}const Y=(O+l+V)/2;return[{x:O,y:B},{x:Y,y:B},{x:Y,y:F}]}if(m<F){if(O>V){let Y=E;return T>=m&&b<=O&&(Y=Tt),[{x:O,y:Y},{x:V,y:Y},{x:V,y:F}]}return[{x:O,y:F}]}const W=Math.min(b,wt);if(O<V&&s<=F)return[{x:O,y:B},{x:W,y:B},{x:W,y:F}];if(W<k&&B>u){const Y=Math.max(m,E),tt=Math.min(P,b);return[{x:O,y:Y},{x:tt,y:Y},{x:tt,y:F}]}return[{x:O,y:B},{x:W,y:B},{x:W,y:F}]}else if(D==="left"&&$==="bottom"){if(mt.containsPoint(c)){if(B<=E){const tt=Math.min(P,b),St=Math.max(B+l,F);return[{x:tt,y:B},{x:tt,y:St},{x:V,y:St}]}const Y=(B-l+F)/2;return[{x:O,y:B},{x:O,y:Y},{x:V,y:Y}]}if(P>V){if(B<F){let Y=b;return w<=P&&E>=B&&(Y=wt),[{x:Y,y:B},{x:Y,y:F},{x:V,y:F}]}return[{x:V,y:B}]}const W=Math.max(E,Tt);if(B>F&&S>=V)return[{x:O,y:B},{x:O,y:W},{x:V,y:W}];if(W>N&&O<v){const Y=Math.min(P,b),tt=Math.max(m,E);return[{x:Y,y:B},{x:Y,y:tt},{x:V,y:tt}]}return[{x:O,y:B},{x:O,y:W},{x:V,y:W}]}else if(D==="left"&&$==="top"){if(mt.containsPoint(c)){if(B>=T){const tt=Math.min(B-l,F),St=Math.min(P,b);return[{x:St,y:B},{x:St,y:tt},{x:V,y:tt}]}const Y=(B+l+F)/2;return[{x:O,y:B},{x:O,y:Y},{x:V,y:Y}]}if(P>V){if(B>F){let Y=b;return w<=P&&T<=B&&(Y=wt),[{x:Y,y:B},{x:Y,y:F},{x:V,y:F}]}return[{x:V,y:B}]}const W=Math.min(T,Tt);if(B<F&&S>=V)return[{x:O,y:B},{x:O,y:W},{x:V,y:W}];if(W<m&&O<v){const Y=Math.min(P,b),tt=Math.min(N,T);return[{x:Y,y:B},{x:Y,y:tt},{x:V,y:tt}]}return[{x:O,y:B},{x:O,y:W},{x:V,y:W}]}else if(D==="right"&&$==="top"){if(mt.containsPoint(c)){if(B>=T){const tt=Math.max(k,w),St=Math.min(B-l,F);return[{x:tt,y:B},{x:tt,y:St},{x:V,y:St}]}const Y=(B+l+F)/2;return[{x:O,y:B},{x:O,y:Y},{x:V,y:Y}]}if(k<V){if(B>F){let Y=w;return b>=k&&T<=B&&(Y=wt),[{x:Y,y:B},{x:Y,y:F},{x:V,y:F}]}return[{x:V,y:B}]}const W=Math.min(T,Tt);if(B<F&&r<=V)return[{x:O,y:B},{x:O,y:W},{x:V,y:W}];if(W<m&&O>h){const Y=Math.max(k,w),tt=Math.min(N,T);return[{x:Y,y:B},{x:Y,y:tt},{x:V,y:tt}]}return[{x:O,y:B},{x:O,y:W},{x:V,y:W}]}else if(D==="right"&&$==="bottom"){if(mt.containsPoint(c)){if(B<=E){const tt=Math.max(k,w),St=Math.max(B+l,F);return[{x:tt,y:B},{x:tt,y:St},{x:V,y:St}]}const Y=(B-l+F)/2;return[{x:O,y:B},{x:O,y:Y},{x:V,y:Y}]}if(k<V){if(B<F){let Y=w;return b>=k&&E>=B&&(Y=wt),[{x:Y,y:B},{x:Y,y:F},{x:V,y:F}]}return[{x:V,y:B}]}const W=Math.max(E,Tt);if(B>F&&r<=V)return[{x:O,y:B},{x:O,y:W},{x:V,y:W}];if(W>N&&O>h){const Y=Math.max(k,w),tt=Math.max(m,E);return[{x:Y,y:B},{x:Y,y:tt},{x:V,y:tt}]}return[{x:O,y:B},{x:O,y:W},{x:V,y:W}]}}function P_(t,e,n){const{sourceDirection:i=Q.AUTO,targetDirection:r=Q.AUTO}=e,s=e.margin||20,o=e.useVertices||!1,a=!!n.model.source().port,l=Lv(n.sourceView,n.sourceAnchor,n.sourceBBox,i,a,n.sourceAnchor,s),c=!!n.model.target().port,h=Lv(n.targetView,n.targetAnchor,n.targetBBox,r,c,n.targetAnchor,s);let u=[];if(!o||t.length===0)return yc(Vr(l,h));const d=t.map(g=>nd(g)),[f]=d;if(l.view&&l.view.model.isElement()&&l.view.model.getBBox().inflate(s).containsPoint(f.point)){const[g]=cu(l,f),v=g,x=nd(l.point);x.margin=s,x.direction=g,f.direction=v,u.push(...Vr(x,f,{targetInSourceBBox:!0}),f.point)}else{const g=d[1]||h,v=_V(l,f,g);f.direction=v,u.push(...Vr(l,f),f.point)}for(let g=0;g<d.length-1;g++){const v=d[g],x=d[g+1],S=new gt(v.point,x.point),C=Ra(S);if(C%90===0){const N=vc[C],m=xo[N];if(N!==v.direction)u.push(v.point,x.point),x.direction=m;else{const b=nn(C-90);let w=0,T=0;b===90?T=-s:b===180?w=-s:b===270?T=s:b===0&&(w=s);const E={x:v.point.x+w,y:v.point.y+T},D={x:x.point.x+w,y:x.point.y+T},$=new gt(x.point,D);x.direction=vc[Ra($)],u.push(v.point,E,D,x.point)}continue}const[P,k]=id(v,x);v.direction=P,x.direction=k,u.push(...Vr(v,x),x.point)}const p=d[d.length-1];if(h.view&&h.view.model.isElement())if(h.view.model.getBBox().inflate(s).containsPoint(p.point)){const[g]=id(p,h),v=nd(h.point),[,x]=cu(p,h);v.margin=s,v.direction=x,p.direction=g,u.push(...Vr(p,v))}else{const g=yc(u),v=new gt(g[g.length-2],p.point),x=vc[Math.round(Ra(v))];p.direction=x;let S=Vr(p,h);const[C,P]=yc([...S,h.point]),k=new gt(C,P),N=Math.round(Ra(k)),m=vc[N];m!==x&&x===xo[m]&&(p.margin=s,S=Vr(p,h)),u.push(...S)}else{const[g]=id(p,h);p.direction=g,u.push(...Vr(p,h))}return yc(u)}function id(t,e){const n=t.direction,i=vV.includes(n);let r=t.direction,s=e.direction;if(i){const o=t.point.y>e.point.y,a=e.point.x-t.point.x;n===Q.BOTTOM?(r=o?xo[n]:a>=0?Q.RIGHT:Q.LEFT,a>0?s=o?Q.LEFT:Q.TOP:a<0&&(s=o?Q.RIGHT:Q.TOP)):(r=o?a>=0?Q.RIGHT:Q.LEFT:xo[n],a>0?s=o?Q.BOTTOM:Q.LEFT:a<0&&(s=o?Q.BOTTOM:Q.RIGHT))}else{const o=t.point.x>e.point.x,a=e.point.y-t.point.y;n===Q.RIGHT?(r=o?xo[n]:a>=0?Q.BOTTOM:Q.TOP,a>0?s=o?Q.TOP:Q.LEFT:a<0&&(s=o?Q.BOTTOM:Q.LEFT)):(r=o?a>=0?Q.BOTTOM:Q.TOP:xo[n],a>0?s=o?Q.RIGHT:Q.TOP:a<0&&(s=o?Q.RIGHT:Q.BOTTOM))}return[r,s]}P_.Directions=Q;const SV=P_,EV=Object.freeze(Object.defineProperty({__proto__:null,manhattan:rf,metro:mV,normal:J5,oneSide:Q5,orthogonal:nf,rightAngle:SV},Symbol.toStringTag,{value:"Module"}));function TV(t,e,n,i){var r="ratio"in i?i.ratio:.5;return t.getPointAtRatio(r)}function AV(t,e,n,i){var r="length"in i?i.length:20;return t.getPointAtLength(r)}function CV(t,e,n,i){var r=1e6,s=t.getConnection(),o=t.getConnectionSubdivisions(),a=new gt(n.clone().offset(0,r),n.clone().offset(0,-r)),l=new gt(n.clone().offset(r,0),n.clone().offset(-r,0)),c=a.intersect(s,{segmentSubdivisions:o}),h=l.intersect(s,{segmentSubdivisions:o}),u=[];return c&&Array.prototype.push.apply(u,c),h&&Array.prototype.push.apply(u,h),u.length>0?n.chooseClosest(u):"fallbackAt"in i?I_(t,i.fallbackAt):k_(t,e,n,i)}function PV(t,e,n,i){var r=t.getClosestPoint(n);return r||new M}function Bl(t){return function(e,n,i,r){if(i instanceof Element){var s=this.paper.findView(i),o;if(s)if(s.isNodeConnection(i)){var a="fixedAt"in r?r.fixedAt:"50%";o=I_(s,a)}else o=s.getNodeBBox(i).center();else o=new M;return t.call(this,e,n,o,r)}return t.apply(this,arguments)}}function I_(t,e){var n=parseFloat(e);return je(e)?t.getPointAtRatio(n/100):t.getPointAtLength(n)}const IV=Bl(CV),k_=Bl(PV),kV=Object.freeze(Object.defineProperty({__proto__:null,connectionClosest:k_,connectionLength:AV,connectionPerpendicular:IV,connectionRatio:TV,resolveRef:Bl},Symbol.toStringTag,{value:"Module"}));function Nr(t){return function(e,n,i,r){var s=!!r.rotate,o=s?e.getNodeUnrotatedBBox(n):e.getNodeBBox(n),a=o[t](),l=r.dx;if(l){var c=je(l);l=parseFloat(l),isFinite(l)&&(c&&(l/=100,l*=o.width),a.x+=l)}var h=r.dy;if(h){var u=je(h);h=parseFloat(h),isFinite(h)&&(u&&(h/=100,h*=o.height),a.y+=h)}return s?a.rotate(e.model.getBBox().center(),-e.model.angle()):a}}function OV(t,e,n,i){var r=t.model.angle(),s=t.getNodeBBox(e),o=s.center(),a=s.origin(),l=s.corner(),c=i.padding;if(isFinite(c)||(c=0),a.y+c<=n.y&&n.y<=l.y-c){var h=n.y-o.y;o.x+=r===0||r===180?0:h*1/Math.tan(un(r)),o.y+=h}else if(a.x+c<=n.x&&n.x<=l.x-c){var u=n.x-o.x;o.y+=r===90||r===270?0:u*Math.tan(un(r)),o.x+=u}return o}function LV(t,e,n,i){var r=!!i.rotate,s,o,a;r?(s=t.getNodeUnrotatedBBox(e),a=t.model.getBBox().center(),o=t.model.angle()):s=t.getNodeBBox(e);var l=i.padding;isFinite(l)&&s.inflate(l),r&&n.rotate(a,o);var c=s.sideNearestToPoint(n),h;switch(c){case"left":h=s.leftMiddle();break;case"right":h=s.rightMiddle();break;case"top":h=s.topMiddle();break;case"bottom":h=s.bottomMiddle();break}return r?h.rotate(a,-o):h}function MV(t,e,n,i,r){return t.model.getPointFromConnectedLink(this.model,r).offset(i.dx,i.dy)}const DV=Nr("center"),NV=Nr("topMiddle"),RV=Nr("bottomMiddle"),$V=Nr("leftMiddle"),BV=Nr("rightMiddle"),FV=Nr("origin"),VV=Nr("topRight"),zV=Nr("bottomLeft"),GV=Nr("corner"),HV=Bl(OV),UV=Bl(LV),jV=MV,WV=Object.freeze(Object.defineProperty({__proto__:null,bottom:RV,bottomLeft:zV,bottomRight:GV,center:DV,left:$V,midSide:UV,modelCenter:jV,perpendicular:HV,right:BV,top:NV,topLeft:FV,topRight:VV},Symbol.toStringTag,{value:"Module"})),YV=kr.extend({initialize:function(t,e){e.cellNamespace?this.cellNamespace=e.cellNamespace:this.cellNamespace=typeof joint<"u"&&di(joint,"shapes")?joint.shapes:null,this.graph=e.graph},model:function(t,e){const n=e.collection,i=n.cellNamespace,{type:r}=t,s=yn(i,r,".");if(!s)throw new Error(`dia.Graph: Could not find cell constructor for type: '${r}'. Make sure to add the constructor to 'cellNamespace'.`);const o=new s(t,e);return e.dry||(o.graph=n.graph),o},comparator:function(t){return t.get("z")||0}}),On=gn.extend({initialize:function(t,e){e=e||{};var n=new YV([],{model:e.cellModel,cellNamespace:e.cellNamespace,graph:this});gn.prototype.set.call(this,"cells",n),n.on("all",this.trigger,this),this.on("change:z",this._sortOnChangeZ,this),this._out={},this._in={},this._nodes={},this._edges={},this._batches={},n.on("add",this._restructureOnAdd,this),n.on("remove",this._restructureOnRemove,this),n.on("reset",this._restructureOnReset,this),n.on("change:source",this._restructureOnChangeSource,this),n.on("change:target",this._restructureOnChangeTarget,this),n.on("remove",this._removeCell,this)},_sortOnChangeZ:function(){this.get("cells").sort()},_restructureOnAdd:function(t){if(t.isLink()){this._edges[t.id]=!0;var{source:e,target:n}=t.attributes;e.id&&((this._out[e.id]||(this._out[e.id]={}))[t.id]=!0),n.id&&((this._in[n.id]||(this._in[n.id]={}))[t.id]=!0)}else this._nodes[t.id]=!0},_restructureOnRemove:function(t){if(t.isLink()){delete this._edges[t.id];var{source:e,target:n}=t.attributes;e.id&&this._out[e.id]&&this._out[e.id][t.id]&&delete this._out[e.id][t.id],n.id&&this._in[n.id]&&this._in[n.id][t.id]&&delete this._in[n.id][t.id]}else delete this._nodes[t.id]},_restructureOnReset:function(t){t=t.models,this._out={},this._in={},this._nodes={},this._edges={},t.forEach(this._restructureOnAdd,this)},_restructureOnChangeSource:function(t){var e=t.previous("source");e.id&&this._out[e.id]&&delete this._out[e.id][t.id];var n=t.attributes.source;n.id&&((this._out[n.id]||(this._out[n.id]={}))[t.id]=!0)},_restructureOnChangeTarget:function(t){var e=t.previous("target");e.id&&this._in[e.id]&&delete this._in[e.id][t.id];var n=t.get("target");n.id&&((this._in[n.id]||(this._in[n.id]={}))[t.id]=!0)},getOutboundEdges:function(t){return this._out&&this._out[t]||{}},getInboundEdges:function(t){return this._in&&this._in[t]||{}},toJSON:function(){var t=gn.prototype.toJSON.apply(this,arguments);return t.cells=this.get("cells").toJSON(),t},fromJSON:function(t,e){if(!t.cells)throw new Error("Graph JSON must contain cells array.");return this.set(t,e)},set:function(t,e,n){var i;return typeof t=="object"?(i=t,n=e):(i={})[t]=e,i.hasOwnProperty("cells")&&(this.resetCells(i.cells,n),i=Qe(i,"cells")),gn.prototype.set.call(this,i,n)},clear:function(t){t=H({},t,{clear:!0});var e=this.get("cells");if(e.length===0)return this;this.startBatch("clear",t);var n=e.sortBy(function(i){return i.isLink()?1:2});do n.shift().remove(t);while(n.length>0);return this.stopBatch("clear"),this},_prepareCell:function(t,e){var n;if(t instanceof gn?(n=t.attributes,!t.graph&&(!e||!e.dry)&&(t.graph=this)):n=t,!ne(n.type))throw new TypeError("dia.Graph: cell type must be a string.");return t},minZIndex:function(){var t=this.get("cells").first();return t&&t.get("z")||0},maxZIndex:function(){var t=this.get("cells").last();return t&&t.get("z")||0},addCell:function(t,e){return Array.isArray(t)?this.addCells(t,e):(t instanceof gn?t.has("z")||t.set("z",this.maxZIndex()+1):t.z===void 0&&(t.z=this.maxZIndex()+1),this.get("cells").add(this._prepareCell(t,e),e||{}),this)},addCells:function(t,e){return t.length===0?this:(t=Iw(t),e.maxPosition=e.position=t.length-1,this.startBatch("add",e),t.forEach(function(n){this.addCell(n,e),e.position--},this),this.stopBatch("add",e),this)},resetCells:function(t,e){var n=pt(t).map(function(i){return this._prepareCell(i,e)},this);return this.get("cells").reset(n,e),this},removeCells:function(t,e){return t.length&&(this.startBatch("remove"),Ue(t,"remove",e),this.stopBatch("remove")),this},_removeCell:function(t,e,n){n=n||{},n.clear||(n.disconnectLinks?this.disconnectLinks(t,n):this.removeLinks(t,n)),this.get("cells").remove(t,{silent:!0}),t.graph===this&&(t.graph=null)},getCell:function(t){return this.get("cells").get(t)},getCells:function(){return this.get("cells").toArray()},getElements:function(){return this.get("cells").toArray().filter(t=>t.isElement())},getLinks:function(){return this.get("cells").toArray().filter(t=>t.isLink())},getFirstCell:function(){return this.get("cells").first()},getLastCell:function(){return this.get("cells").last()},getConnectedLinks:function(t,e){e=e||{};var n=e.indirect,i=e.inbound,r=e.outbound;i===void 0&&r===void 0&&(i=r=!0);var s=[],o={};r&&a(this,t),i&&l(this,t);function a(u,d){if(Jt(u.getOutboundEdges(d.id),(function(p,g){if(!o[g]){var v=u.getCell(g);s.push(v),o[g]=!0,n&&(i&&l(u,v),r&&a(u,v))}}).bind(u)),n&&d.isLink()){var f=d.getTargetCell();f&&f.isLink()&&(o[f.id]||(s.push(f),a(u,f)))}}function l(u,d){if(Jt(u.getInboundEdges(d.id),(function(p,g){if(!o[g]){var v=u.getCell(g);s.push(v),o[g]=!0,n&&(i&&l(u,v),r&&a(u,v))}}).bind(u)),n&&d.isLink()){var f=d.getSourceCell();f&&f.isLink()&&(o[f.id]||(s.push(f),l(u,f)))}}if(e.deep){var c=t.getEmbeddedCells({deep:!0}),h={};c.forEach(function(u){u.isElement()&&(h[u.id]=!0)}),c.forEach(function(u){u.isLink()||(r&&Jt(this.getOutboundEdges(u.id),(function(d,f){if(!o[f]){var p=this.getCell(f),{source:g,target:v}=p.attributes,x=g.id,S=v.id;if(!e.includeEnclosed&&x&&h[x]&&S&&h[S])return;s.push(this.getCell(f)),o[f]=!0}}).bind(this)),i&&Jt(this.getInboundEdges(u.id),(function(d,f){if(!o[f]){var p=this.getCell(f),{source:g,target:v}=p.attributes,x=g.id,S=v.id;if(!e.includeEnclosed&&x&&h[x]&&S&&h[S])return;s.push(this.getCell(f)),o[f]=!0}}).bind(this)))},this)}return s},getNeighbors:function(t,e){e||(e={});var n=e.inbound,i=e.outbound;n===void 0&&i===void 0&&(n=i=!0);var r=this.getConnectedLinks(t,e).reduce((function(a,l){var{source:c,target:h}=l.attributes,u=l.hasLoop(e);if(n&&di(c,"id")&&!a[c.id]){var d=this.getCell(c.id);d.isElement()&&(u||d&&d!==t&&(!e.deep||!d.isEmbeddedIn(t)))&&(a[c.id]=d)}if(i&&di(h,"id")&&!a[h.id]){var f=this.getCell(h.id);f.isElement()&&(u||f&&f!==t&&(!e.deep||!f.isEmbeddedIn(t)))&&(a[h.id]=f)}return a}).bind(this),{});if(t.isLink()){if(n){var s=t.getSourceCell();s&&s.isElement()&&!r[s.id]&&(r[s.id]=s)}if(i){var o=t.getTargetCell();o&&o.isElement()&&!r[o.id]&&(r[o.id]=o)}}return pt(r)},getCommonAncestor:function(){var t=Array.from(arguments).map(function(n){for(var i=[],r=n.get("parent");r;)i.push(r),r=this.getCell(r).get("parent");return i},this);t=t.sort(function(n,i){return n.length-i.length});var e=pt(t.shift()).find(function(n){return t.every(function(i){return i.includes(n)})});return this.getCell(e)},getSuccessors:function(t,e){e=e||{};var n=[];return this.search(t,function(i){i!==t&&n.push(i)},H({},e,{outbound:!0})),n},cloneCells:tg,cloneSubgraph:function(t,e){var n=this.getSubgraph(t,e);return this.cloneCells(n)},getSubgraph:function(t,e){e=e||{};var n=[],i={},r=[],s=[];return pt(t).forEach(function(o){if(i[o.id]||(n.push(o),i[o.id]=o,o.isLink()?s.push(o):r.push(o)),e.deep){var a=o.getEmbeddedCells({deep:!0});a.forEach(function(l){i[l.id]||(n.push(l),i[l.id]=l,l.isLink()?s.push(l):r.push(l))})}}),s.forEach(function(o){var{source:a,target:l}=o.attributes;if(a.id&&!i[a.id]){var c=this.getCell(a.id);n.push(c),i[c.id]=c,r.push(c)}if(l.id&&!i[l.id]){var h=this.getCell(l.id);n.push(this.getCell(l.id)),i[h.id]=h,r.push(h)}},this),r.forEach(function(o){var a=this.getConnectedLinks(o,e);a.forEach(function(l){var{source:c,target:h}=l.attributes;!i[l.id]&&c.id&&i[c.id]&&h.id&&i[h.id]&&(n.push(l),i[l.id]=l)})},this),n},getPredecessors:function(t,e){e=e||{};var n=[];return this.search(t,function(i){i!==t&&n.push(i)},H({},e,{inbound:!0})),n},search:function(t,e,n){n=n||{},n.breadthFirst?this.bfs(t,e,n):this.dfs(t,e,n)},bfs:function(t,e,n={}){const i={},r={},s=[];for(s.push(t),r[t.id]=0;s.length>0;){var o=s.shift();if(i[o.id]||(i[o.id]=!0,e.call(this,o,r[o.id])===!1))continue;const a=this.getNeighbors(o,n);for(let l=0,c=a.length;l<c;l++){const h=a[l];r[h.id]=r[o.id]+1,s.push(h)}}},dfs:function(t,e,n={}){const i={},r={},s=[];for(s.push(t),r[t.id]=0;s.length>0;){const o=s.pop();if(i[o.id]||(i[o.id]=!0,e.call(this,o,r[o.id])===!1))continue;const a=this.getNeighbors(o,n),l=s.length;for(let c=0,h=a.length;c<h;c++){const u=a[c];r[u.id]=r[o.id]+1,s.splice(l,0,u)}}},getSources:function(){var t=[];return Jt(this._nodes,(function(e,n){(!this._in[n]||En(this._in[n]))&&t.push(this.getCell(n))}).bind(this)),t},getSinks:function(){var t=[];return Jt(this._nodes,(function(e,n){(!this._out[n]||En(this._out[n]))&&t.push(this.getCell(n))}).bind(this)),t},isSource:function(t){return!this._in[t.id]||En(this._in[t.id])},isSink:function(t){return!this._out[t.id]||En(this._out[t.id])},isSuccessor:function(t,e){var n=!1;return this.search(t,function(i){if(i===e&&i!==t)return n=!0,!1},{outbound:!0}),n},isPredecessor:function(t,e){var n=!1;return this.search(t,function(i){if(i===e&&i!==t)return n=!0,!1},{inbound:!0}),n},isNeighbor:function(t,e,n){n=n||{};var i=n.inbound,r=n.outbound;i===void 0&&r===void 0&&(i=r=!0);var s=!1;return this.getConnectedLinks(t,n).forEach(function(o){var{source:a,target:l}=o.attributes;if(i&&di(a,"id")&&a.id===e.id||r&&di(l,"id")&&l.id===e.id)return s=!0,!1}),s},disconnectLinks:function(t,e){this.getConnectedLinks(t).forEach(function(n){n.set(n.attributes.source.id===t.id?"source":"target",{x:0,y:0},e)})},removeLinks:function(t,e){Ue(this.getConnectedLinks(t),"remove",e)},findModelsFromPoint:function(t){return this.getElements().filter(e=>e.getBBox({rotate:!0}).containsPoint(t))},findModelsInArea:function(t,e={}){const n=new Z(t),{strict:i=!1}=e,r=i?"containsRect":"intersect";return this.getElements().filter(s=>n[r](s.getBBox({rotate:!0})))},findModelsUnderElement:function(t,e={}){const{searchBy:n="bbox"}=e,i=t.getBBox().rotateAroundCenter(t.angle());return(n==="bbox"?this.findModelsInArea(i):this.findModelsFromPoint(Os(i,n))).filter(s=>t.id!==s.id&&!s.isEmbeddedIn(t))},getBBox:function(){return this.getCellsBBox(this.getCells())},getCellsBBox:function(t,e={}){const{rotate:n=!0}=e;return pt(t).reduce(function(i,r){const s=r.getBBox({rotate:n});return s?i?i.union(s):s:i},null)},translate:function(t,e,n){var i=this.getCells().filter(function(r){return!r.isEmbedded()});return Ue(i,"translate",t,e,n),this},resize:function(t,e,n){return this.resizeCells(t,e,this.getCells(),n)},resizeCells:function(t,e,n,i){var r=this.getCellsBBox(n);if(r){var s=Math.max(t/r.width,0),o=Math.max(e/r.height,0);Ue(n,"scale",s,o,r.origin(),i)}return this},startBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)+1,this.trigger("batch:start",H({},e,{batchName:t}))},stopBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)-1,this.trigger("batch:stop",H({},e,{batchName:t}))},hasActiveBatch:function(t){const e=this._batches;let n;return arguments.length===0?n=Object.keys(e):Array.isArray(t)?n=t:n=[t],n.some(i=>e[i]>0)}},{validations:{multiLinks:function(t,e){var{source:n,target:i}=e.attributes;if(n.id&&i.id){var r=e.getSourceCell();if(r){var s=t.getConnectedLinks(r,{outbound:!0}),o=s.filter(function(a){var{source:l,target:c}=a.attributes;return l&&l.id===n.id&&(!l.port||l.port===n.port)&&c&&c.id===i.id&&(!c.port||c.port===i.port)});if(o.length>1)return!1}}return!0},linkPinning:function(t,e){var{source:n,target:i}=e.attributes;return n.id&&i.id}}});o_(On.prototype,["resetCells","addCells","removeCells"],su.cells);const _n={GRID:"grid",CELLS:"cells",BACK:"back",FRONT:"front",TOOLS:"tools",LABELS:"labels"},uu=ce.extend({tagName:"g",svgElement:!0,pivotNodes:null,defaultTheme:null,options:{name:""},className:function(){return kn(`${this.options.name}-layer`)},init:function(){this.pivotNodes={}},insertSortedNode:function(t,e){this.el.insertBefore(t,this.insertPivot(e))},insertNode:function(t){const{el:e}=this;t.parentNode!==e&&e.appendChild(t)},insertPivot:function(t){const{el:e,pivotNodes:n}=this;t=+t,t||(t=0);let i=n[t];if(i)return i;i=n[t]=document.createComment("z-index:"+(t+1));let r=-1/0;for(let s in n)s=+s,s<t&&s>r&&(r=s,t-1);if(r!==-1/0){const s=n[r];e.insertBefore(i,s.nextSibling)}else e.insertBefore(i,e.firstChild);return i},removePivots:function(){const{el:t,pivotNodes:e}=this;for(let n in e)t.removeChild(e[n]);this.pivotNodes={}}}),XV=["transform","x","y","cx","cy","dx","dy","x1","y1","x2","y2","points","d","r","rx","ry","width","height","stroke-width","font-size"],qV=["r","rx","ry","width","height","stroke-width","font-size"],KV=XV.reduce((t,e)=>(t[e]=!0,t),{}),ZV=qV.reduce((t,e)=>(t[e]=!0,t),{});function Dv(t,e){const n={};for(let i in t)t.hasOwnProperty(i)&&(n[i]=O_(i,t[i],e));return n}function O_(t,e,n){if(t in KV&&Pr(e)){let i=Ir(e,n);return t in ZV&&(i=Math.max(0,i)),i}return e}const ao={DEFAULT:"default",EMBEDDING:"embedding",CONNECTING:"connecting",MAGNET_AVAILABILITY:"magnetAvailability",ELEMENT_AVAILABILITY:"elementAvailability"},JV={TOOLS:"TOOLS"},Xt=ce.extend({tagName:"g",svgElement:!0,selector:"root",metrics:null,className:function(){var t=["cell"],e=this.model.get("type");return e&&e.toLowerCase().split(".").forEach(function(n,i,r){t.push("type-"+r.slice(0,i+1).join("-"))}),t.join(" ")},_presentationAttributes:null,_flags:null,setFlags:function(){var t={},e={},n=0,i,r,s,o=ee(this,"presentationAttributes");for(var a in o)if(o.hasOwnProperty(a)){var l=o[a];for(Array.isArray(l)||(l=[l]),i=0,r=l.length;i<r;i++){s=l[i];var c=t[s];c||(c=t[s]=1<<n++),e[a]|=c}}var h=ee(this,"initFlag");for(Array.isArray(h)||(h=[h]),i=0,r=h.length;i<r;i++)s=h[i],t[s]||(t[s]=1<<n++);if(n>25)throw new Error("dia.CellView: Maximum number of flags exceeded.");this._flags=t,this._presentationAttributes=e},hasFlag:function(t,e){return t&this.getFlag(e)},removeFlag:function(t,e){return t^t&this.getFlag(e)},getFlag:function(t){var e=this._flags;if(!e)return 0;var n=0;if(Array.isArray(t))for(var i=0,r=t.length;i<r;i++)n|=e[t[i]];else n|=e[t];return n},attributes:function(){var t=this.model;return{"model-id":t.id,"data-type":t.attributes.type}},constructor:function(t){t.id=t.id||Jr(this),ce.call(this,t)},initialize:function(){this.setFlags(),ce.prototype.initialize.apply(this,arguments),this.cleanNodesCache(),this.startListening()},startListening:function(){this.listenTo(this.model,"change",this.onAttributesChange)},onAttributesChange:function(t,e){var n=t.getChangeFlag(this._presentationAttributes);e.updateHandled||!n||(e.dirty&&this.hasFlag(n,"UPDATE")&&(n|=this.getFlag("RENDER")),e.tool&&(e.async=!1),this.requestUpdate(n,e))},requestUpdate:function(t,e){const{paper:n}=this;n&&t>0&&n.requestViewUpdate(this,t,this.UPDATE_PRIORITY,e)},parseDOMJSON:function(t,e){var n=el(t),i=n.selectors,r=n.groupSelectors;for(var s in r){if(i[s])throw new Error("dia.CellView: ambiguous group selector");i[s]=r[s]}if(e){var o=this.selector;if(i[o])throw new Error("dia.CellView: ambiguous root selector.");i[o]=e}return{fragment:n.fragment,selectors:i}},can:function(t){var e=_t(this.options.interactive)?this.options.interactive(this):this.options.interactive;return Vt(e)&&e[t]!==!1||jp(e)&&e!==!1},findBySelector:function(t,e,n){if(!t||t===".")return[e];if(n){var i=n[t];if(i)return Array.isArray(i)?i:[i]}return this.useCSSSelectors?q(e).find(t).toArray():[]},findNodes:function(t){return this.findBySelector(t,this.el,this.selectors)},findNode:function(t){const[e=null]=this.findNodes(t);return e},notify:function(t){if(this.paper){var e=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t].concat(e)),this.paper.trigger.apply(this.paper,[t,this].concat(e))}},getBBox:function(t){var e;if(t&&t.useModelGeometry){var n=this.model;e=n.getBBox().bbox(n.angle())}else e=this.getNodeBBox(this.el);return this.paper.localToPaperRect(e)},getNodeBBox:function(t){const e=this.getNodeBoundingRect(t),n=this.getRootTranslateMatrix().multiply(this.getNodeRotateMatrix(t)),i=this.getNodeMatrix(t);return L.transformRect(e,n.multiply(i))},getNodeRotateMatrix(t){return!this.rotatableNode||this.rotatableNode.contains(t)?this.getRootRotateMatrix():L.createSVGMatrix()},getNodeUnrotatedBBox:function(t){var e=this.getNodeBoundingRect(t),n=this.getNodeMatrix(t),i=this.getRootTranslateMatrix();return L.transformRect(e,i.multiply(n))},getRootTranslateMatrix:function(){var t=this.model,e=t.position(),n=L.createSVGMatrix().translate(e.x,e.y);return n},getRootRotateMatrix:function(){var t=L.createSVGMatrix(),e=this.model,n=e.angle();if(n){var i=e.getBBox(),r=i.width/2,s=i.height/2;t=t.translate(r,s).rotate(n).translate(-r,-s)}return t},_notifyHighlight:function(t,e,n={}){const{el:i}=this;let r;if(typeof e=="string"?r=this.findNode(e)||i:[r=i]=this.$(e),n.partial=r!==i,n.type===void 0){let s;switch(!0){case n.embedding:s=ao.EMBEDDING;break;case n.connecting:s=ao.CONNECTING;break;case n.magnetAvailability:s=ao.MAGNET_AVAILABILITY;break;case n.elementAvailability:s=ao.ELEMENT_AVAILABILITY;break;default:s=ao.DEFAULT;break}n.type=s}return this.notify(t,r,n),this},highlight:function(t,e){return this._notifyHighlight("cell:highlight",t,e)},unhighlight:function(t,e={}){return this._notifyHighlight("cell:unhighlight",t,e)},findMagnet:function(t){const e=this.el;let n=this.$(t)[0];n||(n=e);do{const i=n.getAttribute("magnet"),r=n===e;if((i||r)&&i!=="false")return n;if(r)return;n=n.parentNode}while(n)},findProxyNode:function(t,e){t||(t=this.el);const n=t.getAttribute(`${e}-selector`);if(n){const i=this.findNode(n);if(i)return i}return t},getSelector:function(t,e){var n;if(t===this.el)return typeof e=="string"&&(n=":scope > "+e),n;if(t){var i=L(t).index()+1;n=t.tagName+":nth-child("+i+")",e&&(n+=" > "+e),n=this.getSelector(t.parentNode,n)}return n},addLinkFromMagnet:function(t,e,n){var i=this.paper,r=i.model,s=i.getDefaultLink(this,t);return s.set({source:this.getLinkEnd(t,e,n,s,"source"),target:{x:e,y:n}}).addTo(r,{async:!1,ui:!0}),s.findView(i)},getLinkEnd:function(t,...e){const n=this.model,i=n.id,r=this.findAttributeNode("port",t),s=t.getAttribute("joint-selector"),o={id:i};if(s!=null&&(o.magnet=s),r!=null){let a=r.getAttribute("port");r.getAttribute("port-id-type")==="number"&&(a=parseInt(a,10)),o.port=a,!n.hasPort(a)&&!s&&(o.selector=this.getSelector(t))}else s==null&&this.el!==t&&(o.selector=this.getSelector(t));return this.customizeLinkEnd(o,t,...e)},customizeLinkEnd:function(t,e,n,i,r,s){const{paper:o}=this,{connectionStrategy:a}=o.options;if(typeof a=="function"){var l=a.call(o,t,this,e,new M(n,i),r,s,o);if(l)return l}return t},getMagnetFromLinkEnd:function(t){var e=t.port,n=t.magnet,i=this.model,r;return e!=null&&i.isElement()&&i.hasPort(e)?r=this.findPortNode(e,n)||this.el:(n||(n=t.selector),!n&&e!=null&&(n='[port="'+e+'"]'),r=this.findNode(n)),this.findProxyNode(r,"magnet")},dragLinkStart:function(t,e,n,i){this.model.startBatch("add-link");const r=this.addLinkFromMagnet(e,n,i);r.notifyPointerdown(t,n,i),r.eventData(t,r.startArrowheadMove("target",{whenNotAllowed:"remove"})),this.eventData(t,{linkView:r})},dragLink:function(t,e,n){var i=this.eventData(t),r=i.linkView;if(r)r.pointermove(t,e,n);else{var s=this.paper,o=s.options.magnetThreshold,a=this.getEventTarget(t),l=i.targetMagnet;if(o==="onleave"){if(l===a||L(l).contains(a))return}else if(s.eventData(t).mousemoved<=o)return;this.dragLinkStart(t,l,e,n)}},dragLinkEnd:function(t,e,n){var i=this.eventData(t),r=i.linkView;r&&(r.pointerup(t,e,n),this.model.stopBatch("add-link"))},getAttributeDefinition:function(t){return this.model.constructor.getAttributeDefinition(t)},setNodeAttributes:function(t,e){En(e)||(t instanceof SVGElement?L(t).attr(e):q(t).attr(e))},processNodeAttributes:function(t,e){var n,i,r,s,o,a,l,c,h,u=[];const d={};for(n in e)e.hasOwnProperty(n)&&(d[L.attributeNames[n]]=e[n]);for(n in d)d.hasOwnProperty(n)&&(i=d[n],r=this.getAttributeDefinition(n),r&&(!_t(r.qualify)||r.qualify.call(this,i,t,d,this))?(ne(r.set)&&(a||(a={}),a[r.set]=i),i!==null&&u.push(n,r)):(a||(a={}),a[n]=i));for(s=0,o=u.length;s<o;s+=2)n=u[s],r=u[s+1],i=e[n],_t(r.set)&&(l||(l={}),l[n]=i),_t(r.position)&&(c||(c={}),c[n]=i),_t(r.offset)&&(h||(h={}),h[n]=i);return{raw:d,normal:a,set:l,position:c,offset:h}},updateRelativeAttributes:function(t,e,n,i){i||(i={});var r,s,o,a=Dv(e.raw||{},n),l=e.normal||{};for(const b in l)l[b]=a[b];var c=e.set,h=e.position,u=e.offset;for(r in c){s=a[r],o=this.getAttributeDefinition(r);var d=o.set.call(this,s,n.clone(),t,a,this);Vt(d)?H(l,d):d!==void 0&&(l[r]=d)}if(t instanceof HTMLElement){this.setNodeAttributes(t,l);return}var f=l.transform,p=L.transformStringToMatrix(f),g=M(p.e,p.f);f&&(l=Qe(l,"transform"),p.e=p.f=0);var v,x,S;if(h||u){var C=this.getNodeScale(t,i.scalableNode);v=C.sx,x=C.sy}var P=!1;for(r in h)s=a[r],o=this.getAttributeDefinition(r),S=o.position.call(this,s,n.clone(),t,a,this),S&&(g.offset(M(S).scale(v,x)),P||(P=!0));this.setNodeAttributes(t,l);var k=!1;if(u){var N=this.getNodeBoundingRect(t);if(N.width>0&&N.height>0){var m=L.transformRect(N,p).scale(1/v,1/x);for(r in u)s=a[r],o=this.getAttributeDefinition(r),S=o.offset.call(this,s,m,t,a,this),S&&(g.offset(M(S).scale(v,x)),k||(k=!0))}}(f!==void 0||P||k)&&(g.round(1),p.e=g.x,p.f=g.y,t.setAttribute("transform",L.matrixToTransformString(p)))},getNodeScale:function(t,e){var n,i;if(e&&e.contains(t)){var r=e.scale();n=1/r.sx,i=1/r.sy}else n=1,i=1;return{sx:n,sy:i}},cleanNodesCache:function(){this.metrics={}},nodeCache:function(t){var e=this.metrics;if(!e)return{};var n=L.ensureId(t),i=e[n];return i||(i=e[n]={}),i},getNodeData:function(t){var e=this.nodeCache(t);return e.data||(e.data={}),e.data},getNodeBoundingRect:function(t){var e=this.nodeCache(t);return e.boundingRect===void 0&&(e.boundingRect=L(t).getBBox()),new Z(e.boundingRect)},getNodeMatrix:function(t){const e=this.nodeCache(t);if(e.magnetMatrix===void 0){const{rotatableNode:n,el:i}=this;let r;n&&n.contains(t)?r=n:r=i,e.magnetMatrix=L(t).getTransformToElement(r)}return L.createSVGMatrix(e.magnetMatrix)},getNodeShape:function(t){var e=this.nodeCache(t);return e.geometryShape===void 0&&(e.geometryShape=L(t).toGeometryShape()),e.geometryShape.clone()},isNodeConnection:function(t){return this.model.isLink()&&(!t||t===this.el)},findNodesAttributes:function(t,e,n,i){var r,s,o,a,l={},c=[];for(var h in t)if(t.hasOwnProperty(h)&&(o=t[h],!!Ce(o))){var u=n[h]=this.findBySelector(h,e,i);for(r=0,s=u.length;r<s;r++){var d=u[r];a=L.ensureId(d);var f=i&&i[h]===d,p=l[a];if(p){p.array||(c.push(a),p.array=!0,p.attributes=[p.attributes],p.selectedLength=[p.selectedLength]);var g=p.attributes,v=p.selectedLength;if(f)g.unshift(o),v.unshift(-1);else{var x=ih(v,s);g.splice(x,0,o),v.splice(x,0,s)}}else l[a]={attributes:o,selectedLength:f?-1:s,node:d,array:!1}}}for(r=0,s=c.length;r<s;r++)a=c[r],o=l[a],o.attributes=Te({},...o.attributes.reverse());return l},getEventTarget:function(t,e={}){const{target:n,type:i,clientX:r=0,clientY:s=0}=t;return e.fromPoint||i==="touchmove"||i==="touchend"||"pointerId"in t&&n.hasPointerCapture(t.pointerId)?document.elementFromPoint(r,s):n},updateDOMSubtreeAttributes:function(t,e,n){n||(n={}),n.rootBBox||(n.rootBBox=Z()),n.selectors||(n.selectors=this.selectors);var i={},r={},s=[],o=[],a,l,c,h,u,d=n.roAttributes,f=this.findNodesAttributes(d||e,t,i,n.selectors),p=d?this.findNodesAttributes(e,t,i,n.selectors):f;for(var g in f)if(h=f[g],c=h.attributes,l=h.node,u=this.processNodeAttributes(l,c),!u.set&&!u.position&&!u.offset&&!u.raw.ref)this.setNodeAttributes(l,Dv(u.normal,n.rootBBox));else{var v=p[g]&&p[g].attributes,x=v&&c.ref===void 0?v.ref:c.ref,S;if(x){if(S=(i[x]||this.findBySelector(x,t,n.selectors))[0],!S)throw new Error('dia.CellView: "'+x+'" reference does not exist.')}else S=null;if(a={node:l,refNode:S,processedAttributes:u,allAttributes:v},S){var C=o.findIndex(function(P){return P.refNode===l});C>-1?o.splice(C,0,a):o.push(a)}else s.push(a)}s.push(...o);for(let P=0,k=s.length;P<k;P++){a=s[P],l=a.node,S=a.refNode;const N=S?L.ensureId(S):"";let m=r[N];m||(m=r[N]=S?L(S).getBBox({target:QV(l,S)}):n.rootBBox),d?(u=this.processNodeAttributes(l,a.allAttributes),this.mergeProcessedAttributes(u,a.processedAttributes)):u=a.processedAttributes,this.updateRelativeAttributes(l,u,m,n)}},mergeProcessedAttributes:function(t,e){t.set||(t.set={}),t.position||(t.position={}),t.offset||(t.offset={}),H(t.set,e.set),H(t.position,e.position),H(t.offset,e.offset);var n=t.normal&&t.normal.transform;n!==void 0&&e.normal&&(e.normal.transform=n),t.normal=e.normal},onMount(t){t||(this.mountTools(),hi.mount(this))},onDetach(){this.unmountTools(),hi.unmount(this)},onRemove:function(){this.removeTools(),this.removeHighlighters()},_toolsView:null,hasTools:function(t){var e=this._toolsView;return e?t?e.getName()===t:!0:!1},addTools:function(t){return this.removeTools(),t&&(this._toolsView=t,t.configure({relatedView:this}),t.listenTo(this.paper,"tools:event",this.onToolEvent.bind(this))),this},unmountTools(){const t=this._toolsView;return t&&t.unmount(),this},mountTools(){const t=this._toolsView;return t&&!t.isMounted()&&t.mount(),this},updateTools:function(t){var e=this._toolsView;return e&&e.update(t),this},removeTools:function(){var t=this._toolsView;return t&&(t.remove(),this._toolsView=null),this},hideTools:function(){var t=this._toolsView;return t&&t.hide(),this},showTools:function(){var t=this._toolsView;return t&&t.show(),this},onToolEvent:function(t){switch(t){case"remove":this.removeTools();break;case"hide":this.hideTools();break;case"show":this.showTools();break}},removeHighlighters:function(){hi.remove(this)},updateHighlighters:function(t=!1){hi.update(this,null,t)},transformHighlighters:function(){hi.transform(this)},preventDefaultInteraction(t){this.eventData(t,{defaultInteractionPrevented:!0})},isDefaultInteractionPrevented(t){const{defaultInteractionPrevented:e=!1}=this.eventData(t);return e},pointerdblclick:function(t,e,n){this.notify("cell:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){this.notify("cell:pointerclick",t,e,n)},contextmenu:function(t,e,n){this.notify("cell:contextmenu",t,e,n)},pointerdown:function(t,e,n){const{model:i}=this,{graph:r}=i;r&&(i.startBatch("pointer"),this.eventData(t,{graph:r})),this.notify("cell:pointerdown",t,e,n)},pointermove:function(t,e,n){this.notify("cell:pointermove",t,e,n)},pointerup:function(t,e,n){const{graph:i}=this.eventData(t);this.notify("cell:pointerup",t,e,n),i&&i.stopBatch("pointer",{cell:this.model})},mouseover:function(t){this.notify("cell:mouseover",t)},mouseout:function(t){this.notify("cell:mouseout",t)},mouseenter:function(t){this.notify("cell:mouseenter",t)},mouseleave:function(t){this.notify("cell:mouseleave",t)},mousewheel:function(t,e,n,i){this.notify("cell:mousewheel",t,e,n,i)},onevent:function(t,e,n,i){this.notify(e,t,n,i)},onmagnet:function(){},magnetpointerdblclick:function(){},magnetcontextmenu:function(){},checkMouseleave(t){const{paper:e,model:n}=this;if(e.isAsync()){if(n.isLink()){const s=n.getSourceElement();if(s){const a=e.findViewByModel(s);a&&(e.dumpView(a),e.checkViewVisibility(a))}const o=n.getTargetElement();if(o){const a=e.findViewByModel(o);a&&(e.dumpView(a),e.checkViewVisibility(a))}}e.dumpView(this),e.checkViewVisibility(this)}const i=this.getEventTarget(t,{fromPoint:!0}),r=e.findView(i);r!==this&&(this.mouseleave(t),r&&r.mouseenter(t))},setInteractivity:function(t){this.options.interactive=t}},{Flags:JV,Highlighting:ao,addPresentationAttributes:function(t){return Te({},ee(this.prototype,"presentationAttributes"),t,function(e,n){if(!(!e||!n)&&(typeof e=="string"&&(e=[e]),typeof n=="string"&&(n=[n]),Array.isArray(e)&&Array.isArray(n)))return Ii(e.concat(n))})},evalAttribute:O_});Object.defineProperty(Xt.prototype,"useCSSSelectors",{get(){const t=this.model.useCSSSelectors;return t!==void 0?t:Tr.useCSSSelectors}});function QV(t,e){let n=t;do{if(n.contains(e))return n;n=n.parentNode}while(n);return null}const Qt={TOOLS:Xt.Flags.TOOLS,UPDATE:"UPDATE",TRANSLATE:"TRANSLATE",RESIZE:"RESIZE",PORTS:"PORTS",ROTATE:"ROTATE",RENDER:"RENDER"},lo={MOVE:"move",MAGNET:"magnet"},Pe=Xt.extend({_removePorts:function(){},_renderPorts:function(){},className:function(){var t=Xt.prototype.className.apply(this).split(" ");return t.push("element"),t.join(" ")},initialize:function(){Xt.prototype.initialize.apply(this,arguments),this._initializePorts()},presentationAttributes:{attrs:[Qt.UPDATE],position:[Qt.TRANSLATE,Qt.TOOLS],size:[Qt.RESIZE,Qt.PORTS,Qt.TOOLS],angle:[Qt.ROTATE,Qt.TOOLS],markup:[Qt.RENDER],ports:[Qt.PORTS]},initFlag:[Qt.RENDER],UPDATE_PRIORITY:0,confirmUpdate:function(t,e){const{useCSSSelectors:n}=this;this.hasFlag(t,Qt.PORTS)&&(this._removePorts(),this._cleanPortsCache());let i=!1;if(this.hasFlag(t,Qt.RENDER))this.render(),this.updateTools(e),this.updateHighlighters(!0),i=!0,t=this.removeFlag(t,[Qt.RENDER,Qt.UPDATE,Qt.RESIZE,Qt.TRANSLATE,Qt.ROTATE,Qt.PORTS,Qt.TOOLS]);else{let r=!1;this.hasFlag(t,Qt.RESIZE)&&(this.resize(e),r=!0,t=this.removeFlag(t,[Qt.RESIZE,Qt.UPDATE]),n&&(t=this.removeFlag(t,Qt.PORTS))),this.hasFlag(t,Qt.UPDATE)&&(this.update(this.model,null,e),t=this.removeFlag(t,Qt.UPDATE),r=!0,n&&(t=this.removeFlag(t,Qt.PORTS))),this.hasFlag(t,Qt.TRANSLATE)&&(this.translate(),t=this.removeFlag(t,Qt.TRANSLATE),i=!0),this.hasFlag(t,Qt.ROTATE)&&(this.rotate(),t=this.removeFlag(t,Qt.ROTATE),i=!0),this.hasFlag(t,Qt.PORTS)&&(this._renderPorts(),r=!0,t=this.removeFlag(t,Qt.PORTS)),r&&this.updateHighlighters(!1)}return i&&this.transformHighlighters(),this.hasFlag(t,Qt.TOOLS)&&(this.updateTools(e),t=this.removeFlag(t,Qt.TOOLS)),t},_initializePorts:function(){},update:function(t,e){this.cleanNodesCache();const{useCSSSelectors:n}=this;n&&this._removePorts();var i=this.model,r=i.attr();this.updateDOMSubtreeAttributes(this.el,r,{rootBBox:new Z(i.size()),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode,roAttributes:e===r?null:e}),n&&this._renderPorts()},rotatableSelector:"rotatable",scalableSelector:"scalable",scalableNode:null,rotatableNode:null,renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.ElementView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if(typeof e=="string")return this.renderStringMarkup(e);throw new Error("dia.ElementView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el),n=this.selectors=e.selectors;this.rotatableNode=L(n[this.rotatableSelector])||null,this.scalableNode=L(n[this.scalableSelector])||null,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=this.vel;e.append(L(t)),this.rotatableNode=e.findOne(".rotatable"),this.scalableNode=e.findOne(".scalable");var n=this.selectors={};n[this.selector]=this.el},render:function(){return this.vel.empty(),this.renderMarkup(),this.scalableNode&&this.update(),this.resize(),this.rotatableNode?(this.rotate(),this.translate()):this.updateTransformation(),this.useCSSSelectors||this._renderPorts(),this},resize:function(t){if(this.scalableNode)return this.sgResize(t);this.model.attributes.angle&&this.rotate(),this.update()},translate:function(){if(this.rotatableNode)return this.rgTranslate();this.updateTransformation()},rotate:function(){if(this.rotatableNode){this.rgRotate(),this.update();return}this.updateTransformation()},updateTransformation:function(){var t=this.getTranslateString(),e=this.getRotateString();e&&(t+=" "+e),this.vel.attr("transform",t)},getTranslateString:function(){var t=this.model.attributes.position;return"translate("+t.x+","+t.y+")"},getRotateString:function(){var t=this.model.attributes,e=t.angle;if(!e)return null;var n=t.size;return"rotate("+e+","+n.width/2+","+n.height/2+")"},rgRotate:function(){this.rotatableNode.attr("transform",this.getRotateString())},rgTranslate:function(){this.vel.attr("transform",this.getTranslateString())},sgResize:function(t){var e=this.model,n=e.angle(),i=e.size(),r=this.scalableNode,s=!1;r.node.getElementsByTagName("path").length>0&&(s=!0);var o=r.getBBox({recursive:s}),a=i.width/(o.width||1),l=i.height/(o.height||1);r.attr("transform","scale("+a+","+l+")");var c=this.rotatableNode,h=c&&c.attr("transform");if(h){c.attr("transform",h+" rotate("+-n+","+i.width/2+","+i.height/2+")");var u=r.getBBox({target:this.paper.cells});e.set("position",{x:u.x,y:u.y},H({updateHandled:!0},t)),this.translate(),this.rotate()}this.update()},prepareEmbedding:function(t={}){const e=t.model||this.model,i=(t.paper||this.paper).model,r=t.initialZIndices={},s=e.getEmbeddedCells({deep:!0}),o=i.getConnectedLinks(e,{deep:!0,includeEnclosed:!0});[e,...s,...o].forEach(c=>r[c.id]=c.attributes.z),e.startBatch("to-front"),e.toFront({deep:!0,ui:!0});const a=i.getElements().reduce((c,h)=>Math.max(c,h.attributes.z||0),0);o.forEach(c=>{c.attributes.z<=a&&c.set("z",a+1,{ui:!0})}),e.stopBatch("to-front");const l=e.parent();l?(i.getCell(l).unembed(e,{ui:!0}),t.initialParentId=l):t.initialParentId=null},processEmbedding:function(t={},e,n,i){const r=t.model||this.model,s=t.paper||this.paper,o=s.model,{findParentBy:a,frontParentOnly:l,validateEmbedding:c}=s.options;let h;_t(a)?h=pt(a.call(o,this,e,n,i)):a==="pointer"?h=pt(o.findModelsFromPoint({x:n,y:i})):h=o.findModelsUnderElement(r,{searchBy:a}),h=h.filter(f=>f instanceof an&&r.id!==f.id&&!f.isEmbeddedIn(r)),l&&(h=h.slice(-1));let u=null;const d=t.candidateEmbedView;for(let f=h.length-1;f>=0;f--){const p=h[f];if(d&&d.model.id==p.id){u=d;break}else{const g=p.findView(s);if(!_t(c)||c.call(s,this,g)){u=g;break}}}u&&u!=d&&(this.clearEmbedding(t),t.candidateEmbedView=u.highlight(u.findProxyNode(null,"container"),{embedding:!0})),!u&&d&&this.clearEmbedding(t)},clearEmbedding:function(t){t||(t={});var e=t.candidateEmbedView;e&&(e.unhighlight(e.findProxyNode(null,"container"),{embedding:!0}),t.candidateEmbedView=null)},finalizeEmbedding:function(t={}){const e=t.candidateEmbedView,n=t.model||this.model,i=t.paper||this.paper;if(e)e.model.embed(n,{ui:!0}),e.unhighlight(e.findProxyNode(null,"container"),{embedding:!0}),t.candidateEmbedView=null;else{const{validateUnembedding:r}=i.options,{initialParentId:s}=t;if(s&&typeof r=="function"&&!r.call(i,this)){this._disallowUnembed(t);return}}i.model.getConnectedLinks(n,{deep:!0}).forEach(r=>{r.reparent({ui:!0})})},_disallowUnembed:function(t){const{model:e,whenNotAllowed:n="revert"}=t,i=e||this.model,s=(t.paper||this.paper).model;switch(n){case"remove":{i.remove({ui:!0});break}case"revert":{const{initialParentId:o,initialPosition:a,initialZIndices:l}=t;if(a){const{x:h,y:u}=a;i.position(h,u,{deep:!0,ui:!0})}l&&Object.keys(l).forEach(h=>{const u=s.getCell(h);u&&u.set("z",l[h],{ui:!0})});const c=s.getCell(o);c&&c.embed(i,{ui:!0});break}}},getDelegatedView:function(){for(var t=this,e=t.model,n=t.paper;t&&!e.isLink();){if(!e.isEmbedded()||t.can("stopDelegation"))return t;e=e.getParentCell(),t=n.findViewByModel(e)}return null},findProxyNode:function(t,e){t||(t=this.el);const n=t.getAttribute(`${e}-selector`);if(n){const i=this.findAttribute("port",t);if(i){const r=this.findPortNode(i,n);if(r)return r}else{const r=this.findNode(n);if(r)return r}}return t},notifyPointerdown(t,e,n){Xt.prototype.pointerdown.call(this,t,e,n),this.notify("element:pointerdown",t,e,n)},notifyPointermove(t,e,n){Xt.prototype.pointermove.call(this,t,e,n),this.notify("element:pointermove",t,e,n)},notifyPointerup(t,e,n){this.notify("element:pointerup",t,e,n),Xt.prototype.pointerup.call(this,t,e,n)},pointerdblclick:function(t,e,n){Xt.prototype.pointerdblclick.apply(this,arguments),this.notify("element:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){Xt.prototype.pointerclick.apply(this,arguments),this.notify("element:pointerclick",t,e,n)},contextmenu:function(t,e,n){Xt.prototype.contextmenu.apply(this,arguments),this.notify("element:contextmenu",t,e,n)},pointerdown:function(t,e,n){this.notifyPointerdown(t,e,n),this.dragStart(t,e,n)},pointermove:function(t,e,n){const i=this.eventData(t),{targetMagnet:r,action:s,delegatedView:o}=i;switch(r&&this.magnetpointermove(t,r,e,n),s){case lo.MAGNET:this.dragMagnet(t,e,n);break;case lo.MOVE:(o||this).drag(t,e,n);default:if(i.preventPointerEvents)break;this.notifyPointermove(t,e,n);break}this.eventData(t,i)},pointerup:function(t,e,n){const i=this.eventData(t),{targetMagnet:r,action:s,delegatedView:o}=i;switch(r&&this.magnetpointerup(t,r,e,n),s){case lo.MAGNET:this.dragMagnetEnd(t,e,n);break;case lo.MOVE:(o||this).dragEnd(t,e,n);default:if(i.preventPointerEvents)break;this.notifyPointerup(t,e,n)}r&&this.magnetpointerclick(t,r,e,n),this.checkMouseleave(t)},mouseover:function(t){Xt.prototype.mouseover.apply(this,arguments),this.notify("element:mouseover",t)},mouseout:function(t){Xt.prototype.mouseout.apply(this,arguments),this.notify("element:mouseout",t)},mouseenter:function(t){Xt.prototype.mouseenter.apply(this,arguments),this.notify("element:mouseenter",t)},mouseleave:function(t){Xt.prototype.mouseleave.apply(this,arguments),this.notify("element:mouseleave",t)},mousewheel:function(t,e,n,i){Xt.prototype.mousewheel.apply(this,arguments),this.notify("element:mousewheel",t,e,n,i)},onmagnet:function(t,e,n){const{currentTarget:i}=t;this.magnetpointerdown(t,i,e,n),this.eventData(t,{targetMagnet:i}),this.dragMagnetStart(t,e,n)},magnetpointerdown:function(t,e,n,i){this.notify("element:magnet:pointerdown",t,e,n,i)},magnetpointermove:function(t,e,n,i){this.notify("element:magnet:pointermove",t,e,n,i)},magnetpointerup:function(t,e,n,i){this.notify("element:magnet:pointerup",t,e,n,i)},magnetpointerdblclick:function(t,e,n,i){this.notify("element:magnet:pointerdblclick",t,e,n,i)},magnetcontextmenu:function(t,e,n,i){this.notify("element:magnet:contextmenu",t,e,n,i)},dragStart:function(t,e,n){if(this.isDefaultInteractionPrevented(t))return;var i=this.getDelegatedView();if(!i||!i.can("elementMove"))return;this.eventData(t,{action:lo.MOVE,delegatedView:i});const r=i.model.position();i.eventData(t,{initialPosition:r,pointerOffset:r.difference(e,n),restrictedArea:this.paper.getRestrictedArea(i,e,n)})},dragMagnetStart:function(t,e,n){const{paper:i}=this,r=t.isPropagationStopped();if(r&&this.eventData(t,{preventPointerEvents:!0}),this.isDefaultInteractionPrevented(t)||!this.can("addLinkFromMagnet"))return;const{targetMagnet:s=t.currentTarget}=this.eventData(t);if(t.stopPropagation(),!i.options.validateMagnet.call(i,this,s,t)){r?this.dragStart(t,e,n):this.pointerdown(t,e,n);return}i.options.magnetThreshold<=0&&this.dragLinkStart(t,s,e,n),this.eventData(t,{action:lo.MAGNET})},drag:function(t,e,n){var i=this.paper,r=i.options.gridSize,s=this.model,o=this.eventData(t),{pointerOffset:a,restrictedArea:l,embedding:c}=o,h=pi(e+a.x,r),u=pi(n+a.y,r);s.position(h,u,{restrictedArea:l,deep:!0,ui:!0}),i.options.embeddingMode&&(c||(this.prepareEmbedding(o),c=!0),this.processEmbedding(o,t,e,n)),this.eventData(t,{embedding:c})},dragMagnet:function(t,e,n){this.dragLink(t,e,n)},dragEnd:function(t,e,n){var i=this.eventData(t);i.embedding&&this.finalizeEmbedding(i)},dragMagnetEnd:function(t,e,n){this.dragLinkEnd(t,e,n)},magnetpointerclick:function(t,e,n,i){var r=this.paper;r.eventData(t).mousemoved>r.options.clickThreshold||this.notify("element:magnet:pointerclick",t,e,n,i)}},{Flags:Qt});H(Pe.prototype,IF);const te={TOOLS:Xt.Flags.TOOLS,RENDER:"RENDER",UPDATE:"UPDATE",LABELS:"LABELS",SOURCE:"SOURCE",TARGET:"TARGET",CONNECTOR:"CONNECTOR"},Ao=Xt.extend({className:function(){var t=Xt.prototype.className.apply(this).split(" ");return t.push("link"),t.join(" ")},_labelCache:null,_labelSelectors:null,_V:null,_dragData:null,metrics:null,decimalsRounding:2,initialize:function(){Xt.prototype.initialize.apply(this,arguments),this._labelCache={},this._labelSelectors={},this._V={},this.cleanNodesCache()},presentationAttributes:{markup:[te.RENDER],attrs:[te.UPDATE],router:[te.UPDATE],connector:[te.CONNECTOR],labels:[te.LABELS],labelMarkup:[te.LABELS],vertices:[te.UPDATE],source:[te.SOURCE,te.UPDATE],target:[te.TARGET,te.UPDATE]},initFlag:[te.RENDER,te.SOURCE,te.TARGET,te.TOOLS],UPDATE_PRIORITY:1,confirmUpdate:function(t,e){if(e||(e={}),this.hasFlag(t,te.SOURCE)){if(!this.updateEndProperties("source"))return t;t=this.removeFlag(t,te.SOURCE)}if(this.hasFlag(t,te.TARGET)){if(!this.updateEndProperties("target"))return t;t=this.removeFlag(t,te.TARGET)}const{paper:n,sourceView:i,targetView:r}=this;if(n&&(i&&!n.isViewMounted(i)||r&&!n.isViewMounted(r)))return t;if(this.hasFlag(t,te.RENDER))return this.render(),this.updateHighlighters(!0),this.updateTools(e),t=this.removeFlag(t,[te.RENDER,te.UPDATE,te.LABELS,te.TOOLS,te.CONNECTOR]),t;let s=!1;const{model:o}=this,{attributes:a}=o;let l=this.hasFlag(t,te.LABELS);l&&(this.onLabelsChange(o,a.labels,e),t=this.removeFlag(t,te.LABELS),s=!0);const c=this.hasFlag(t,te.UPDATE),h=this.hasFlag(t,te.CONNECTOR);return(c||h)&&(c?e.translateBy&&o.isRelationshipEmbeddedIn(e.translateBy)?this.translate(e.tx,e.ty):this.update():(this.updatePath(),this.updateDOM()),this.updateTools(e),t=this.removeFlag(t,[te.UPDATE,te.TOOLS,te.CONNECTOR]),l=!1,s=!0),l&&this.updateLabelPositions(),s&&this.updateHighlighters(),this.hasFlag(t,te.TOOLS)&&(this.updateTools(e),t=this.removeFlag(t,te.TOOLS)),t},requestConnectionUpdate:function(t){this.requestUpdate(this.getFlag(te.UPDATE),t)},isLabelsRenderRequired:function(t={}){const e=this.model.previous("labels");if(!e)return!0;if("propertyPathArray"in t&&"propertyValue"in t){var n=t.propertyPathArray||[],i=n.length;if(i>1){var r=!!e[n[1]];if(r){if(i===2)return"markup"in Object(t.propertyValue);if(n[2]!=="markup")return!1}}}return!0},onLabelsChange:function(t,e,n){this.isLabelsRenderRequired(n)?this.renderLabels():this.updateLabels()},render:function(){return this.vel.empty(),this.unmountLabels(),this._V={},this.renderMarkup(),this.renderLabels(),this.update(),this},renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.LinkView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if(typeof e=="string")return this.renderStringMarkup(e);throw new Error("dia.LinkView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el);this.selectors=e.selectors,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=L(t);Array.isArray(e)||(e=[e]),this.vel.append(e)},_getLabelMarkup:function(t){if(t){if(Array.isArray(t))return this.parseDOMJSON(t,null);if(typeof t=="string")return this._getLabelStringMarkup(t);throw new Error("dia.linkView: invalid label markup")}},_getLabelStringMarkup:function(t){var e=L(t),n=document.createDocumentFragment();if(!Array.isArray(e))n.appendChild(e.node);else for(var i=0,r=e.length;i<r;i++){var s=e[i].node;n.appendChild(s)}return{fragment:n,selectors:{}}},_normalizeLabelMarkup:function(t){if(t){var e=t.fragment;if(!(t.fragment instanceof DocumentFragment)||!t.fragment.hasChildNodes())throw new Error("dia.LinkView: invalid label markup.");var n,i=e.childNodes;return i.length>1||i[0].nodeName.toUpperCase()!=="G"?n=L("g").append(e):n=L(i[0]),n.addClass("label"),{node:n.node,selectors:t.selectors}}},renderLabels:function(){var t=this._V,e=t.labels,n=this._labelCache={},i=this._labelSelectors={},r=this.model,s=r.attributes.labels||[],o=s.length;if(o===0)return e&&e.remove(),this;e?e.empty():(e=t.labels=L("g").addClass("labels"),this.options.labelsLayer&&(e.addClass(kn(ee(this,"className"))),e.attr("model-id",r.id)));for(var a=0;a<o;a++){var l=s[a],c=this._normalizeLabelMarkup(this._getLabelMarkup(l.markup)),h,u;if(c)h=c.node,u=c.selectors;else{var d=r._builtins.defaultLabel,f=this._normalizeLabelMarkup(this._getLabelMarkup(d.markup)),p=r._getDefaultLabel(),g=this._normalizeLabelMarkup(this._getLabelMarkup(p.markup)),v=g||f;h=v.node,u=v.selectors}h.setAttribute("label-idx",a),e.append(h),n[a]=h;var x=this.selector;if(u[x])throw new Error("dia.LinkView: ambiguous label root selector.");u[x]=h,i[a]=u}return e.parent()||this.mountLabels(),this.updateLabels(),this},mountLabels:function(){const{el:t,paper:e,model:n,_V:i,options:r}=this,{labels:s}=i;if(!s||!n.hasLabels())return;const{node:o}=s;r.labelsLayer?e.getLayerView(r.labelsLayer).insertSortedNode(o,n.get("z")):o.parentNode!==t&&t.appendChild(o)},unmountLabels:function(){const{options:t,_V:e}=this;if(!e)return;const{labels:n}=e;n&&t.labelsLayer&&n.remove()},findLabelNodes:function(t,e){const n=this._labelCache[t];if(!n)return[];const i=this._labelSelectors[t];return this.findBySelector(e,n,i)},findLabelNode:function(t,e){const[n=null]=this.findLabelNodes(t,e);return n},_mergeLabelAttrs:function(t,e,n,i){return e===null?null:e===void 0?n===null?null:n===void 0?t?void 0:i:t?n:Te({},i,n):t?Te({},n,e):Te({},i,n,e)},_mergeLabelSize:function(t,e){return t===null?null:t===void 0?e===null?null:e===void 0?void 0:e:Te({},e,t)},updateLabels:function(){if(!this._V.labels)return this;for(var t=this.model,e=t.get("labels")||[],n=this.can("labelMove"),i=t._builtins.defaultLabel,r=i.attrs,s=t._getDefaultLabel(),o=s.markup,a=s.attrs,l=s.size,c=0,h=e.length;c<h;c++){var u=this._labelCache[c];u.setAttribute("cursor",n?"move":"default");var d=this._labelSelectors[c],f=e[c],p=f.markup,g=f.attrs,v=f.size,x=this._mergeLabelAttrs(p||o,g,a,r),S=this._mergeLabelSize(v,l);this.updateDOMSubtreeAttributes(u,x,{rootBBox:new Z(S),selectors:d})}return this},removeRedundantLinearVertices:function(t){const n=this.model,i=n.vertices(),r=[this.sourceAnchor,...i,this.targetAnchor],s=r.length,o=new _e(r);o.simplify({threshold:.001});const a=o.points.map(c=>c.toJSON()),l=a.length;return s===l?0:(n.vertices(a.slice(1,l-1),t),s-l)},getEndView:function(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error("dia.LinkView: type parameter required.")}},getEndAnchor:function(t){switch(t){case"source":return new M(this.sourceAnchor);case"target":return new M(this.targetAnchor);default:throw new Error("dia.LinkView: type parameter required.")}},getEndConnectionPoint:function(t){switch(t){case"source":return new M(this.sourcePoint);case"target":return new M(this.targetPoint);default:throw new Error("dia.LinkView: type parameter required.")}},getEndMagnet:function(t){switch(t){case"source":var e=this.sourceView;if(!e)break;return this.sourceMagnet||e.el;case"target":var n=this.targetView;if(!n)break;return this.targetMagnet||n.el;default:throw new Error("dia.LinkView: type parameter required.")}return null},update:function(){return this.updateRoute(),this.updatePath(),this.updateDOM(),this},translate:function(t=0,e=0){const{route:n,path:i}=this;if(!n||!i)return;const r=new _e(n);r.translate(t,e),this.route=r.points,this.sourcePoint.offset(t,e),this.targetPoint.offset(t,e),this.sourceAnchor.offset(t,e),this.targetAnchor.offset(t,e),i.translate(t,e),this.updateDOM()},updateDOM(){const{el:t,model:e,selectors:n}=this;this.cleanNodesCache(),this.updateDOMSubtreeAttributes(t,e.attr(),{selectors:n}),this.updateLabelPositions(),this.options.perpendicular=null},updateRoute:function(){const{model:t}=this,e=t.vertices(),n=this.findAnchors(e),i=this.sourceAnchor=n.source,r=this.targetAnchor=n.target,s=this.findRoute(e);this.route=s;var o=this.findConnectionPoints(s,i,r);this.sourcePoint=o.source,this.targetPoint=o.target},updatePath:function(){const{route:t,sourcePoint:e,targetPoint:n}=this,i=this.findPath(t,e.clone(),n.clone());this.path=i},findAnchorsOrdered:function(t,e,n,i){var r,s,o,a,l=this.model,c=l.get(t),h=l.get(n),u=this.getEndView(t),d=this.getEndView(n),f=this.getEndMagnet(t),p=this.getEndMagnet(n);u?(e?o=new M(e):d?o=p:o=new M(h),r=this.getAnchor(c.anchor,u,f,o,t)):r=new M(c),d?(a=new M(i||r),s=this.getAnchor(h.anchor,d,p,a,n)):s=new M(h);var g={};return g[t]=r,g[n]=s,g},findAnchors:function(t){var e=this.model,n=t[0],i=t[t.length-1];return e.target().priority&&!e.source().priority?this.findAnchorsOrdered("target",i,"source",n):this.findAnchorsOrdered("source",n,"target",i)},findConnectionPoints:function(t,e,n){var i=t[0],r=t[t.length-1],s=this.model,o=s.get("source"),a=s.get("target"),l=this.sourceView,c=this.targetView,h=this.paper.options,u,d,f;if(l&&!l.isNodeConnection(this.sourceMagnet)){u=this.sourceMagnet||l.el;var p=o.connectionPoint||h.defaultConnectionPoint,g=i||n,v=new gt(g,e);f=this.getConnectionPoint(p,l,u,v,"source")}else f=e;var x;if(c&&!c.isNodeConnection(this.targetMagnet)){d=this.targetMagnet||c.el;var S=a.connectionPoint||h.defaultConnectionPoint,C=r||e,P=new gt(C,n);x=this.getConnectionPoint(S,c,d,P,"target")}else x=n;return{source:f,target:x}},getAnchor:function(t,e,n,i,r){var s=e.isNodeConnection(n),o=this.paper.options;if(t||(s?t=o.defaultLinkAnchor:this.options.perpendicular?t={name:"perpendicular"}:t=o.defaultAnchor),!t)throw new Error("Anchor required.");var a;if(typeof t=="function")a=t;else{var l=t.name,c=s?"linkAnchorNamespace":"anchorNamespace";if(a=o[c][l],typeof a!="function")throw new Error("Unknown anchor: "+l)}var h=a.call(this,e,n,i,t.args||{},r,this);return h?h.round(this.decimalsRounding):new M},getConnectionPoint:function(t,e,n,i,r){var s,o=i.end,a=this.paper.options;if(!t)return o;var l;if(typeof t=="function")l=t;else{var c=t.name;if(l=a.connectionPointNamespace[c],typeof l!="function")throw new Error("Unknown connection point: "+c)}return s=l.call(this,i,e,n,t.args||{},r,this),s?s.round(this.decimalsRounding):o},_getDefaultLabelPositionProperty:function(){var t=this.model,e=t._builtins.defaultLabel,n=e.position,i=t._getDefaultLabel(),r=this._normalizeLabelPosition(i.position);return Te({},n,r)},_normalizeLabelPosition:function(t){return typeof t=="number"?{distance:t,offset:null,angle:0,args:null}:t},_mergeLabelPositionProperty:function(t,e){return t===null?null:t===void 0?e===null?null:e:Te({},e,t)},updateLabelPositions:function(){if(!this._V.labels)return this;var t=this.path;if(!t)return this;var e=this.model,n=e.get("labels")||[];if(!n.length)return this;for(var i=this._getDefaultLabelPositionProperty(),r=0,s=n.length;r<s;r++){var o=this._labelCache[r];if(o){var a=n[r],l=this._normalizeLabelPosition(a.position),c=this._mergeLabelPositionProperty(l,i),h=this._getLabelTransformationMatrix(c);o.setAttribute("transform",L.matrixToTransformString(h)),this._cleanLabelMatrices(r)}}return this},_cleanLabelMatrices:function(t){const{metrics:e,_labelSelectors:n}=this,i=n[t];if(i)for(let r in i){const{id:s}=i[r];s&&s in e&&delete e[s].magnetMatrix}},updateEndProperties:function(t){const{model:e,paper:n}=this,i=`${t}View`,r=e.get(t),s=r&&r.id;if(!s)return this[i]=null,this.updateEndMagnet(t),!0;const o=n.getModelById(s);if(!o)throw new Error("LinkView: invalid "+t+" cell.");const a=o.findView(n);return a?(this[i]=a,this.updateEndMagnet(t),!0):!1},updateEndMagnet:function(t){const e=`${t}Magnet`,n=this.getEndView(t);if(n){let i=n.getMagnetFromLinkEnd(this.model.get(t));i===n.el&&(i=null),this[e]=i}else this[e]=null},_getLabelPositionProperty:function(t){return this.model.label(t).position||{}},_getLabelPositionAngle:function(t){var e=this._getLabelPositionProperty(t);return e.angle||0},_getLabelPositionArgs:function(t){var e=this._getLabelPositionProperty(t);return e.args},_getDefaultLabelPositionArgs:function(){var t=this.model._getDefaultLabel(),e=t.position||{};return e.args},_mergeLabelPositionArgs:function(t,e){return t===null?null:t===void 0?e===null?null:e:Te({},e,t)},addLabel:function(t,e,n,i){var r,s,o=0,a;typeof t!="number"?(r=t.x,s=t.y,typeof e=="number"?(o=e,a=n):a=e):(r=t,s=e,typeof n=="number"?(o=n,a=i):a=n);var l=this._getDefaultLabelPositionArgs(),c=a,h=this._mergeLabelPositionArgs(c,l),u={position:this.getLabelPosition(r,s,o,h)},d=-1;return this.model.insertLabel(d,u,a),d},addVertex:function(t,e,n){var i=typeof t!="number",r=i?t.x:t,s=i?t.y:e,o=i?e:n,a={x:r,y:s},l=this.getVertexIndex(r,s);return this.model.insertVertex(l,a,o),l},sendToken:function(t,e,n){function i(u,d){return function(){u.remove(),typeof d=="function"&&d()}}var r,s,o;Vt(e)?(r=e.duration,s=e.direction==="reverse",o=e.connection):(r=e,s=!1,o=null),r=r||1e3;var a={dur:r+"ms",repeatCount:1,calcMode:"linear",fill:"freeze"};s&&(a.keyPoints="1;0",a.keyTimes="0;1");var l=L(t),c;if(typeof o=="string")c=this.findNode(o);else{var h=this._V;c=h.connection?h.connection.node:this.el.querySelector("path")}if(!(c instanceof SVGPathElement))throw new Error("dia.LinkView: token animation requires a valid connection path.");l.appendTo(this.paper.cells).animateAlongPath(a,c),setTimeout(i(l,n),r)},findRoute:function(t){t||(t=[]);var e=this.paper.options.routerNamespace||EV,n=this.model.router(),i=this.paper.options.defaultRouter;if(!n)if(i)n=i;else return t.map(M);var r=_t(n)?n:e[n.name];if(!_t(r))throw new Error('dia.LinkView: unknown router: "'+n.name+'".');var s=n.args||{},o=r.call(this,t,s,this);return o||t.map(M)},findPath:function(t,e,n){var i=this.paper.options.connectorNamespace||_5,r=this.model.connector(),s=this.paper.options.defaultConnector;r||(r=s||{});var o=_t(r)?r:i[r.name];if(!_t(o))throw new Error('dia.LinkView: unknown connector: "'+r.name+'".');var a=we(r.args||{});a.raw=!0;var l=o.call(this,e,n,t,a,this);return typeof l=="string"&&(l=new K(L.normalizePathData(l))),l},getConnection:function(){var t=this.path;return t?t.clone():null},getSerializedConnection:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("data"))return e.data;var n=t.serialize();return e.data=n,n},getConnectionSubdivisions:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("segmentSubdivisions"))return e.segmentSubdivisions;var n=t.getSegmentSubdivisions();return e.segmentSubdivisions=n,n},getConnectionLength:function(){var t=this.path;if(!t)return 0;var e=this.metrics;if(e.hasOwnProperty("length"))return e.length;var n=t.length({segmentSubdivisions:this.getConnectionSubdivisions()});return e.length=n,n},getPointAtLength:function(t){var e=this.path;return e?e.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getPointAtRatio:function(t){var e=this.path;return e?(je(t)&&(t=parseFloat(t)/100),e.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})):null},getTangentAtLength:function(t){var e=this.path;return e?e.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getTangentAtRatio:function(t){var e=this.path;return e?e.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPoint:function(t){var e=this.path;return e?e.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointLength:function(t){var e=this.path;return e?e.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointRatio:function(t){var e=this.path;return e?e.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getLabelPosition:function(t,e,n,i){var r={},s=0,o;typeof n=="number"?(s=n,o=i):o=n,o&&(r.args=o);var a=!(o&&o.absoluteDistance),l=o&&o.absoluteDistance&&o.reverseDistance,c=o&&o.absoluteOffset,h=this.path,u={segmentSubdivisions:this.getConnectionSubdivisions()},d=new M(t,e),f=h.closestPointT(d,u),p=h.lengthAtT(f,u);a&&(p=p/this.getConnectionLength()||0),l&&(p=-1*(this.getConnectionLength()-p)||1),r.distance=p;var g;c||(g=h.tangentAtT(f));var v;if(g)v=g.pointOffset(d);else{var x=h.pointAtT(f),S=d.difference(x);v={x:S.x,y:S.y}}return r.offset=v,r.angle=s,r},_getLabelTransformationMatrix:function(t){var e,n=0,i={};if(typeof t=="number")e=t;else if(typeof t.distance=="number")i=t.args||{},e=t.distance,n=t.angle||0;else throw new Error("dia.LinkView: invalid label position distance.");var r=e>0&&e<=1,s=0,o={x:0,y:0};if(t.offset){var a=t.offset;typeof a=="number"&&(s=a),a.x&&(o.x=a.x),a.y&&(o.y=a.y)}var l=o.x!==0||o.y!==0||s===0,c=i.keepGradient,h=i.ensureLegibility,u=this.path,d={segmentSubdivisions:this.getConnectionSubdivisions()},f=r?e*this.getConnectionLength():e,p=u.tangentAtLength(f,d),g,v=n;if(p){if(l)g=p.start.clone(),g.offset(o);else{var x=p.clone();x.rotate(p.start,-90),x.setLength(s),g=x.end}c&&(v=p.angle()+n,h&&(v=nn((v+90)%180-90)))}else g=u.start.clone(),l&&g.offset(o);return L.createSVGMatrix().translate(g.x,g.y).rotate(v)},getLabelCoordinates:function(t){var e=this._getLabelTransformationMatrix(t);return new M(e.e,e.f)},getVertexIndex:function(t,e){for(var n=this.model,i=n.vertices(),r=this.getClosestPointLength(new M(t,e)),s=0,o=i.length;s<o;s++){var a=i[s],l=this.getClosestPointLength(a);if(r<l)break}return s},notifyPointerdown(t,e,n){Xt.prototype.pointerdown.call(this,t,e,n),this.notify("link:pointerdown",t,e,n)},notifyPointermove(t,e,n){Xt.prototype.pointermove.call(this,t,e,n),this.notify("link:pointermove",t,e,n)},notifyPointerup(t,e,n){this.notify("link:pointerup",t,e,n),Xt.prototype.pointerup.call(this,t,e,n)},pointerdblclick:function(t,e,n){Xt.prototype.pointerdblclick.apply(this,arguments),this.notify("link:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){Xt.prototype.pointerclick.apply(this,arguments),this.notify("link:pointerclick",t,e,n)},contextmenu:function(t,e,n){Xt.prototype.contextmenu.apply(this,arguments),this.notify("link:contextmenu",t,e,n)},pointerdown:function(t,e,n){this.notifyPointerdown(t,e,n),this.dragStart(t,e,n)},pointermove:function(t,e,n){var i=this._dragData;i&&this.eventData(t,i);var r=this.eventData(t);switch(r.action){case"label-move":this.dragLabel(t,e,n);break;case"arrowhead-move":this.dragArrowhead(t,e,n);break;case"move":this.drag(t,e,n);break}i&&H(i,this.eventData(t)),this.notifyPointermove(t,e,n)},pointerup:function(t,e,n){var i=this._dragData;i&&(this.eventData(t,i),this._dragData=null);var r=this.eventData(t);switch(r.action){case"label-move":this.dragLabelEnd(t,e,n);break;case"arrowhead-move":this.dragArrowheadEnd(t,e,n);break;case"move":this.dragEnd(t,e,n)}this.notifyPointerup(t,e,n),this.checkMouseleave(t)},mouseover:function(t){Xt.prototype.mouseover.apply(this,arguments),this.notify("link:mouseover",t)},mouseout:function(t){Xt.prototype.mouseout.apply(this,arguments),this.notify("link:mouseout",t)},mouseenter:function(t){Xt.prototype.mouseenter.apply(this,arguments),this.notify("link:mouseenter",t)},mouseleave:function(t){Xt.prototype.mouseleave.apply(this,arguments),this.notify("link:mouseleave",t)},mousewheel:function(t,e,n,i){Xt.prototype.mousewheel.apply(this,arguments),this.notify("link:mousewheel",t,e,n,i)},onlabel:function(t,e,n){this.notifyPointerdown(t,e,n),this.dragLabelStart(t,e,n);var i=this.eventData(t).stopPropagation;i&&t.stopPropagation()},dragLabelStart:function(t,e,n){if(this.can("labelMove")){if(this.isDefaultInteractionPrevented(t))return;var i=t.currentTarget,r=parseInt(i.getAttribute("label-idx"),10),s=this._getDefaultLabelPositionProperty(),o=this._normalizeLabelPosition(this._getLabelPositionProperty(r)),a=this._mergeLabelPositionProperty(o,s),l=this.getLabelCoordinates(a),c=l.x-e,h=l.y-n,u=this._getLabelPositionAngle(r),d=this._getLabelPositionArgs(r),f=this._getDefaultLabelPositionArgs(),p=this._mergeLabelPositionArgs(d,f);this.eventData(t,{action:"label-move",labelIdx:r,dx:c,dy:h,positionAngle:u,positionArgs:p,stopPropagation:!0})}else this.eventData(t,{stopPropagation:!0});this.paper.delegateDragEvents(this,t.data)},dragArrowheadStart:function(t,e,n){if(this.can("arrowheadMove")){var i=t.target,r=i.getAttribute("end"),s=this.startArrowheadMove(r,{ignoreBackwardsCompatibility:!0});this.eventData(t,s)}},dragStart:function(t,e,n){this.isDefaultInteractionPrevented(t)||this.can("linkMove")&&this.eventData(t,{action:"move",dx:e,dy:n})},dragLabel:function(t,e,n){var i=this.eventData(t),r={position:this.getLabelPosition(e+i.dx,n+i.dy,i.positionAngle,i.positionArgs)};this.paper.options.snapLabels&&delete r.position.offset;const s={ui:!0};this.paper.isAsync()&&t.type==="touchmove"&&(s.async=!1),this.model.label(i.labelIdx,r,s)},dragArrowhead:function(t,e,n){this.paper.options.snapLinks?!this._snapArrowhead(t,e,n)&&this.paper.options.snapLinksSelf&&this._snapArrowheadSelf(t,e,n):this.paper.options.snapLinksSelf?this._snapArrowheadSelf(t,e,n):this._connectArrowhead(this.getEventTarget(t),e,n,this.eventData(t))},drag:function(t,e,n){var i=this.eventData(t);this.model.translate(e-i.dx,n-i.dy,{ui:!0}),this.eventData(t,{dx:e,dy:n})},dragLabelEnd:function(){},dragArrowheadEnd:function(t,e,n){var i=this.eventData(t),r=this.paper;r.options.snapLinks?this._snapArrowheadEnd(i):this._connectArrowheadEnd(i,e,n),r.linkAllowed(this)?(this._finishEmbedding(i),this._notifyConnectEvent(i,t)):this._disallow(i),this._afterArrowheadMove(i)},dragEnd:function(){},_disallow:function(t){switch(t.whenNotAllowed){case"remove":this.model.remove({ui:!0});break;case"revert":default:this.model.set(t.arrowhead,t.initialEnd,{ui:!0});break}},_finishEmbedding:function(t){this.paper.options.embeddingMode&&this.model.reparent()&&(t.z=null)},_notifyConnectEvent:function(t,e){var n=t.arrowhead,i=t.initialEnd,r=this.model.prop(n),s=r&&!Dr.endsEqual(i,r);if(s){var o=this.paper;i.id&&this.notify("link:disconnect",e,o.findViewByModel(i.id),t.initialMagnet,n),r.id&&this.notify("link:connect",e,o.findViewByModel(r.id),t.magnetUnderPointer,n)}},_snapToPoints:function(t,e,n){let i=null,r=1/0,s=null,o=1/0,a=t.x,l=t.y;for(let c=0;c<e.length;c++){const h=Math.abs(e[c].x-t.x);h<r&&(r=h,i=e[c]);const u=Math.abs(e[c].y-t.y);u<o&&(o=u,s=e[c])}return r<n&&(a=i.x),o<n&&(l=s.y),{x:a,y:l}},_snapArrowheadSelf:function(t,e,n){const{paper:i,model:r}=this,{snapLinksSelf:s}=i.options,o=this.eventData(t),a=s.radius||20,l=this.getEndAnchor(o.arrowhead==="source"?"target":"source"),c=r.vertices(),h=[l,...c],u=this._snapToPoints({x:e,y:n},h,a),d=i.localToClientPoint(u);this._connectArrowhead(document.elementFromPoint(d.x,d.y),u.x,u.y,this.eventData(t))},_snapArrowhead:function(t,e,n){const{paper:i}=this,{snapLinks:r,connectionStrategy:s}=i.options,o=this.eventData(t);let a=!1;var l=r.radius||50,c=i.findViewsInArea({x:e-l,y:n-l,width:2*l,height:2*l}),h=o.closestView||null,u=o.closestMagnet||null,d=o.magnetProxy||null;o.closestView=o.closestMagnet=o.magnetProxy=null;var f=Number.MAX_VALUE,p=new M(e,n);c.forEach(function(k){const N=[];k.el.getAttribute("magnet")!=="false"&&N.push({bbox:k.model.getBBox(),magnet:k.el}),k.$("[magnet]").toArray().forEach(m=>{N.push({bbox:k.getNodeBBox(m),magnet:m})}),N.forEach(m=>{const{magnet:b,bbox:w}=m,T=w.center().squaredDistance(p);T<f&&(u===b||i.options.validateConnection.apply(i,o.validateConnectionArgs(k,k.el===b?null:b)))&&(f=T,o.closestView=k,o.closestMagnet=b)})},this);var g,v=null,x=o.closestView,S=o.closestMagnet;S&&(v=o.magnetProxy=x.findProxyNode(S,"highlighter"));var C=o.arrowhead,P=u!==S;if(h&&P&&h.unhighlight(d,{connecting:!0,snapping:!0}),x){const{prevEnd:k,prevX:N,prevY:m}=o;if(o.prevX=e,o.prevY=n,a=!0,!P&&(typeof s!="function"||N===e&&m===n)||(g=x.getLinkEnd(S,e,n,this.model,C),!P&&ke(k,g)))return a;o.prevEnd=g,P&&x.highlight(v,{connecting:!0,snapping:!0})}else g={x:e,y:n};return this.model.set(C,g||{x:e,y:n},{ui:!0}),h&&this.notify("link:snap:disconnect",t,h,u,C),x&&this.notify("link:snap:connect",t,x,S,C),a},_snapArrowheadEnd:function(t){var e=t.closestView,n=t.closestMagnet;e&&n&&(e.unhighlight(t.magnetProxy,{connecting:!0,snapping:!0}),t.magnetUnderPointer=e.findMagnet(n)),t.closestView=t.closestMagnet=null},_connectArrowhead:function(t,e,n,i){const{paper:r,model:s}=this;if(i.eventTarget!==t){i.magnetProxy&&i.viewUnderPointer.unhighlight(i.magnetProxy,{connecting:!0});const o=i.viewUnderPointer=r.findView(t);if(o){const a=i.magnetUnderPointer=o.findMagnet(t),l=i.magnetProxy=o.findProxyNode(a,"highlighter");a&&this.paper.options.validateConnection.apply(r,i.validateConnectionArgs(o,a))?l&&o.highlight(l,{connecting:!0}):(i.magnetUnderPointer=null,i.magnetProxy=null)}else i.magnetUnderPointer=null,i.magnetProxy=null}i.eventTarget=t,s.set(i.arrowhead,{x:e,y:n},{ui:!0})},_connectArrowheadEnd:function(t={},e,n){const{model:i}=this,{viewUnderPointer:r,magnetUnderPointer:s,magnetProxy:o,arrowhead:a}=t;if(!s||!o||!r)return;r.unhighlight(o,{connecting:!0});const l=r.getLinkEnd(s,e,n,i,a);i.set(a,l,{ui:!0})},_beforeArrowheadMove:function(t){t.z=this.model.get("z"),this.model.toFront();var e=this.el.style;t.pointerEvents=e.pointerEvents,e.pointerEvents="none",this.paper.options.markAvailable&&this._markAvailableMagnets(t)},_afterArrowheadMove:function(t){t.z!==null&&(this.model.set("z",t.z,{ui:!0}),t.z=null),this.el.style.pointerEvents=t.pointerEvents,this.paper.options.markAvailable&&this._unmarkAvailableMagnets(t)},_createValidateConnectionArgs:function(t){var e=[];e[4]=t,e[5]=this;var n,i=0,r=0;t==="source"?(i=2,n="target"):(r=2,n="source");var s=this.model.get(n);if(s.id){var o=e[i]=this.paper.findViewByModel(s.id),a=o.getMagnetFromLinkEnd(s);a===o.el&&(a=void 0),e[i+1]=a}function l(c,h){return e[r]=c,e[r+1]=c.el===h?void 0:h,e}return l},_markAvailableMagnets:function(t){function e(u,d){var f=u.paper,p=f.options.validateConnection;return p.apply(f,this.validateConnectionArgs(u,d))}var n=this.paper,i=n.model.getCells();t.marked={};for(var r=0,s=i.length;r<s;r++){var o=i[r].findView(n);if(o){var a=Array.prototype.slice.call(o.el.querySelectorAll("[magnet]"));o.el.getAttribute("magnet")!=="false"&&a.push(o.el);var l=a.filter(e.bind(t,o));if(l.length>0){for(var c=0,h=l.length;c<h;c++)o.highlight(l[c],{magnetAvailability:!0});o.highlight(null,{elementAvailability:!0}),t.marked[o.model.id]=l}}}},_unmarkAvailableMagnets:function(t){for(var e=Object.keys(t.marked),n,i,r=0,s=e.length;r<s;r++){n=e[r],i=t.marked[n];var o=this.paper.findViewByModel(n);if(o){for(var a=0,l=i.length;a<l;a++)o.unhighlight(i[a],{magnetAvailability:!0});o.unhighlight(null,{elementAvailability:!0})}}t.marked=null},startArrowheadMove:function(t,e){e||(e={});var n={action:"arrowhead-move",arrowhead:t,whenNotAllowed:e.whenNotAllowed||"revert",initialMagnet:this[t+"Magnet"]||(this[t+"View"]?this[t+"View"].el:null),initialEnd:we(this.model.get(t)),validateConnectionArgs:this._createValidateConnectionArgs(t)};return this._beforeArrowheadMove(n),e.ignoreBackwardsCompatibility!==!0&&(this._dragData=n),n},onMount:function(){Xt.prototype.onMount.apply(this,arguments),this.mountLabels()},onDetach:function(){Xt.prototype.onDetach.apply(this,arguments),this.unmountLabels()},onRemove:function(){Xt.prototype.onRemove.apply(this,arguments),this.unmountLabels()}},{Flags:te});Object.defineProperty(Ao.prototype,"sourceBBox",{enumerable:!0,get:function(){var t=this.sourceView;if(!t){var e=this.model.source();return new Z(e.x,e.y)}var n=this.sourceMagnet;return t.isNodeConnection(n)?new Z(this.sourceAnchor):t.getNodeBBox(n||t.el)}});Object.defineProperty(Ao.prototype,"targetBBox",{enumerable:!0,get:function(){var t=this.targetView;if(!t){var e=this.model.target();return new Z(e.x,e.y)}var n=this.targetMagnet;return t.isNodeConnection(n)?new Z(this.targetAnchor):t.getNodeBBox(n||t.el)}});const t4=uu.extend({style:{"pointer-events":"none"},_gridCache:null,_gridSettings:null,init(){uu.prototype.init.apply(this,arguments);const{options:{paper:t}}=this;this._gridCache=null,this._gridSettings=[],this.listenTo(t,"transform resize",this.updateGrid)},setGrid(t){this._gridSettings=this.getGridSettings(t),this.renderGrid()},getGridSettings(t){const e=[];return t&&(Array.isArray(t)?t:[t||{}]).forEach(i=>{e.push(...this._resolveDrawGridOption(i))}),e},removeGrid(){const{_gridCache:t}=this;t&&(t.root.remove(),this._gridCache=null)},renderGrid(){const{options:{paper:t}}=this,{_gridSettings:e}=this;if(this.removeGrid(),e.length===0)return;const n=t.options.drawGridSize||t.options.gridSize;if(n<=1)return;const i=this._getGridRefs();e.forEach((r,s)=>{const o=this._getPatternId(s),a=Te({},r),{scaleFactor:l=1}=a;a.width=n*l||1,a.height=n*l||1;let c;i.exist(o)?c=i.get(o):(c=L("pattern",{id:o,patternUnits:"userSpaceOnUse"},L(a.markup)),i.add(o,c)),_t(a.render)&&a.render(c.node.firstChild,a,t),c.attr({width:a.width,height:a.height})}),i.root.appendTo(this.el),this.updateGrid()},updateGrid(){const{_gridCache:t,_gridSettings:e,options:{paper:n}}=this;if(!t)return;const{root:i,patterns:r}=t,{x:s,y:o,width:a,height:l}=n.getArea();i.attr({x:s,y:o,width:a,height:l});for(const c in r)r[c].attr({x:-s,y:-o});e.forEach((c,h)=>{if(_t(c.update)){const u=r[this._getPatternId(h)];c.update(u.node.firstChild,c,n)}})},_getPatternId(t){return`pattern_${this.options.paper.cid}_${t}`},_getGridRefs(){let{_gridCache:t}=this;if(t)return t;const e=L("defs"),n=L("svg",{width:"100%",height:"100%"},[e]);return t=this._gridCache={root:n,patterns:{},add:function(i,r){const s=L("rect",{width:"100%",height:"100%",fill:`url(#${i})`});e.append(r),n.append(s),this.patterns[i]=r},get:function(i){return this.patterns[i]},exist:function(i){return this.patterns[i]!==void 0}},t},_resolveDrawGridOption(t){var e=this.options.patterns;if(ne(t)&&Array.isArray(e[t]))return e[t].map(function(l){return H({},l)});var n=t||{args:[{}]},i=Array.isArray(n),r=n.name;if(!i&&!r&&!n.markup&&(r="dot"),r&&Array.isArray(e[r])){var s=e[r].map(function(l){return H({},l)}),o=Array.isArray(n.args)?n.args:[n.args||{}];me(o[0],Qe(t,"args"));for(var a=0;a<o.length;a++)s[a]&&H(s[a],o[a]);return s}return i?n:[n]}}),co={NONE:"sorting-none",APPROX:"sorting-approximate",EXACT:"sorting-exact"},e4=50,Nv=20,Rv=1e3,n4=1/0,bc=9007199254740991,rd=Xt.Highlighting,$v={[rd.DEFAULT]:{name:"stroke",options:{padding:3}},[rd.MAGNET_AVAILABILITY]:{name:"addClass",options:{className:"available-magnet"}},[rd.ELEMENT_AVAILABILITY]:{name:"addClass",options:{className:"available-cell"}}},i4=[{name:_n.GRID},{name:_n.BACK},{name:_n.CELLS},{name:_n.LABELS},{name:_n.FRONT},{name:_n.TOOLS}],Ai=ce.extend({className:"paper",options:{width:800,height:600,gridSize:1,drawGrid:!1,drawGridSize:null,background:!1,elementView:Pe,linkView:Ao,snapLabels:!1,snapLinks:!1,snapLinksSelf:!1,labelsLayer:!1,multiLinks:!0,guard:function(t,e){return!1},highlighting:$v,preventContextMenu:!0,preventDefaultBlankAction:!0,preventDefaultViewAction:!0,restrictTranslate:!1,markAvailable:!1,defaultLink:function(){const{cellNamespace:t}=this.model.get("cells"),e=yn(t,["standard","Link"]);if(!e)throw new Error("dia.Paper: no default link model found. Use `options.defaultLink` to specify a default link model.");return new e},defaultConnector:{name:"normal"},defaultRouter:{name:"normal"},defaultAnchor:{name:"center"},defaultLinkAnchor:{name:"connectionRatio"},defaultConnectionPoint:{name:"boundary"},connectionStrategy:null,validateMagnet:function(t,e,n){return e.getAttribute("magnet")!=="passive"},validateConnection:function(t,e,n,i,r,s){return(r==="target"?n:t)instanceof Pe},embeddingMode:!1,validateEmbedding:function(t,e){return!0},validateUnembedding:function(t){return!0},findParentBy:"bbox",frontParentOnly:!0,interactive:{labelMove:!1},linkPinning:!0,allowLink:null,clickThreshold:0,moveThreshold:0,magnetThreshold:0,sorting:co.APPROX,frozen:!1,autoFreeze:!1,onViewUpdate:function(t,e,n,i,r){e&(t.FLAG_INSERT|t.FLAG_REMOVE)||i.mounting||i.isolate||r.requestConnectedLinksUpdate(t,n,i)},onViewPostponed:function(t,e,n){return n.forcePostponedViewUpdate(t,e)},beforeRender:null,afterRender:null,viewport:null,cellViewNamespace:null,routerNamespace:null,connectorNamespace:null,highlighterNamespace:$5,anchorNamespace:WV,linkAnchorNamespace:kV,connectionPointNamespace:Y5,overflow:!1},events:{dblclick:"pointerdblclick",dbltap:"pointerdblclick",contextmenu:"contextmenu",mousedown:"pointerdown",touchstart:"pointerdown",mouseover:"mouseover",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",wheel:"mousewheel","mouseenter .joint-cell":"mouseenter","mouseleave .joint-cell":"mouseleave","mouseenter .joint-tools":"mouseenter","mouseleave .joint-tools":"mouseleave","dblclick .joint-cell [magnet]":"magnetpointerdblclick","contextmenu .joint-cell [magnet]":"magnetcontextmenu","mousedown .joint-link .label":"onlabel","touchstart .joint-link .label":"onlabel","dragstart .joint-cell image":"onImageDragStart"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},stylesheet:`
        .joint-element .scalable * {
            vector-effect: non-scaling-stroke;
        }
    `,svg:null,viewport:null,defs:null,tools:null,layers:null,_viewportMatrix:null,_viewportTransformString:null,_updates:null,_layers:null,SORT_DELAYING_BATCHES:["add","to-front","to-back"],UPDATE_DELAYING_BATCHES:["translate"],FORM_CONTROL_TAG_NAMES:["TEXTAREA","INPUT","BUTTON","SELECT","OPTION"],GUARDED_TAG_NAMES:["SELECT"],MIN_SCALE:1e-6,init:function(){const{options:t}=this;t.cellViewNamespace||(t.cellViewNamespace=typeof joint<"u"&&di(joint,"shapes")?joint.shapes:null);const e=this.model=t.model||new On;this._layers={},this.cloneOptions(),this.render(),this._setDimensions(),this.startListening(),this._views={},this._mw_evt_buffer={event:null,deltas:[]},this.resetViews(e.attributes.cells.models),!this.isFrozen()&&this.isAsync()&&this.updateViewsAsync()},_resetUpdates:function(){return this._updates&&this._updates.id&&ks(this._updates.id),this._updates={id:null,priorities:[{},{},{}],unmountedCids:[],mountedCids:[],unmounted:{},mounted:{},count:0,keyFrozen:!1,freezeKey:null,sort:!1,disabled:!1,idle:!1}},startListening:function(){var t=this.model;this.listenTo(t,"add",this.onCellAdded).listenTo(t,"remove",this.onCellRemoved).listenTo(t,"change",this.onCellChange).listenTo(t,"reset",this.onGraphReset).listenTo(t,"sort",this.onGraphSort).listenTo(t,"batch:stop",this.onGraphBatchStop),this.on("cell:highlight",this.onCellHighlight).on("cell:unhighlight",this.onCellUnhighlight).on("transform",this.update)},onCellAdded:function(t,e,n){var i=n.position;this.isAsync()||!Nt(i)?this.renderView(t,n):(n.maxPosition===i&&this.freeze({key:"addCells"}),this.renderView(t,n),i===0&&this.unfreeze({key:"addCells"}))},onCellRemoved:function(t,e,n){const i=this.findViewByModel(t);i&&this.requestViewUpdate(i,i.FLAG_REMOVE,i.UPDATE_PRIORITY,n)},onCellChange:function(t,e){if(t!==this.model.attributes.cells&&t.hasChanged("z")&&this.options.sorting===co.APPROX){const n=this.findViewByModel(t);n&&this.requestViewUpdate(n,n.FLAG_INSERT,n.UPDATE_PRIORITY,e)}},onGraphReset:function(t,e){this.resetLayers(),this.resetViews(t.models,e)},onGraphSort:function(){this.model.hasActiveBatch(this.SORT_DELAYING_BATCHES)||this.sortViews()},onGraphBatchStop:function(t){if(!this.isFrozen()){var e=t&&t.batchName,n=this.model;if(!this.isAsync()){var i=this.UPDATE_DELAYING_BATCHES;i.includes(e)&&!n.hasActiveBatch(i)&&this.updateViews(t)}var r=this.SORT_DELAYING_BATCHES;r.includes(e)&&!n.hasActiveBatch(r)&&this.sortViews()}},cloneOptions:function(){const{options:t}=this,{defaultConnector:e,defaultRouter:n,defaultConnectionPoint:i,defaultAnchor:r,defaultLinkAnchor:s,highlighting:o,cellViewNamespace:a,interactive:l}=t;!a&&typeof joint<"u"&&di(joint,"shapes")&&(t.cellViewNamespace=joint.shapes),_t(e)||(t.defaultConnector=Le(e)),_t(n)||(t.defaultRouter=Le(n)),_t(i)||(t.defaultConnectionPoint=Le(i)),_t(r)||(t.defaultAnchor=Le(r)),_t(s)||(t.defaultLinkAnchor=Le(s)),Ce(l)&&(t.interactive=H({},l)),Ce(o)&&(t.highlighting=er({},o,$v))},children:function(){var t=L.namespace;return[{namespaceURI:t.xhtml,tagName:"div",className:kn("paper-background"),selector:"background",style:{position:"absolute",inset:0}},{namespaceURI:t.svg,tagName:"svg",attributes:{width:"100%",height:"100%","xmlns:xlink":t.xlink},selector:"svg",style:{position:"absolute",inset:0},children:[{tagName:"defs",selector:"defs"},{tagName:"g",className:kn("layers"),selector:"layers"}]}]},hasLayerView(t){return t in this._layers},getLayerView(t){const{_layers:e}=this;if(t in e)return e[t];throw new Error(`dia.Paper: Unknown layer "${t}"`)},getLayerNode(t){return this.getLayerView(t).el},render:function(){this.renderChildren();const{el:t,childNodes:e,options:n,stylesheet:i}=this,{svg:r,defs:s,layers:o}=e;return t.style.position="relative",r.style.overflow=n.overflow?"visible":"hidden",this.svg=r,this.defs=s,this.layers=o,this.renderLayers(),L.ensureId(r),this.addStylesheet(i),n.background&&this.drawBackground(n.background),n.drawGrid&&this.setGrid(n.drawGrid),this},addStylesheet:function(t){t&&L(this.svg).prepend(L.createSVGStyle(t))},createLayer(t){switch(t){case _n.GRID:return new t4({name:t,paper:this,patterns:this.constructor.gridPatterns});default:return new uu({name:t})}},renderLayers:function(t=i4){this.removeLayers(),t.forEach(({name:r,sorted:s})=>{const o=this.createLayer(r);this.layers.appendChild(o.el),this._layers[r]=o});const e=this.getLayerView(_n.CELLS),n=this.getLayerView(_n.TOOLS),i=this.getLayerView(_n.LABELS);this.tools=n.el,this.cells=this.viewport=e.el,e.vel.addClass(kn("viewport")),i.vel.addClass(kn("viewport")),e.el.style.webkitUserSelect="none",e.el.style.userSelect="none",i.el.style.webkitUserSelect="none",i.el.style.userSelect="none"},removeLayers:function(){const{_layers:t}=this;Object.keys(t).forEach(e=>{t[e].remove(),delete t[e]})},resetLayers:function(){const{_layers:t}=this;Object.keys(t).forEach(e=>{t[e].removePivots()})},update:function(){return this._background&&this.updateBackgroundImage(this._background),this},scale:function(t,e,n){const i=this.matrix();return t===void 0?L.matrixToScale(i):(e===void 0&&(e=t),t=Math.max(t||0,this.MIN_SCALE),e=Math.max(e||0,this.MIN_SCALE),i.a=t,i.d=e,this.matrix(i,n),this)},scaleUniformAtPoint:function(t,e,n){const{a:i,d:r,e:s,f:o}=this.matrix();if(t=Math.max(t||0,this.MIN_SCALE),t===i&&t===r)return this;const a=L.createSVGMatrix().translate(s-e.x*(t-i),o-e.y*(t-r)).scale(t,t);return this.matrix(a,n),this},translate:function(t,e,n){const i=this.matrix();return t===void 0?L.matrixToTranslate(i):(t||(t=0),e||(e=0),i.e===t&&i.f===e?this:(i.e=t,i.f=e,this.matrix(i,n),this))},matrix:function(t,e={}){var n=this.layers;if(t===void 0){var i=n.getAttribute("transform");return(this._viewportTransformString||null)===i?t=this._viewportMatrix:(t=n.getCTM(),this._viewportMatrix=t,this._viewportTransformString=i),L.createSVGMatrix(t)}const r=this.matrix(),s=L.createSVGMatrix(t),o=this._viewportTransformString,a=L.matrixToTransformString(s);if(a===o)return this;if(!o&&L.matrixToTransformString()===a)return this;const{a:l,d:c,e:h,f:u}=s;return n.setAttribute("transform",a),this._viewportMatrix=s,this._viewportTransformString=n.getAttribute("transform"),(l!==r.a||c!==r.d)&&this.trigger("scale",l,c,e),(h!==r.e||u!==r.f)&&this.trigger("translate",h,u,e),this.trigger("transform",s,e),this},clientMatrix:function(){return L.createSVGMatrix(this.cells.getScreenCTM())},requestConnectedLinksUpdate:function(t,e,n){if(t instanceof Xt)for(var i=t.model,r=this.model.getConnectedLinks(i),s=0,o=r.length;s<o;s++){var a=r[s],l=this.findViewByModel(a);if(l){var c=["UPDATE"];a.getTargetCell()===i&&c.push("TARGET"),a.getSourceCell()===i&&c.push("SOURCE");var h=Math.max(e+1,l.UPDATE_PRIORITY);this.scheduleViewUpdate(l,l.getFlag(c),h,n)}}},forcePostponedViewUpdate:function(t,e){if(!t||!(t instanceof Xt))return!1;var n=t.model;if(n.isElement())return!1;if(!(e&t.getFlag(["SOURCE","TARGET"]))){var i={silent:!0},r=0,s=this.findViewByModel(n.getSourceCell());s&&!this.isViewMounted(s)&&(r=this.dumpView(s,i),t.updateEndMagnet("source"));var o=0,a=this.findViewByModel(n.getTargetCell());if(a&&!this.isViewMounted(a)&&(o=this.dumpView(a,i),t.updateEndMagnet("target")),r===0&&o===0)return!this.dumpView(t,i)}return!1},requestViewUpdate:function(t,e,n,i){i||(i={}),this.scheduleViewUpdate(t,e,n,i);var r=this.isAsync();if(!(this.isFrozen()||r&&i.async!==!1)&&!this.model.hasActiveBatch(this.UPDATE_DELAYING_BATCHES)){var s=this.updateViews(i);r&&this.notifyAfterRender(s,i)}},scheduleViewUpdate:function(t,e,n,i){const{_updates:r,options:s}=this;r.idle&&s.autoFreeze&&(r.idle=!1,this.unfreeze());const{FLAG_REMOVE:o,FLAG_INSERT:a,UPDATE_PRIORITY:l,cid:c}=t;let h=r.priorities[n];if(h||(h=r.priorities[n]={}),n>l)for(let f=n-1;f>=l;f--){const p=r.priorities[f];!p||!(c in p)||(h[c]|=p[c],delete p[c])}let u=h[c]||0;if((u&e)===e)return;u||r.count++,e&o&&u&a?h[c]^=a:e&a&&u&o&&(h[c]^=o),h[c]|=e;const d=s.onViewUpdate;typeof d=="function"&&d.call(this,t,e,n,i||{},this)},dumpViewUpdate:function(t){if(!t)return 0;var e=this._updates,n=t.cid,i=e.priorities[t.UPDATE_PRIORITY],r=this.registerMountedView(t)|i[n];return delete i[n],r},dumpView:function(t,e={}){const n=this.dumpViewUpdate(t);if(!n)return 0;const i=!e.silent;i&&this.notifyBeforeRender(e);const r=this.updateView(t,n,e);if(i){const s={updated:1,priority:t.UPDATE_PRIORITY};this.notifyAfterRender(s,e)}return r},updateView:function(t,e,n){if(!t)return 0;const{FLAG_REMOVE:i,FLAG_INSERT:r,FLAG_INIT:s,model:o}=t;if(t instanceof Xt){if(e&i)return this.removeView(o),0;if(e&r){const a=!!(e&s);a&&(e^=s),this.insertView(t,a),e^=r}}return e?t.confirmUpdate(e,n||{}):0},requireView:function(t,e){var n=this.findViewByModel(t);return n?(this.dumpView(n,e),n):null},registerUnmountedView:function(t){var e=t.cid,n=this._updates;if(e in n.unmounted)return 0;var i=n.unmounted[e]|=t.FLAG_INSERT;return n.unmountedCids.push(e),delete n.mounted[e],i},registerMountedView:function(t){var e=t.cid,n=this._updates;if(e in n.mounted)return 0;n.mounted[e]=!0,n.mountedCids.push(e);var i=n.unmounted[e]||0;return delete n.unmounted[e],i},isViewMounted:function(t){if(!t)return!1;var e=t.cid,n=this._updates;return e in n.mounted},dumpViews:function(t){var e=me({},t,{viewport:null});this.checkViewport(e),this.updateViews(e)},updateViews:function(t){this.notifyBeforeRender(t);let e,n=0,i=0,r=bc;do i++,e=this.updateViewsBatch(t),n+=e.updated,r=Math.min(e.priority,r);while(!e.empty);const s={updated:n,batches:i,priority:r};return this.notifyAfterRender(s,t),s},hasScheduledUpdates:function(){const t=this._updates.priorities,e=Object.keys(t);let n=e.length;for(;n>0&&n--;)for(let i in t[e[n]])return!0;return!1},updateViewsAsync:function(t,e){t||(t={}),e||(e={processed:0,priority:bc});const{_updates:n,options:i}=this,r=n.id;if(r){ks(r),e.processed===0&&this.hasScheduledUpdates()&&this.notifyBeforeRender(t);const s=this.updateViewsBatch(t),o=me({},t,{mountBatchSize:Rv-s.mounted,unmountBatchSize:Rv-s.unmounted}),a=this.checkViewport(o),l=a.unmounted,c=a.mounted;let h=e.processed;const u=n.count;s.updated>0?(h+=s.updated+s.unmounted,s.processed=h,e.priority=Math.min(s.priority,e.priority),s.empty&&c===0?(s.unmounted+=l,s.mounted+=c,s.priority=e.priority,this.notifyAfterRender(s,t),e.processed=0,e.priority=bc,n.count=0):e.processed=h):n.idle||i.autoFreeze&&(this.freeze(),n.idle=!0,this.trigger("render:idle",t));const d=t.progress;if(u&&typeof d=="function"&&d.call(this,s.empty,h,u,s,this),n.id!==r)return}if(n.disabled)throw new Error("dia.Paper: can not unfreeze the paper after it was removed");n.id=Ho(this.updateViewsAsync,this,t,e)},notifyBeforeRender:function(t={}){let e=t.beforeRender;typeof e!="function"&&(e=this.options.beforeRender,typeof e!="function")||e.call(this,t,this)},notifyAfterRender:function(t,e={}){let n=e.afterRender;typeof n!="function"&&(n=this.options.afterRender),typeof n=="function"&&n.call(this,t,e,this),this.trigger("render:done",t,e)},updateViewsBatch:function(t){t||(t={});var e=t.batchSize||n4,n=this._updates,i=0,r=0,s=0,o=0,a=bc,l=!0,c=this.options,h=n.priorities,u="viewport"in t?t.viewport:c.viewport;typeof u!="function"&&(u=null);var d=c.onViewPostponed;typeof d!="function"&&(d=null);var f=Object.keys(h);t:for(var p=0,g=f.length;p<g;p++){var v=+f[p],x=h[v];for(var S in x){if(i>=e){l=!1;break t}var C=jr[S];if(!C){delete x[S];continue}var P=x[S];if(!(P&C.FLAG_REMOVE)){var k=S in n.unmounted;if(C.DETACHABLE&&u&&!u.call(this,C,!k,this)){k||(this.registerUnmountedView(C),this.detachView(C)),n.unmounted[S]|=P,delete x[S],s++;continue}k&&(P|=C.FLAG_INSERT,o++),P|=this.registerMountedView(C)}var N=this.updateView(C,P,t);if(N>0&&(x[S]=N,!d||!d.call(this,C,N,this)||x[S])){r++,l=!1;continue}a>v&&(a=v),i++,delete x[S]}}return{priority:a,updated:i,postponed:r,unmounted:s,mounted:o,empty:l}},getUnmountedViews:function(){const t=this._updates,e=Object.keys(t.unmounted),n=e.length,i=new Array(n);for(var r=0;r<n;r++)i[r]=jr[e[r]];return i},getMountedViews:function(){const t=this._updates,e=Object.keys(t.mounted),n=e.length,i=new Array(n);for(var r=0;r<n;r++)i[r]=jr[e[r]];return i},checkUnmountedViews:function(t,e){e||(e={});var n=0;typeof t!="function"&&(t=null);for(var i=("mountBatchSize"in e)?e.mountBatchSize:1/0,r=this._updates,s=r.unmountedCids,o=r.unmounted,a=0,l=Math.min(s.length,i);a<l;a++){var c=s[a];if(c in o){var h=jr[c];if(h){if(h.DETACHABLE&&t&&!t.call(this,h,!1,this)){s.push(c);continue}n++;var u=this.registerMountedView(h);u&&this.scheduleViewUpdate(h,u,h.UPDATE_PRIORITY,{mounting:!0})}}}return s.splice(0,a),n},checkMountedViews:function(t,e){e||(e={});var n=0;if(typeof t!="function")return n;for(var i=("unmountBatchSize"in e)?e.unmountBatchSize:1/0,r=this._updates,s=r.mountedCids,o=r.mounted,a=0,l=Math.min(s.length,i);a<l;a++){var c=s[a];if(c in o){var h=jr[c];if(h){if(!h.DETACHABLE||t.call(this,h,!0,this)){s.push(c);continue}n++;var u=this.registerUnmountedView(h);u&&this.detachView(h)}}}return s.splice(0,a),n},checkViewVisibility:function(t,e={}){let n="viewport"in e?e.viewport:this.options.viewport;typeof n!="function"&&(n=null);const i=this._updates,{mounted:r,unmounted:s}=i,o=!t.DETACHABLE||!n||n.call(this,t,!1,this);let a=!1,l=!1;if(t.cid in r&&!o){this.registerUnmountedView(t)&&this.detachView(t);const u=i.mountedCids.indexOf(t.cid);i.mountedCids.splice(u,1),a=!0}if(!a&&t.cid in s&&o){const h=i.unmountedCids.indexOf(t.cid);i.unmountedCids.splice(h,1);var c=this.registerMountedView(t);c&&this.scheduleViewUpdate(t,c,t.UPDATE_PRIORITY,{mounting:!0}),l=!0}return{mounted:l?1:0,unmounted:a?1:0}},checkViewport:function(t){var e=me({},t,{mountBatchSize:1/0,unmountBatchSize:1/0}),n="viewport"in e?e.viewport:this.options.viewport,i=this.checkMountedViews(n,e);if(i>0){var r=this._updates.unmountedCids;e.mountBatchSize=Math.min(r.length-i,e.mountBatchSize)}var s=this.checkUnmountedViews(n,e);return{mounted:s,unmounted:i}},freeze:function(t){t||(t={});var e=this._updates,n=t.key,i=this.options.frozen,r=e.freezeKey;if(n&&n!==r){if(i&&r)return;e.freezeKey=n,e.keyFrozen=i}this.options.frozen=!0;var s=e.id;e.id=null,this.isAsync()&&s&&ks(s)},unfreeze:function(t){t||(t={});var e=this._updates,n=t.key,i=e.freezeKey;n&&i&&n!==i||(e.freezeKey=null,!(n&&n===i&&e.keyFrozen)&&(this.isAsync()?(this.freeze(),this.updateViewsAsync(t)):this.updateViews(t),this.options.frozen=e.keyFrozen=!1,e.sort&&(this.sortViews(),e.sort=!1)))},isAsync:function(){return!!this.options.async},isFrozen:function(){return!!this.options.frozen},isExactSorting:function(){return this.options.sorting===co.EXACT},onRemove:function(){this.freeze(),this._updates.disabled=!0,this.removeLayers(),this.removeViews()},getComputedSize:function(){var t=this.options,e=t.width,n=t.height;return Nt(e)||(e=this.el.clientWidth),Nt(n)||(n=this.el.clientHeight),{width:e,height:n}},setDimensions:function(t,e,n={}){const{options:i}=this,{width:r,height:s}=i;let o=t===void 0?r:t,a=e===void 0?s:e;if(r===o&&s===a)return;i.width=o,i.height=a,this._setDimensions();const l=this.getComputedSize();this.trigger("resize",l.width,l.height,n)},_setDimensions:function(){const{options:t}=this;let e=t.width,n=t.height;Nt(e)&&(e=`${Math.round(e)}px`),Nt(n)&&(n=`${Math.round(n)}px`),this.$el.css({width:e===null?"":e,height:n===null?"":n})},fitToContent:function(t,e,n,i){Vt(t)?i=t:i=H({gridWidth:t,gridHeight:e,padding:n},i);const{x:r,y:s,width:o,height:a}=this.getFitToContentArea(i),{sx:l,sy:c}=this.scale();return this.translate(-r*l,-s*c,i),this.setDimensions(o*l,a*c,i),new Z(r,s,o,a)},getFitToContentArea:function(t={}){const e=t.gridWidth||1,n=t.gridHeight||1,i=Re(t.padding||0),r=Math.max(t.minWidth||0,e),s=Math.max(t.minHeight||0,n),o=t.maxWidth||Number.MAX_VALUE,a=t.maxHeight||Number.MAX_VALUE,l=t.allowNewOrigin,c="contentArea"in t?new Z(t.contentArea):this.getContentArea(t),{sx:h,sy:u}=this.scale();c.x*=h,c.y*=u,c.width*=h,c.height*=u;let d=Math.ceil((c.width+c.x)/e),f=Math.ceil((c.height+c.y)/n);t.allowNegativeBottomRight||(d=Math.max(d,1),f=Math.max(f,1)),d*=e,f*=n;let p=0;(l==="negative"&&c.x<0||l==="positive"&&c.x>=0||l==="any")&&(p=Math.ceil(-c.x/e)*e,p+=i.left,d+=p);let g=0;return(l==="negative"&&c.y<0||l==="positive"&&c.y>=0||l==="any")&&(g=Math.ceil(-c.y/n)*n,g+=i.top,f+=g),d+=i.right,f+=i.bottom,d=Math.max(d,r),f=Math.max(f,s),d=Math.min(d,o),f=Math.min(f,a),new Z(-p/h,-g/u,d/h,f/u)},transformToFitContent:function(t){t||(t={});let e,n;if("contentArea"in t){const C=t.contentArea;e=this.localToPaperRect(C),n=new M(C)}else e=this.getContentBBox(t),n=this.paperToLocalPoint(e);if(!e.width||!e.height)return;me(t,{padding:0,preserveAspectRatio:!0,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE,verticalAlign:"top",horizontalAlign:"left"});const i=Re(t.padding),r=t.minScaleX||t.minScale,s=t.maxScaleX||t.maxScale,o=t.minScaleY||t.minScale,a=t.maxScaleY||t.maxScale;let l;if(t.fittingBBox)l=t.fittingBBox;else{const C=this.translate(),P=this.getComputedSize();l={x:C.tx,y:C.ty,width:P.width,height:P.height}}l=new Z(l).moveAndExpand({x:i.left,y:i.top,width:-i.left-i.right,height:-i.top-i.bottom});const c=this.matrix(),{a:h,d:u,e:d,f}=c;let p=l.width/e.width*h,g=l.height/e.height*u;if(t.preserveAspectRatio&&(p=g=Math.min(p,g)),t.scaleGrid){const C=t.scaleGrid;p=C*Math.floor(p/C),g=C*Math.floor(g/C)}p=Math.min(s,Math.max(r,p)),g=Math.min(a,Math.max(o,g));const v={x:p/h,y:g/u};let x=l.x-n.x*p-d,S=l.y-n.y*g-f;switch(t.verticalAlign){case"middle":S=S+(l.height-e.height*v.y)/2;break;case"bottom":S=S+(l.height-e.height*v.y);break}switch(t.horizontalAlign){case"middle":x=x+(l.width-e.width*v.x)/2;break;case"right":x=x+(l.width-e.width*v.x);break}c.a=p,c.d=g,c.e=x,c.f=S,this.matrix(c,t)},scaleContentToFit:function(t){this.transformToFitContent(t)},getContentArea:function(t){return t&&t.useModelGeometry?this.model.getBBox()||new Z:L(this.cells).getBBox()},getContentBBox:function(t){return this.localToPaperRect(this.getContentArea(t))},getArea:function(){return this.paperToLocalRect(this.getComputedSize())},getRestrictedArea:function(...t){const{restrictTranslate:e}=this.options;let n;return _t(e)?n=e.apply(this,t):e===!0?n=this.getArea():e?n=new Z(e):n=null,n},createViewForModel:function(t){const{options:e}=this;var n,i,r=e.cellViewNamespace,s=t.get("type")+"View",o=yn(r,s,".");t.isLink()?(n=e.linkView,i=Ao):(n=e.elementView,i=Pe);var a=n.prototype instanceof Ss?o||n:n.call(this,t)||o||i;return new a({model:t,interactive:e.interactive,labelsLayer:e.labelsLayer===!0?_n.LABELS:e.labelsLayer})},removeView:function(t){const{id:e}=t,{_views:n,_updates:i}=this,r=n[e];if(r){var{cid:s}=r;const{mounted:o,unmounted:a}=i;r.remove(),delete n[e],delete o[s],delete a[s]}return r},renderView:function(t,e){const{id:n}=t,i=this._views;let r,s,o=!0;return n in i&&(r=i[n],r.model===t?(s=r.FLAG_INSERT,o=!1):this.removeView(t)),o&&(r=i[n]=this.createViewForModel(t),r.paper=this,s=this.registerUnmountedView(r)|this.FLAG_INIT|r.getFlag(ee(r,"initFlag"))),this.requestViewUpdate(r,s,r.UPDATE_PRIORITY,e),r},onImageDragStart:function(){return!1},resetViews:function(t,e){e||(e={}),t||(t=[]),this._resetUpdates(),this.removeViews();const n=this.options.autoFreeze?null:"reset";this.freeze({key:n});for(var i=0,r=t.length;i<r;i++)this.renderView(t[i],e);this.unfreeze({key:n}),this.sortViews()},removeViews:function(){Ue(this._views,"remove"),this._views={}},sortViews:function(){if(this.isExactSorting()){if(this.isFrozen()){this._updates.sort=!0;return}this.sortViewsExact()}},sortViewsExact:function(){var t=Array.from(this.cells.childNodes).filter(n=>n.getAttribute("model-id")),e=this.model.get("cells");Kw(t,function(n,i){var r=e.get(n.getAttribute("model-id")),s=e.get(i.getAttribute("model-id")),o=r.attributes.z||0,a=s.attributes.z||0;return o===a?0:o<a?-1:1})},insertView:function(t,e){const n=this.getLayerView(_n.CELLS),{el:i,model:r}=t;switch(this.options.sorting){case co.APPROX:n.insertSortedNode(i,r.get("z"));break;case co.EXACT:default:n.insertNode(i);break}t.onMount(e)},detachView(t){t.unmount(),t.onDetach()},findView:function(t){var e=ne(t)?this.cells.querySelector(t):t instanceof q?t[0]:t,n=this.findAttribute("model-id",e);if(n)return this._views[n]},findViewByModel:function(t){var e=ne(t)||Nt(t)?t:t&&t.id;return this._views[e]},findViewsFromPoint:function(t){t=new M(t);var e=this.model.getElements().map(this.findViewByModel,this);return e.filter(function(n){return n&&n.vel.getBBox({target:this.cells}).containsPoint(t)},this)},findViewsInArea:function(t,e){e=me(e||{},{strict:!1}),t=new Z(t);var n=this.model.getElements().map(this.findViewByModel,this),i=e.strict?"containsRect":"intersect";return n.filter(function(r){return r&&t[i](r.vel.getBBox({target:this.cells}))},this)},removeTools:function(){return this.dispatchToolsEvent("remove"),this},hideTools:function(){return this.dispatchToolsEvent("hide"),this},showTools:function(){return this.dispatchToolsEvent("show"),this},dispatchToolsEvent:function(t,...e){typeof t=="string"&&this.trigger("tools:event",t,...e)},getModelById:function(t){return this.model.getCell(t)},snapToGrid:function(t,e){return this.clientToLocalPoint(t,e).snapToGrid(this.options.gridSize)},localToPaperPoint:function(t,e){var n=new M(t,e),i=L.transformPoint(n,this.matrix());return i},localToPaperRect:function(t,e,n,i){var r=new Z(t,e,n,i),s=L.transformRect(r,this.matrix());return s},paperToLocalPoint:function(t,e){var n=new M(t,e),i=L.transformPoint(n,this.matrix().inverse());return i},paperToLocalRect:function(t,e,n,i){var r=new Z(t,e,n,i),s=L.transformRect(r,this.matrix().inverse());return s},localToClientPoint:function(t,e){var n=new M(t,e),i=L.transformPoint(n,this.clientMatrix());return i},localToClientRect:function(t,e,n,i){var r=new Z(t,e,n,i),s=L.transformRect(r,this.clientMatrix());return s},clientToLocalPoint:function(t,e){var n=new M(t,e),i=L.transformPoint(n,this.clientMatrix().inverse());return i},clientToLocalRect:function(t,e,n,i){var r=new Z(t,e,n,i),s=L.transformRect(r,this.clientMatrix().inverse());return s},localToPagePoint:function(t,e){return this.localToPaperPoint(t,e).offset(this.pageOffset())},localToPageRect:function(t,e,n,i){return this.localToPaperRect(t,e,n,i).offset(this.pageOffset())},pageToLocalPoint:function(t,e){var n=new M(t,e),i=n.difference(this.pageOffset());return this.paperToLocalPoint(i)},pageToLocalRect:function(t,e,n,i){var r=this.pageOffset(),s=new Z(t,e,n,i);return s.x-=r.x,s.y-=r.y,this.paperToLocalRect(s)},clientOffset:function(){var t=this.svg.getBoundingClientRect();return new M(t.left,t.top)},pageOffset:function(){return this.clientOffset().offset(window.scrollX,window.scrollY)},linkAllowed:function(t){if(!(t instanceof Ao))throw new Error("Must provide a linkView.");var e=t.model,n=this.options,i=this.model,r=i.constructor.validations;return!(!n.multiLinks&&!r.multiLinks.call(this,i,e)||!n.linkPinning&&!r.linkPinning.call(this,i,e)||typeof n.allowLink=="function"&&!n.allowLink.call(this,t,this))},getDefaultLink:function(t,e){return _t(this.options.defaultLink)?this.options.defaultLink.call(this,t,e):this.options.defaultLink.clone()},resolveHighlighter:function(t={}){let{highlighter:e,type:n}=t;const{highlighting:i,highlighterNamespace:r}=this.options;if(e===void 0){if(!i||n&&(e=i[n],e===!1))return!1;e||(e=i.default)}if(!e)return!1;ne(e)&&(e={name:e});const s=e.name,o=r[s];if(!o)throw new Error('Unknown highlighter ("'+s+'")');if(typeof o.highlight!="function")throw new Error('Highlighter ("'+s+'") is missing required highlight() method');if(typeof o.unhighlight!="function")throw new Error('Highlighter ("'+s+'") is missing required unhighlight() method');return{highlighter:o,options:e.options||{},name:s}},onCellHighlight:function(t,e,n){const i=this.resolveHighlighter(n);if(!i)return;const{highlighter:r,options:s}=i;r.highlight(t,e,s)},onCellUnhighlight:function(t,e,n){const i=this.resolveHighlighter(n);if(!i)return;const{highlighter:r,options:s}=i;r.unhighlight(t,e,s)},pointerdblclick:function(t){t.preventDefault(),t=at(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?e.pointerdblclick(t,n.x,n.y):this.trigger("blank:pointerdblclick",t,n.x,n.y)}},pointerclick:function(t){var e=this.eventData(t);if(e.mousemoved<=this.options.clickThreshold){t=at(t);var n=this.findView(t.target);if(this.guard(t,n))return;var i=this.snapToGrid(t.clientX,t.clientY);n?n.pointerclick(t,i.x,i.y):this.trigger("blank:pointerclick",t,i.x,i.y)}},contextmenu:function(t){if(this.options.preventContextMenu&&t.preventDefault(),this.contextMenuFired){this.contextMenuFired=!1;return}t=at(t),this.contextMenuTrigger(t)},contextMenuTrigger:function(t){var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?e.contextmenu(t,n.x,n.y):this.trigger("blank:contextmenu",t,n.x,n.y)}},pointerdown:function(t){t=at(t);const{target:e,button:n}=t,i=this.findView(e),r=n===2;if(i){if(!r&&this.guard(t,i))return;const s=this.FORM_CONTROL_TAG_NAMES.includes(e.tagName);this.options.preventDefaultViewAction&&!s&&t.preventDefault(),s&&i.preventDefaultInteraction(t);const o=this.customEventTrigger(t,i);if(o){if(o.isPropagationStopped())return;t.data=o.data}const a=e.closest("[magnet]");if(a&&i.el!==a&&i.el.contains(a)){const l=at(new q.Event(t.originalEvent,{data:t.data,currentTarget:a}));if(this.onmagnet(l),l.isDefaultPrevented()&&t.preventDefault(),l.isPropagationStopped()){if(r)return;this.delegateDragEvents(i,l.data);return}t.data=l.data}}if(r){this.contextMenuFired=!0;const s=new q.Event(t.originalEvent,{type:"contextmenu",data:t.data});this.contextMenuTrigger(s)}else{const s=this.snapToGrid(t.clientX,t.clientY);i?i.pointerdown(t,s.x,s.y):(this.options.preventDefaultBlankAction&&t.preventDefault(),this.trigger("blank:pointerdown",t,s.x,s.y)),this.delegateDragEvents(i,t.data)}},pointermove:function(t){var e=this.eventData(t);e.mousemoved||(e.mousemoved=0,this.undelegateEvents());var n=++e.mousemoved;if(!(n<=this.options.moveThreshold)){t=at(t);var i=this.snapToGrid(t.clientX,t.clientY),r=e.sourceView;r?r.pointermove(t,i.x,i.y):this.trigger("blank:pointermove",t,i.x,i.y),this.eventData(t,e)}},pointerup:function(t){this.undelegateDocumentEvents();var e=at(t),n=this.snapToGrid(e.clientX,e.clientY),i=this.eventData(t).sourceView;i?i.pointerup(e,n.x,n.y):this.trigger("blank:pointerup",e,n.x,n.y),e.isPropagationStopped()||this.pointerclick(new q.Event(t.originalEvent,{type:"click",data:t.data})),this.delegateEvents()},mouseover:function(t){t=at(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseover(t);else{if(this.el===t.target)return;this.trigger("blank:mouseover",t)}},mouseout:function(t){t=at(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseout(t);else{if(this.el===t.target)return;this.trigger("blank:mouseout",t)}},mouseenter:function(t){t=at(t);const{target:e,relatedTarget:n,currentTarget:i}=t,r=this.findView(e);if(this.guard(t,r))return;const s=this.findView(n);r&&(s===r||(r.mouseenter(t),this.el.contains(n)))||s||i===this.el&&this.trigger("paper:mouseenter",t)},mouseleave:function(t){t=at(t);const{target:e,relatedTarget:n,currentTarget:i}=t,r=this.findView(e);if(this.guard(t,r))return;const s=this.findView(n);r&&(s===r||(r.mouseleave(t),this.el.contains(n)))||s||i===this.el&&this.trigger("paper:mouseleave",t)},_processMouseWheelEvtBuf:Nl(function(){const{event:t,deltas:e}=this._mw_evt_buffer,n=e.reduce((o,a)=>o+Hw(a,e4),0),i=Math.pow(.995,n),{x:r,y:s}=this.clientToLocalPoint(t.clientX,t.clientY);this.trigger("paper:pinch",t,r,s,i),this._mw_evt_buffer={event:null,deltas:[]}},Nv,{maxWait:Nv}),mousewheel:function(t){t=at(t);const e=this.findView(t.target);if(this.guard(t,e))return;const n=t.originalEvent,i=this.snapToGrid(n.clientX,n.clientY),{deltaX:r,deltaY:s}=Gw(n),o=this._events["paper:pinch"];if(t.ctrlKey&&o&&o.length>0)n.preventDefault(),this._mw_evt_buffer.event=t,this._mw_evt_buffer.deltas.push(s),this._processMouseWheelEvtBuf();else{const a=Math.max(-1,Math.min(1,n.wheelDelta));e?e.mousewheel(t,i.x,i.y,a):this.trigger("blank:mousewheel",t,i.x,i.y,a),this.trigger("paper:pan",t,r,s)}},onevent:function(t){var e=t.currentTarget,n=e.getAttribute("event");if(n){var i=this.findView(e);if(i){if(t=at(t),this.guard(t,i))return;var r=this.snapToGrid(t.clientX,t.clientY);i.onevent(t,n,r.x,r.y)}}},magnetEvent:function(t,e){var n=t.currentTarget,i=n.getAttribute("magnet");if(i){var r=this.findView(n);if(r){if(t=at(t),this.guard(t,r))return;var s=this.snapToGrid(t.clientX,t.clientY);e.call(this,r,t,n,s.x,s.y)}}},onmagnet:function(t){if(t.button===2){this.contextMenuFired=!0,this.magnetContextMenuFired=!0;const e=new q.Event(t.originalEvent,{type:"contextmenu",data:t.data,currentTarget:t.currentTarget});this.magnetContextMenuTrigger(e),e.isPropagationStopped()&&t.stopPropagation()}else this.magnetEvent(t,function(e,n,i,r,s){e.onmagnet(n,r,s)})},magnetpointerdblclick:function(t){this.magnetEvent(t,function(e,n,i,r,s){e.magnetpointerdblclick(n,i,r,s)})},magnetcontextmenu:function(t){if(this.options.preventContextMenu&&t.preventDefault(),this.magnetContextMenuFired){this.magnetContextMenuFired=!1;return}this.magnetContextMenuTrigger(t)},magnetContextMenuTrigger:function(t){this.magnetEvent(t,function(e,n,i,r,s){e.magnetcontextmenu(n,i,r,s)})},onlabel:function(t){var e=t.currentTarget,n=this.findView(e);if(!n||(t=at(t),this.guard(t,n)))return;const i=this.customEventTrigger(t,n,e);if(i){if(i.isPropagationStopped())return;t.data=i.data}var r=this.snapToGrid(t.clientX,t.clientY);n.onlabel(t,r.x,r.y)},getPointerArgs(t){const e=at(t),{x:n,y:i}=this.snapToGrid(e.clientX,e.clientY);return[e,n,i]},delegateDragEvents:function(t,e){e||(e={}),this.eventData({data:e},{sourceView:t||null,mousemoved:0}),this.delegateDocumentEvents(null,e)},guard:function(t,e){if(t.type==="mousedown"&&t.button===2||this.options.guard&&this.options.guard(t,e))return!0;if(t.data&&t.data.guarded!==void 0)return t.data.guarded;const{target:n}=t;return this.GUARDED_TAG_NAMES.includes(n.tagName)?!0:!(e&&e.model&&e.model instanceof an||this.el===n||this.svg.contains(n))},setGridSize:function(t){const{options:e}=this;return e.gridSize=t,e.drawGrid&&!e.drawGridSize&&this.getLayerView(_n.GRID).renderGrid(),this},setGrid:function(t){return this.getLayerView(_n.GRID).setGrid(t),this},updateBackgroundImage:function(t){t=t||{};var e=t.position||"center",n=t.size||"auto auto",i=this.scale(),r=this.translate();if(Vt(e)){var s=r.tx+i.sx*(e.x||0),o=r.ty+i.sy*(e.y||0);e=s+"px "+o+"px"}Vt(n)&&(n=new Z(n).scale(i.sx,i.sy),n=n.width+"px "+n.height+"px");const{background:a}=this.childNodes;a.style.backgroundSize=n,a.style.backgroundPosition=e},drawBackgroundImage:function(t,e){if(!(t instanceof HTMLImageElement)){this.childNodes.background.style.backgroundImage="";return}if(!(!this._background||this._background.id!==e.id)){e=e||{};var n,i=e.size,r=e.repeat||"no-repeat",s=e.opacity||1,o=Math.abs(e.quality)||1,a=this.constructor.backgroundPatterns[Rl(r)];if(_t(a)){t.width*=o,t.height*=o;var l=a(t,e);if(!(l instanceof HTMLCanvasElement))throw new Error("dia.Paper: background pattern must return an HTML Canvas instance");n=l.toDataURL("image/png"),r="repeat",Vt(i)?(i.width*=l.width/t.width,i.height*=l.height/t.height):i===void 0&&(e.size={width:l.width/o,height:l.height/o})}else n=t.src,i===void 0&&(e.size={width:t.width,height:t.height});this.childNodes.background.style.opacity=s,this.childNodes.background.style.backgroundRepeat=r,this.childNodes.background.style.backgroundImage=`url(${n})`,this.updateBackgroundImage(e)}},updateBackgroundColor:function(t){this.$el.css("backgroundColor",t||"")},drawBackground:function(t){if(t=t||{},this.updateBackgroundColor(t.color),t.image){t=this._background=Le(t),Jr(t);var e=document.createElement("img");e.onload=this.drawBackgroundImage.bind(this,e,t),e.src=t.image}else this.drawBackgroundImage(null),this._background=null;return this},setInteractivity:function(t){this.options.interactive=t,Ue(this._views,"setInteractivity",t)},isDefined:function(t){return!!this.svg.getElementById(t)},defineFilter:function(t){if(!Vt(t))throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.");var e=t.id,n=t.name;if(e||(e=n+this.svg.id+Da(JSON.stringify(t))),!this.isDefined(e)){var i=Jw,r=i[n]&&i[n](t.args||{});if(!r)throw new Error("Non-existing filter "+n);var s=H({filterUnits:"userSpaceOnUse"},t.attrs,{id:e});L(r,s).appendTo(this.defs)}return e},defineGradient:function(t){if(!Vt(t))throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.");const{svg:e,defs:n}=this,{type:i,id:r=i+e.id+Da(JSON.stringify(t)),stops:s,attrs:o={}}=t;if(this.isDefined(r))return r;const a=pt(s).map(({offset:c,color:h,opacity:u})=>L("stop").attr({offset:c,"stop-color":h,"stop-opacity":Number.isFinite(u)?u:1})),l=L(i,o,a);return l.id=r,l.appendTo(n),r},definePattern:function(t){if(!Vt(t))throw new TypeError("dia.Paper: definePattern() requires 1. argument to be an object.");const{svg:e,defs:n}=this,{id:i=e.id+Da(JSON.stringify(t)),markup:r,attrs:s={}}=t;if(!r)throw new TypeError("dia.Paper: definePattern() requires markup.");if(this.isDefined(i))return i;const o=L("pattern",{patternUnits:"userSpaceOnUse"});if(o.id=i,o.attr(s),typeof r=="string")o.append(L(r));else{const{fragment:a}=el(r);o.append(a)}return o.appendTo(n),i},defineMarker:function(t){if(!Vt(t))throw new TypeError("dia.Paper: defineMarker() requires the first argument to be an object.");const{svg:e,defs:n}=this,{id:i=e.id+Da(JSON.stringify(t)),markup:r,attrs:s={},markerUnits:o="userSpaceOnUse"}=t;if(this.isDefined(i))return i;const a=L("marker",{orient:"auto",overflow:"visible",markerUnits:o});a.id=i,a.attr(s);let l;if(r){let u;if(typeof r=="string")u=L(r),u=Array.isArray(u)?u:[u];else{const{fragment:d}=el(r);u=L(d).children()}u.length>1?l=L("g").append(u):l=u[0]}else{const{type:u="path"}=t;l=L(u)}const c=Qe(t,"type","id","markup","attrs","markerUnits");return Object.keys(c).forEach(u=>{const d=c[u],f=l.attr(u);if(f==null)l.attr(u,d);else switch(u){case"transform":l.attr(u,d+" "+f);break}}),l.appendTo(a),a.appendTo(n),i},customEventTrigger:function(t,e,n=e.el){const i=t.target.closest("[event]");if(i&&n!==i&&e.el.contains(i)){const r=at(new q.Event(t.originalEvent,{data:t.data,currentTarget:i}));return this.onevent(r),r.isDefaultPrevented()&&t.preventDefault(),r}return null}},{sorting:co,Layers:_n,backgroundPatterns:{flipXy:function(t){var e=document.createElement("canvas"),n=t.width,i=t.height;e.width=2*n,e.height=2*i;var r=e.getContext("2d");return r.drawImage(t,0,0,n,i),r.setTransform(-1,0,0,-1,e.width,e.height),r.drawImage(t,0,0,n,i),r.setTransform(-1,0,0,1,e.width,0),r.drawImage(t,0,0,n,i),r.setTransform(1,0,0,-1,0,e.height),r.drawImage(t,0,0,n,i),e},flipX:function(t){var e=document.createElement("canvas"),n=t.width,i=t.height;e.width=n*2,e.height=i;var r=e.getContext("2d");return r.drawImage(t,0,0,n,i),r.translate(2*n,0),r.scale(-1,1),r.drawImage(t,0,0,n,i),e},flipY:function(t){var e=document.createElement("canvas"),n=t.width,i=t.height;e.width=n,e.height=i*2;var r=e.getContext("2d");return r.drawImage(t,0,0,n,i),r.translate(0,2*i),r.scale(1,-1),r.drawImage(t,0,0,n,i),e},watermark:function(t,e){e=e||{};var n=t.width,i=t.height,r=document.createElement("canvas");r.width=n*3,r.height=i*3;for(var s=r.getContext("2d"),o=Nt(e.watermarkAngle)?-e.watermarkAngle:-20,a=un(o),l=r.width/4,c=r.height/4,h=0;h<4;h++)for(var u=0;u<4;u++)(h+u)%2>0&&(s.setTransform(1,0,0,1,(2*h-1)*l,(2*u-1)*c),s.rotate(a),s.drawImage(t,-n/2,-i/2,n,i));return r}},gridPatterns:{dot:[{color:"#AAAAAA",thickness:1,markup:"rect",render:function(t,e){L(t).attr({width:e.thickness,height:e.thickness,fill:e.color})}}],fixedDot:[{color:"#AAAAAA",thickness:1,markup:"rect",render:function(t,e){L(t).attr({fill:e.color})},update:function(t,e,n){const{sx:i,sy:r}=n.scale(),s=i<=1?e.thickness:e.thickness/i,o=r<=1?e.thickness:e.thickness/r;L(t).attr({width:s,height:o})}}],mesh:[{color:"#AAAAAA",thickness:1,markup:"path",render:function(t,e){var n,i=e.width,r=e.height,s=e.thickness;i-s>=0&&r-s>=0?n=["M",i,0,"H0 M0 0 V0",r].join(" "):n="M 0 0 0 0",L(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}}],doubleMesh:[{color:"#AAAAAA",thickness:1,markup:"path",render:function(t,e){var n,i=e.width,r=e.height,s=e.thickness;i-s>=0&&r-s>=0?n=["M",i,0,"H0 M0 0 V0",r].join(" "):n="M 0 0 0 0",L(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}},{color:"#000000",thickness:3,scaleFactor:4,markup:"path",render:function(t,e){var n,i=e.width,r=e.height,s=e.thickness;i-s>=0&&r-s>=0?n=["M",i,0,"H0 M0 0 V0",r].join(" "):n="M 0 0 0 0",L(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}}]}}),as=ce.extend({name:null,tagName:"g",className:"tool",svgElement:!0,_visible:!0,init:function(){var t=this.name;t&&this.vel.attr("data-tool-name",t)},configure:function(t,e){return this.relatedView=t,this.paper=t.paper,this.parentView=e,this.simulateRelatedView(this.el),this.delegateEvents(),this},simulateRelatedView:function(t){t&&t.setAttribute("model-id",this.relatedView.model.id)},getName:function(){return this.name},show:function(){this.el.style.display="",this._visible=!0},hide:function(){this.el.style.display="none",this._visible=!1},isVisible:function(){return!!this._visible},focus:function(){var t=this.options.focusOpacity;isFinite(t)&&(this.el.style.opacity=t),this.parentView.focusTool(this)},blur:function(){this.el.style.opacity="",this.parentView.blurTool(this)},update:function(){},guard:function(t){const{paper:e,relatedView:n}=this;return!e||!n?!0:e.guard(t,n)}}),r4=ce.extend({tagName:"g",className:"tools",svgElement:!0,tools:null,isRendered:!1,options:{tools:null,relatedView:null,name:null},configure:function(t){t=H(this.options,t);var e=t.tools;if(!Array.isArray(e))return this;var n=t.relatedView;if(!(n instanceof Xt))return this;for(var i=this.tools=[],r=0,s=e.length;r<s;r++){var o=e[r];o instanceof as&&(o.configure(n,this),this.vel.append(o.el),i.push(o))}return this.isRendered=!1,n.requestUpdate(n.getFlag("TOOLS")),this},getName:function(){return this.options.name},update:function(t){t||(t={});var e=this.tools;if(!e)return this;for(var n=this.isRendered,i=0,r=e.length;i<r;i++){var s=e[i];n?t.tool!==s.cid&&s.isVisible()&&s.update():s.render()}return this.isMounted()||this.mount(),n||(this.blurTool(),this.isRendered=!0),this},focusTool:function(t){var e=this.tools;if(!e)return this;for(var n=0,i=e.length;n<i;n++){var r=e[n];t===r?r.show():r.hide()}return this},blurTool:function(t){var e=this.tools;if(!e)return this;for(var n=0,i=e.length;n<i;n++){var r=e[n];r!==t&&!r.isVisible()&&(r.show(),r.update())}return this},hide:function(){return this.focusTool(null)},show:function(){return this.blurTool(null)},onRemove:function(){var t=this.tools;if(!t)return this;for(var e=0,n=t.length;e<n;e++)t[e].remove();this.tools=null},mount:function(){const{options:t,el:e}=this,{relatedView:n,layer:i=_n.TOOLS,z:r}=t;return n&&(i?n.paper.getLayerView(i).insertSortedNode(e,r):n.el.appendChild(e)),this}}),L_=Object.freeze(Object.defineProperty({__proto__:null,Cell:an,CellView:Xt,Element:Kt,ElementView:Pe,Graph:On,HighlighterView:hi,LayersNames:_n,Link:Dr,LinkView:Ao,Paper:Ai,PaperLayer:uu,ToolView:as,ToolsView:r4,attributes:aa},Symbol.toStringTag,{value:"Module"}));function hu(t,e){const{model:n}=t;return e?n.getBBox():n.isLink()?t.getConnection().bbox():t.getNodeUnrotatedBBox(t.el)}function s4(t,e,n){var i=Z5.call(this.paper,{},e,n,t,this.model);return i.anchor}var Bv=ce.extend({tagName:"g",svgElement:!0,className:"marker-segment",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},children:[{tagName:"line",selector:"line",attributes:{stroke:"#33334F","stroke-width":2,fill:"none","pointer-events":"none"}},{tagName:"rect",selector:"handle",attributes:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2}}],onRender:function(){this.renderChildren()},position:function(t,e,n,i){const{scale:r}=this.options;let s=L.createSVGMatrix().translate(t,e).rotate(n);r&&(s=s.scale(r));var o=this.childNodes.handle;o.setAttribute("transform",L.matrixToTransformString(s)),o.setAttribute("cursor",n%180===0?"row-resize":"col-resize");var a=i.getClosestPoint(new M(t,e)),l=this.childNodes.line;l.setAttribute("x1",t),l.setAttribute("y1",e),l.setAttribute("x2",a.x),l.setAttribute("y2",a.y)},onPointerDown:function(t){this.options.guard(t)||(this.trigger("change:start",this,t),t.stopPropagation(),t.preventDefault(),this.options.paper.undelegateEvents(),this.delegateDocumentEvents(null,t.data))},onPointerMove:function(t){this.trigger("changing",this,t)},onPointerUp:function(t){this.undelegateDocumentEvents(),this.options.paper.delegateEvents(),this.trigger("change:end",this,t)},show:function(){this.el.style.display=""},hide:function(){this.el.style.display="none"}});const o4=as.extend({name:"segments",precision:.5,options:{handleClass:Bv,segmentLengthThreshold:40,redundancyRemoval:!0,anchor:s4,snapRadius:10,snapHandle:!0,stopPropagation:!0},handles:null,onRender:function(){this.resetHandles();var t=this.relatedView,e=t.model.vertices();e.unshift(t.sourcePoint),e.push(t.targetPoint);for(var n=0,i=e.length;n<i-1;n++){var r=e[n],s=e[n+1],o=this.renderHandle(r,s);this.simulateRelatedView(o.el),this.handles.push(o),o.options.index=n}return this},renderHandle:function(t,e){var n=new this.options.handleClass({paper:this.paper,scale:this.options.scale,guard:i=>this.guard(i)});return n.render(),this.updateHandle(n,t,e),n.vel.appendTo(this.el),this.startHandleListening(n),n},update:function(){return this.render(),this},startHandleListening:function(t){this.listenTo(t,"change:start",this.onHandleChangeStart),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"change:end",this.onHandleChangeEnd)},resetHandles:function(){var t=this.handles;if(this.handles=[],this.stopListening(),!!Array.isArray(t))for(var e=0,n=t.length;e<n;e++)t[e].remove()},shiftHandleIndexes:function(t){for(var e=this.handles,n=0,i=e.length;n<i;n++)e[n].options.index+=t},resetAnchor:function(t,e){var n=this.relatedView.model;e?n.prop([t,"anchor"],e,{rewrite:!0,ui:!0,tool:this.cid}):n.removeProp([t,"anchor"],{ui:!0,tool:this.cid})},snapHandle:function(t,e,n){var i=t.options.index,r=this.relatedView,s=r.model,o=s.vertices(),a=t.options.axis,l=o[i-2]||n.sourceAnchor,c=o[i+1]||n.targetAnchor,h=this.options.snapRadius;return Math.abs(e[a]-l[a])<h?e[a]=l[a]:Math.abs(e[a]-c[a])<h&&(e[a]=c[a]),e},onHandleChanging:function(t,e){const{options:n}=this;var i=this.eventData(e),r=this.relatedView,s=r.paper,o=t.options.index-1,a=at(e),l=s.snapToGrid(a.clientX,a.clientY),c=this.snapHandle(t,l.clone(),i),h=t.options.axis,u=this.options.snapHandle?0:l[h]-c[h],d=r.model,f=Le(d.vertices()),p=this.options.anchor;typeof p!="function"&&(p=null);const g=t.options.index,v=[r.sourcePoint.clone(),...f,r.targetPoint.clone()];let x=0;if(g-1>=0){const O=v[g-1],B=v[g];new gt(O,B).vector().theta()%90!==0&&(f.splice(g-1,0,i.originalVertices[g-1]),x++,this.shiftHandleIndexes(1))}var S=f[o+x],C=f[o+1+x];if(g+2<v.length){const O=v[g+1],B=v[g+2];if(new gt(O,B).vector().theta()%90!==0){const F=i.originalVertices.length===1,At=F?0:g,vt=i.firstHandleShifted&&!F?1:0;let zt=1+x;f.splice(g+zt,0,i.originalVertices[At-vt])}}var P=r.sourceView,k=r.sourceBBox,N=!1,m=!1;if(S?o===0?k.containsPoint(S)?(f.shift(),this.shiftHandleIndexes(-1),N=!0):(S[h]=c[h],m=!0):S[h]=c[h]:(S=r.sourceAnchor.toJSON(),S[h]=c[h],k.containsPoint(S)?(S[h]=c[h],N=!0):(f.unshift(S),this.shiftHandleIndexes(1),i.firstHandleShifted=!0,m=!0)),p&&P){if(N){var b=i.sourceAnchor.clone();b[h]=c[h];var w=p.call(r,b,P,r.sourceMagnet||P.el,"source",r);this.resetAnchor("source",w)}m&&this.resetAnchor("source",i.sourceAnchorDef)}var T=r.targetView,E=r.targetBBox,D=!1,$=!1;if(C?o===f.length-2?E.containsPoint(C)?(f.pop(),D=!0):(C[h]=c[h],$=!0):C[h]=c[h]:(C=r.targetAnchor.toJSON(),C[h]=c[h],E.containsPoint(C)?D=!0:(f.push(C),$=!0)),p&&T){if(D){var z=i.targetAnchor.clone();z[h]=c[h];var j=p.call(r,z,T,r.targetMagnet||T.el,"target",r);this.resetAnchor("target",j)}$&&this.resetAnchor("target",i.targetAnchorDef)}if(f.some(O=>!O))throw new Error("Segments: incompatible router in use");d.vertices(f,{ui:!0,tool:this.cid}),this.updateHandle(t,S,C,u),n.stopPropagation||r.notifyPointermove(a,l.x,l.y)},onHandleChangeStart:function(t,e){const{options:n,handles:i,relatedView:r}=this,{model:s,paper:o}=r;var a=t.options.index;if(Array.isArray(i)){for(var l=0,c=i.length;l<c;l++)l!==a&&i[l].hide();this.focus(),this.eventData(e,{sourceAnchor:r.sourceAnchor.clone(),targetAnchor:r.targetAnchor.clone(),sourceAnchorDef:we(s.prop(["source","anchor"])),targetAnchorDef:we(s.prop(["target","anchor"])),originalVertices:Le(s.vertices()),firstHandleShifted:!1}),s.startBatch("segment-move",{ui:!0,tool:this.cid}),n.stopPropagation||r.notifyPointerdown(...o.getPointerArgs(e))}},onHandleChangeEnd:function(t,e){const{options:n,relatedView:i}=this,{paper:r,model:s}=i;n.redundancyRemoval&&i.removeRedundantLinearVertices({ui:!0,tool:this.cid});const o=at(e),a=r.snapToGrid(o.clientX,o.clientY);this.render(),this.blur(),s.stopBatch("segment-move",{ui:!0,tool:this.cid}),n.stopPropagation||i.notifyPointerup(o,a.x,a.y),i.checkMouseleave(o)},updateHandle:function(t,e,n,i){var r=Math.abs(e.x-n.x)<this.precision,s=Math.abs(e.y-n.y)<this.precision;if(r||s){var o=new gt(e,n),a=o.length();if(a<this.options.segmentLengthThreshold)t.hide();else{var l=o.midpoint(),c=r?"x":"y";l[c]+=i||0;var h=o.vector().vectorAngle(new M(1,0));t.position(l.x,l.y,h,this.relatedView),t.show(),t.options.axis=c}}else t.hide()},onRemove:function(){this.resetHandles()}},{SegmentHandle:Bv}),M_=as.extend({name:"boundary",tagName:"rect",options:{padding:10,useModelGeometry:!1},attributes:{fill:"none",stroke:"#33334F","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"},onRender:function(){this.update()},update:function(){const{relatedView:t,options:e,vel:n}=this,{useModelGeometry:i,rotate:r}=e,s=Re(e.padding);let o=hu(t,i).moveAndExpand({x:-s.left,y:-s.top,width:s.left+s.right,height:s.top+s.bottom});var a=t.model;if(a.isElement()){var l=a.angle();if(l)if(r){var c=a.getBBox().center();n.rotate(l,c.x,c.y,{absolute:!0})}else o=o.bbox(l)}return n.attr(o.toJSON()),this}}),og=as.extend({name:"button",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},options:{distance:0,offset:0,scale:null,rotate:!1},onRender:function(){this.renderChildren(this.options.markup),this.update()},update:function(){return this.position(),this},position:function(){const{vel:t}=this;t.transform(this.getCellMatrix(),{absolute:!0})},getCellMatrix(){return this.relatedView.model.isLink()?this.getLinkMatrix():this.getElementMatrix()},getElementMatrix(){const{relatedView:t,options:e}=this;let{x:n=0,y:i=0,offset:r={},useModelGeometry:s,rotate:o,scale:a}=e,l=hu(t,s);const c=t.model.angle();o||(l=l.bbox(c));const{x:h=0,y:u=0}=r;je(n)?n=parseFloat(n)/100*l.width:Pr(n)&&(n=Number(Ir(n,l))),je(i)?i=parseFloat(i)/100*l.height:Pr(i)&&(i=Number(Ir(i,l)));let d=L.createSVGMatrix().translate(l.x+l.width/2,l.y+l.height/2);return o&&(d=d.rotate(c)),d=d.translate(n+h-l.width/2,i+u-l.height/2),a&&(d=d.scale(a)),d},getLinkMatrix(){const{relatedView:t,options:e}=this,{offset:n=0,distance:i=0,rotate:r,scale:s}=e;let o,a,l;je(i)?o=t.getTangentAtRatio(parseFloat(i)/100):o=t.getTangentAtLength(i),o?(a=o.start,l=o.vector().vectorAngle(new M(1,0))||0):(a=t.getConnection().start,l=0);let c=L.createSVGMatrix().translate(a.x,a.y).rotate(l).translate(0,n);return r||(c=c.rotate(-l)),s&&(c=c.scale(s)),c},onPointerDown:function(t){if(!this.guard(t)){t.stopPropagation(),t.preventDefault();var e=this.options.action;typeof e=="function"&&e.call(this.relatedView,t,this.relatedView,this)}}}),a4=og.extend({name:"remove",children:[{tagName:"circle",selector:"button",attributes:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attributes:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],options:{distance:60,offset:0,action:function(t,e,n){e.model.remove({ui:!0,tool:n.cid})}}}),Vc=og.extend({name:"connect",documentEvents:{mousemove:"drag",touchmove:"drag",mouseup:"dragend",touchend:"dragend",touchcancel:"dragend"},children:[{tagName:"circle",selector:"button",attributes:{r:7,fill:"#333333",cursor:"pointer"}},{tagName:"path",selector:"icon",attributes:{d:"M -4 -1 L 0 -1 L 0 -4 L 4 0 L 0 4 0 1 -4 1 z",fill:"#FFFFFF",stroke:"none","stroke-width":2,"pointer-events":"none"}}],options:{distance:80,offset:0,magnet:t=>t.el,action:(t,e,n)=>n.dragstart(t)},getMagnetNode:function(){const{options:t,relatedView:e}=this,{magnet:n}=t;let i;switch(typeof n){case"function":{i=n.call(this,e,this);break}case"string":{i=e.findNode(n);break}default:{i=n;break}}if(i||(i=e.el),i instanceof SVGElement)return i;throw new Error("Connect: magnet must be an SVGElement")},dragstart:function(t){const{paper:e,relatedView:n}=this,i=at(t),{x:r,y:s}=e.clientToLocalPoint(i.clientX,i.clientY);n.dragLinkStart(i,this.getMagnetNode(),r,s),e.undelegateEvents(),this.delegateDocumentEvents(null,i.data),this.focus()},drag:function(t){const{paper:e,relatedView:n}=this,i=at(t),{x:r,y:s}=e.snapToGrid(i.clientX,i.clientY);n.dragLink(i,r,s)},dragend:function(t){const{paper:e,relatedView:n}=this,i=at(t),{x:r,y:s}=e.snapToGrid(i.clientX,i.clientY);n.dragLinkEnd(i,r,s),this.undelegateDocumentEvents(),e.delegateEvents(),this.blur(),n.checkMouseleave(i)}}),l4=Vc.extend({name:"hover-connect",defaultMarkup:[{tagName:"circle",attributes:{r:7,fill:"#333333",cursor:"pointer"}},{tagName:"path",attributes:{d:"M -4 -1 L 0 -1 L 0 -4 L 4 0 L 0 4 0 1 -4 1 z",fill:"#FFFFFF",stroke:"none","stroke-width":2}}],children(){const{options:t,defaultMarkup:e}=this;return[{tagName:"path",selector:"track",attributes:{fill:"none",stroke:"transparent","stroke-width":t.trackWidth||15,cursor:"pointer"}},{tagName:"g",selector:"button",attributes:{"pointer-events":"none",display:"none"},children:t.markup||e}]},events:Object.assign({mousemove:"onMousemove",mouseenter:"onMouseenter",mouseleave:"onMouseleave"},Vc.prototype.events),onRender:function(){this.renderChildren(),this.update()},trackPath:null,update(){const{childNodes:t}=this;this.trackPath=this.getTrackPath(),Vc.prototype.update.apply(this,arguments),t.track.setAttribute("d",this.trackPath.serialize())},position(){const{el:t,childNodes:e}=this;e.button.setAttribute("transform",L.matrixToTransformString(this.getButtonMatrix())),t.setAttribute("transform",L.matrixToTransformString(this.getTrackMatrix()))},getButtonMatrix(){const{options:t,trackPath:e}=this,{offset:n=0,distance:i=0,rotate:r,scale:s}=t;let o,a,l;je(i)?o=e.tangentAtRatio(parseFloat(i)/100):o=e.tangentAtLength(i),o?(a=o.start,l=o.vector().vectorAngle(new M(1,0))||0):(a=e.start,l=0);let c=L.createSVGMatrix().translate(a.x,a.y).rotate(l).translate(0,n);return r||(c=c.rotate(-l)),s&&(c=c.scale(s)),c},getTrackPath(){return this.relatedView.getConnection()},getTrackMatrix(){return L.createSVGMatrix()},getTrackRatioFromEvent(t){const{relatedView:e,trackPath:n}=this,i=e.paper.clientToLocalPoint(t.clientX,t.clientY),r=L.transformPoint(i,this.getTrackMatrix().inverse());return n.closestPointLength(r)},canShowButton(){return q.event.has(this.paper.el)},showButton(){this.childNodes.button.style.display="block"},hideButton(){this.childNodes.button.style.display=""},onMousemove(t){const{trackPath:e}=this;if(!e)return;const{options:n}=this;n.distance=this.getTrackRatioFromEvent(t),this.position()},onMouseenter(){this.canShowButton()&&this.showButton()},onMouseleave(){this.hideButton()}}),c4=as.extend({tagName:"g",children:[{tagName:"circle",selector:"handle",attributes:{cursor:"pointer","stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6}},{tagName:"rect",selector:"extras",attributes:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onPointerDblClick",dbltap:"onPointerDblClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{handleAttributes:null,selector:"root",padding:6,scale:null},getPosition:function(){},setPosition:function(){},resetPosition:function(){},onRender:function(){this.renderChildren(),this.toggleExtras(!1),this.update()},update:function(){const{handle:t,extras:e}=this.childNodes;if(t)this.updateHandle(t);else throw new Error("Control: markup selector `handle` is required");return e&&this.updateExtras(e),this},updateHandle:function(t){const{relatedView:e,options:n}=this,{model:i}=e,r=this.getPosition(e,this),s=i.getAbsolutePointFromRelative(r),{handleAttributes:o,scale:a}=n;let l=`translate(${s.x},${s.y})`;if(a&&(l+=` scale(${a})`),t.setAttribute("transform",l),o)for(let c in o)t.setAttribute(c,o[c])},updateExtras:function(t){const{relatedView:e,options:n}=this,{selector:i}=this.options;if(!i){this.toggleExtras(!1);return}const r=e.findNode(i);if(!r)throw new Error("Control: invalid selector.");let s=n.padding;isFinite(s)||(s=0);const o=e.getNodeUnrotatedBBox(r),a=e.model,l=a.angle(),c=o.center();l&&c.rotate(a.getBBox().center(),-l),o.inflate(s),t.setAttribute("x",-o.width/2),t.setAttribute("y",-o.height/2),t.setAttribute("width",o.width),t.setAttribute("height",o.height),t.setAttribute("transform",`translate(${c.x},${c.y}) rotate(${l})`)},toggleExtras:function(t){const{extras:e}=this.childNodes;e&&(e.style.display=t?"":"none")},onPointerDown:function(t){const{relatedView:e,paper:n}=this;this.guard(t)||(t.stopPropagation(),t.preventDefault(),n.undelegateEvents(),this.delegateDocumentEvents(),this.focus(),this.toggleExtras(!0),e.model.startBatch("control-move",{ui:!0,tool:this.cid}))},onPointerMove:function(t){const{relatedView:e,paper:n}=this,{model:i}=e,{clientX:r,clientY:s}=at(t),o=n.clientToLocalPoint(r,s),a=i.getRelativePointFromAbsolute(o);this.setPosition(e,a,this),this.update()},onPointerUp:function(t){const{relatedView:e,paper:n}=this;n.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleExtras(!1),e.model.stopBatch("control-move",{ui:!0,tool:this.cid})},onPointerDblClick:function(){const{relatedView:t}=this;this.resetPosition(t,this),this.update()}}),u4=l4.extend({getTrackPath(){const{relatedView:t,options:e}=this;let{useModelGeometry:n,trackPath:i="M 0 0 H calc(w) V calc(h) H 0 Z"}=e;if(typeof i=="function"&&(i=i.call(this,t)),Pr(i)){const r=hu(t,n);i=Ir(i,r)}return new K(L.normalizePathData(i))},getTrackMatrix(){const{relatedView:t,options:e}=this;let{useModelGeometry:n,rotate:i}=e,r=hu(t,n);const s=t.model.angle();i||(r=r.bbox(s));let o=L.createSVGMatrix().translate(r.x+r.width/2,r.y+r.height/2);return i&&(o=o.rotate(s)),o=o.translate(-r.width/2,-r.height/2),o}}),h4=Object.freeze(Object.defineProperty({__proto__:null,Boundary:M_,Button:og,Connect:Vc,Control:c4,HoverConnect:u4,Remove:a4},Symbol.toStringTag,{value:"Module"})),d4={PortLabel:g_,Port:u_},xnt=function(t,e){e=e||{},Ue(jr,"setTheme",t,e),ce.prototype.defaultTheme=t};var f4=Kt,p4=Pe,g4=p4.prototype;const ah=f4.define("standard.Record",{size:{width:100},padding:0,scrollTop:null,items:[],itemHeight:20,itemOffset:20,itemMinLabelWidth:10,itemButtonSize:10,itemIcon:{width:16,height:16,padding:2},itemOverflow:!1,itemAboveViewSelector:"root",itemBelowViewSelector:"root",attrs:{root:{cursor:"move"},wrapper:{scrollable:!0},bodiesGroups:{fill:"transparent",stroke:"none"},labelsGroups:{fill:"#333333"},buttonsGroups:{fill:"transparent",stroke:"#333333",strokeWidth:1},forksGroups:{stroke:"#333333"},groups:{groupPosition:!0},itemBodies:{groupWidth:!0,itemHighlight:{fill:"#eeeeee"}},itemLabels:{fontSize:16,textVerticalAnchor:"middle",itemText:{textWrap:!0,ellipsis:!0},itemHighlight:{fill:"red"}}}},{markup:[],metrics:null,markupAttributes:["items","itemHeight","itemOffset","itemIcon","itemMinLabelWidth","itemButtonSize","itemOverflow","padding"],initialize:function(){Kt.prototype.initialize.apply(this,arguments),this.on("change",this.onChange,this),this.buildMarkup()},anyHasChanged:function(t){return Array.isArray(t)?t.some(function(e){return this.hasChanged(e)},this):!1},onChange:function(t,e){e.record!==this.id&&this.hasChanged("markup")&&uo("Markup can not be modified."),this.anyHasChanged(this.markupAttributes)&&this.buildMarkup(e)},getPadding:function(){return Re(this.attributes.padding)},buildMarkup:function(t){var e=this.metrics={},n=e.items={},i=this.attributes,r=i.itemHeight,s=i.itemOffset,o=!!i.itemOverflow,a=i.items;Array.isArray(a)||(a=[]);var l=a.length,c=0,h=Le(this.markup);Array.isArray(h)||uo("Expects Prototype JSON Markup.");var u=this.getPadding(),d=0,f=[];h.push({tagName:"g",selector:"wrapper",children:f});for(var p=0;p<l;p++){for(var g=[],v=[],x=[],S=[],C=[],P=Array.from(a[p]),k=this.createQueue(P,0,[],null),N=0,m=0;k.length>0;){var b=k.pop(),w=b.path,T=b.level,E=b.item,D=b.parent;T===0&&w.splice(1,0,p);var $=E.id,z=T!==-1,j=E.height||r,O=E.icon,B=E.items,V=!!E.highlighted,F=!!E.collapsed,At=Array.isArray(B)&&B.length>0;$||uo("Item id required."),n.hasOwnProperty($)&&uo("Duplicated item id.");var vt=n[$]={path:w,visible:z,parent:D,label:E.label,height:j,group:p,hasSubItems:At,highlighted:V,collapsed:F};if(At&&(vt.children=B.map(function(It){return It.id}),Array.prototype.push.apply(k,this.createQueue(B,F||!z?-1:T+1,w,$))),!!z){var zt=s*T;if(vt.x=zt+s,vt.y=N,vt.cx=zt+s/2,vt.cy=N+j/2,vt.span=E.span||1,$){var re=this.getItemBodyMarkup(E,zt,N,p,o&&p===0?u.left:0);g.push(re);var wt=this.getItemLabelMarkup(E,zt,N,p);v.push(wt),At&&(x.push(this.getButtonMarkup(E,zt,N,p)),F||C.push($)),O&&(S.push(this.getIconMarkup(E,zt,N,p)),vt.x+=i.itemIcon.width+i.itemIcon.padding)}m=Math.max(m,vt.x+i.itemMinLabelWidth),N+=j}}d=Math.max(m,d),c=Math.max(c,N);var Tt=[];f.push({tagName:"g",selector:this.getSelector("group",p),groupSelector:"groups",attributes:{"record-group":p},children:Tt}),Tt.push({tagName:"g",selector:this.getSelector("bodiesGroup",p),groupSelector:"bodiesGroups",children:g},{tagName:"g",selector:this.getSelector("labelsGroup",p),groupSelector:"labelsGroups",children:v}),C.length>0&&Tt.push({tagName:"g",selector:this.getSelector("forksGroup",p),groupSelector:"forksGroups",children:C.map(this.getForkMarkup,this)}),x.length>0&&Tt.push({tagName:"g",selector:this.getSelector("buttonsGroup",p),groupSelector:"buttonsGroups",children:x}),S.length>0&&Tt.push({tagName:"g",selector:this.getSelector("iconsGroup",p),groupSelector:"iconsGroups",children:S})}e.padding=u,e.groupsCount=l,e.overflow=o,e.minHeight=c+u.top+u.bottom,e.minWidth=d*l+u.left+u.right;var Pt=H({record:this.id,dry:!0},t);this.set("markup",h,Pt),this.autoresize(Pt)},autoresize:function(t){const e=this.getMinimalSize(),{size:n}=this.attributes,{height:i,width:r}=n,s=this.getScrollTop()===null?e.height:i,o=Math.max(r,e.width);this.resize(o,s,t)},getMinimalSize:function(){var t=this.metrics;return{width:t.minWidth,height:t.minHeight}},removeInvalidLinks:function(t){var e=this.graph;return e?e.getConnectedLinks(this).filter(this.isLinkInvalid,this).map(function(n){return n.remove(t)}):[]},isLinkInvalid:function(t){var e=this.id,n=this.metrics.items,i=t.source(),r=i.port;if(i.id===e&&r&&!(n[r]||this.hasPort(r)))return!0;var s=t.target(),o=s.port;return!!(s.id===e&&o&&!(n[o]||this.hasPort(o)))},createQueue:function(t,e,n,i){var r=t.length;return Array.from({length:r},function(s,o){var a=r-o-1;return{path:n.concat(["items",a]),item:t[a],level:e,parent:i}})},getGroupSelector:function(t){for(var e=Array.prototype.slice.call(arguments,1),n=[t],i=0,r=e.length;i<r;i++){var s=e[i];if(s!=null){Array.isArray(s)||(s=[s]);for(var o=0,a=s.length;o<a;o++)n.push(this.getSelector(t,s[o]))}}return n},getItemLabelMarkup:function(t,e,n,i){var r=this.attributes,s=r.itemOffset,o=t.height||r.itemHeight,a=t.id,l=e+s;return t.icon&&(l+=r.itemIcon.width+2*r.itemIcon.padding),{tagName:"text",className:"record-item-label",selector:this.getSelector("itemLabel",a),groupSelector:this.getGroupSelector("itemLabels",i,t.group),attributes:{x:l,y:n+o/2,"item-id":a}}},getItemBodyMarkup:function(t,e,n,i,r){var s=t.height||this.attributes.itemHeight,o=0;r&&(o-=r);var a={x:o,y:n,height:s,"item-id":t.id},l=t.span;return l&&(a["item-span"]=l),{tagName:"rect",selector:this.getSelector("itemBody",t.id),groupSelector:this.getGroupSelector("itemBodies",i,t.group),className:"record-item-body",attributes:a}},getButtonMarkup:function(t,e,n){var i=this.attributes,r=i.itemButtonSize,s=i.itemOffset,o=t.height||i.itemHeight;return{tagName:"path",className:"record-item-button",attributes:{d:this.getButtonPathData(e+s/2,n+o/2,r/2,t.collapsed),"item-id":t.id,cursor:"pointer","shape-rendering":"geometricprecision"}}},getIconMarkup:function(t,e,n,i){var r=this.attributes,s=r.itemOffset,o=r.itemIcon,a=t.height||r.itemHeight;return{tagName:"image",className:"record-item-icon",selector:this.getSelector("itemIcon",t.id),groupSelector:this.getGroupSelector("itemIcons",i,t.group),attributes:{x:e+s+o.padding,y:n+(a-o.height)/2,width:o.width,height:o.height,"xlink:href":t.icon,"item-id":t.id}}},getForkMarkup:function(t){return{tagName:"path",attributes:{d:this.getForkPathData(t),fill:"none"}}},getButtonPathData:function(t,e,n,i){var r=["M",t-n,e-n,t+n,e-n,t+n,e+n,t-n,e+n,"Z","M",t-n/2,e,t+n/2,e];return i&&Array.prototype.push.apply(r,["M",t,e-n/2,t,e+n/2]),r.join(" ")},getForkPathData:function(t){var e=this.metrics.items;if(!e)return null;var n=e[t];if(!n)return null;var i=n.children;if(!i||i.length===0)return null;for(var r=this.attributes.itemButtonSize,s=[],o,a=0,l=i.length;a<l;a++){o=e[i[a]];var c=o.cx+(o.hasSubItems?-1:1)*r/2;s.push("M",n.cx,o.cy,c,o.cy)}return s.push("M",n.cx,n.cy+r/2,n.cx,o.cy),s.join(" ")},item:function(t,e,n){var i=this.getItemPathArray(t);return i?e===void 0?this.prop(i):this.prop(i,e,n):null},toggleItemCollapse:function(t,e){var n=this.getItemPathArray(t);if(!n)return this;n.push("collapsed");var i=!!this.prop(n);return this.prop(n,!i,e),this},toggleItemHighlight:function(t,e){var n=this.getItemPathArray(t);if(!n)return this;n.push("highlighted");var i=!!this.prop(n);return this.prop(n,!i,e),this},isItemVisible:function(t){return this.getItemCacheAttribute(t,"visible")},isItemCollapsed:function(t){return this.getItemCacheAttribute(t,"collapsed")},isItemHighlighted:function(t){return this.getItemCacheAttribute(t,"highlighted")},getItemParentId:function(t){return this.getItemCacheAttribute(t,"parent")},getItemGroupIndex:function(t){return this.getItemCacheAttribute(t,"group")},getItemPathArray:function(t){var e=this.getItemCacheAttribute(t,"path");return e?e.slice():null},getItemSide:function(t){var e=this.getItemGroupIndex(t);if(e===null)return null;var n=this.metrics,i=n.groupsCount;if(i>1){if(e===0)return"left";if(e+n.items[t].span-1===i-1)return"right"}return"middle"},getItemCacheAttribute:function(t,e){if(!e)return null;const n=this.getItemCache(t);return n?n[e]:null},getItemCache:function(t){const e=this.metrics.items;if(!e)return null;const n=e[t];return n||null},getItemBBox:function(t){const e=this.getItemCache(t);if(!e)return null;const{x:n,y:i,width:r,height:s}=e;return new Z(n,i,r,s)},getSelector:function(t,e){return t+"_"+e},removeItem:function(t,e){var n=this.getItemPathArray(t);if(!n)return this;var i=n.pop(),r=this.prop(n).slice();return r.length>1?(r.splice(i,1),this.prop(n,r,H({rewrite:!0},e))):n.length>2?this.removeProp(n,e):(i=n.pop(),r=this.get("items").slice(),r.splice(i,1,[]),this.prop(n,r,H({rewrite:!0},e))),this},addNextSibling:function(t,e,n){var i=this.getItemPathArray(t);if(!i)return this;var r=this.getItemParentId(t)||this.getItemGroupIndex(t),s=i[i.length-1]+1;return this.addItemAtIndex(r,s,e,n)},addPrevSibling:function(t,e,n){var i=this.getItemPathArray(t);if(!i)return this;var r=this.getItemParentId(t)||this.getItemGroupIndex(t),s=i[i.length-1];return this.addItemAtIndex(r,s,e,n)},addItemAtIndex:function(t,e,n,i){if(!n)return this;var r;switch(typeof t){case"number":var s=this.prop("items"),o=Math.min(Math.max(t,0),s.length);r=["items",o];break;case"string":if(r=this.getItemPathArray(t),!r)return this;r.push("items");break;default:uo("Requires an item id.")}var a=this.prop(r);Array.isArray(a)?a=a.slice():a=[];var l=Math.min(Math.max(e,0),a.length);return a.splice(l,0,n),this.prop(r,a,H({rewrite:!0},i))},toJSON:function(){var t=Kt.prototype.toJSON.apply(this,arguments);return delete t.markup,t},getItemViewSign:function(t){this.isItemVisible(t)||uo(`Item "${t}" does not exist or is not visible.`);const{attributes:e,metrics:n}=this,{y:i,height:r}=n.items[t],s=this.getScrollTop();if(s===null)return 0;const{height:o}=e.size,{top:a,bottom:l}=n.padding;return i-s<0?-1:o-a-l-(i+r-s)<0?1:0},isItemInView:function(t){return this.getItemViewSign(t)===0},isEveryItemInView:function(){if(this.getScrollTop()===null)return!0;const{minHeight:t}=this.metrics,{height:e}=this.size();return t<=e},clampScrollTop:function(t){const{height:e}=this.size(),{minHeight:n}=this.metrics;return Number.isFinite(t)?Math.min(Math.max(t,0),Math.max(n-e,0)):null},getScrollTop(){return this.clampScrollTop(this.get("scrollTop"))},setScrollTop(t,e){const n=this.get("scrollTop"),i=this.clampScrollTop(t);n!==i&&this.set("scrollTop",i,e)}},{attributes:{"item-text":{set:function(t,e,n,i){if(!Ce(t))return null;var r=this.model,s=n.getAttribute("item-id"),o=r.metrics.items[s];if(o){var a=o.label,l=r.metrics.padding,c=r.metrics.groupsCount,h=o.x,u=(e.width-l.left-l.right)/c*o.span-h,d=new Z(h,o.y,u,o.height),f,p;t.textWrap?(f="text-wrap",p=H({text:a},t)):(f="text",p=a),this.getAttributeDefinition(f).set.call(this,p,d,n,i)}}},"item-highlight":{set:function(t,e,n,i){if(!Ce(t))return null;var r=this.model,s=n.getAttribute("item-id"),o=r.getItemCacheAttribute(s,"highlighted");switch(o){case!0:return t;case null:case!1:return Object.keys(t).reduce(function(a,l){return!i.hasOwnProperty(l)&&n.getAttribute(L.attributeNames[l])&&(a[l]=null),a},{})}}},"group-width":{set:function(t,e,n){var i=this.model.metrics,r=i.padding,s=i.groupsCount,o=(e.width-r.left-r.right)/s,a=Number(n.getAttribute("item-span")||1);if(isFinite(a)||(a=1),o*=a,i.overflow){var l=Number(this.findAttribute("record-group",n));l===0&&(o+=r.left),l+a===s&&(o+=r.right)}return{width:o}}},"group-position":{position:function(t,e,n){var i=Number(n.getAttribute("record-group")),r=this.model.metrics,s=r.groupsCount,o=r.padding,a=(e.width-o.left-o.right)/s,l=o.left+i*a,c=o.top;return new M(l,c)}},scrollable:{set:Fv(function(t,e){const{paper:{svg:n,defs:i},model:r,cid:s}=this,o=`scroll-clip-${s}`;let a,l=n.getElementById(o);l?(l=L(l),[a]=l.children()):(a=L("rect"),l=L("clipPath",{id:o},[a]),l.appendTo(i));const{padding:c,overflow:h}=r.metrics,{top:u,bottom:d,left:f,right:p}=c;let g=0,v=e.width;return h||(g+=f,v-=f+p),a.attr({y:t+u,x:g,width:v,height:Math.max(e.height-u-d,0)}),{"clip-path":`url(#${o})`}}),position:Fv(function(t){return new M(0,-t)})}}}),m4=ah.define("standard.BorderedRecord",{padding:0,attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#000000",fill:"#FFFFFF"}}},{markup:[{tagName:"rect",selector:"body"}]}),v4=ah.define("standard.HeaderedRecord",{padding:{top:30,left:0,right:0,bottom:0},itemAboveViewSelector:"header",itemBelowViewSelector:"header",attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#000000",fill:"#FFFFFF"},header:{refWidth:"100%",height:30,stroke:"#000000",fill:"transparent"},headerLabel:{refX:"50%",refY:15,textAnchor:"middle",textVerticalAnchor:"middle",fontSize:20,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerLabel"}]});var y4=ah.prototype.markupAttributes.reduce(function(t,e){return t[e]=["UPDATE"],t},{scrollTop:["UPDATE","TOOLS"]});const ag=Pe.extend({events:{"mousedown .record-item-button":"onItemButtonClick","touchstart .record-item-button":"onItemButtonClick"},presentationAttributes:Pe.addPresentationAttributes(y4),getLinkEnd:function(t,...e){const n={id:this.model.id},i=this.findAttribute("item-id",t)||this.findAttribute("port",t);return i&&(n.port=i),this.customizeLinkEnd(n,t,...e)},getMagnetFromLinkEnd:function(t){for(var e=t.port,n=this.model;e&&!n.isItemVisible(e);)e=n.getItemParentId(e);if(!e)return g4.getMagnetFromLinkEnd.apply(this,arguments);const i=n.getItemViewSign(e);let r;switch(i){case-1:r=String(n.get("itemAboveViewSelector"));break;case 1:r=String(n.get("itemBelowViewSelector"));break;case 0:default:r=n.getSelector("itemBody",e);break}return this.findNode(r)},onItemButtonClick:function(t){if(t.button===2)return;t.stopPropagation(),t.preventDefault();const e=t.currentTarget.getAttribute("item-id");this.model.toggleItemCollapse(e,{ui:!0})}}),b4=ag,x4=ag;function uo(t){throw new Error("shapes.standard.Record: "+t)}function Fv(t){return function(e,...n){if(!e)return;const{model:i}=this,r=i.getScrollTop();if(r!==null)return t.call(this,r,...n)}}const w4=Object.freeze(Object.defineProperty({__proto__:null,BorderedRecord:m4,BorderedRecordView:b4,HeaderedRecord:v4,HeaderedRecordView:x4,Record:ah,RecordView:ag},Symbol.toStringTag,{value:"Module"})),Gt='xmlns="http://www.w3.org/2000/svg"';function _4({color:t="#000",svg:e=!1}={}){const n={exclusive_blank:null,exclusive:`<svg ${Gt} viewBox="12 12 26 26"><path fill="${t}" stroke="${t}" d="M18.25 17.063L23.5 25.5l-5.25 8.438h4l3.25-5.25 3.25 5.25h3.906L27.438 25.5l5.218-8.438H28.75l-3.25 5.25-3.25-5.25h-4z"/></svg>`,inclusive:`<svg ${Gt} viewBox="12 12 26 26"><circle cx="25" cy="25" r="9.429" fill="none" stroke="${t}" stroke-width="3"/></svg>`,parallel:`<svg ${Gt} viewBox="12 12 26 26"><path fill="${t}" stroke="${t}" stroke-width="1.4" d="M16.388 21.821v5.625h5.86v6.328h5.624v-6.328H34.2v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>`,event:`<svg ${Gt} viewBox="12 12 26 26"><circle stroke-width="1.4" cx="25" cy="25" r="12.121" fill="none" stroke="${t}"/><circle stroke-width="1.4" cx="25" cy="25" r="10.121" fill="none" stroke="${t}"/><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.4" d="M29.828 31.845h-9.069l-2.801-8.625 7.337-5.33 7.335 5.33-2.802 8.625z"/></svg>`,exclusive_event:`<svg ${Gt} viewBox="12 12 26 26"><circle stroke-width="1.4" cx="25" cy="25" r="12.121" fill="none" stroke="${t}"/><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.4" d="M29.828 31.845h-9.069l-2.801-8.625 7.337-5.33 7.335 5.33-2.802 8.625z"/></svg>`,parallel_event:`<svg ${Gt} viewBox="12 12 26 26"><circle stroke-width="1.4" cx="25" cy="25" r="12.121" fill="none" stroke="${t}"/><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.4" d="M16.388 21.821v5.625h5.86v6.328h5.624v-6.328H34.2v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>`,complex:`<svg ${Gt} viewBox="13 13 25 25"><path fill="none" stroke="${t}" stroke-width="4" d="M16.25 25.5h19m-9.75-9.25v19m-6.644-2.96L32.29 18.857m-13.435.353L32.29 32.644"/></svg>`};if(e)return n;const i={};return Object.keys(n).forEach(r=>{i[r]=`data:image/svg+xml,${encodeURIComponent(n[r])}`}),i}function S4({color:t="#000",svg:e=!1}={}){const n={none:null,parallel:`<svg ${Gt} viewBox="-3 -3 16 16"><path fill="none" stroke="${t}" stroke-width="2" d="M0 0v10M3 0v10M6 0v10"/></svg>`,sequential:`<svg ${Gt} viewBox="-3 -3 16 16"><path fill="none" stroke="${t}" stroke-width="2" d="M0 2h10M0  5h10M0 8h10"/></svg>`,"sub-process":`<svg ${Gt} viewBox="-2 -2 14 14"><path fill="none" stroke="${t}" stroke-width="1" d="M0 0h10v10H0zm5 2v6M2 5h6"/></svg>`,compensation:`<svg ${Gt} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 13.438v13.124L12.437 20 19 13.437m6.563 0v13.126L19 20l6.563-6.563z"/></svg>`,"ad-hoc":`<svg ${Gt} viewBox="0 0 2000 2000"><path fill="${t}" d="M300 1039.87c58.332-138.228 134.894-282.23 266.546-360.085c97.784-58.392 218.701-22.42 308.428 34.819c138.188 85.207 246.292 211.842 382.606 299.507c82.335 48.265 184.733 8.718 244.748-58.056c72.401-84.446 155.215-164.023 197.672-269.981v330.038c-61.331 121.67-140.231 248.152-266.392 307.169c-103.228 44.44-223.148 17.789-312.524-46.586c-131.02-87.979-227.486-223.69-369.854-294.78c-69.172-36.004-157.377-27.545-215.331 26.623C431.412 1101.042 371.534 1231.858 300 1350v-310.13z"/></svg>`,loop:`<svg ${Gt} viewBox="0 0 2000 2000"><path fill="${t}" d="M1057.07 410.836C805.11 407.3 563.447 583.065 491.134 824.983c-55.584 173.977-23.105 373.061 85.522 520.027l-269.086-52.09l-22.804 117.814l483.865 93.664l93.687-479.986l-117.779-22.988l-56.861 291.316c-138.733-165.6-136.73-427.773 4.367-591.379c137.417-171.716 399.203-221.007 590.733-114c183.232 94.568 284.888 318.597 234.896 518.746c-44.77 208.91-247.404 367.34-460.604 363.053c-55.485-3.935-83.374 76.196-37.436 107.561c40.104 24.986 90.846 7.364 134.808 4.475c248.181-37.748 457.52-249.452 489.52-498.91c36.994-238.025-91.384-488.935-304.803-600.241c-86.168-46.769-184.068-71.364-282.089-71.21z"/></svg>`};if(e)return n;const i={};return Object.keys(n).forEach(r=>{i[r]=`data:image/svg+xml,${encodeURIComponent(n[r])}`}),i}function E4({color:t="#000",svg:e=!1}={}){const n={none:null,"business-rule":`<svg ${Gt} viewBox="5 5 25 20"><path fill="${t}" stroke="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2" d="m 8,8 0,4 20,0 0,-4 z"/><path stroke="${t}" fill="none" d=" m 8,8 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"/></svg>`,manual:`<svg ${Gt} viewBox="0 0 2000 2000"><path d="M919.379 382.988c-22.3.007-42.953 8.258-60.567 19.616l-.029.017-.027.02c-94.694 61.32-418.867 286.29-490.127 335.2l-.002.003h-.002c-64.371 44.196-107.733 110.904-132.662 189.935l-.004.016-.004.014c-25.952 82.515-22.622 172.403-22.371 247.685l.002.02v.02c.255 56.685 1.606 106.154 16.309 166.148l.003.015c21.373 87.802 62.768 151.336 121.23 190.285 58.46 38.948 130.615 52.768 211.575 53.018 292.284 1.097 584.741 1.49 877.182 0h.05c32.21-.211 62.96-13.752 82.135-37.678 19.174-23.923 27.017-54.865 27.43-88.81.29-22.768-2.91-44.287-10.307-63.512h32.375c31.532 0 60.434-8.984 81.153-27.916 20.711-18.926 31.304-44.62 36.808-71.68v-.007c7.683-37.64 4.055-74.807-10.916-105.997 32.946-2.661 62.034-15.102 80.74-37.906 21.024-25.627 27.148-58.205 27.256-92.72.115-36.034-8.629-70.421-28.812-97.766s-53.772-45.956-91.567-46.01H1666.21c-13.76-.011-26.16.008-41.781 0 7.516-18.744 10.82-39.826 10.752-62.006v-.113c-.228-35.772-9.251-69.954-29.535-97.127-20.284-27.173-53.809-45.753-91.586-45.754-224.42-.885-446.252 2.157-634.903 1.203 9.83-9.885 19.378-19.525 29.871-29.96 32.482-32.304 63.7-62.743 79.827-83.612 38.555-49.623 44.307-116.852 11.85-166.305-17.114-26.143-42.208-43.832-69.151-47.513a89.543 89.543 0 00-10.012-.8v.003a90.145 90.145 0 00-2.162-.026zm.547 70.028a17.31 17.31 0 012.148.152c5.305.725 10.986 2.62 20.07 16.506l.018.025.016.026c12.691 19.326 12.131 58.305-8.623 84.992l-.035.045-.036.045c-7.546 9.77-41.454 44.616-73.818 76.802-32.364 32.187-63.134 61.896-78.357 80.442-14.557 17.734-9.216 32.647-5.268 41.982 3.948 9.335 8.465 20.237 28.598 25.02 6.028 1.432 6.36 1.02 8.289 1.152 1.929.133 3.923.224 6.267.309 4.689.169 10.688.297 18.094.406 226.465 1.38 450.423-1.24 676.709-.92h.063c17.211 0 26.557 5.657 35.492 17.627 8.929 11.962 15.468 31.813 15.629 55.652.066 24.73-5.857 39.82-13.057 48.133-7.2 8.313-16.845 13.52-37.475 13.588H1030v70h484.791c66.478.006 101.54-.042 151.363 0 17.308.03 26.53 5.662 35.324 17.578 8.8 11.922 15.21 31.827 15.133 55.975v.002c-.08 25.822-5.346 41.196-11.375 48.545-6.029 7.349-14.638 12.732-39.482 12.902-8.43.058-68.808.014-93.863.043-.397-.005-.786-.042-1.184-.043-180.227-.85-360.455-.002-540.682-.002H1030l-.025 70h.025c.043 0 382.517.239 541.33.047 19.7.279 31.511 8.21 40.934 23.601 9.563 15.621 14.323 40.11 8.68 67.756v.028c-3.737 18.38-9.413 28.473-15.436 33.976-6.023 5.504-14.335 9.592-33.934 9.592-180.523-.086-361.044-.452-541.568 0h-.092l.092 70h409.414c14.707.096 21.247 4.008 27.96 12.977 6.715 8.968 12.44 25.642 12.132 49.652v.025c-.284 23.412-5.952 38.272-12.057 45.889-6.105 7.617-12.405 11.357-27.973 11.459-292.123 1.488-584.356 1.097-876.51 0h-.025c-73.053-.223-130.456-12.932-173-41.275-42.55-28.344-73.607-72.869-92.039-148.598l-.008-.03-.005-.029c-12.87-52.492-14.06-94.01-14.311-149.81v-.041c-.256-76.57-1.724-160.05 19.146-226.408 21.392-67.802 55.988-119.253 105.512-153.256l.004-.002c72.125-49.505 398.23-275.66 488.5-334.12l.004-.001c8.476-5.465 15.5-7.79 20.719-8.303.87-.086 1.689-.122 2.457-.113z" fill="${t}" /></svg>`,receive:`<svg ${Gt} viewBox="10 10 20 20"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2" d="M12.5 15.313v9.374h15v-9.375zm0 0l7.5 5.624 7.5-5.625"/></svg>`,script:`<svg ${Gt} viewBox="0 0 2000 2000"><path d="M759.41 378l-8.262 4.904-2.699 1.604C631.658 453.72 551.284 517.185 498.23 579.16c-53.13 62.06-78.817 124.548-79.547 184.787-1.454 119.88 86.972 209.719 165.425 290.067 78.394 80.286 148.323 156.002 154.905 218.664 3.354 31.938-4.195 64.019-39.02 107.943-34.678 43.74-97.616 96.128-198.24 154.785L353.193 1622h916.854l10.85-6.313.011-.01c106.636-62.16 178.477-119.59 224.254-177.33 45.914-57.91 64.594-118.499 58.62-175.378-11.838-112.702-103.646-194.827-180.829-273.873-77.243-79.108-139.852-153.721-139-224.024.43-35.49 14.072-75.084 57.219-125.484 43.073-50.314 115.696-109.181 227.031-175.158v-.002L1674.045 378H759.41zm25.842 92.918h564.643c-49.73 37.078-89.049 72.898-119.307 108.242-53.13 62.06-78.817 124.548-79.547 184.787-1.453 119.882 86.977 209.72 165.43 290.067 78.393 80.286 148.316 156 154.898 218.664 3.355 31.938-4.193 64.019-39.017 107.943-33.397 42.123-93.456 92.386-187.79 148.461h-566.09c39.27-30.627 70.469-60.635 94.33-90.732 45.914-57.911 64.594-118.5 58.62-175.38-11.838-112.701-103.645-194.826-180.828-273.872-77.243-79.108-139.85-153.721-138.998-224.024.43-35.49 14.07-75.084 57.216-125.484 41.627-48.624 111.275-105.346 216.44-168.672zM653.13 629.393v42.92h441.398v-42.92H653.131zm-16.402 231.175v42.918h456.384v-42.918H636.73zm206.794 231.17v42.918h441.989v-42.918H843.523zm63.198 231.174v42.918h457.986v-42.918H906.721z" fill="${t}"/></svg>`,send:`<svg ${Gt} viewBox="10 10 20 20"><path fill="${t}" d="M12.5 14.344l7.5 5.625 7.5-5.625zm0 .937v9.375h15v-9.375L20 20.906z"/></svg>`,service:`<svg ${Gt} viewBox="0 0 2000 2000"><path d="M825.746 438.174c-.046 36.998.01 73.998.106 110.996-31.554 8.927-60.387 21.384-87.616 36.644l-79.582-78.625-148.806 149.668 79.576 78.612a393.526 393.526 0 00-35.752 87.242l-112.725.205v210.79l113.903-.411c10.416 41.298 33.084 78.425 55.662 111.623V963.094l-99.565.357V892.79l99.069-.18 5.56-28.172c8.11-41.084 24.17-80.249 47.244-115.292l15.785-23.973-69.603-68.762 50.094-50.385 69.73 68.893 23.73-15.836c36.264-23.926 75.929-39.963 115.481-48.316l27.96-5.805-.25-96.785h71.966l-.557 96.281h188.834c-17.713-21.144-91.12-48.658-118.508-56.324l.635-109.957c-78.4-.002-139.865.004-212.37-.002zm199.158 201.658l.287 110.992c-31.554 8.927-60.387 21.383-87.617 36.645l-79.584-78.625-148.806 149.668 79.578 78.611a393.515 393.515 0 00-35.754 87.244l-112.723.203v210.79l113.9-.409c8.966 31.257 21.395 59.8 36.626 86.746l-81.495 81.176 150.465 147.879 81.201-80.824c27.815 15.444 57.38 27.436 88.034 35.781l.052 114.713c72.392.634 149.467.307 211.336.3v-116.07c31.578-8.904 60.501-21.45 87.737-36.705l81.134 79.996 148.905-149.48-81.305-80.123a394.444 394.444 0 0035.799-87.399l110.379-.681v-210.586l-111.618.68c-8.972-31.287-21.22-59.637-36.654-86.762l77.121-77.319-150.38-148.13-77.022 77.285a398.637 398.637 0 00-87.68-35.639l.633-109.957h-212.549zm70.18 70h71.967l-.555 96.283 28.426 5.578c41.272 8.1 80.83 24.14 116.015 47.073l23.825 15.529 67.216-67.445 50.618 49.86-67.31 67.483 16.194 23.907c23.765 35.872 39.529 74.65 48.428 114.58l5.856 28.011 97.28-.591v70.59l-96.737.595-5.557 28.012a324.606 324.606 0 01-47.299 115.398l-15.803 24.006 71.258 70.223-50.086 50.28-71.265-70.266-23.69 15.738c-36.275 23.706-75.624 40.123-115.324 48.21l-28.144 5.622v102.215c-19.241.046-40.231.016-71.37-.028l-.045-101.449-28.271-5.521c-41.33-8.071-80.823-24.038-115.947-47.067l-23.754-15.574-71.541 71.21-50.625-49.757 71.64-71.361-16.347-24.004c-23.787-35.794-39.523-74.612-48.438-114.496l-5.85-27.926-99.564.355v-70.66l99.069-.181 5.56-28.168c8.11-41.085 24.17-80.252 47.244-115.295l15.785-23.975-69.605-68.762 50.094-50.384 69.732 68.892 23.73-15.834c36.31-23.77 74.841-39.541 115.481-48.314l27.96-5.805-.251-96.787zm37.166 257.203c-86.647 0-157.639 70.994-157.639 157.64 0 86.648 70.992 157.638 157.639 157.638s157.639-70.99 157.639-157.637-70.992-157.64-157.639-157.64zm0 70c48.816 0 87.639 38.825 87.639 87.64 0 48.817-38.823 87.638-87.639 87.638-48.816 0-87.637-38.821-87.637-87.637s38.82-87.64 87.637-87.64z" fill="${t}"/></svg>`,user:`<svg ${Gt} viewBox="0 0 2000 2000"><path d="M991.75 365c-177.277 0-304.097 136.28-304.453 291.514v.088c.011 46.944 12.714 96.49 32.56 141.177 14.33 32.267 32.147 61.932 53.858 85.696-129.03 44.143-280.193 116.795-356.598 260.054L413 1151.25V1615h1157.5v-463.75l-4.117-7.72c-75.306-141.2-223.199-213.75-350.98-258.077 62.379-63.433 80.78-145.306 80.8-228.851v-.088C1295.847 501.28 1169.027 365 991.75 365zM870.709 530.299c8.194.02 17.191.294 27.11.879 79.022 4.657 105.618 18.882 126.062 32.373 20.443 13.49 34.855 26.333 88.883 27.908h.034c42.101-1.575 62.349-9.081 76.869-17.584 5.884-3.445 10.824-7.027 15.887-10.447 13.38 28.682 20.567 60.389 20.648 93.203-.028 93.44-16.092 158.876-101.768 212.424l8.381 63.17c17.833 5.415 36.266 11.357 54.975 17.873 2.613 10.9 5.632 25.196 7.662 40.394 2.127 15.923 2.964 32.489 1.652 44.928-1.311 12.439-5.173 19.154-5.851 19.832-43.547 43.547-120.847 68.943-199.252 68.943-78.406 0-155.705-25.396-199.252-68.943-.678-.678-4.54-7.393-5.852-19.832-1.311-12.439-.475-29.005 1.653-44.928 2.041-15.282 5.084-29.662 7.707-40.584 18.522-6.44 36.77-12.32 54.43-17.683l4.995-67.688c-4.068-5.217-8.213-8.673-13.16-12.385-19.121-14.345-42.31-45.903-58.69-82.785-16.373-36.868-26.517-79.01-26.532-112.744.101-40.444 10.985-79.211 30.976-112.697 3.577-1.332 7.349-2.739 11.588-4.133 14.908-4.903 35.337-9.583 70.846-9.494zM719.361 979.855c-.063.46-.133.907-.195 1.368-2.587 19.363-4.107 40.44-1.883 61.537 2.224 21.096 7.79 43.81 25.969 61.988 62.048 62.048 155.95 89.447 248.748 89.447 92.797 0 186.7-27.4 248.748-89.447 18.178-18.178 23.745-40.892 25.969-61.988 2.224-21.097.704-42.174-1.883-61.537-.051-.382-.11-.753-.162-1.133 94.334 41.369 185.515 100.615 235.828 189.074V1545H1333v-265h-70v265H719v-265h-70v265H483v-375.836c50.408-88.626 141.838-147.93 236.361-189.309z" fill="${t}" fill-rule="evenodd"/></svg>`};if(e)return n;const i={};return Object.keys(n).forEach(r=>{i[r]=`data:image/svg+xml,${encodeURIComponent(n[r])}`}),i}function T4({color:t="#000",svg:e=!1}={}){const n={none:null,message1:`<svg ${Gt} viewBox="10 10 20 20"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2" d="M12.5 15.313v9.374h15v-9.375zm0 0l7.5 5.624 7.5-5.625"/></svg>`,message2:`<svg ${Gt} viewBox="10 10 20 20"><path fill="${t}" d="M12.5 14.344l7.5 5.625 7.5-5.625zm0 .937v9.375h15v-9.375L20 20.906z"/></svg>`,timer1:`<svg ${Gt} viewBox="8 8 24 24"><g fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><circle cx="20" cy="20" r="10"/><path d="M20 10v3m5-2l-1.5 3m5.5 1l-3 1.5m4 3.5h-3m2 5l-3-1.5M25 29l-1.5-3M20 30v-3m-5 2l1.5-3M11 25l3-1.5M10 20h3m-2-5l3 1.5m1-5.5l1.5 3m5.5-1l-2 7h4"/></g></svg>`,conditional1:`<svg ${Gt} viewBox="6 6 28 28"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.563 11.563h16.874v16.874H11.563V11.563m2.813 2.813h11.25m-11.25 3.75h11.25m-11.25 3.75h11.25m-11.25 3.75h11.25z"/></svg>`,link1:`<svg ${Gt} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M14.406 18.125h8.438v-2.813L27.53 20l-4.687 4.688v-2.813h-9.375v-3.75"/></svg>`,link2:`<svg ${Gt} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M14.406 18.125h8.438v-2.813L27.53 20l-4.687 4.688v-2.813h-9.375v-3.75"/></svg>`,signal1:`<svg ${Gt}  viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13.17 24.851h13.706l-6.853-11.879-6.854 11.88z"/></svg>`,signal2:`<svg ${Gt}  viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13.17 24.851h13.706l-6.853-11.879-6.854 11.88z"/></svg>`,error1:`<svg ${Gt} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M26.4 15.455l-3.238 12.58L17.7 18.37 13.76 23.8l3.478-12.412 5.576 8.72 3.586-4.652z"/></svg>`,error2:`<svg ${Gt} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M26.4 15.455l-3.238 12.58L17.7 18.37 13.76 23.8l3.478-12.412 5.576 8.72 3.586-4.652z"/></svg>`,escalation1:`<svg ${Gt} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 13.219l5.625 14.062L20 20.953l-5.625 6.328z"/></svg>`,escalation2:`<svg ${Gt} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 13.219l5.625 14.062L20 20.953l-5.625 6.328z"/></svg>`,termination1:`<svg ${Gt} viewBox="8 8 24 24"><circle cx="20" cy="20" r="10.5" fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"/></svg>`,termination2:`<svg ${Gt} viewBox="8 8 24 24"><circle cx="20" cy="20" r="10.5" fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"/></svg>`,compensation1:`<svg ${Gt} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 13.438v13.124L12.437 20 19 13.437m6.563 0v13.126L19 20l6.563-6.563z"/></svg>`,compensation2:`<svg ${Gt} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 13.438v13.124L12.437 20 19 13.437m6.563 0v13.126L19 20l6.563-6.563z"/></svg>`,cancel1:`<svg ${Gt} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.284 14.274l2.867-2.868 5.735 5.735 5.735-5.735 2.868 2.868-5.735 5.735 5.735 5.735-2.868 2.867-5.735-5.735-5.735 5.735-2.867-2.867 5.735-5.735-5.735-5.735z"/></svg>`,cancel2:`<svg ${Gt} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.284 14.274l2.867-2.868 5.735 5.735 5.735-5.735 2.868 2.868-5.735 5.735 5.735 5.735-2.868 2.867-5.735-5.735-5.735 5.735-2.867-2.867 5.735-5.735-5.735-5.735z"/></svg>`,multiple1:`<svg ${Gt} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M24.52 26.39h-9.443l-2.918-8.982 7.64-5.55 7.64 5.551-2.919 8.98z"/></svg>`,multiple2:`<svg ${Gt} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M24.52 26.39h-9.443l-2.918-8.982 7.64-5.55 7.64 5.551-2.919 8.98z"/></svg>`,parallel1:`<svg ${Gt} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.344 17.203v5.625h5.86v6.328h5.624v-6.328h6.328v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>`,parallel2:`<svg ${Gt} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.344 17.203v5.625h5.86v6.328h5.624v-6.328h6.328v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>`};if(e)return n;const i={};return Object.keys(n).forEach(r=>{i[r]=`data:image/svg+xml,${encodeURIComponent(n[r])}`}),i}const sf=T4({color:"${color}",svg:!0}),A4=_4({color:"${color}",svg:!0}),D_=S4({color:"${color}",svg:!0}),C4=E4({color:"${color}",svg:!0});function N_(t){return function(e,n,i,r){switch(e){case"double":{const o=n.clone().inflate(-3),{fill:a="none"}=r;return{d:`${t(n,r,0)} ${t(o,r,3)}`,fill:a}}case"thick":{const o=n.clone().inflate(-3),{stroke:a="black"}=r;return{d:`${t(n,r,0)} ${t(o,r,3)}`,fill:a}}default:case"single":return{d:t(n,r,0),fill:"none"}}}}function R_(t,e,n,i){let r;switch(t){case"dashed":{const{width:s,height:o}=e,a=Math.floor(Math.min(s,o)/20);r=`${a*4},${a}`;break}case"dotted":{const s=i["stroke-width"];r=`${s},${s*2}`;break}default:case"solid":{r="none";break}}return{"stroke-dasharray":r}}function $_(t,e,n={}){let i;const r=n[t];if(typeof r=="string"){const s=e["icon-color"]??"black",o=r.replace(/\${color}/g,s);i=`data:image/svg+xml,${encodeURIComponent(o)}`}else i=null;return{"xlink:href":i,"data-icon-type":t}}function sl(t){return function(n,i,r,s){return $_(n,s,this.model.constructor[t])}}const Uo={row:"row",column:"column"},jo={topLeft:"left-top",bottomLeft:"left-bottom",topRight:"right-top",bottomRight:"right-bottom",topMiddle:"top",bottomMiddle:"bottom",rightMiddle:"right",leftMiddle:"left",center:"center"},Vv=Object.keys(jo).reduce((t,e)=>(t[jo[e]]=e,t),{});function B_(t){return function(e,n,i,r){const s="joint-icons",o=q.data.get(i,s),a=r["icon-color"]??"#333333",l=r["icon-size"]??30,c=r["icons-flow"]??Uo.row,h=`${e.toString()} ${a} ${l} ${c}`;if(o!==h){const u=L(i);u.empty();const d=c===Uo.column;if(!Array.isArray(e))return;const f=e.map((p,g)=>{const v=L("image");v.attr($_(p,r,this.model.constructor[t]));let x,S;return d?(x=0,S=g*l):(x=g*l,S=0),v.attr({x,y:S,width:l,height:l}),v});u.append(f)}q.data.set(i,s,h)}}function F_(t,e,n,i){const r=i["icon-size"]??30,s=i["icons-flow"]??Uo.row,o=i["icons-origin"]??jo.topLeft;let a,l;const c=Array.isArray(t)?t.length:0;s===Uo.column?(a=r,l=c*r):(a=c*r,l=r);const h=new Z(0,0,-a,-l);return o in Vv?h[Vv[o]]():h.center()}function zv(t,e,n,i,r,s,o){const a=we(i),{left:l,right:c,top:h,bottom:u}=Re(i["label-margin"]),d=P4[i["label-alignment"]],f=new Z(l,h,r-l-c,s-h-u);d&&(a["text-anchor"]=d["text-anchor"],a["text-vertical-anchor"]=d["text-vertical-anchor"]);let p,g;return e.textWrap?(p="text-wrap",g={text:o,ellipsis:e.ellipsis}):(p="text",g=o),t.getAttributeDefinition(p).set.call(t,g,f,n,a),d}const on=we(jo),P4={"left-top":{"text-anchor":"start","text-vertical-anchor":"top"},"left-bottom":{"text-anchor":"start","text-vertical-anchor":"bottom"},"right-top":{"text-anchor":"end","text-vertical-anchor":"top"},"right-bottom":{"text-anchor":"end","text-vertical-anchor":"bottom"},top:{"text-anchor":"middle","text-vertical-anchor":"top"},bottom:{"text-anchor":"middle","text-vertical-anchor":"bottom"},right:{"text-anchor":"end","text-vertical-anchor":"middle"},left:{"text-anchor":"start","text-vertical-anchor":"middle"},center:{"text-anchor":"middle","text-vertical-anchor":"middle"}},I4=Kt.define("bpmn2.Event",{size:{width:40,height:40},attrs:{root:{cursor:"move",magnetSelector:"background",highlighterSelector:"background"},background:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%",fill:"#FFFFFF"},border:{stroke:"#333333",fillRule:"evenodd",borderType:"single",borderStyle:"solid",strokeWidth:2},icon:{iconColor:"#333333",iconType:"none",refX:"15%",refY:"15%",refWidth:"70%",refHeight:"70%"},label:{refDy:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold"}}},{markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"icon"},{tagName:"path",selector:"border"},{tagName:"text",selector:"label"}]},{attributes:{"border-type":{set:N_(t=>k4(t))},"border-style":{set:R_},"icon-type":{set:sl("EVENT_ICONS")}},EVENT_ICONS:sf});function k4(t){const e=t.center(),n=L("ellipse",{cx:e.x,cy:e.y,rx:t.width/2,ry:t.height/2});return L.convertEllipseToPathData(n)}const O4=Kt.define("bpmn2.Gateway",{size:{width:58,height:58},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{refPoints:"1,0,2,1,1,2,0,1",fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},icon:{iconColor:"#333333",refX:"19%",refY:"19%",refWidth:"62%",refHeight:"62%"},label:{refDy:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"image",selector:"icon"},{tagName:"text",selector:"label"}]},{attributes:{"icon-type":{set:sl("GATEWAY_ICONS")}},GATEWAY_ICONS:A4});var xc=10;const L4=Kt.define("bpmn2.DataStore",{size:{width:63,height:63},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{lateralArea:xc,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},top:{refCx:"50%",cy:xc,refRx:"50%",ry:xc,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:xc,fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",fill:"#333333",textWrap:{width:"200%"}}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],topRy:function(t,e){if(t===void 0)return this.attr("body/lateralArea");var n=je(t),i={lateralArea:t},r={refY2:t},s=n?{refCy:t,refRy:t,cy:null,ry:null}:{refCy:null,refRy:null,cy:t,ry:t};return this.attr({body:i,top:s,label:r},e)}},{attributes:{"lateral-area":{set:function(t,e){var n=je(t);n&&(t=parseFloat(t)/100);var i=e.x,r=e.y,s=e.width,o=e.height,a=s/2,l=n?o*t:t,c=L.KAPPA,h=c*a,u=c*(n?o*t:t),d=i,f=i+s/2,p=i+s,g=r+l,v=g-l,x=r+o-l,S=r+o,C=["M",d,g,"L",d,x,"C",i,x+u,f-h,S,f,S,"C",f+h,S,p,x+u,p,x,"L",p,g,"C",p,g-u,f+h,v,f,v,"C",f-h,v,d,g-u,d,g,"Z"];const P=7;let k=g+P,N=g+l+P;return C.push("M",p,k,"C",p,k+u,f+h,N,f,N,"C",f-h,N,d,k+u,d,k),k+=P,N+=P,C.push("L",d,k,"C",d,k+u,f-h,N,f,N,"C",f+h,N,p,k+u,p,k,"Z"),{d:C.join(" ")}}}}}),M4=Kt.define("bpmn2.DataObject",{size:{width:48,height:65},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{objectD:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{refY:"100%",refY2:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",textWrap:{width:"200%"}},dataTypeIcon:{iconColor:"#333333",iconType:"none",x:0,y:0,width:25,height:25},collectionIcon:{iconColor:"#333333",collection:!1,refX:"50%",refY:"100%",y:-16-2,x:-16/2+2,width:16,height:16}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"},{tagName:"image",selector:"dataTypeIcon"},{tagName:"image",selector:"collectionIcon"}]},{attributes:{"object-d":{set:function(t,e){const n=t,i=e.topLeft(),r=e.bottomLeft(),s=e.bottomRight(),o=e.topRight(),a=o.clone().offset(-n,n),l=o.clone().offset(0,n),c=o.clone().offset(-n,0),h=`M ${i.serialize()} ${r.serialize()} ${s.serialize()} ${l.serialize()} ${c.serialize()} Z`,u=`M ${c.serialize()} ${a.serialize()} ${l.serialize()}`;return{d:`${h} ${u}`}}},"icon-type":{set:sl("DATA_OBJECT_TYPE_ICONS")},collection:{set:sl("DATA_OBJECT_COLLECTION_ICONS")}},DATA_OBJECT_TYPE_ICONS:{none:null,input:sf.link1,output:sf.link2},DATA_OBJECT_COLLECTION_ICONS:{false:null,true:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="-3 -3 16 16"><path fill="none" stroke="${color}" stroke-width="2" d="M0 0v10M3 0v10M6 0v10"/></svg>'}}),lh={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{label:{fill:"#333333",fontSize:12,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"sans-serif"},body:{ref:"label",fill:"#ffffff",stroke:"none",refX:0,refY:0,refWidth:"100%",refHeight:"100%"}},position:{distance:.5}},D4=Dr.define("bpmn2.DataAssociation",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",strokeDasharray:"2,5",targetMarker:{type:"path",d:"M 10 -7 0 0 10 7","stroke-width":2,fill:"none"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:lh,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),N4=Kt.define("bpmn2.Activity",{size:{width:120,height:100},attrs:{root:{cursor:"move",magnetSelector:"background",highlighterSelector:"background"},background:{refWidth:"100%",refHeight:"100%",fill:"#FFFFFF",rx:10,ry:10},border:{stroke:"#333333",fillRule:"evenodd",borderType:"single",borderStyle:"solid",borderRadius:10,strokeWidth:2},icon:{iconColor:"#333333",iconType:"none",x:5,y:0,width:30,height:30},label:{refY:"50%",refX:"50%",textVerticalAnchor:"middle",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",textWrap:{width:-10,height:-50,ellipsis:!0}},markers:{event:"element:marker:pointerdown",iconSize:16,iconColor:"#333333",iconTypes:[""],iconsOrigin:jo.bottomMiddle,iconsFlow:Uo.row,refX:"50%",refY:"100%",refY2:-5}}},{markup:[{tagName:"rect",selector:"background"},{tagName:"image",selector:"icon"},{tagName:"path",selector:"border"},{tagName:"text",selector:"label"},{tagName:"g",selector:"markers"}]},{attributes:{"border-type":{set:N_((t,e,n)=>{const i=e["border-radius"]??0,r=Math.max(Math.min(i,2),i-n),s=t.toJSON();return s.rx=s.ry=r,L.rectToPath(s)})},"border-style":{set:R_},"icon-type":{set:sl("ACTIVITY_TYPE_ICONS")},"icon-types":{set:B_("ACTIVITY_MARKER_ICONS"),position:F_},"icon-size":{},"icons-origin":{},"icons-flow":{},"icon-color":{},"border-radius":{}},ACTIVITY_TYPE_ICONS:C4,ACTIVITY_MARKER_ICONS:Qe(D_,"none")}),R4=Kt.define("bpmn2.Conversation",{size:{width:58,height:47},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{fill:"#FFFFFF",stroke:"#333333",refPoints:"1,0 3,0, 4,1 3,2 1,2 0,1, 1,0",strokeLinejoin:"round",strokeWidth:2},markers:{event:"element:marker:pointerdown",iconSize:16,iconColor:"#333333",iconTypes:[],iconsOrigin:jo.bottomMiddle,iconsFlow:Uo.row,refX:"50%",refY:"100%"},label:{refDy:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"},{tagName:"g",selector:"markers"}]},{attributes:{"icon-types":{set:B_("CONVERSATION_MARKER_ICONS"),position:F_},"icon-size":{},"icons-origin":{},"icons-flow":{},"icon-color":{}},CONVERSATION_MARKER_ICONS:Qe(D_,"none")}),$4=Dr.define("bpmn2.ConversationLink",{attrs:{line:{connection:!0,stroke:"#FFFFFF",strokeWidth:2,strokeLinejoin:"round"},outline:{connection:!0,stroke:"#333333",strokeWidth:6,strokeLinejoin:"round"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:lh,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"outline",attributes:{fill:"none","pointer-events":"none"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),B4=aa["source-marker"].set,F4=aa["target-marker"].set,Pa={sequence:"sequence",default:"default",conditional:"conditional",message:"message"},V4=Dr.define("bpmn2.Flow",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",flowType:"sequence"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:lh,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]},{attributes:{"flow-type":{set:function(t,e,n,i){const r=i["marker-fill"]??"#FFFFFF",s=i["stroke-width"]??2,o={"stroke-dasharray":"none","marker-start":null,"marker-end":null};let a,l;switch(t){case Pa.default:{a={d:"M 5 -5 15 5","stroke-width":s},l={type:"path",d:"M 12 -5 0 0 12 5 z"};break}case Pa.conditional:{a={d:"M 0 0 9 -5 18 0 9 5 Z","stroke-width":s,fill:r},l={type:"path",d:"M 12 -5 0 0 12 5 z"};break}case Pa.message:{o["stroke-dasharray"]="5,2",a={type:"circle",cx:5,r:5,"stroke-width":s,fill:r},l={type:"path",d:"M 12 -5 0 0 12 5 z","stroke-width":s,fill:r};break}case Pa.sequence:default:{l={type:"path",d:"M 12 -5 0 0 12 5 z"};break}}return a&&H(o,B4.call(this,a,e,n,i)),l&&H(o,F4.call(this,l,e,n,i)),o}},"marker-fill":{}},FLOW_TYPES:Pa}),z4=Kt.define("bpmn2.Group",{size:{width:120,height:100},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{refWidth:"100%",refHeight:"100%",fill:"transparent",rx:10,ry:10,stroke:"#333333",borderStyle:"dashed",strokeWidth:2,strokeLinecap:"square",pointerEvents:"none"},wrapper:{refX:5,refY:5,refWidth:-10,refHeight:-10,pointerEvents:"stroke",strokeWidth:10,stroke:"transparent",fill:"none"},label:{refY:6,refX:"50%",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",textWrap:{width:-12,height:-12,ellipsis:!0}}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"wrapper"},{tagName:"text",selector:"label"}]},{attributes:{"border-style":{set:function(t,e,n,i){var r=2,s=i["stroke-width"]||1,o=r*s+","+r*s+","+s/r;return{"stroke-dasharray":o}}}}}),G4=Kt.define("bpmn2.Annotation",{size:{width:80,height:40},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{refWidth:"100%",refHeight:"100%",fill:"transparent"},border:{annotationD:{size:10},fill:"none",stroke:"#333333",strokeWidth:2},label:{refY:6,refX:4,fontSize:12,fontFamily:"sans-serif",textWrap:{width:-12,height:-12,ellipsis:!0}}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"path",selector:"border"},{tagName:"text",selector:"label"}]},{attributes:{"annotation-d":{set:function(t,e){const n=t.size||0,i=t.side,r=e.topLeft(),s=e.bottomLeft(),o=e.topRight(),a=e.bottomRight();switch(i){case"top":{const l=r.clone().offset(0,n),c=o.clone().offset(0,n);return{d:`${`M ${l.serialize()} ${r.serialize()} ${o.serialize()} ${c.serialize()}`}`}}case"right":{const l=o.clone().offset(-n,0),c=a.clone().offset(-n,0);return{d:`${`M ${l.serialize()} ${o.serialize()} ${a.serialize()} ${c.serialize()}`}`}}case"bottom":{const l=s.clone().offset(0,-n),c=a.clone().offset(0,-n);return{d:`${`M ${l.serialize()} ${s.serialize()} ${a.serialize()} ${c.serialize()}`}`}}case"left":default:{const l=r.clone().offset(n,0),c=s.clone().offset(n,0);return{d:`${`M ${l.serialize()} ${r.serialize()} ${s.serialize()} ${c.serialize()}`}`}}}}}}}),H4=Dr.define("bpmn2.AnnotationLink",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",strokeDasharray:"2,5"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:lh,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),lg=Kt.define("bpmn2.Pool",{size:{width:600,height:300},lanes:null,milestones:null,milestonesSize:20,padding:0,headerSize:20,attrs:{body:{cursor:"move",refWidth:"100%",refHeight:"100%",fill:"transparent"},laneGroups:{laneContainerPosition:!0},laneHeaders:{fill:"#ffffff",stroke:"#333333",strokeWidth:2,headerSize:!0,shapeRendering:"optimizespeed"},laneLabels:{fontSize:14,fill:"#333333",transform:"rotate(-90)",textAnchor:"middle",textVerticalAnchor:"middle",labelAlignment:on.center,labelMargin:{vertical:1,horizontal:10},fontFamily:"sans-serif",labelPosition:!0,laneLabel:{textWrap:!0,ellipsis:!0}},lanes:{stroke:"#333333",strokeWidth:2,fill:"#ffffff",laneSize:!0,shapeRendering:"optimizespeed"},milestoneGroups:{milestoneContainerPosition:!0},milestoneHeaders:{fill:"#ffffff",stroke:"#333333",strokeWidth:2,milestoneHeaderSize:!0,shapeRendering:"optimizespeed"},milestoneLabels:{fontSize:14,fill:"#333333",textAnchor:"end",textVerticalAnchor:"middle",labelAlignment:on.rightMiddle,labelMargin:{vertical:1,horizontal:10},fontFamily:"sans-serif",milestoneLabelPosition:!0,milestoneLabel:{textWrap:!0,ellipsis:!0}},milestoneLines:{stroke:"#333333",strokeWidth:2,milestoneLinePosition:!0,shapeRendering:"optimizespeed"}}},{metrics:null,markup:[{tagName:"rect",selector:"body"}],markupAttributes:["lanes","padding","milestones","headerSize","milestonesSize"],initialize:function(){Kt.prototype.initialize.apply(this,arguments),this.on("change",this.onChange,this),this.buildMarkup()},anyHasChanged:function(t){return Array.isArray(t)?t.some(function(e){return this.hasChanged(e)},this):!1},onChange:function(t,e){e.pool!==this.id&&this.hasChanged("markup")&&Mn("Markup cannot be modified."),this.anyHasChanged(this.markupAttributes)&&this.buildMarkup(e)},buildMarkup:function(t){const e=Le(this.markup);Array.isArray(e)||Mn("Expects Prototype JSON Markup.");const n=this.attributes.lanes||[{}];Array.isArray(n)||Mn("Expects lanes to be an array.");const i=this.attributes.milestones||[];Array.isArray(i)||Mn("Expects milestones to be an array.");const r=this.metrics={};r.lanes={},r.lanesNameCache={},r.milestonesNameCache={},r.milestones={},r.totalTakenHeightSpace=0,r.topLaneGroupsCount=n.length,r.padding=Re(this.attributes.padding),this.buildLanesMarkupRecursively(n,e,null,1,0),this.buildMilestones(i,e);const s=H({pool:this.id,dry:!0},t);this.set("markup",e,s),s.autoResize!==!1&&this.autoresize(s)},buildLanesMarkupRecursively:function(t,e,n,i,r){Array.isArray(t)||Mn("Expects lanes to be an array.");let s=0;return t.forEach((o,a)=>{let l=0;const c=o.id!==void 0&&o.id!==""?o.id:null,h=n!==null?`${n}_${a}`:`${a}`,u=this.getLaneGroupMarkup(h,c);e.push(u);const d=Number.isFinite(o.size)?Math.max(o.size,0):void 0,f=this.getLaneMarkup(h,c);u.children.push(f);const p=o.label,g=typeof o.label=="string",v=g?Number.isFinite(o.headerSize)?Math.max(o.headerSize,0):this.attributes.headerSize:0;if(g){const C=this.getHeaderMarkup(h,c),P=this.getLabelMarkup(h,c);u.children.push(C),u.children.push(P)}o.sublanes&&!Array.isArray(o.sublanes)&&Mn("Expects sublanes to be an array.");const x=o.sublanes||[];if(x.length){const C=u.children,P=i+1;l=this.buildLanesMarkupRecursively(x,C,h,P,x.length)}l=d&&d>l?d:l,s+=l;const S={nestLevel:i,laneIndexWithinGroup:a,parentId:n?`lanes_${n}`:null,parentSublanesCount:r,headerSize:v,label:p,hasLabel:g,size:d,takenUpSpaceByLaneAndSublanes:l,sublanesCount:x.length,customId:c};this.addLaneGroupMetrics(h,S)}),s},buildMilestones:function(t,e){const{metrics:n,attributes:i}=this,r=n.padding;n.milestonesCount=t.length,r.top+=t.length?i.milestonesSize:0,t.forEach((s,o)=>{const a=s.id,l=`milestone_${o}`,c=n.milestonesNameCache[l]!==void 0;if(a){const p=a!==l&&n.milestones[a]!==void 0;(n.milestonesNameCache[a]!==void 0||p)&&Mn("Duplicated milestone group id: "+a),n.milestonesNameCache[a]=l}c&&Mn("Duplicated milestone group id: "+l);const h=this.getMilestoneGroupMarkup(o,a);e.push(h);const u=this.getMilestoneHeaderMarkup(o,a),d=this.getMilestoneLabelMarkup(o,a),f=this.getMilestoneLineMarkup(o,a);n.milestones[l]={label:typeof s.label=="string"?s.label:"",indexWithin:o,size:Number.isFinite(s.size)?Math.max(s.size,0):void 0,customId:a},h.children.push(f),h.children.push(u),h.children.push(d)})},addLaneGroupMetrics:function(t,e){const n=`lanes_${t}`,{laneSize:i,customId:r}=e,{metrics:s}=this;if(s.lanesNameCache[n]!==void 0&&Mn("Duplicated lane group id: "+n),r!==null){const a=r!==n&&s.lanes[r]!==void 0;(s.lanesNameCache[r]!==void 0||a)&&Mn("Duplicated lane group id: "+r),s.lanesNameCache[r]=n}s.lanes[n]=e,Number.isFinite(i)&&(s.totalTakenHeightSpace+=i)},autoresize:function(t){const e=this.getMinimalSize(),n=this.attributes.size;this.resize(Math.max(e.width,n.width),Math.max(e.height,n.height),t)},getMinimalSize:function(){const{metrics:t}=this,e=t.padding;let n,i,r=0,s=0,o=0;const a=this.attributes.milestonesSize,l=t.lanes,c=t.milestones;return Object.keys(l).forEach(h=>{const u=l[h];let d=h,f=0;for(;d;){const p=t.lanes[d];f+=p.headerSize||0,d=p.parentId}r=f>r?f:r,u.nestLevel===1&&(s+=u.takenUpSpaceByLaneAndSublanes||0)}),Object.keys(c).forEach(h=>{o+=c[h].size||0}),n=r>o?r:o,i=t.milestonesCount&&a>s?0:s,{height:i+e.top+e.bottom,width:n+e.left+e.right}},getLaneGroupMarkup:function(t,e){const n=["laneGroups"];return e&&n.push(`lanes_${e}`),{tagName:"g",selector:`lanes_${t}`,groupSelector:n,attributes:{laneGroupId:`lanes_${t}`},children:[]}},getMilestoneGroupMarkup:function(t,e){const n=["milestoneGroups"];return e&&n.push(`milestone_${e}`),{tagName:"g",selector:`milestone_${t}`,groupSelector:n,attributes:{milestoneGroupId:`milestone_${t}`},children:[]}},getLaneMarkup:function(t,e){const n=["lanes"];return e&&n.push(`lane_${e}`),{tagName:"rect",selector:`lane_${t}`,groupSelector:n,children:[],attributes:{laneGroupId:`lanes_${t}`}}},getHeaderMarkup:function(t,e){const n=["laneHeaders"];return e&&n.push(`header_${e}`),{tagName:"rect",selector:`header_${t}`,groupSelector:n,attributes:{laneGroupId:`lanes_${t}`}}},getLabelMarkup:function(t,e){const n=["laneLabels"];return e&&n.push(`label_${e}`),{tagName:"text",selector:`label_${t}`,groupSelector:n,attributes:{laneGroupId:`lanes_${t}`}}},getMilestoneHeaderMarkup:function(t,e){const n=["milestoneHeaders"];return e&&n.push(`milestoneHeader_${e}`),{tagName:"rect",selector:`milestoneHeader_${t}`,groupSelector:n,attributes:{milestoneGroupId:`milestone_${t}`}}},getMilestoneLabelMarkup:function(t,e){const n=["milestoneLabels"];return e&&n.push(`milestoneLabel_${e}`),{tagName:"text",selector:`milestoneLabel_${t}`,groupSelector:n,attributes:{milestoneGroupId:`milestone_${t}`}}},getMilestoneLineMarkup:function(t,e){const n=["milestoneLines"];return e&&n.push(`milestoneLine_${e}`),{tagName:"line",selector:`milestoneLine_${t}`,groupSelector:n,attributes:{milestoneGroupId:`milestone_${t}`}}},getParentIndexesArray:function(t){let e=[],n=t;for(;n;)e.push(n),n=this.metrics.lanes[n].parentId;return e.reverse()},getFlexAndFixedLaneSizesWithinGroup:function(t){const{metrics:e}=this,n=e.lanes[t];let i=n.parentId,r=0,s=0,o=n.parentSublanesCount-1;for(i||(i="lanes",o=e.topLaneGroupsCount-1);o>=0;){const a=`${i}_${o}`,l=e.lanes[a];Number.isFinite(l.size)?r+=Math.max(l.size,l.takenUpSpaceByLaneAndSublanes):s++,o--}return{totalFixedSize:r,flexLanesWithinGroupCount:s}},getLaneWidth:function(t){const{metrics:e}=this,n=e.padding,i=this.getParentIndexesArray(t),r=this.attributes.size.width-n.left-n.right;let s=0;return i.forEach(o=>{const a=e.lanes[o];s+=a.headerSize}),Math.max(r-s,0)},getLaneHeight:function(t){const{metrics:e}=this,n=e.lanes[t],i=e.padding;let r=this.getParentIndexesArray(t);const s=this.attributes.size.height-i.top-i.bottom,o=n.parentId;let a=s;if(o){const d=e.lanes[o].sublanesCount;if(n.laneIndexWithinGroup===d-1){const{y:g}=this.getLaneContainerPosition(t),v=this.getLaneHeight(o);return Math.max(v-g,0)}}if(Number.isFinite(n.size))if(!o&&n.laneIndexWithinGroup===e.topLaneGroupsCount-1){const{y:u}=this.getLaneContainerPosition(t);return Math.max(this.attributes.size.height-u-i.bottom,0)}else{const u=n.takenUpSpaceByLaneAndSublanes;return Math.max(u,n.size,0)}const l=r.map(u=>u).reverse().find(u=>e.lanes[u].size);if(l){let u=r.map(f=>f);const d=u.indexOf(l);r=u.slice(d+1),a=e.lanes[l].size}r.forEach(u=>{const d=this.getFlexAndFixedLaneSizesWithinGroup(u),p=e.lanes[u].parentId,g=e.lanes[u].parentSublanesCount,v=e.topLaneGroupsCount;let x=0,S=0,C=(a-d.totalFixedSize)/(d.flexLanesWithinGroupCount||1),P=p?g-1:v-1;for(;P>=0;){const k=`${p||"lanes"}_${P}`;if(k===t){P--;continue}const N=e.lanes[k],m=N.takenUpSpaceByLaneAndSublanes;!N.size&&m>C&&(x+=m,S++),P--}a-=d.totalFixedSize+x,a/=Math.max(d.flexLanesWithinGroupCount-S,1)});const c=n.takenUpSpaceByLaneAndSublanes,h=c>a?c:a;return Math.max(h,0)},getMilestoneWidth:function(t){const{metrics:e}=this,n=e.padding,i=this.attributes.size.width-n.left-n.right,r=e.milestones[t],s=e.milestonesCount;if(Number.isFinite(r.size))return r.size;let o=s-1,a=0,l=0;for(;o>=0;){const h=`milestone_${o}`,u=e.milestones[h];Number.isFinite(u.size)&&(a+=u.size,l++),o--}const c=(i-a)/(s-l||1);return Math.max(c,0)},getLaneContainerPosition:function(t){const{metrics:e}=this,n=e.padding,i=e.lanes[t],{laneIndexWithinGroup:r,nestLevel:s,parentId:o}=i;let l=o?e.lanes[o].headerSize:0,c=0;s===1&&(l+=n.left,c+=n.top);let h=0,u=r-1;for(;u>=0;){const d=o?`${o}_${u}`:`lanes_${u}`;h+=this.getLaneHeight(d),u--}return new M(l,c+h)},getMilestoneContainerPosition:function(t){const{metrics:e}=this,i=e.milestones[t].indexWithin,r=e.padding;let s=i-1,o=0;for(;s>=0;){const h=`milestone_${s}`,u=this.getMilestoneWidth(h);o+=u,s--}const a=this.attributes.milestonesSize,l=o+r.left,c=r.top-a;return new M(l,c)},getLaneBBox:function(t){typeof t!="string"&&Mn("Expects id to be a string");const{metrics:e}=this,n=this.position();let i=e.lanes[t];if(i||(t=e.lanesNameCache[t],i=e.lanes[t]),!i)return null;const r=i.parentId,s=i.headerSize;let o={x:0,y:0};if(r){const u=this.getLaneBBox(r);o.x+=u.x-n.x,o.y+=u.y-n.y}const{x:a,y:l}=this.getLaneContainerPosition(t),c=this.getLaneWidth(t),h=this.getLaneHeight(t);return new Z({x:a+o.x+n.x,y:l+o.y+n.y,width:c+s,height:h})},getParentLaneId(t){const{lanes:e,lanesNameCache:n}=this.metrics,i=n.hasOwnProperty(t)?n[t]:t;i in e||Mn(`Lane with ID ${t} wasn't found`);const r=e[i];if(r.parentId===null)return null;const s=e[r.parentId];return s.customId!==null?s.customId:r.parentId},getLanesIds:function(){const{lanes:t}=this.metrics;return Object.keys(t).map(n=>{const{customId:i}=t[n];return i!==null?i:n})},getLaneMetrics(t){const{lanes:e,lanesNameCache:n}=this.metrics,i=t in n?n[t]:t;return e[i]||null},getMilestoneBBox:function(t){typeof t!="string"&&Mn("Expects id to be a string");const{metrics:e,attributes:n}=this,i=e.padding,r=e.milestones;let s=r[t];if(s||(t=e.milestonesNameCache[t],s=r[t]),!s)return null;const o=this.position(),a=this.getMilestoneWidth(t),l=n.milestonesSize,c=n.size.height-i.bottom-i.top+l,{x:h,y:u}=this.getMilestoneContainerPosition(t);return new Z(h+o.x,u+o.y,a,c)},getLanesFromPoint:function(t){t||Mn("A point is required");const e=this.getBBox(),n=e.center(),i=this.angle(),r=new M(t).rotate(n,i);if(!e.containsPoint(r))return[];const s=this.metrics,o=s.lanes,a=[],l=c=>{let h=c?o[c].sublanesCount-1:s.topLaneGroupsCount-1;for(;h>=0;){const u=c?`${c}_${h}`:`lanes_${h}`;if(this.getLaneBBox(u).containsPoint(r)){const f=o[u].customId;a.push(f||u),l(u);break}h--}};return l(),a.reverse()},getMilestoneFromPoint:function(t){t||Mn("A point is required");const e=this.metrics,n=this.getBBox(),i=this.angle(),r=new M(t).rotate(n.center(),i);if(!n.containsPoint(r))return null;let s=e.milestonesCount-1;for(;s>=0;){const o=`milestone_${s}`;if(this.getMilestoneBBox(o).containsPoint(r)){const l=e.milestones[o].customId;return l===void 0?o:l}s--}return null},getLanePath:function(t){let e=this.getLaneMetrics(t);if(e===null)return[];const i=this.metrics.lanes,r=[e.laneIndexWithinGroup];let s=e;for(;s.parentId;){const o=i[s.parentId].laneIndexWithinGroup;r.unshift(o,"sublanes"),s=i[s.parentId]}return r.unshift("lanes"),r},toJSON:function(){const t=Kt.prototype.toJSON.apply(this,arguments);return delete t.markup,t}},{attributes:{"lane-container-position":{position:function(t,e,n){const i=n.getAttribute("lane-group-id");return this.model.getLaneContainerPosition(i)}},"lane-size":{set:function(t,e,n){const{model:i}=this,r=n.getAttribute("lane-group-id"),s=i.getLaneWidth(r),o=i.getLaneHeight(r),a=i.metrics.lanes[r].headerSize;return{width:s+a,height:o}}},"header-size":{set:function(t,e,n){const i=n.getAttribute("lane-group-id"),s=this.model.metrics.lanes[i].headerSize,o=Math.max(this.model.getLaneHeight(i),0);return{width:s,height:o}}},"label-position":{position:function(t,e,n,i){const{model:r}=this,s=n.getAttribute("lane-group-id"),a=r.metrics.lanes[s].headerSize,l=r.getLaneHeight(s),{left:c,top:h,right:u,bottom:d}=Re(i["label-margin"]),f=l/2,p=a/2;switch(i["label-alignment"]){case on.topMiddle:return{x:h,y:f+c-u};case on.topLeft:return{x:h,y:l-u};case on.topRight:return{x:h,y:c};case on.leftMiddle:return{x:p+h-d,y:l-u};case on.rightMiddle:return{x:p+h-d,y:c};case on.bottomLeft:return{x:a-d,y:l-u};case on.bottomMiddle:return{x:a-d,y:f+c-u};case on.bottomRight:return{x:a-d,y:c};case on.center:default:return{x:p+h-d,y:f+c-u}}}},"lane-label":{set:function(t,e,n,i){if(!Ce(t))return null;const{model:r}=this,s=n.getAttribute("lane-group-id"),o=r.metrics.lanes[s],a=o.headerSize,l=r.getLaneHeight(s),c=o.label;return zv(this,t,n,i,l,a,c)}},"milestone-container-position":{position:function(t,e,n){const i=n.getAttribute("milestone-group-id");return this.model.getMilestoneContainerPosition(i)}},"milestone-header-size":{set:function(t,e,n){const{model:i}=this,r=n.getAttribute("milestone-group-id"),s=i.getMilestoneWidth(r),o=i.attributes.milestonesSize;return{width:s,height:o}}},"milestone-label-position":{position:function(t,e,n,i){const{model:r}=this,s=n.getAttribute("milestone-group-id"),o=r.getMilestoneWidth(s),a=r.attributes.milestonesSize,{left:l,top:c,right:h,bottom:u}=Re(i["label-margin"]),d=a/2,f=o/2;switch(i["label-alignment"]){case on.topMiddle:return{x:f+l-h,y:c};case on.topLeft:return{x:l,y:c};case on.topRight:return{x:o-h,y:c};case on.leftMiddle:return{x:l,y:d+c-u};case on.bottomLeft:return{x:l,y:a-u};case on.bottomMiddle:return{x:f+l-h,y:a-u};case on.bottomRight:return{x:o-h,y:a-u};case on.rightMiddle:return{x:o-h,y:d+c-u};case on.center:default:return{x:f+l-h,y:d+c-u}}}},"milestone-label":{set:function(t,e,n,i){if(!Ce(t))return null;const{model:r}=this,s=n.getAttribute("milestone-group-id"),o=r.metrics.milestones[s],a=r.getMilestoneWidth(s),l=r.attributes.milestonesSize,c=o.label;return zv(this,t,n,i,a,l,c)}},"milestone-line-position":{set:function(t,e,n){const{model:i}=this,r=i.position(),s=i.metrics.padding,o=i.attributes.milestonesSize,a=n.getAttribute("milestone-group-id"),{x:l,width:c,height:h}=i.getMilestoneBBox(a);let u="block";const d=e.width-s.right;return Math.ceil(l)-r.x+Math.ceil(c)>=d&&(u="none"),{x1:c,x2:c,y1:o,y2:h,display:u}}},"text-vertical":{set:function(){return{transform:"rotate(-90)"}}},"text-wrap":{set:function(t,e,n,i){if(i["text-vertical"]){const r=e.width;e.width=e.height,e.height=r}aa["text-wrap"].set.call(this,t,e,n,i)}},"label-margin":{},"label-alignment":{}}}),U4=lg.define("bpmn2.HeaderedPool",{padding:{top:0,left:30,right:0,bottom:0},attrs:{header:{width:30,refHeight:"100%",stroke:"#333333",strokeWidth:2,fill:"#ffffff",shapeRendering:"optimizespeed"},headerLabel:{textVertical:!0,textWrap:{width:-10,ellipsis:!0,maxLineCount:1},refX:15,refY:"50%",fontSize:20,fill:"#333333",fontFamily:"sans-serif",textAnchor:"middle",textVerticalAnchor:"middle"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerLabel"}]}),j4=lg.prototype.markupAttributes.reduce(function(t,e){return t[e]=["UPDATE","TOOLS"],t},{}),V_=Pe.extend({presentationAttributes:Pe.addPresentationAttributes(j4)}),W4=V_;function Mn(t){throw new Error("shapes.bpmn2.Pool: "+t)}const ch=Kt.define("bpmn2.Choregraphy",{type:"bpmn2.Choreography",size:{width:100,height:120},attrs:{root:{cursor:"move"},body:{width:"calc(w)",height:"calc(h)",strokeWidth:2,stroke:"#333333",fill:"#ffffff"},fo:{width:"calc(w)",height:"calc(h)"},participants:{participantY:!0},participantsBodies:{width:"calc(w)",height:20,strokeWidth:2,stroke:"#333333",fill:"#aaaaaa"},participantsLabels:{x:"calc(w / 2)",y:10,textAnchor:"middle",dominantBaseline:"central",fontSize:12,fontFamily:"sans-serif"},initiatingParticipantBody:{fill:"transparent"},content:{contentAlignment:!0,style:{textAlign:"center",verticalAlign:"middle",display:"table-cell",fontFamily:"sans-serif"},html:""},subProcess:{d:"M -8 -20 H 8 V -4 H -8 Z M -6 -12 H 6 M 0 -18 V -6",fill:"transparent",transform:"translate(calc(w / 2), 0)",subProcessY:!0,stroke:"#000000",strokeWidth:2}},subProcess:!1,participants:[],participantHeight:20,initiatingParticipant:0},{markup:[{tagName:"rect",selector:"body"},{tagName:"foreignObject",selector:"fo",children:[{tagName:"div",selector:"content",namespaceURI:"http://www.w3.org/1999/xhtml"}]},{tagName:"text",selector:"label"}],markupAttributes:["participants","initiatingParticipant","subProcess"],initialize:function(){Kt.prototype.initialize.apply(this,arguments),this.on("change",(t,e)=>this.onChange(e)),this.buildMarkup()},anyHasChanged:function(t){return Array.isArray(t)?t.some(function(e){return this.hasChanged(e)},this):!1},onChange:function(t){if(t.choreography!==this.id&&this.hasChanged("markup"))throw new Error("bpmn2.Choreography: Markup can not be modified.");this.anyHasChanged(this.markupAttributes)&&this.buildMarkup(t)},buildParticipantMarkup:function(t,e,n){const i={tagName:"g",groupSelector:"participants",attributes:{"participant-id":t}},r={tagName:"rect",groupSelector:"participantsBodies"},s={tagName:"text",groupSelector:"participantsLabels",textContent:e};return n&&(i.selector="initiatingParticipant",r.selector="initiatingParticipantBody",s.selector="initiatingParticipantLabel"),i.children=[r,s],i},buildSubProcessMarkup:function(){return{tagName:"path",selector:"subProcess"}},buildMarkup:function(t){const{initiatingParticipantIndex:e,participants:n}=this,i=n.map((o,a)=>{const l=a>e?-(n.length-a):a;return this.buildParticipantMarkup(l,o,a===e)}),r=this.markup.concat(...i);this.get("subProcess")&&r.push(this.buildSubProcessMarkup());const s=H({choreography:this.id,dry:!0},t);this.set("markup",r,s)}},{attributes:{"participant-y":{position(t,e,n){const{participantHeight:i}=this.model,r=parseInt(n.getAttribute("participant-id"),10);return{x:0,y:r<0?e.height+r*i:r*i}}},"sub-process-y":{position(t,e,n){const{participantHeight:i,participants:r,initiatingParticipantIndex:s}=this.model,o=i*(r.length-s-1);return{x:0,y:e.height-o}}},"content-alignment":{set(t,e,n){const{participantHeight:i,participants:r,initiatingParticipantIndex:s}=this.model,o=i*(s+1);n.style.paddingTop=`${o}px`,n.style.height=`${e.height-r.length*i}px`,n.style.width=`${e.width}px`}}}});Object.defineProperty(ch.prototype,"participants",{get(){const t=this.get("participants");return Array.isArray(t)?t:[]}});Object.defineProperty(ch.prototype,"initiatingParticipantIndex",{get(){const t=this.get("initiatingParticipant");return Number.isFinite(t)?t:this.participants.indexOf(t)}});Object.defineProperty(ch.prototype,"participantHeight",{get(){const t=this.get("participantHeight");return Number.isFinite(t)?t:20}});const Y4=Object.freeze(Object.defineProperty({__proto__:null,Activity:N4,Annotation:G4,AnnotationLink:H4,Choreography:ch,Conversation:R4,ConversationLink:$4,DataAssociation:D4,DataObject:M4,DataStore:L4,Event:I4,Flow:V4,Gateway:O4,Group:z4,HeaderedPool:U4,HeaderedPoolView:W4,Pool:lg,PoolView:V_},Symbol.toStringTag,{value:"Module"})),sd=q,X4=Kt.extend({useCSSSelectors:!0,markup:['<clipPath class="clip"><rect/></clipPath>','<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="axis">','<g class="y-axis"><path/><g class="ticks"></g></g>','<g class="x-axis"><path/><g class="ticks"></g></g>','<g class="markings"></g>',"</g>",'<g class="data"><g class="series"></g></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>','<line class="guideline x-guideline" /><line class="guideline y-guideline" />',"</g>","</g>"].join(""),tickMarkup:'<g class="tick"><line/><text/></g>',pointMarkup:'<g class="point"><circle/><text/></g>',barMarkup:'<path class="bar"/>',markingMarkup:'<g class="marking"><rect/><text/></g>',serieMarkup:'<g><clipPath class="serie-clip"><rect/></clipPath><path/><g class="bars"></g><g class="points"></g></g>',legendItemMarkup:'<g class="legend-item"><circle/><text/></g>',defaults:er({type:"chart.Plot",attrs:{root:{cursor:"move"},".data path":{fill:"none",stroke:"black"},".data .bars rect":{fill:"none",stroke:"black"},".background rect":{fill:"white",stroke:"#e5e5e5",opacity:1},".background text":{fill:"black",text:"No data available.",ref:".","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":10,"text-anchor":"middle","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":23,"text-anchor":"middle","y-alignment":"middle","font-size":10},".point":{display:"inline-block"},".point circle":{r:2,stroke:"black",fill:"black",opacity:.3},".point text":{fill:"black","font-size":8,"text-anchor":"middle",display:"none"},".axis path":{fill:"none",stroke:"black"},".axis .tick":{fill:"none",stroke:"black"},".y-axis .tick line":{fill:"none",stroke:"black",x2:2,y2:0,opacity:1},".x-axis .tick line":{fill:"none",stroke:"black",x2:0,y2:-3,opacity:1},".y-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"end"},".x-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"middle"},".y-axis .tick text > tspan":{dy:"-.5em",x:-5},".x-axis .tick text > tspan":{dy:".5em",x:0},".axis .markings":{fill:"black",stroke:"none","fill-opacity":1},".axis .markings text":{fill:"black","text-anchor":"end","font-size":10,dy:-5,dx:-5},".guideline":{"pointer-events":"none",display:"none"},".x-guideline":{stroke:"black",visibility:"hidden"},".y-guideline":{stroke:"black",visibility:"hidden"},".legend":{"ref-x":10,"ref-y":10},".legend-item text":{fill:"black",transform:"translate(14, 0)","font-size":11},".legend-item circle":{r:5,transform:"translate(5,5)"},".legend-item":{cursor:"pointer"},".legend-item.disabled circle":{fill:"gray"},".legend-item.disabled text":{opacity:.5}}},Kt.prototype.defaults),legendPosition:function(t,e){e=e||{},this.trigger("batch:start"),[".legend/ref-x",".legend/ref-y",".legend/ref-dx",".legend/ref-dy",".legend/x-alignment",".legend/y-alignment"].forEach(function(r){this.removeAttr(r,{silent:!0})},this);var n=e.padding||10,i={n:{".legend":{"ref-x":.5,"x-alignment":-.5,"ref-y":n}},ne:{".legend":{"ref-dx":-n,"x-alignment":-.999,"ref-y":n}},e:{".legend":{"ref-dx":-n,"x-alignment":-.999,"ref-y":.5,"y-alignment":-.5}},se:{".legend":{"ref-dx":-n,"ref-dy":-n,"x-alignment":-.999,"y-alignment":-.999}},s:{".legend":{"ref-x":.5,"ref-dy":-n,"x-alignment":-.5,"y-alignment":-.999}},sw:{".legend":{"ref-x":n,"ref-dy":-n,"y-alignment":-.999}},w:{".legend":{"ref-x":n,"ref-y":.5,"y-alignment":-.5}},nw:{".legend":{"ref-x":n,"ref-y":n}},nnw:{".legend":{"ref-x":n,"ref-y":-n,"y-alignment":-.999}},nn:{".legend":{"ref-x":.5,"ref-y":-n,"x-alignment":-.5,"y-alignment":-.999}},nne:{".legend":{"ref-dx":-n,"ref-y":-n,"x-alignment":-.999,"y-alignment":-.999}},nnee:{".legend":{"ref-dx":n,"ref-y":-n,"y-alignment":-.999}},nee:{".legend":{"ref-y":n,"ref-dx":n}},ee:{".legend":{"ref-dx":n,"ref-y":.5,"y-alignment":-.5}},see:{".legend":{"ref-dx":n,"ref-dy":-n,"y-alignment":-.999}},ssee:{".legend":{"ref-dx":n,"ref-dy":n}},sse:{".legend":{"ref-dx":-n,"ref-dy":n,"x-alignment":-.999}},ss:{".legend":{"ref-x":.5,"ref-dy":n,"x-alignment":-.5}},ssw:{".legend":{"ref-x":n,"ref-dy":n}},ssww:{".legend":{"ref-x":-n,"ref-dy":n,"x-alignment":-.999}},sww:{".legend":{"ref-x":-n,"ref-dy":-n,"x-alignment":-.999,"y-alignment":-.999}},ww:{".legend":{"ref-x":-n,"ref-y":.5,"x-alignment":-.999,"y-alignment":-.5}},nww:{".legend":{"ref-x":-n,"ref-y":n,"x-alignment":-.999}},nnww:{".legend":{"ref-x":-n,"ref-y":-n,"x-alignment":-.999,"y-alignment":-.999}}};i[t]&&this.attr(i[t]),this.trigger("batch:stop")},addPoint:function(t,e,n){n=n||{};var i=this.get("series"),r=pt(i).findIndex(function(o){return o.name===e});if(r===-1)throw new Error("Serie "+e+" was not found.");var s=Le(i[r]);s.data.push(t),Number.isFinite(n.maxLen)&&s.data.length>n.maxLen&&s.data.shift(),i=i.slice(),i[r]=s,this.set("series",i,n)},lastPoint:function(t){var e=pt(this.get("series")).find(function(n){return n&&n.name===t}).data;return e[e.length-1]},firstPoint:function(t){return pt(this.get("series")).find(function(e){return e&&e.name===t}).data[0]}}),q4=Pe.extend({events:{mousemove:"onMouseMove",mouseout:"onMouseOut"},presentationAttributes:Pe.addPresentationAttributes({series:["UPDATE"],interpolate:["UPDATE"],padding:["UPDATE"],canvas:["UPDATE"],markings:["UPDATE"],axis:["UPDATE"]}),initialize:function(){Pe.prototype.initialize.apply(this,arguments),this.on("cell:pointerdown",this.onPointerDown,this),this._disabledSeries=[]},renderMarkup:function(){Pe.prototype.renderMarkup.apply(this,arguments),this.elDataClipPath=this.$(".clip")[0],this.elDataClipPathRect=this.elDataClipPath.firstChild,this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForeground=this.$(".foreground")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elDataSeries=this.$(".data .series")[0],this.elYAxisPath=this.$(".y-axis path")[0],this.elYAxisTicks=this.$(".y-axis .ticks")[0],this.elXAxisPath=this.$(".x-axis path")[0],this.elXAxisTicks=this.$(".x-axis .ticks")[0],this.elMarkings=this.$(".axis .markings")[0],this.elXGuideline=this.$(".x-guideline")[0],this.elYGuideline=this.$(".y-guideline")[0],this.elLegend=this.$(".legend")[0],this.elLegendItems=this.$(".legend-items")[0],this.elTick=L(this.model.tickMarkup),this.elMarking=L(this.model.markingMarkup),this.elLegendItem=L(this.model.legendItemMarkup),this.elPoint=L(this.model.pointMarkup),this.elBar=L(this.model.barMarkup),this.elSerie=L(this.model.serieMarkup),this.elDataClipPath.id="clip_"+this.cid,L(this.$(".data")[0]).attr("clip-path","url(#"+this.elDataClipPath.id+")"),L(this.elMarkings).attr("clip-path","url(#"+this.elDataClipPath.id+")")},update:function(){var t=this.filterSeries();this.calculateStats(t);var e=this.model.get("size"),n=e.width,i=e.height;this.canvas=H({x:0,y:0,width:n,height:i},this.model.get("canvas"));var r,s={top:0,right:0,bottom:0,left:0},o=this.model.get("padding");Vt(o)?r=H({},s,o):o!==void 0?r={top:o,right:2*o,bottom:2*o,left:o}:r=s,this.canvas=xr(this.canvas).moveAndExpand(xr(r.left,r.top,-r.right,-r.bottom));var a={x:0,y:0,width:n,height:i};L(this.elDataClipPathRect).attr(a),L(this.elBackgroundRect).attr(a),L(this.elForegroundRect).attr(a),this.updateAxis(),this.updateMarkings(),this.isEmpty()?this.elBackgroundText.style.display="block":this.elBackgroundText.style.display="none",this.updateSeries(t),this.updateLegend(),Pe.prototype.update.apply(this,arguments)},calculateStats:function(t){t=t||this.model.get("series");var e=[],n=[],i={},r={},s={};pt(t).forEach(function(c,h){var u=s[c.name||h]||(s[c.name||h]={});u.decreasingX=!0,u.decreasingY=!0,u.nonDecreasingX=!0,u.nonDecreasingY=!0;var d;Jt(c.data,function(f){u.minX=u.minX===void 0?f.x:Math.min(u.minX,f.x),u.maxX=u.maxX===void 0?f.x:Math.max(u.maxX,f.x),u.minY=u.minY===void 0?f.y:Math.min(u.minY,f.y),u.maxY=u.maxY===void 0?f.y:Math.max(u.maxY,f.y),d&&(u.decreasingX=u.decreasingX&&f.x<d.x,u.decreasingY=u.decreasingY&&f.y<d.y,u.nonDecreasingX=u.nonDecreasingX&&f.x>=d.x,u.nonDecreasingY=u.nonDecreasingY&&f.y>=d.y),e.includes(f.x)||e.push(f.x),n.includes(f.y)||n.push(f.y),(i[f.x]||(i[f.x]=[])).push({serie:c,x:f.x,y:f.y}),(r[f.y]||(r[f.y]=[])).push({serie:c,x:f.x,y:f.y}),d=f})});var o=this.model.get("axis")||{},a=o["x-axis"]||{},l=o["y-axis"]||{};this.stats={minX:a.min===void 0?e.reduce(function(c,h){return h<c?h:c},1/0):a.min,maxX:a.max===void 0?e.reduce(function(c,h){return h>c?h:c},-1/0):a.max,minY:l.min===void 0?n.reduce(function(c,h){return h<c?h:c},1/0):l.min,maxY:l.max===void 0?n.reduce(function(c,h){return h>c?h:c},-1/0):l.max,bySerie:s,xValues:e,yValues:n,xMap:i,yMap:r}},isEmpty:function(){return!this.stats.xValues.length},updateSeries:function(t){if(t=t||this.model.get("series"),this.elDataSeries.textContent="",!this.isEmpty()){var e=[this.stats.minX,this.stats.maxX],n=[this.stats.minY,this.stats.maxY],i=[this.canvas.x,this.canvas.x+this.canvas.width],r=[this.canvas.y+this.canvas.height,this.canvas.y],s=this.model.get("attrs");pt(t).forEach(function(o,a){var l=o.data,c=[],h=this.elSerie.clone().attr("class",o.name||"serie-"+a);L(this.elDataSeries).append(h),Jt(l,(function(S){var C=Ze.linear(e,i,S.x),P=Ze.linear(n,r,S.y);c.push({x:C,y:P}),s[".point"]&&s[".point"].display!=="none"&&this.renderPoint(S,o),o.bars&&this.renderBar(S,o)}).bind(this));var u=h.findOne(".serie-clip"),d=this.model.get("size"),f=this.stats.bySerie[o.name||a],p=Ze.linear(e,i,f.minX),g=Ze.linear(e,i,f.maxX),v=u.findOne("rect");if(v.attr(xr(p,0,g-p,d.height)),!o.bars){var x=h.findOne("path");x.attr({d:this.seriePathData(c,o,a),"clip-path":"url(#"+u.node.id+")"})}},this)}},seriePathClipData:function(t,e){var n=10,i=this.model.get("size"),r=t[0],s=["M",r.x,r.y,"V",i.height+n];return s.join(" ")},renderBar:function(t,e){var n=[this.stats.minX,this.stats.maxX],i=[this.stats.minY,this.stats.maxY],r=[this.canvas.x,this.canvas.x+this.canvas.width],s=[this.canvas.y+this.canvas.height,this.canvas.y],o=Ze.linear(n,r,t.x),a=Ze.linear(i,s,t.y),l=e.bars.barWidth||.8,c=l>1?l:this.canvas.width/(this.stats.maxX-this.stats.minX)*l,h=Ze.linear(i,s,0)-a;i[0]===i[1]&&(a=this.canvas.y+this.canvas.height,h=0);var u=t["top-rx"]||e.bars["top-rx"],d=t["top-ry"]||e.bars["top-ry"],f=t["bottom-rx"]||e.bars["bottom-rx"],p=t["bottom-ry"]||e.bars["bottom-ry"],g={left:o,middle:o-c/2,right:o-c}[e.bars.align||"middle"],v=this.elBar.clone();v.attr({"data-serie":e.name,"data-x":t.x,"data-y":t.y,d:L.rectToPath({x:g,y:a,width:c,height:h,"top-rx":u,"top-ry":d,"bottom-rx":f,"bottom-ry":p})});var x=e.name||"serie-"+this.model.get("series").indexOf(e);return L(this.elDataSeries).findOne("."+x+" .bars").append(v),v.node},renderPoint:function(t,e){var n=[this.stats.minX,this.stats.maxX],i=[this.stats.minY,this.stats.maxY],r=[this.canvas.x,this.canvas.x+this.canvas.width],s=[this.canvas.y+this.canvas.height,this.canvas.y],o=Ze.linear(n,r,t.x),a=Ze.linear(i,s,t.y);i[0]===i[1]&&(a=this.canvas.y+this.canvas.height);var l=this.elPoint.clone();l.attr({"data-serie":e.name,"data-x":t.x,"data-y":t.y}),l.findOne("circle").attr({cx:o,cy:a}),l.findOne("text").attr({x:o,dy:a}).text(this.pointLabel(t,e));var c=e.name||"serie-"+this.model.get("series").indexOf(e);return L(this.elDataSeries).findOne("."+c+" .points").append(l),l.node},seriePathData:function(t,e,n){var i,r=t.length,s=[this.stats.minY,this.stats.maxY];if(s[0]===s[1])for(i=0;i<r;i++)t[i].y=this.canvas.y+this.canvas.height;var o,a=e.interpolate===void 0?this.model.get("interpolate"):e.interpolate;switch(a){case"bezier":o=new K(le.throughPoints(t));break;case"step":for(o=new K,o.appendSegment(K.createSegment("M",t[0].x,t[0].y)),i=1;i<r;i++)o.appendSegment(K.createSegment("L",(t[i-1].x+t[i].x)/2,t[i-1].y)),o.appendSegment(K.createSegment("L",(t[i-1].x+t[i].x)/2,t[i].y));o.appendSegment(K.createSegment("L",t[r-1].x,t[r-1].y));break;case"stepBefore":for(o=new K,o.appendSegment(K.createSegment("M",t[0].x,t[0].y)),i=1;i<r;i++)o.appendSegment(K.createSegment("L",t[i-1].x,t[i].y)),o.appendSegment(K.createSegment("L",t[i].x,t[i].y));break;case"stepAfter":for(o=new K,o.appendSegment(K.createSegment("M",t[0].x,t[0].y)),i=1;i<r;i++)o.appendSegment(K.createSegment("L",t[i].x,t[i-1].y)),o.appendSegment(K.createSegment("L",t[i].x,t[i].y));break;default:for(o=new K,o.appendSegment(K.createSegment("M",t[0].x,t[0].y)),i=1;i<r;i++)o.appendSegment(K.createSegment("L",t[i].x,t[i].y));break}return this.fixPathForFill(o,t,e,n).serialize()},fixPathForFill:function(t,e,n,i){if(e.length===0||n.hideFillBoundaries)return t;var r=this.stats.bySerie[n.name||i];if(!r.nonDecreasingX)return t;var s=t.getSegment(0);t.replaceSegment(0,K.createSegment("L",s.end.x,s.end.y));var o=n.fillPadding&&n.fillPadding.left||0,a=n.fillPadding&&n.fillPadding.right||0,l=n.fillPadding&&n.fillPadding.bottom||10,c=this.model.get("size"),h=e[0],u=e[e.length-1];return t.insertSegment(0,K.createSegment("M",u.x+a,c.height+l)),t.insertSegment(1,K.createSegment("L",h.x-o,c.height+l)),t.insertSegment(2,K.createSegment("L",h.x-o,h.y)),n.showRightFillBoundary&&(t.appendSegment(K.createSegment("L",u.x+a,u.y)),t.appendSegment(K.createSegment("Z"))),t},updateAxis:function(){var t=this.model.get("axis"),e=this.model.get("size"),n=e.height,i=e.width;if(L(this.elXAxisPath).attr("d",["M",0,n,"L",i,n].join(" ")),L(this.elYAxisPath).attr("d",["M",0,0,"L",0,n].join(" ")),this.elXAxisTicks.textContent="",this.elYAxisTicks.textContent="",this.isEmpty())return;var r=[this.stats.minX,this.stats.maxX],s=[this.stats.minY,this.stats.maxY],o=[this.canvas.x,this.canvas.x+this.canvas.width],a=[0,this.canvas.height],l=t&&t["y-axis"]||{},c=t&&t["x-axis"]||{};h.call(this,c,e,r,o),u.call(this,l,e,s,a);function h(g,v,x,S){var C=function(b,w,T){b.translate(w,T.height),L(this.elXAxisTicks).append(b)},P=function(b,w,T){return Ze.linear(b,w,T)},k=function(b){return b};if(!g.ticks){var N=this.stats.xValues;d.call(this,g,v,x,S,P,C,k,N);return}var m=this.canvas.width/(v.width-2*this.canvas.x);f.call(this,g,v,x,S,P,C,k,m)}function u(g,v,x,S){var C=function(m,b){m.translate(0,b),L(this.elYAxisTicks).append(m)},P=function(m,b,w){return m[0]===m[1]?this.canvas.y+this.canvas.height:Ze.linear(m,b,w)},k=function(m,b,w){var T=b[1]-(m-b[0]);return T+=Ze.linear(w,b,this.canvas.y)-b[0],T},N=this.canvas.height/v.height;f.call(this,g,v,x,S,P,C,k,N)}function d(g,v,x,S,C,P,k,N){N.forEach(function(m,b){b%(g.tickStep||1)===0&&p.call(this,g,v,x,S,C,P,k,m)},this)}function f(g,v,x,S,C,P,k,N){var m=x[1]-x[0],b=g.ticks||11;m===0&&(b=1);for(var w=m/b/N,T=x[0],E=0;E<b;E++)p.call(this,g,v,x,S,C,P,k,T),T+=w}function p(g,v,x,S,C,P,k,N){var m=this.elTick.clone(),b=C.call(this,x,S,N);if(!(b>v.width)){P.call(this,m,b,v);var w=k.call(this,N,x,S);m.findOne("text").text(this.tickLabel(w,g))}}},tickLabel:function(t,e){if(_t(e.tickFormat))return e.tickFormat(t);var n=e.tickFormat||".1f",i=nl.number(n,t);return i+(_t(e.tickSuffix)?e.tickSuffix(t):e.tickSuffix||"")},pointLabel:function(t,e){if(_t(e.pointFormat))return e.pointFormat(t);var n=e.pointFormat||".1f",i=nl.number(n,t.y);return i+(e.pointSuffix||"")},updateMarkings:function(){this.elMarkings.textContent="";var t=this.model.get("markings");if(!t||t.length===0)return;var e=this.model.get("size"),n=e.width,i=e.height,r=[this.stats.minX,this.stats.maxX],s=[this.stats.minY,this.stats.maxY],o=[this.canvas.x,this.canvas.x+this.canvas.width],a=[this.canvas.y,this.canvas.y+this.canvas.height];function l(c,h){return c===void 0?h:c}pt(t).forEach(function(c,h){var u=c.start||c.end,d=c.end||c.start,f=Math.min(l(u.x,this.stats.minX),l(d.x,this.stats.minX)),p=Math.max(l(u.x,this.stats.maxX),l(d.x,this.stats.maxX)),g=Math.min(l(u.y,this.stats.minY),l(d.y,this.stats.minY)),v=Math.max(l(u.y,this.stats.maxY),l(d.y,this.stats.maxY)),x=u.x===void 0||d.x===void 0,S=u.y===void 0||d.y===void 0;x&&(o=[0,n]),S&&(a=[0,i]);var C=Ze.linear(r,o,f),P=Ze.linear(r,o,p),k=Ze.linear(s,a,g),N=Ze.linear(s,a,v),m=C,b=a[1]-N+a[0],w=P-C,T=N-k;if(s[0]===s[1]&&g===v){if(s[0]!==g)return;b=this.canvas.y+this.canvas.height,T=1}w=Math.max(w,1),T=Math.max(T,1);var E=this.elMarking.clone();E.findOne("rect").attr({x:m,y:b,width:w,height:T}),E.findOne("text").text(c.label||"").attr({x:m+w,y:b});var D=E.attr("class")+" "+(c.name||"marking-"+h);E.attr(H({class:D},c.attrs)),L(this.elMarkings).append(E)},this)},updateLegend:function(){var t=this.model.get("series");this.elLegendItems.textContent="",pt(t).forEach(function(e,n){if(!(_t(e.showLegend)&&!e.showLegend(e,this.stats.bySerie[e.name||n]))&&e.showLegend!==!1){var i=this.elLegendItem.clone();this._disabledSeries.includes(e.name)&&i.addClass("disabled"),i.attr("data-serie",e.name),i.findOne("circle").attr({fill:this.getSerieColor(e.name)}),i.findOne("text").text(e.label||e.name),i.translate(0,n*(e.legendLabelLineHeight||16)),L(this.elLegendItems).append(i)}},this)},getSerieColor:function(t){var e=this.model.get("attrs"),n=Object.keys(e).find(function(i){return i.includes(t)});return n?e[n].stroke||e[n].fill:"black"},hideSerie:function(t){this._disabledSeries.includes(t)||this._disabledSeries.push(t);var e=this.filterSeries();this.update(e)},showSerie:function(t){this._disabledSeries=Vo(this._disabledSeries,t);var e=this.filterSeries();this.update(e)},filterSeries:function(t){return t=t||this.model.get("series"),t=pt(t).filter(function(e){return!this._disabledSeries.includes(e.name)},this),t},onPointerDown:function(t,e,n){var i=t.target.closest(".legend-item");i&&(L(i).toggleClass("disabled"),L(i).hasClass("disabled")?this.hideSerie(L(i).attr("data-serie")):this.showSerie(L(i).attr("data-serie")))},onMouseMove:function(t){this.showGuidelines(t.clientX,t.clientY,t)},onMouseOut:function(t){this.hideGuidelines(),this.trigger("mouseout",t)},showGuidelines:function(t,e,n){var i=this.model.get("angle"),r=this.model.getBBox(),s=new M(L(this.paper.layers).toLocalPoint(t,e)).rotate(r.center(),i);if(xr(r).containsPoint(s)){var o=this.model.get("size"),a=s.x-r.x,l=s.y-r.y;L(this.elXGuideline).attr({x1:a,y1:0,x2:a,y2:o.height,visibility:"visible"}),L(this.elYGuideline).attr({x1:0,y1:l,x2:o.width,y2:l,visibility:"visible"});var c=Ze.linear([this.canvas.x,this.canvas.x+this.canvas.width],[this.stats.minX,this.stats.maxX],a),h=Ze.linear([this.canvas.y,this.canvas.y+this.canvas.height],[this.stats.minY,this.stats.maxY],l),u={x:c,y:this.stats.minY+this.stats.maxY-h},d={x:t,y:e},f=this.closestPoints(c);this.trigger("mouseover",u,d,f,n)}},closestPoints:function(t){var e=ih(this.stats.xValues,t),n=this.stats.xValues[e],i=this.stats.xValues[e-1],r=i===void 0||Math.abs(t-n)<Math.abs(t-i)?n:i;return this.stats.xMap[r]},hideGuidelines:function(){L(this.elXGuideline).attr("visibility","hidden"),L(this.elYGuideline).attr("visibility","hidden")}}),zc=Kt.extend({useCSSSelectors:!0,markup:['<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="data"></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>',"</g>","</g>"].join(""),sliceMarkup:'<g class="slice"/>',sliceFillMarkup:'<path class="slice-fill"/>',sliceBorderMarkup:'<path class="slice-border"/>',sliceInnerLabelMarkup:'<text class="slice-inner-label"/>',legendSerieMarkup:'<g class="legend-serie"><text/></g>',legendSliceMarkup:'<g class="legend-slice"><circle/><text/></g>',defaults:er({type:"chart.Pie",size:{width:200,height:200},pieHole:0,serieDefaults:{startAngle:0,degree:360,label:null,showLegend:!0,labelLineHeight:6},sliceDefaults:{innerLabel:"{percentage:.0f}%",innerLabelMargin:6,legendLabel:"{label}: {value}",legendLabelLineHeight:6,legendLabelMargin:14,offset:0,onClickEffect:{type:"offset",offset:20},onHoverEffect:null},series:[],attrs:{root:{cursor:"move"},".background > rect":{opacity:0},".background > text":{fill:"black",text:"No data available.",ref:".background > rect","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":6,"text-anchor":"start","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":18,"text-anchor":"start","y-alignment":"middle","font-size":10},".data":{ref:".background","ref-x":.5,"ref-y":.5},".slice":{cursor:"pointer"},".slice > .slice-fill":{stroke:"#ffffff","stroke-width":1,"fill-opacity":1},".slice.hover > .slice-fill":{"fill-opacity":.8},".slice > .slice-border":{"stroke-width":6,"stroke-opacity":.4,"fill-opacity":1,fill:"none",display:"none"},".slice.hover > .slice-border":{display:"block"},".slice > .slice-inner-label":{"text-anchor":"middle","font-size":"12",stroke:"none","stroke-width":"0",fill:"#ffffff"},".slice > .slice-inner-label > tspan":{dy:"-.5em"},".legend":{"ref-dx":20,"ref-y":5},".legend-serie text":{fill:"grey",transform:"translate(2, 0)","font-size":13},".legend-slice":{cursor:"pointer"},".legend-slice text":{"font-weight":"normal",fill:"black","font-size":11},".legend-slice.hover text":{"font-weight":"bold"},".legend-slice circle":{r:5,transform:"translate(5,5)"}}},Kt.prototype.defaults),addSlice:function(t,e,n){n=n||{},e=e||0;var i=this.get("series");i[e]===void 0&&(i[e]={data:[]});var r=Le(i[e]);r.data.push(t),i=i.slice(),i[e]=r,n=r.data.length>1?H(n,{changedSerieIndex:e}):n,this.set("series",i,n)},editSlice:function(t,e,n,i){i=i||{},n=n||0;var r=this.get("series");if(r[n]===void 0||r[n].data[e]===void 0)throw new Error("Slice "+e+" on serie "+n+" was not found.");var s=Le(r[n]);s.data[e]=H(s.data[e],t),r=r.slice(),r[n]=s,this.set("series",r,H(i,{changedSerieIndex:n}))}}),z_=Pe.extend({events:{"mouseover .slice":"onMouseOverSlice","mouseout .slice":"onMouseOverSlice","mousemove .slice":"onMouseMoveSlice","mouseover .legend-slice":"onEventLegendItem","mouseout .legend-slice":"onEventLegendItem"},presentationAttributes:Pe.addPresentationAttributes({series:["UPDATE"],serieDefaults:["UPDATE"],sliceDefaults:["UPDATE"],pieHole:["UPDATE"]}),initialize:function(){Pe.prototype.initialize.apply(this,arguments),this.on("cell:pointerclick",this.onClickSlice,this),this.on("cell:pointerclick",this.onEventLegendItem,this)},renderMarkup:function(){Pe.prototype.renderMarkup.apply(this,arguments),this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elLegendItems=this.$(".legend-items")[0],this.elPie=this.$(".data")[0],this.elSlice=L(this.model.sliceMarkup),this.elSliceFill=L(this.model.sliceFillMarkup),this.elSliceBorder=L(this.model.sliceBorderMarkup),this.elSliceInnerLabel=L(this.model.sliceInnerLabelMarkup),this.elLegendSerie=L(this.model.legendSerieMarkup),this.elLegendSlice=L(this.model.legendSliceMarkup)},update:function(t,e,n){n=n||{};var i=n.changedSerieIndex,r=this.calculateSeries(i);i in r?sd(this.elPie).find(".serie-"+i).remove():sd(this.elPie).empty();var s=this.model.get("size");L(this.elBackgroundRect).attr(s),L(this.elForegroundRect).attr(s),r.length?this.elBackgroundText.style.display="none":this.elBackgroundText.style.display="block",pt(r).forEach(function(o,a){i!==void 0&&i!==a||Jt(o.data,this.updateSlice.bind(this))},this),this.updateLegend(),Pe.prototype.update.apply(this,arguments)},calculateSeries:function(t){var e=Le(this.model.get("series")),n=this.model.get("serieDefaults"),i=this.model.get("sliceDefaults"),r=this.model.get("size"),s=Math.min(r.width,r.height)/2,o=this.model.get("pieHole");o=o>1?o:s*o;var a=s,l=(s-o)/e.length;return this._series=e.map(function(c,h){if(t!==void 0&&t!==h)return c;c=me(c,n);var u=c.startAngle,d=c.data.reduce(function(g,v){return g+v.value},0),f=c.degree/d||0,p=100/d;return c.data=c.data.map(function(g,v){g=me(g,Qe(i,"offset","onClickEffect","onHoverEffect")),g.outerRadius=a,g.innerRadius=a-l,h||(g=me(g,tl(i,"offset","onClickEffect","onHoverEffect")),g.isOuter=!0,g.offset=g.offset>1?g.offset:g.offset*g.outerRadius,g.onClickEffect.offset=g.onClickEffect.offset>1?g.onClickEffect.offset:g.onClickEffect.offset*g.outerRadius),g.serieIndex=h,g.sliceIndex=v,g.innerLabelMargin=g.innerLabelMargin<-1||g.innerLabelMargin>1?g.innerLabelMargin:g.innerLabelMargin*g.outerRadius,g.percentage=g.value*p;var x=g.value*f;return g.degree={angle:x,start:u,end:x+u},g.rad={angle:un(g.degree.angle,!0),start:un(g.degree.start,!0),end:un(g.degree.end,!0)},g.middleangle=(g.rad.start+g.rad.end)/2,u=g.degree.end,g}),a-=l,c}),this._series},updateLegend:function(){var t=this._series;this.elLegendItems.textContent="";var e=0,n=parseInt(this.model.attr(".legend-serie text/font-size"),10),i=parseInt(this.model.attr(".legend-slice text/font-size"),10);pt(t).forEach(function(r,s){if(r.showLegend){if(r.label){var o=this.elLegendSerie.clone();r.name&&o.addClass(r.name),o.attr({"data-serie":s}),o.findOne("text").text(r.label),o.translate(0,e),L(this.elLegendItems).append(o),e+=n+r.labelLineHeight}Jt(r.data,(function(a,l){var c=this.elLegendSlice.clone(),h=this.getSliceFillColor(l,s);a.name&&c.addClass(a.name),c.attr({"data-serie":s,"data-slice":l}),c.findOne("text").text(nl.string(a.legendLabel,a)),c.findOne("text").translate(a.legendLabelMargin),c.translate(0,e),e+=i+a.legendLabelLineHeight,Vt(h)?this.applyGradient(c.node.querySelector("circle"),"fill",h):c.findOne("circle").attr({fill:h}),L(this.elLegendItems).append(c)}).bind(this))}},this)},applyGradient:function(t,e,n){var i=ne(t)?this.findNodes(t):sd(t).toArray(),r=this.paper.defineGradient(n);i.forEach(function(s){L(s).attr(e,"url(#"+r+")")})},updateSlice:function(t){var e=this.elSlice.clone();L(this.elPie).append(e);var n=this.elSliceFill.clone(),i=this.getSliceFillColor(t.sliceIndex,t.serieIndex);n.attr({fill:i,d:L.createSlicePathData(t.innerRadius,t.outerRadius,t.rad.start,t.rad.end)}),e.append(n),Vt(i)&&this.applyGradient("#"+n.attr("id"),"fill",i);var r=this.elSliceBorder.clone(),s=parseInt(this.model.attr(".slice > .slice-border/stroke-width"),10),o=oe.fromPolar(t.outerRadius+s/2,-t.rad.start,oe(0,0)),a=oe.fromPolar(t.outerRadius+s/2,-t.rad.end,oe(0,0));r.attr({stroke:i,d:this.drawArc(o,a,t.outerRadius+s/2,t.rad.start,t.rad.end)}),e.append(r),Vt(i)&&this.applyGradient("#"+r.attr("id"),"stroke",i);var l=this.elSliceInnerLabel.clone();l.text(nl.string(t.innerLabel,t)),e.append(l);var c=l.bbox(),h=t.outerRadius-c.width/2-t.innerLabelMargin;l.translate(h*Math.cos(-t.middleangle),-h*Math.sin(-t.middleangle)),e.attr({"data-serie":t.serieIndex,"data-slice":t.sliceIndex,"data-value":t.value});var u=this._series[t.serieIndex].name;return u&&e.addClass(u),t.name&&e.addClass(t.name),e.addClass("serie-"+t.serieIndex+" slice-"+t.sliceIndex),t.isOuter&&(e.addClass("outer"),t.offset&&(e.addClass("clicked"),this.effectOnSlice(e,t,{type:"offset",offset:t.offset}))),e},getSliceFillColor:function(t,e){e=e||0;var n=this.model.get("attrs"),i=Object.keys(n).find(function(r){return r.indexOf(".serie-"+e+".slice-"+t+" > .slice-fill")>-1});return i?n[i].fill:this._series[e].data[t].fill},onMouseMoveSlice:function(t){var e=L(t.currentTarget),n=e.attr("data-serie"),i=e.attr("data-slice"),r=this._series[n].data[i];this.trigger(t.type,r,t)},mouseOverSlice:function(t,e){e=e||0;var n=L(this.$('.slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]),i=this._series[e].data[t];n.toggleClass("hover"),i.isOuter&&!En(i.onHoverEffect)&&this.effectOnSlice(n,i,i.onHoverEffect,!n.hasClass("hover"));var r=L(this.$('.legend-slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]);r&&r.toggleClass("hover");var s=Object.keys(this.model.get("attrs")).filter(function(o){return o.indexOf(".slice")>-1||o.indexOf(".legend-slice")>-1});Pe.prototype.update.call(this,this.model,tl(this.model.get("attrs"),s))},onMouseOverSlice:function(t){var e=L(t.currentTarget),n=e.attr("data-serie"),i=e.attr("data-slice");this.mouseOverSlice(i,n);var r=this._series[n].data[i];this.trigger(t.type,r,t)},clickSlice:function(t,e){e=e||0;var n=L(this.$('.slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]),i=this._series[e].data[t];i.isOuter&&(n.hasClass("clicked")?(n.removeClass("clicked"),this.model.get("series")[e].data[t].offset=0,this.effectOnSlice(n,i,i.onClickEffect,!0)):(n.addClass("clicked"),this.model.get("series")[e].data[t].offset=i.onClickEffect.offset,this.effectOnSlice(n,i,i.onClickEffect)))},onClickSlice:function(t){var e=L(t.target.closest(".slice.outer"));if(e){var n=e.attr("data-serie"),i=e.attr("data-slice");this.clickSlice(i,n);var r=this._series[n].data[i];this.trigger(t.type,r,t)}},onEventLegendItem:function(t){var e=L(t.target.closest(".legend-slice"));if(e){var n=e.attr("data-serie"),i=e.attr("data-slice");switch(t.type){case"click":this.clickSlice(i,n);break;case"mouseover":case"mouseout":this.mouseOverSlice(i,n);break}}},effectOnSlice:function(t,e,n,i){switch(i=i||!1,n.type){case"enlarge":i?t.scale(1):t.scale(n.scale||1.05);break;case"offset":i?t.translate(0,0,{absolute:!0}):t.translate(n.offset*Math.cos(-e.middleangle),-n.offset*Math.sin(-e.middleangle));break}},svgArcMax:2*Math.PI-1e-6,drawArc:function(t,e,n,i,r){var s=0,o=1,a=r-i;return a>Math.PI&&(s=1,a>=this.svgArcMax&&(s=0,o=0)),"M"+t.x+","+t.y+" A"+n+","+n+" 0 "+s+","+o+" "+e.x+","+e.y}}),K4=zc.extend({defaults:er({type:"chart.Knob",sliceDefaults:{legendLabel:"{value:.0f}",outer:{offsetOnClick:0}},pieHole:.7,value:0,attrs:{".legend":{"ref-x":.5,"ref-y":.5,"ref-dx":null,"x-alignment":-.5,"y-alignment":-.5},".legend-slice text":{"font-size":30},".legend-slice circle":{display:"none"},".slice-inner-label":{display:"none"},".slice-fill":{stroke:"none"}}},zc.prototype.defaults),initialize:function(){this.set("series",this.getKnobSeries(),{silent:!0}),zc.prototype.initialize.apply(this,arguments),this.on("change:value change:min change:max change:fill",this.updateKnob,this)},getKnobSeries:function(){var t=Array.isArray(this.get("value"))?this.get("value"):[this.get("value")],e=Array.isArray(this.get("fill"))?this.get("fill"):[this.get("fill")],n=Array.isArray(this.get("min"))?this.get("min"):[this.get("min")],i=Array.isArray(this.get("max"))?this.get("max"):[this.get("max")],r=t.map(function(s,o){var a=n[o]===void 0?n[0]:n[o],l=i[o]===void 0?i[0]:i[o],c=e[o]===void 0?e[0]:e[o];return{degree:Ze.linear([a,l],[0,360],s),data:[{value:s,fill:c}],showLegend:!(o>0)}});return r},updateKnob:function(){this.set("series",this.getKnobSeries())}}),Z4=z_,J4=Kt.extend({useCSSSelectors:!0,markup:['<g class="rotatable">','<g class="scalable">','<g class="background"><rect/></g>','<g class="cells"/>','<g class="foreground"/>',"</g>",'<g class="labels">','<g class="rows"/>','<g class="columns"/>',"</g>","</g>"].join(""),cellMarkup:'<rect class="cell"/>',labelMarkup:'<text class="label"/>',gridLineMarkup:'<path class="grid-line"/>',defaults:er({type:"chart.Matrix",attrs:{root:{cursor:"move"},".background rect":{fill:"#eeeeee"},".grid-line":{stroke:"white","stroke-width":2},".label":{fill:"black","alignment-baseline":"middle"},".labels .rows .label":{"text-anchor":"end"},".labels .columns .label":{"text-anchor":"start"}}},Kt.prototype.defaults)}),Q4=Pe.extend({presentationAttributes:Pe.addPresentationAttributes({size:["LABELS"],cells:[Pe.Flags.RENDER]}),confirmUpdate:function(t,e){return this.hasFlag(t,"LABELS")&&!this.hasFlag(t,Pe.Flags.RENDER)&&(this.renderLabels(),t=this.removeFlag(t,"LABELS")),Pe.prototype.confirmUpdate.call(this,t,e)},renderMarkup:function(){Pe.prototype.renderMarkup.apply(this,arguments),this.elCells=this.$(".cells")[0],this.elRowLabels=this.$(".labels .rows")[0],this.elColumnLabels=this.$(".labels .columns")[0],this.elForeground=this.$(".foreground")[0],this.elCell=L(this.model.cellMarkup),this.elGridLine=L(this.model.gridLineMarkup);var t=this.model.get("cells")||[],e=this.model.get("size");if(this.elBackgroundRect=this.$(".background rect")[0],L(this.elBackgroundRect).attr(e),!(!Array.isArray(t)||t.length===0||!Array.isArray(t[0])||t[0].length===0)){var n=e.height/t.length,i=e.width/t[0].length,r=document.createDocumentFragment();this.elCells.textContent="",this.elForeground.textContent="";for(var s=document.createDocumentFragment(),o,a,l,c,h,u=0;u<t.length;u++)for(l=this.elGridLine.clone(),l.addClass("horizontal"),l.attr("d","M 0 "+u*n+" "+e.width+" "+u*n),s.appendChild(l.node),o=t[u],a=0;a<o.length;a++)u===0&&(l=this.elGridLine.clone(),l.addClass("vertical"),l.attr("d","M "+a*i+" 0 "+a*i+" "+e.height),s.appendChild(l.node)),c=o[a],c&&(h=this.elCell.clone(),h.attr(H({x:a*i,y:u*n,width:i,height:n},c)),r.appendChild(h.node));this.elForeground.appendChild(s),this.elCells.appendChild(r),this.renderLabels()}},renderLabels:function(){this.elLabel=L(this.model.labelMarkup);var t=this.model.get("cells")||[];if(!(!Array.isArray(t)||t.length===0||!Array.isArray(t[0])||t[0].length===0)){var e=this.model.get("labels")||{},n=e.rows||[],i=e.columns||[],r=this.model.get("size"),s=r.height/t.length,o=r.width/t[0].length,a,l;this.elRowLabels.textContent="",this.elColumnLabels.textContent="";for(var c=document.createDocumentFragment(),h=0;h<n.length;h++)a=e.rows[h],l=this.elLabel.clone(),l.text(a.text),l.attr(H({x:-(e.padding||5),y:h*s+s/2,"text-anchor":"end","dominant-baseline":"central","font-size":s,"data-row":h},Qe(a,"text"))),c.appendChild(l.node);this.elRowLabels.appendChild(c);for(var u,d,f=document.createDocumentFragment(),p=0;p<i.length;p++)a=e.columns[p],l=this.elLabel.clone(),u=p*o+o/2,d=-(e.padding||5),l.attr("x",u),l.text(a.text),l.attr(H({y:d,"text-anchor":"start","dominant-baseline":"central","font-size":o,"data-column":p},Qe(a,"text"))),l.rotate(-90,u,d),f.appendChild(l.node);this.elColumnLabels.appendChild(f)}}}),tz=Object.freeze(Object.defineProperty({__proto__:null,Knob:K4,KnobView:Z4,Matrix:J4,MatrixView:Q4,Pie:zc,PieView:z_,Plot:X4,PlotView:q4},Symbol.toStringTag,{value:"Module"})),{Link:G_,attributes:H_}=L_,ez=new M(1,0),nz=G_.define("measurement.Distance",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",targetMarker:{type:"path","stroke-width":2,d:"M 0 10 0 -10 M 10 10 0 0 10 -10",fill:"none"},sourceMarker:{type:"path","stroke-width":2,d:"M 0 10 0 -10 M 10 10 0 0 10 -10",fill:"none"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"},anchorLines:{stroke:"#333333",strokeWidth:1,strokeDasharray:"1,2"},sourceAnchorLine:{dAnchor:"source"},targetAnchorLine:{dAnchor:"target"},distanceLabel:{distanceText:{unit:"px",fixed:0},fontFamily:"sans-serif",fontWeight:"lighter",fontSize:14,labelPosition:{ratio:.5,offset:12},textAnchor:"middle",textVerticalAnchor:"middle"}}},{markup:[{tagName:"path",selector:"sourceAnchorLine",groupSelector:"anchorLines"},{tagName:"path",selector:"targetAnchorLine",groupSelector:"anchorLines"},{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}},{tagName:"text",selector:"distanceLabel"}],getDistanceText:function(t,e={}){const{fixed:n=0,unit:i=""}=e,r=t.getConnectionLength().toFixed(n);return i?`${r} ${i}`:`${r}`}},{attributes:{"distance-text":{set:function(t,...e){H_.text.set.call(this,this.model.getDistanceText(this,t),...e)}},"d-anchor":{set:function(t){return{d:`M ${new gt(this.getEndAnchor(t),this.getEndConnectionPoint(t)).serialize()}`}}},"label-position":{set:function(t){const{ratio:e=.5,offset:n=0}=t;let i,r;const s=this.getTangentAtRatio(e);s?(r=s.vector().vectorAngle(ez),i=s.start):(i=this.path.start,r=0);let o,a=n;if(r===0)o=`translate(${i.x},${i.y})`;else{const l=nn((r+90)%180-90);r!==l&&(a=-n),o=`translate(${i.x},${i.y}) rotate(${l})`}return{transform:o,y:a}}}}}),Co={self:"self",source:"source",target:"target"},Ee={clockwise:"clockwise",anticlockwise:"anticlockwise",small:"small",large:"large"},iz=G_.define("measurement.Angle",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"},angles:{stroke:"#333333",fill:"none",strokeWidth:1,angleRadius:40},sourceAngle:{angleD:"source"},targetAngle:{angleD:"target"},angleLabels:{textAnchor:"middle",textVerticalAnchor:"middle",fill:"#333333",fontSize:11,fontFamily:"sans-serif",angleTextDecimalPoints:0,angleTextDistance:23},sourceAngleLabel:{angleText:"source",angleTextPosition:"source"},targetAngleLabel:{angleText:"target",angleTextPosition:"target"}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}},{tagName:"path",selector:"sourceAngle",groupSelector:"angles",attributes:{cursor:"pointer"}},{tagName:"path",selector:"targetAngle",groupSelector:"angles",attributes:{cursor:"pointer"}},{tagName:"text",selector:"sourceAngleLabel",groupSelector:"angleLabels"},{tagName:"text",selector:"targetAngleLabel",groupSelector:"angleLabels"}],getAngleText:function(t={}){const{angle:e=0,decimalPoints:n=2}=t;return`${e.toFixed(n)}`}},{AngleStarts:Co,AngleDirections:Ee,attributes:{"angle-d":{set:function(t,e,n,i){const{"angle-radius":r=40,"angle-start":s=Co.self,"angle-pie":o=!1,"angle-direction":a=Ee.small,angle:l}=i,c=od(this,t,{angle:l,angleRadius:r,angleStart:s,angleDirection:a});if(!c)return{d:"M 0 0 0 0"};const{connectionPoint:h,linkArcPoint:u,otherArcPoint:d,arcAngle:f,largeArcFlag:p,sweepFlag:g}=c,v=[`M ${u.serialize()}`,`A ${r} ${r} ${f} ${p} ${g} ${d.serialize()}`];return o&&v.push(`L ${h.serialize()} Z`),{d:v.join(" ")}}},"angle-text":{set:function(t,e,n,i){let r="";const s=od(this,t,{angleRadius:40});s&&(r=this.model.getAngleText({angle:s.angleBetween,decimalPoints:i["angle-text-decimal-points"]})),H_.text.set.call(this,r,e,n,i)}},"angle-text-position":{set:function(t,e,n,i){const{"angle-text-distance":r=60}=i,s=od(this,t,{angleRadius:r});if(!s)return{};const{connectionPoint:o,otherArcPoint:a,linkArcPoint:l,angleBetween:c,largeArcFlag:h}=s;let u;if(Math.abs(c-180)<1e-6){const p=l.clone().rotate(o,h?90:-90);u=new gt(o,p).setLength(r)}else{const p=new gt(l,a).midpoint();u=new gt(o,p).setLength(r),h&&u.scale(-1,-1,u.start)}const d=u.end,f=nn((u.angle()+90)%180-90);return{transform:`translate(${d.serialize()}) rotate(${f})`}}},angle:{},"angle-radius":{},"angle-text-distance":{},"angle-text-decimal-points":{},"angle-pie":{},"angle-start":{},"angle-direction":{}}});function od(t,e,n){let i;const r="angleData",s=t.nodeCache(t.el);if(r in s){if(e in s[r])return s[r][e]}else s[r]={};const o=typeof n.angle=="number",a=t.getEndView(e);if(!a&&!o)return null;const l=e==="target",c=t.getTangentAtRatio(l?1:0);if(!c)return null;if(l&&c.scale(-1,-1,c.start),o)i=rz(c,n);else if(a.model.isLink())i=sz(c,a,n);else{const h=t.getEndMagnet(e);i=oz(c,a,h,n)}return s.angleData[e]=i,i}function rz(t,{angle:e,angleRadius:n}){const i=t.clone().rotate(t.start,-e);return U_(t,i,{angleRadius:n,angleStart:Co.target,angleDirection:e<0?Ee.clockwise:Ee.anticlockwise})}function sz(t,e,n){const i=e.getClosestPointLength(t.start),r=e.getTangentAtLength(i);return U_(t,r,n)}function U_(t,e,{angleRadius:n,angleStart:i,angleDirection:r}){const{start:s,end:o}=t.setLength(n),a=t.angle();let{end:l}=e.setLength(n),c=s.angleBetween(o,l),h=1,u=0,d=!1,f=!1,p=!0;const g=Math.floor(c/90);switch(i){case Co.target:{switch(r===Ee.small?r=c<180?Ee.clockwise:Ee.anticlockwise:r===Ee.large&&(r=c>180?Ee.clockwise:Ee.anticlockwise),r){case Ee.anticlockwise:{c>0&&c<180&&(u^=1),f=!0;break}default:case Ee.clockwise:{c>=180&&(u^=1),h^=1;break}}p=!1;break}case Co.source:{switch(r===Ee.small?r=c>180?Ee.clockwise:Ee.anticlockwise:r===Ee.large&&(r=c<180?Ee.clockwise:Ee.anticlockwise),r){case Ee.anticlockwise:{c>180&&(u^=1),h=1,f=!0;break}default:case Ee.clockwise:{c<180&&(u^=1),h=0;break}}p=!1,d=!0,c=nn(c+180);break}default:case Co.self:{switch(r){case Ee.anticlockwise:{d=g===0||g===1,h=1,f=!0;break}case Ee.clockwise:{d=g===2||g===3,h=0,f=!1;break}case Ee.small:{d=g===1||g===2,h=g===0||g===2?0:1,f=g===1||g===3;break}case Ee.large:{d=g===0||g===3,h=g===1||g===3?0:1,f=g===0||g===2;break}}break}}return d&&(l=l.reflection(s)),p&&c>=180&&(c=nn(c-180)),f&&(c=nn((p?180:360)-c)),{angleBetween:c,connectionPoint:s,linkArcPoint:o,otherArcPoint:l,largeArcFlag:u,sweepFlag:h,arcAngle:a}}function oz(t,e,n,{angleRadius:i,angleDirection:r}){const{model:s}=e,o=s.getBBox(),a=s.angle(),l=o.center(),c=e.getNodeUnrotatedBBox(n),{end:h}=t.clone().setLength(1),u=h.rotate(l,a);if(c.containsPoint(u))return null;let d=0,f=0,p=t.angle()-a;u.y>c.y+c.height||u.y<c.y?(p+=90,d=i):f=i,p=nn(p);let g;const v=Math.floor(p/90);switch(v){case 0:{g=1;break}case 1:{g=0;break}case 2:{d*=-1,f*=-1,g=1;break}case 3:{d*=-1,f*=-1,g=0;break}}let x=!1;switch(r){case Ee.large:x=!0;break;case Ee.anticlockwise:x=v===0||v===2;break;case Ee.clockwise:x=v===1||v===3;break}x&&(d*=-1,f*=-1,g^=1);const S=0,{start:C,end:P}=t.setLength(i),k=C.clone().offset(d,f).rotate(C,-a);let N=C.angleBetween(P,k);return N>180&&(N=360-N),{arcAngle:p,angleBetween:N,sweepFlag:g,largeArcFlag:S,otherArcPoint:k,linkArcPoint:P,connectionPoint:C}}const az=Object.freeze(Object.defineProperty({__proto__:null,Angle:iz,Distance:nz},Symbol.toStringTag,{value:"Module"})),lz=gn.extend({defaults:{linkDistance:10,linkStrength:1,charge:10,x:0,y:0},cacheAttribute:"_fcache",initialize:function(){var t=this.get("graph"),e,n;if(Array.isArray(t)){var i=t;e=[],n=[];for(var r=0,s=i.length;r<s;r++){var o=i[r];o.isLink()?e.push(o):n.push(o)}}else n=t.getElements(),e=t.getLinks();this.links=e,this.elements=n,this.x=this.get("x"),this.y=this.get("y"),this.width=this.get("width"),this.height=this.get("height"),this.gravityCenter=this.get("gravityCenter"),this.t=1,this.energy=1/0,this.progress=0},start:function(){var t=this.width,e=this.height,n=this.x,i=this.y;this.elements.forEach(function(r){var s=Za(n,n+t),o=Za(i,i+e);r.position(s,o,{forceDirected:!0});var a=r[this.cacheAttribute]={};a.charge=r.get("charge")||this.get("charge"),a.weight=r.get("weight")||1,a.x=a.px=s,a.y=a.py=o,a.fx=0,a.fy=0},this),this.links.forEach(function(r){var s=r[this.cacheAttribute]={};s.source=r.getSourceElement(),s.target=r.getTargetElement(),s.strength=r.get("strength")||this.get("linkStrength"),s.distance=r.get("distance")||this.get("linkDistance")},this)},step:function(){if(this.t*.99<.005)return this.notifyEnd();var t=this.cacheAttribute,e=this.width,n=this.height,i=this.x,r=this.y,s=.1,o=this.gravityCenter,a=this.energy;this.energy=0;var l=0,c=0,h=0,u=0,d,f,p=this.elements.length,g=this.links.length,v,x,S,C,P,k,N,m,b;for(d=0;d<p-1;d++)for(v=this.elements[d][t],l+=v.x,c+=v.y,f=d+1;f<p;f++)x=this.elements[f][t],S=x.x-v.x,C=x.y-v.y,P=S*S+C*C,k=Math.sqrt(P),N=this.t*v.charge/P,m=N*S,b=N*C,v.fx-=m,v.fy-=b,x.fx+=m,x.fy+=b,this.energy+=m*m+b*b;var w=this.elements[p-1][t];l+=w.x,c+=w.y;var T,E,D;for(d=0;d<g;d++)T=this.links[d][t],v=T.source[t],x=T.target[t],S=x.x-v.x,C=x.y-v.y,P=S*S+C*C,k=Math.sqrt(P),E=this.t*T.strength*(k-T.distance)/k,m=E*S,b=E*C,D=v.weight/(v.weight+x.weight),v.x+=m*(1-D),v.y+=b*(1-D),x.x-=m*D,x.y-=b*D,this.energy+=m*m+b*b;var $,z,j;for(d=0;d<p;d++){$=this.elements[d],z=$[t],j={x:z.x,y:z.y},o&&(j.x+=(o.x-j.x)*this.t*s,j.y+=(o.y-j.y)*this.t*s),j.x+=z.fx,j.y+=z.fy,j.x=Math.max(i,Math.min(i+e,j.x)),j.y=Math.max(r,Math.min(i+n,j.y));var O=.9;j.x+=(z.px-j.x)*O,j.y+=(z.py-j.y)*O,z.px=j.x,z.py=j.y,z.fx=z.fy=0,z.x=j.x,z.y=j.y,h+=z.x,u+=z.y,this.notify($,d,j)}this.t=this.cool(this.t,this.energy,a);var B=l-h,V=c-u,F=Math.sqrt(B*B+V*V);F<1&&this.notifyEnd()},cool:function(t,e,n){if(e<n){if(this.progress+=1,this.progress>=5)return this.progress=0,t/.99}else return this.progress=0,t*.99;return t},notify:function(t,e,n){t.set("position",n,{forceDirected:!0})},notifyEnd:function(){this.trigger("end")}});function cz(t,e,n){const{size:i,position:r}=e;if(i){const{width:s,height:o}=i;t.resize(s,o,n)}if(r){const{x:s,y:o}=r;t.position(s,o,n)}}const of={layout:function(t,e){var n;t instanceof On?n=t:n=new On().resetCells(t,{dry:!0,sort:!1}),t=null,e=e||{};var i=n.getElements(),r=e.columns||1,s=Math.ceil(i.length/r),o=e.verticalAlign||"middle",a=e.horizontalAlign||"middle",l=!!e.resizeToFit,c=e.marginX||0,h=e.marginY||0,u=e.columnGap||0,d=e.rowGap||0,f=e.setAttributes;typeof f!="function"&&(f=cz);var p=[],g=e.columnWidth;if(g==="compact")for(var v=0;v<r;v++){var x=this._elementsAtColumn(i,v,r);p.push(this._maxDim(x,"width"))}else{(!g||ne(g))&&(g=this._maxDim(i,"width"));for(var S=0;S<r;S++)p.push(g)}var C=this._accumulate(p,c).map((E,D)=>E+(D-.5)*u),P=[],k=e.rowHeight;if(k==="compact")for(var N=0;N<s;N++){var m=this._elementsAtRow(i,N,r);P.push(this._maxDim(m,"height"))}else{(!k||ne(k))&&(k=this._maxDim(i,"height"));for(var b=0;b<s;b++)P.push(k)}var w=this._accumulate(P,h).map((E,D)=>E+(D-.5)*d);n.startBatch("layout"),i.forEach(function(E,D){var $=D%r,z=Math.floor(D/r),j=p[$],O=P[z],B=0,V=0,F=E.get("size"),At={};if(l){var vt=j,zt=O,re=F.height*(F.width?vt/F.width:1),wt=F.width*(F.height?zt/F.height:1);re>O?vt=wt:zt=re,F={width:vt,height:zt},At.size=F}switch(o){case"top":break;case"bottom":V=O-F.height;break;case"middle":V=(O-F.height)/2;break}switch(a){case"left":break;case"right":B=j-F.width;break;case"middle":B=(j-F.width)/2;break}At.position={x:C[$]+B+u/2,y:w[z]+V+d/2},f.call(n,E,At,e)}),n.stopBatch("layout"),r>0&&(C[0]+=u/2,C[r]-=u/2),s>0?(w[0]+=d/2,w[s]-=d/2):w.length===0&&(w=[h,h]);const T=new Z(c,h,C[r]-C[0],w[s]-w[0]);return{rowHeights:P,columnWidths:p,gridY:w,gridX:C,bbox:T}},_maxDim:function(t,e){return t.reduce(function(n,i){return Math.max(i.get("size")[e],n)},0)},_elementsAtRow:function(t,e,n){for(var i=[],r=n*e,s=Math.min(r+n,t.length);r<s;r++)i.push(t[r]);return i},_elementsAtColumn:function(t,e,n){for(var i=[],r=e,s=t.length;r<s;r+=n)i.push(t[r]);return i},_accumulate:function(t,e){return t.length===0?[]:t.reduce(function(n,i,r){return n.push(n[r]+i),n},[e||0])}},Wn={TopBottom:"TB",BottomTop:"BT",LeftRight:"LR",RightLeft:"RL"},wc={Start:"start",Middle:"middle",End:"end"},uz=(t,e,n)=>{const{size:i,position:r}=e;if(i){const{width:s,height:o}=i;t.resize(s,o,n)}if(r){const{x:s,y:o}=r;t.position(s,o,n)}},fn={Directions:Wn,Alignments:wc,layout:function(t,e={}){const{direction:n=Wn.TopBottom,topLeft:i,bottomLeft:r,topRight:s,bottomRight:o,stackGap:a=10,stackElementGap:l=10,stackSize:c=100,stackCount:h,setAttributes:u=uz,alignment:d=wc.Middle,stackIndexAttributeName:f="stackIndex",stackElementIndexAttributeName:p="stackElementIndex"}=e;let g,v,x;t instanceof On?(v=t.getElements(),x=t):(v=t,v[0]&&(x=v[0].graph)),h?g=Array(h).fill(null).map(()=>Array()):g=[],v.forEach(E=>{const D=E.get(f)||0;g[D]||(g[D]=[]),g[D].push(E)});const S=n===Wn.TopBottom||n===Wn.BottomTop,C=n===Wn.LeftRight||n===Wn.RightLeft,P=g.length;let k,N;S&&(k=g.reduce((E,D)=>Math.max(E,D.reduce(($,z)=>$+z.size().height,0)+(D.length-1)*l),0),N=P*c+(P-1)*a),C&&(N=g.reduce((E,D)=>Math.max(E,D.reduce(($,z)=>$+z.size().width,0)+(D.length-1)*l),0),k=P*c+(P-1)*a);const b=(()=>i?new Z(i.x,i.y,N,k):s?new Z(s.x-N,s.y,N,k):r?new Z(r.x,r.y-k,N,k):o?new Z(o.x-N,o.y-k,N,k):new Z(0,0,N,k))(),w=b.topLeft(),T=[];for(let E=0;E<g.length;E++)g[E]=tn(g[E],D=>D.get(p)||0),S&&(T.push({bbox:new Z(w.x,w.y,c,k),elements:g[E],index:E}),w.x+=c+a),C&&(T.push({bbox:new Z(w.x,w.y,N,c),elements:g[E],index:E}),w.y+=c+a);x&&x.startBatch("layout");for(let E=0;E<T.length;E++){const D=T[E];if(D.elements.length){const $=D.bbox.topLeft();n===Wn.BottomTop&&($.y+=D.bbox.height),n===Wn.RightLeft&&($.x+=D.bbox.width),D.elements.forEach(z=>{const j=z.size();n===Wn.BottomTop&&($.y-=j.height),n===Wn.RightLeft&&($.x-=j.width);const O=$.toJSON();switch(d){case wc.Middle:{S?O.x+=(c-j.width)/2:O.y+=(c-j.height)/2;break}case wc.End:{S?O.x+=c-j.width:O.y+=c-j.height;break}}u(z,{position:O},e),n===Wn.BottomTop&&($.y-=l),n===Wn.TopBottom&&($.y+=j.height+l),n===Wn.RightLeft&&($.x-=l),n===Wn.LeftRight&&($.x+=j.width+l)})}}return x&&x.stopBatch("layout"),{bbox:b,stacks:T}}};function uh(t,e,n){n=me(n||{},{siblingGap:0}),this.width=0,this.height=0,this.layoutAreas=this.sortLayoutAreas(t),this.parentArea=e,this.siblingGap=n.siblingGap,this.exists()&&this.computeSize(n)}H(uh.prototype,{sortLayoutAreas:function(t){var e=tn(t,"siblingRank");return e.forEach(function(n,i){n.siblingRank=i}),e},move:function(t,e){for(var n=0,i=this.layoutAreas.length;n<i;n++)this.layoutAreas[n].dx+=t,this.layoutAreas[n].dy+=e},exists:function(){return this.layoutAreas.length>0},sumGaps:function(t){var e=Math.max(this.layoutAreas.length-1,0);return e*t},getSiblingRankByPoint:function(t){if(!this.exists())return-1;var e=this.findAreaByPoint(t);return e?e.siblingRank-1:this.layoutAreas.length-1},getFirstChildConnectionPoints:function(){return[]},getConnectionPoints:function(t,e){if(!this.exists())return this.getFirstChildConnectionPoints(t);var n={dx:t.x-this.parentArea.rootCX,dy:t.y-this.parentArea.rootCY};return this.layoutAreas[0].getRootVertices(n,e)},getParentConnectionPoint:function(){var t=this.parentArea,e=this.proxyLayoutArea("getConnectionPoint",t.rootSize),n=oe(t.rootCX,t.rootCY);return n.offset(e.x,e.y)},getChildConnectionPoint:function(t,e){var n=this.proxyLayoutArea("getConnectionPoint",e);return oe(t).difference(n)},proxyLayoutArea:function(t){var e=Array.prototype.slice.call(arguments,1);return Vn.fromDirection(this.direction).prototype[t].apply(this.parentArea,e)}});uh.extend=gn.extend;var la=uh.extend({getTopDY:function(){return-this.height/2},findAreaByPoint:function(t){return this.layoutAreas.find(function(e){return e.rootCY>t.y})},computeSize:function(t){this.height=this.sumGaps(t.siblingGap);var e=this.layoutAreas;if(t.symmetrical){const n=e.reduce(function(i,r){return Math.max(i,r.height+r.prevSiblingGap+r.nextSiblingGap)},0);this.height+=n*e.length,e.reduce((i,r)=>(this.width=Math.max(this.width,r.getExtendedWidth()),r.dy+=i+n/2,i+n+t.siblingGap),this.getTopDY())}else this.height+=e.reduce(function(n,i){return n+i.height+i.prevSiblingGap+i.nextSiblingGap},0),e.reduce((n,i)=>(this.width=Math.max(this.width,i.getExtendedWidth()),i.dy+=n+i.getCY(),n+i.prevSiblingGap+i.height+i.nextSiblingGap+t.siblingGap),this.getTopDY())},getYTowardsParent:function(){return this.parentArea.rootCY},getXTowardsParent:function(){var t=this.parentArea;return t.rootCX+this.LRSign*(t.rootSize.width/2+t.gap)},getNeighborPointFromRank:function(t){var e,n=this.siblingGap;if(!this.exists())e=this.getYTowardsParent();else{var i=this.layoutAreas[t],r=this.layoutAreas[t+1];i?r?e=(i.y+i.height+r.y)/2:e=i.y+i.height+n/2:e=r.y-n/2}return{x:this.getXTowardsParent(),y:e}}}),hz=la.extend({direction:"L",LRSign:-1}),dz=la.extend({direction:"R",LRSign:1}),hh={getXTowardsParent:function(){var t=this.parentArea;return t.rootCX+this.LRSign*t.gap},getYTowardsParent:function(){var t=this.parentArea,e=t.getLRHeight(t.siblings)/2;return e+=Math.min(t.firstChildGap,this.siblingGap/2),t.rootCY+this.TBSign*e},getFirstChildConnectionPoints:function(t){return[oe(this.parentArea.rootCX,t.y)]},getChildConnectionPoint:function(t,e){return oe(t).offset(-this.LRSign*e.width/2,0)},getParentConnectionPoint:function(){var t=this.parentArea,e=oe(t.rootCX,t.rootCY);return e.offset(0,this.TBSign*(t.rootSize.height-t.rootMargin)/2)}},j_={getTopDY:function(){return 0}},W_={getTopDY:function(){return-this.height}},Y_=la.extend({direction:"BR",LRSign:1,TBSign:1});H(Y_.prototype,hh,j_);var X_=la.extend({direction:"BL",LRSign:-1,TBSign:1});H(X_.prototype,hh,j_);var q_=la.extend({direction:"TR",LRSign:1,TBSign:-1});H(q_.prototype,hh,W_);var K_=la.extend({direction:"TL",LRSign:-1,TBSign:-1});H(K_.prototype,hh,W_);var Z_=uh.extend({getLeftDX:function(){return-this.width/2},findAreaByPoint:function(t){return this.layoutAreas.find(function(e){return e.rootCX>t.x})},computeSize:function(t){this.width=this.sumGaps(t.siblingGap);var e=this.layoutAreas;if(t.symmetrical){const n=e.reduce(function(i,r){return Math.max(i,r.width+r.prevSiblingGap+r.nextSiblingGap)},0);this.width+=n*e.length,e.reduce((i,r)=>(this.height=Math.max(this.height,r.getExtendedHeight()),r.dx+=i+n/2,i+n+t.siblingGap),this.getLeftDX())}else this.width+=e.reduce(function(n,i){return n+i.width+i.prevSiblingGap+i.nextSiblingGap},0),e.reduce((n,i)=>(this.height=Math.max(this.height,i.getExtendedHeight()),i.dx+=n+i.getCX(),n+i.prevSiblingGap+i.width+i.nextSiblingGap+t.siblingGap),this.getLeftDX())},getNeighborPointFromRank:function(t){var e;if(!this.exists())e=this.parentArea.rootCX;else{var n=this.layoutAreas[t],i=this.layoutAreas[t+1];n?i?e=(n.x+n.width+i.x)/2:e=n.x+n.width+this.siblingGap/2:e=i.x-this.siblingGap/2}return{x:e,y:this.getYTowardsParent()}}}),fz=Z_.extend({direction:"T",getYTowardsParent:function(){var t=this.parentArea;return t.rootCY-t.getLRHeight()/2-t.gap}}),pz=Z_.extend({direction:"B",getYTowardsParent:function(){var t=this.parentArea;return t.rootCY+t.getLRHeight()/2+t.gap}});function Vn(t,e){this.root=t;var n=H({},e,this.getRootAttributes(t,e.attributeNames)),i=e.gap||0;me(n,{parentGap:i,siblingGap:i,firstChildGap:i}),this.siblingRank=n.siblingRank,this.rootOffset=n.rootOffset,this.rootMargin=n.rootMargin,this.siblingGap=n.siblingGap,this.gap=this.parentGap=n.parentGap,this.nextSiblingGap=n.nextSiblingGap,this.prevSiblingGap=n.prevSiblingGap,this.firstChildGap=n.firstChildGap,this.dx=0,this.dy=0,this.width=0,this.height=0,this.symmetrical=n.symmetrical}H(Vn,{create:function(t,e,n){var i=Vn.fromDirection(t,n);return new i(e,n)},fromDirection:function(t,e){var n;switch(t){case"L":n=mz;break;case"T":n=vz;break;case"R":n=gz;break;case"B":n=yz;break;case"BR":n=bz;break;case"BL":n=xz;break;case"TR":n=wz;break;case"TL":n=_z;break;default:n=Vn}return n}});H(Vn.prototype,{direction:null,compute:function(t){this.childAreas=t,this.computeRelativePosition(this.root,t)},getHeight:function(t,e){return this.getTHeight(t)+this.getBHeight(t)+this.getLRHeight()},getWidth:function(t,e){var n=Math.max(t.T.width,t.B.width)/2,i=Math.max(this.getLWidth(t,e)+e.width/2,n),r=Math.max(this.getRWidth(t,e)+e.width/2,n);return i+r},getLRHeight:function(){return Math.max(this.rootSize.height,this.siblings.L.height,this.siblings.R.height)},getTHeight:function(t){return t.T.height+this.getTXHeight(t)},getBHeight:function(t){return t.B.height+this.getBXHeight(t)},getXLRWidth:function(t,e){return this.getLWidth(t,e)+e.width+this.getRWidth(t,e)},getXRWidth:function(t,e){var n=Math.max(t.BR.width,t.TR.width);return n>0&&(n-=e.width/2),n},getTXHeight:function(t){var e=Math.max(t.TR.height,t.TL.height);return e>0&&(e+=this.firstChildGap),e},getBXHeight:function(t){var e=Math.max(t.BR.height,t.BL.height);return e>0&&(e+=this.firstChildGap),e},getXLWidth:function(t,e){var n=Math.max(t.BL.width,t.TL.width);return n>0&&(n-=e.width/2),n},getRWidth:function(t,e){return Math.max(t.R.width,this.getXRWidth(t,e))},getLWidth:function(t,e){return Math.max(t.L.width,this.getXLWidth(t,e))},getTBOverlap:function(t,e){var n=Math.max(t.T.width,t.B.width);return n>0&&(n-=e.width,n/=2),n},getRootDX:function(t,e){var n=this.getTBOverlap(t,e),i=Math.max(this.getLWidth(t,e),n);return i-=Math.max(this.getRWidth(t,e),n),i/2},getMinimalGap:function(t){return Math.min(t.siblingGap,this.firstChildGap,this.parentGap)},getBBox:function(t){var e=xr(this),n=t&&t.expandBy;return n&&e.moveAndExpand({x:-n,y:-n,width:n*2,height:n*2}),e},containsPoint:function(t,e){return this.getBBox(e).containsPoint(t)},getLayoutSiblings:function(t){return this.siblings[t]},getExtendedWidth:function(){return this.width+this.gap+this.rootOffset},getExtendedHeight:function(){return this.height+this.gap+this.rootOffset},findMinimalAreaByPoint:function(t,e){if(!this.containsPoint(t,e))return null;var n;return this.childAreas.some(function(i){return n=i.findMinimalAreaByPoint(t,e),!!n}),n||this},getType:function(){return Object.keys(this.siblings).reduce((t,e)=>{var n=this.siblings[e];return n.exists()?t.concat(e):t},[]).sort().join("-")},getRootAttributes:function(t,e){var n={rootOffset:t.get(e.offset||"offset")||0,rootMargin:t.get(e.margin||"margin")||0,prevSiblingGap:t.get(e.prevSiblingGap||"prevSiblingGap")||0,nextSiblingGap:t.get(e.nextSiblingGap||"nextSiblingGap")||0},i=t.get(e.siblingRank||"siblingRank");Nt(i)&&(n.siblingRank=i);var r=t.get(e.firstChildGap||"firstChildGap");return Nt(r)&&(n.firstChildGap=r),n},getRootSize:function(t,e){var n=t.size();return n[this.marginDimension]+=e,n},createSiblings:function(t,e){var n=Wp(t,"direction");return{L:new hz(n.L,this,e),T:new fz(n.T,this,e),R:new dz(n.R,this,e),B:new pz(n.B,this,e),BR:new Y_(n.BR,this,e),BL:new X_(n.BL,this,e),TR:new q_(n.TR,this,e),TL:new K_(n.TL,this,e)}},computeSize:function(t,e){return{width:this.getWidth(t,e),height:this.getHeight(t,e)}},computeOrigin:function(){var t=this.siblings,e=this.rootSize,n=Math.max(this.getLWidth(t,e)+e.width/2,this.getXLWidth(t,e)+e.width/2,t.T.width/2,t.B.width/2);return{x:this.rootCX-n,y:this.rootCY-this.getTHeight(t)-this.getLRHeight()/2}},moveSiblings:function(t,e){if(this.hasHorizontalSiblings(t)){var n=e.width/2;t.L.move(-n,0),t.R.move(n,0)}if(this.hasVerticalSiblings(t)){var i=this.getLRHeight()/2;t.T.move(0,-i),t.B.move(0,i),t.BR.move(0,i),t.BL.move(0,i),t.B.move(0,this.getBXHeight(t)),t.TR.move(0,-i),t.TL.move(0,-i),t.T.move(0,-this.getTXHeight(t))}},moveRootToConnectionPoint:function(t){var e=this.getConnectionPoint(t);this.dx+=e.x,this.dy+=e.y},computeRelativePosition:function(t,e){var n=this.siblings=this.createSiblings(e,{siblingGap:this.siblingGap,symmetrical:this.symmetrical}),i=this.rootSize=this.getRootSize(t,this.rootMargin);H(this,this.computeSize(n,i)),this.moveSiblings(n,i),this.moveRootToConnectionPoint(i),this.moveRootBehindSiblings(n,i),this.moveRootFromParent()},computeAbsolutePosition:function(){if(this.parentArea)this.rootCX=this.parentArea.rootCX+this.dx,this.rootCY=this.parentArea.rootCY+this.dy,this.level=this.parentArea.level+1;else{var t=this.root.getBBox().center();this.rootCX=t.x,this.rootCY=t.y,this.level=0}H(this,this.computeOrigin())},hasVerticalSiblings:function(t){return t.T.exists()||t.B.exists()||t.BR.exists()||t.BL.exists()||t.TR.exists()||t.TL.exists()},hasHorizontalSiblings:function(t){return t.L.exists()||t.R.exists()},isSourceArea:function(){return!this.parentArea},isSinkArea:function(){return this.childAreas.length===0},getRootPosition:function(){var t=this.root.get("size");return{x:this.rootCX-t.width/2,y:this.rootCY-t.height/2}},getRootVertices:function(t,e){if(e=e||{},t=t||this,t[this.deltaCoordinate]===0||!this.parentArea)return[];var n=this.parentArea.getInnerSize(),i;if(!e.ignoreSiblings&&this.hasSiblingsBetweenParent()){var r=this.siblings[this.oppositeDirection];i=this.getRelativeVerticesAvoidingSiblings(n,t,r)}else i=this.getRelativeVertices(n,t);return Ue(i,"offset",this.parentArea.rootCX,this.parentArea.rootCY)},getInnerSize:function(){return{width:this.rootSize.width,height:this.getLRHeight()}},getConnectionPoint:function(){return null},getRelativeVertices:function(){return null},moveRootFromParent:function(){},moveRootBehindSiblings:function(){},hasSiblingsBetweenParent:function(){return!this.isSourceArea()&&this.siblings[this.oppositeDirection].exists()},getCY:function(){return this.height/2+this.prevSiblingGap},getCX:function(){return this.width/2+this.prevSiblingGap}});Vn.extend=gn.extend;var gz=Vn.extend({direction:"R",oppositeDirection:"L",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(t){return oe(t.width/2,0)},moveRootBehindSiblings:function(t,e){this.dx+=Math.max(this.getLWidth(t,e),this.getTBOverlap(t,e)),this.dy+=(this.getTHeight(t)-this.getBHeight(t))/2},moveRootFromParent:function(){this.dx+=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=this.parentGap/2;return[n.clone().offset(i,0),n.clone().offset(i,e.dy)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=this.getConnectionPoint(t),r=n.siblingGap/2,s=this.dx>0?-1:1,o=e.dy+s*(n.height+r)/2,a=e.dy+s*this.rootSize.height/4,l=this.gap/2,c=1.5*l+Math.max(this.getLWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[i.clone().offset(l,0),i.clone().offset(l,o),i.clone().offset(c,o),i.clone().offset(c,a)]}}),mz=Vn.extend({direction:"L",oppositeDirection:"R",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(t){return oe(-t.width/2,0)},moveRootBehindSiblings:function(t,e){this.dx-=Math.max(this.getRWidth(t,e),this.getTBOverlap(t,e)),this.dy+=(this.getTHeight(t)-this.getBHeight(t))/2},moveRootFromParent:function(){this.dx-=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=-this.parentGap/2;return[n.clone().offset(i,0),n.clone().offset(i,e.dy)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=this.getConnectionPoint(t),r=this.dx>0?-1:1,s=e.dy+r*(n.height+n.siblingGap/2)/2,o=e.dy+r*this.rootSize.height/4,a=this.gap/2,l=1.5*a+Math.max(this.getRWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[i.clone().offset(-a,0),i.clone().offset(-a,s),i.clone().offset(-l,s),i.clone().offset(-l,o)]}}),vz=Vn.extend({direction:"T",oppositeDirection:"B",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(t){return oe(0,-t.height/2)},moveRootBehindSiblings:function(t,e){this.dx+=this.getRootDX(t,e),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2),this.dy-=this.getBHeight(t)},moveRootFromParent:function(){this.dy-=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=-this.getTXHeight(this.parentArea.siblings)-this.parentGap/2;return[n.clone().offset(0,i),n.clone().offset(e.dx,i)]},getRelativeVerticesAvoidingSiblings:function(t,e){var n=this.getConnectionPoint(t),i=this.siblings,r=i.B,s=this.getTXHeight(this.parentArea.siblings)+this.parentGap/2,o=s+r.height;o+=this.getBXHeight(this.siblings)+this.parentGap/4;var a=this.dy<0?-1:1,l=i[a>0?"BR":"BL"].width,c=e.dx;c+=a*(Math.max(l,r.width/2)+r.siblingGap/4);var h=e.dx+a*this.rootSize.width/4;return[n.clone().offset(0,-s),n.clone().offset(c,-s),n.clone().offset(c,-o),n.clone().offset(h,-o)]}}),yz=Vn.extend({direction:"B",oppositeDirection:"T",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(t){return oe(0,t.height/2)},moveRootBehindSiblings:function(t,e){this.dx+=this.getRootDX(t,e),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){this.dy+=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2;return[n.clone().offset(0,i),n.clone().offset(e.dx,i)]},getRelativeVerticesAvoidingSiblings:function(t,e){var n=this.getConnectionPoint(t),i=this.siblings,r=i.T,s=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2,o=s+r.height;o+=this.getTXHeight(i)+this.parentGap/4;var a=this.dy<0?-1:1,l=i[a>0?"TR":"TL"].width,c=e.dx;c+=a*(Math.max(l,r.width/2)+r.siblingGap/4);var h=e.dx+a*this.rootSize.width/4;return[n.clone().offset(0,s),n.clone().offset(c,s),n.clone().offset(c,o),n.clone().offset(h,o)]}}),bz=Vn.extend({direction:"BR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return oe(0,t.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(t,e){var n=Math.max(t.T.width,t.B.width);this.dx+=Math.max(this.getLWidth(t,e),(n-e.width)/2),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy+=t.firstChildGap),this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){const n=this.getConnectionPoint(t),{dx:i,dy:r}=e,{width:s,height:o}=t;let a;return r-o/2<0?a=(s/2+(i-this.rootSize.width/2))/2:a=0,[n.clone().offset(a,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx-this.rootSize.width/4,r=e.dy;return r+=Math.max(n.height,this.rootSize.height)/2,r+=this.getMinimalGap(n)/2,[oe(0,r),oe(i,r)]}}),xz=Vn.extend({direction:"BL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return oe(0,t.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(t,e){var n=Math.max(t.T.width,t.B.width);this.dx-=Math.max(this.getRWidth(t,e),(n-e.width)/2),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy+=t.firstChildGap),this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){const n=this.getConnectionPoint(t),{dx:i,dy:r}=e,{width:s,height:o}=t;let a;return r-o/2<0?a=(-s/2+(i+this.rootSize.width/2))/2:a=0,[n.clone().offset(a,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx+this.rootSize.width/4,r=e.dy;return r+=Math.max(n.height,this.rootSize.height)/2,r+=this.getMinimalGap(n)/2,[oe(0,r),oe(i,r)]}}),wz=Vn.extend({direction:"TR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return oe(0,t.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(t,e){this.dx+=Math.max(this.getLWidth(t,e),this.getTBOverlap(t,e)),this.dy-=this.getBHeight(t),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy-=t.firstChildGap),this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){const n=this.getConnectionPoint(t),{dx:i,dy:r}=e,{width:s,height:o}=t;let a;return r+o/2>0?a=(s/2+(i-this.rootSize.width/2))/2:a=0,[n.clone().offset(a,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx-this.rootSize.width/4,r=e.dy;return r-=Math.max(n.height,this.rootSize.height)/2,r-=this.getMinimalGap(n)/2,[oe(0,r),oe(i,r)]}}),_z=Vn.extend({direction:"TL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return oe(0,t.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(t,e){this.dx-=Math.max(this.getRWidth(t,e),this.getTBOverlap(t,e)),this.dy-=this.getBHeight(t),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy-=t.firstChildGap),this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){const n=this.getConnectionPoint(t),{dx:i,dy:r}=e,{width:s,height:o}=t;let a;return r+o/2>0?a=(-s/2+(i+this.rootSize.width/2))/2:a=0,[n.clone().offset(a,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx+this.rootSize.width/4,r=e.dy;return r-=Math.max(n.height,this.rootSize.height)/2,r-=this.getMinimalGap(n)/2,[oe(0,r),oe(i,r)]}}),Gv={rotate:function(t){var e="LRBT",n=e.indexOf(t[0])-e.indexOf(t[1]);return function(i){var r=e.indexOf(i);return r>=0?e[(4+r-n)%4]:i}},flip:function(t){var e=t[0],n=t[1];return function(i){return i===e?n:i===n?e:i}},straighten:function(t){return function(){return t[1]}}};const Sz=gn.extend({defaults:{graph:void 0,gap:20,parentGap:20,siblingGap:20,firstChildGap:20,direction:"R",directionRule:Gv.straighten,updatePosition:function(t,e,n){t.set("position",e,n)},updateVertices:function(t,e,n){t.set("vertices",e,n)},updateAttributes:null,filter:null,attributeNames:{}},initialize:function(){this._cacheOptions(this.attributes),this.layoutAreas={}},layout:function(t){this.layoutAreas={};for(var e=this.getGraphSources(t),n=0,i=e.length;n<i;n++)this.layoutTree(e[n],t);return this.trigger("layout:done",t),this},layoutTree:function(t,e){e=e||{},e.treeLayout=!0;var n=this._computeLayoutAreas(t,null,e);return this._computeAbsolutePositions(n),this._updateCells(n,e),this},getLayoutBBox:function(){return this.getRootLayoutAreas().reduce(function(t,e){var n=e.getBBox();return t?t.union(n):n},null)},getLayoutArea:function(t){return this.layoutAreas[t.id||t]||null},getRootLayoutAreas:function(){return this.getGraphSources().map(this.getLayoutArea,this)},getGraphSources:function(t){var e=this.graph.getSources();return this.filter&&e.length>0&&(e=this.filter(e,null,t)||e),e},getMinimalRootAreaByPoint:function(t){var e=this.getRootLayoutAreas().filter(function(n){return n.containsPoint(t)});return En(e)?null:e.reduce(function(n,i){return i.width*i.height<n.min&&(n.min=i.width*i.height,n.item=i),n},{min:1/0,item:void 0}).item},_computeLayoutAreas:function(t,e,n){var i=e?e.direction:this.get("direction"),r=t.get(this.getAttributeName("direction"))||i,s=Vn.create(r,t,this.attributes);s.parentArea=e,s.link=this.graph.getConnectedLinks(t,{inbound:!0})[0];var o=this._getChildren(t,n);this.layoutAreas[t.id]=s;for(var a=[],l=0,c=o.length;l<c;l++)a.push(this._computeLayoutAreas(o[l],s,n));return s.compute(a),s},_cacheOptions:function(t){var e=["updateAttributes","updateVertices","updatePosition","filter"];e.forEach(function(n){this[n]=_t(t[n])?t[n]:null},this),this.graph=t.graph},_getChildren:function(t,e){if(this.layoutAreas[t.id])return[];var n=this.graph.getNeighbors(t,{outbound:!0});return this.filter&&n.length>0&&(n=this.filter(n,t,e)||n),n},_computeAbsolutePositions:function(t){t.computeAbsolutePosition(t);for(var e=0,n=t.childAreas.length;e<n;e++)this._computeAbsolutePositions(t.childAreas[e])},_updateCells:function(t,e){var n=t.root,i=t.link||null;i&&(this.updatePosition&&this.updatePosition(n,t.getRootPosition(),e),this.updateVertices&&this.updateVertices(i,t.getRootVertices(),e)),this.changeSiblingRank(n,t.siblingRank,e),this.updateAttributes&&this.updateAttributes(t,n,i,e);for(var r=0,s=t.childAreas.length;r<s;r++)this._updateCells(t.childAreas[r],e)},updateDirections:function(t,e,n){n=n||{};var i=this.getAttributeName("direction"),r=this.get("directionRule")(e);this.graph.search(t,(s,o)=>{if(o!==0){var a=r(s.get(i));this.changeDirection(s,a,n)}},{outbound:!0})},reconnectElement:function(t,e,n){n=n||{};var i=this.getLayoutArea(t),r=i.link;if(r){r.set("source",{id:e.id||e},n);var s=i.direction,o=n.direction||s,a=n.siblingRank||void 0;return this.changeSiblingRank(t,a,n),this.changeDirection(t,o,n),s!==o&&this.updateDirections(t,[s,n.direction],n),!0}return!1},changeSiblingRank:function(t,e,n){t.set(this.getAttributeName("siblingRank"),e,n)},changeDirection:function(t,e,n){t.set(this.getAttributeName("direction"),e,n)},getAttributeName:function(t){return this.get("attributeNames")[t]||t},getAttribute:function(t,e){return t.get(this.getAttributeName(e))},prepare:function(){return this},removeElement:function(t,e={}){const[n]=this.graph.getNeighbors(t,{inbound:!0});if(n){const i=t.get("siblingRank"),r=this.graph.getConnectedLinks(t,{outbound:!0});r.forEach(s=>{s.source(n);const o=s.getTargetCell(),a=Ze.linear([0,r.length],[0,1],o.get("siblingRank"));o.set("siblingRank",i+a,e)})}t.remove(e),e.layout!==!1&&this.layout(e)}},{directionRules:Gv}),Ez=as.extend({name:"scroll-bar",tagName:"rect",options:{margin:2,width:8,rightAlign:!1},attributes:{fill:"#333",rx:4,ry:4,"fill-opacity":.4,cursor:"grab"},events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},onRender:function(){this.update()},update:function(){const t=this.getBBox();return t?(this.enable(),this.vel.attr(t.toJSON())):this.disable(),this},getTrackHeight(){const{relatedView:t,options:e}=this,n=t.model,{metrics:i}=n,{padding:r}=i,s=e.margin,o=r.top+r.bottom+2*Math.abs(s),{height:a}=n.attributes.size;return a-o},getScale(){const{relatedView:t}=this,e=t.model,{metrics:n,attributes:i}=e,{minHeight:r}=n,{height:s}=i.size,o=this.getTrackHeight();return o/(r-(s-o))},getBBox:function(){const{relatedView:t,options:e}=this,n=t.model;if(n.isEveryItemInView())return null;const{metrics:i,attributes:r}=n,{width:s}=r.size,{padding:o,overflow:a}=i,l=this.getTrackHeight();if(l<=0)return null;const{margin:c,width:h}=e,u=this.getScale(),d=l*u,{x:f,y:p}=r.position,g=p+Math.abs(c)+o.top;let v=f;return e.rightAlign?(v+=s-c,c>=0&&(v-=h),a||(v-=o.right)):(v+=c,c<0&&(v-=h),a||(v+=o.left)),new Z({x:v,y:g+u*n.getScrollTop(),width:h,height:d})},disable:function(){this.vel.attr("display","none")},enable:function(){this.vel.attr("display","")},onPointerDown:function(t){if(this.guard(t))return;t.stopPropagation(),t.preventDefault();const{relatedView:e}=this,n=e.model;n.startBatch("scroll-record",{ui:!0,tool:this.cid}),this.focus(),this.delegateDocumentEvents(null,{y:t.clientY,scrollTop:n.getScrollTop()}),e.paper.undelegateEvents()},onPointerMove:function(t){const e=at(t),{y:n,scrollTop:i,lastScrollTop:r}=e.data,{relatedView:s}=this,o=s.model,a=this.getScale(),l=i+(e.clientY-n)/a;r!==l&&(e.data.lastScrollTop=l,o.setScrollTop(l))},onPointerUp:function(){this.undelegateDocumentEvents(),this.paper.delegateEvents(),this.blur(),this.el.style.pointerEvents="",this.relatedView.model.stopBatch("scroll-record",{ui:!0,tool:this.cid})}}),Tz=M_.extend({name:"swimlane-boundary",tagName:"rect",options:{padding:10,laneId:""},update:function(){const{vel:t,relatedView:e,options:n}=this,i=e.model,r=i.angle(),s=i.getBBox().center(),o=this.getBoundaryBBox(i,n.laneId,n.padding);return o===null?t.attr({width:0,height:0}):(t.attr(o.toJSON()),t.rotate(r,s.x,s.y,{absolute:!0})),this},getBoundaryBBox:function(t,e,n){const{left:i,top:r,right:s,bottom:o}=Re(n),a=t.getLaneBBox(e);return a===null?null:(a.moveAndExpand({x:-i,y:-r,width:i+s,height:r+o}),a.width<0&&(a.width=0),a.height<0&&(a.height=0),a)}}),dr=function(t,e,n){this.top=t.topLine().rotate(e,-n),this.left=t.leftLine().rotate(e,-n),this.right=t.rightLine().rotate(e,-n),this.bottom=t.bottomLine().rotate(e,-n)};dr.inflatedOnSide=function(t,e,n,i,r){const s=new dr(t,e,n),o=s.getLine(r);switch(r){case"top":case"right":s[r]=o.parallel(-i);break;case"bottom":case"left":s[r]=o.parallel(i);break}return s};dr.prototype={getLine:function(t){switch(t){case"top":return this.top;case"right":return this.right;case"bottom":return this.bottom;case"left":return this.left}},isPointOnLine:function(t,e){return Math.round(this.getLine(e).closestPoint(t).distance(t))===0},isPointToTheLeftOfLine:function(t,e){const n=Math.round(this.getLine(e).pointOffset(t));switch(e){case"top":case"right":return n>0;case"bottom":case"left":return n<0}},isPointToTheRightOfLine:function(t,e){const n=Math.round(this.getLine(e).pointOffset(t));switch(e){case"top":case"right":return n<0;case"bottom":case"left":return n>0}},isPointInside:function(t){let e=this.isPointToTheLeftOfLine(t,"top"),n=this.isPointToTheLeftOfLine(t,"right"),i=this.isPointToTheLeftOfLine(t,"bottom");return this.isPointToTheLeftOfLine(t,"left")&&e&&n&&i},isPointInsideOrOnLine:function(t){const e=this.isPointInside(t),n=this.isPointOnLine(t,"top"),i=this.isPointOnLine(t,"right"),r=this.isPointOnLine(t,"bottom"),s=this.isPointOnLine(t,"left");return e||n||i||r||s},findClosestPointToLine:function(t,e){const n=new M;let i=1/0;return t.forEach(r=>{const s=this.getDistanceFromLineToPoint(r,e);s<i&&(n.update(r.x,r.y),i=s)}),n},findFurthestPointFromLine:function(t,e){const n=new M;let i=-1/0;return t.forEach(r=>{const s=this.getDistanceFromLineToPoint(r,e);s>i&&(n.update(r.x,r.y),i=s)}),n},getDistanceFromLineToPoint:function(t,e){const n=this.getLine(e),i=this.isPointToTheRightOfLine(t,e)?1:-1,r=Math.abs(n.pointOffset(t))*i;return Math.round(r)}};const Hv=o4.SegmentHandle.extend({className:"swimlane-transform-handle",children:[{tagName:"rect",selector:"handle",attributes:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#3498db",stroke:"#FFFFFF","stroke-width":2}}],position:function(t,e,n){const i=this.childNodes.handle,r=L.createSVGMatrix().translate(t,e).rotate(n);i.setAttribute("transform",L.matrixToTransformString(r)),i.setAttribute("cursor",n%180===0?"row-resize":"col-resize")}}),Ye={Top:"top",Right:"right",Bottom:"bottom",Left:"left"},us={X:"x",Y:"y"},Az=as.extend({name:"swimlane-transform",options:{laneId:void 0,minSize:30,padding:10,stopPropagation:!0,constraintsPadding:10,handleClass:Hv,minSizeConstraints:void 0,maxSizeConstraints:void 0},handles:null,minConstraintPoints:null,maxConstraintPoints:null,initialize:function(){const t=this.options;t.minSizeConstraints===void 0&&(t.minSizeConstraints=(e,n,i)=>this.getMinConstraintsToEmbeds(e,n,i)),t.maxSizeConstraints===void 0&&(t.maxSizeConstraints=(e,n,i)=>this.getMaxConstraintsToEmbeds(e,n,i))},update:function(){return this.render(),this},onRender:function(){return this.removeHandles(),this.doesLaneExist()&&this.renderHandles(),this},onRemove:function(){this.removeHandles()},doesLaneExist:function(){return this.relatedView.model.getLaneBBox(this.options.laneId)!==null},removeHandles:function(){const t=this.handles;if(this.handles=[],this.stopListening(),!!Array.isArray(t))for(let e=0;e<t.length;e++)t[e].remove()},renderHandles:function(){this.getHandlesPositionInfo().forEach(e=>{const n=this.renderHandle(e);this.simulateRelatedView(n.el),this.handles.push(n)})},getHandlesPositionInfo:function(){const{options:t,relatedView:e}=this,n=t.laneId,i=e.model,r=i.angle(),s=i.getBBox().center(),o=this.getHandlesBoundaryBBox(i,n,t.padding);return[{position:o.topMiddle().rotate(s,-r),axis:us.Y,side:Ye.Top},{position:o.leftMiddle().rotate(s,-r),axis:us.X,side:Ye.Left},{position:o.rightMiddle().rotate(s,-r),axis:us.X,side:Ye.Right},{position:o.bottomMiddle().rotate(s,-r),axis:us.Y,side:Ye.Bottom}]},getHandlesBoundaryBBox:function(t,e,n){const{left:i,top:r,right:s,bottom:o}=Re(n),a=t.getLaneBBox(e).moveAndExpand({x:-i,y:-r,width:i+s,height:r+o});return a.width<0&&(a.width=0),a.height<0&&(a.height=0),a},renderHandle:function(t){const e=new this.options.handleClass({paper:this.paper,axis:t.axis,side:t.side,guard:n=>this.guard(n)});return e.render(),e.vel.appendTo(this.el),this.updateHandlePosition(e,t.position),this.startHandleListening(e),e},updateHandlePosition:function(t,e){let n=this.relatedView.model.angle();t.options.axis===us.X&&(n+=90),t.position(e.x,e.y,n)},startHandleListening:function(t){this.listenTo(t,"change:start",this.onHandleChangeStart),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"change:end",this.onHandleChangeEnd)},onHandleChangeStart:function(t,e){const n=t.options.side,{options:i,handles:r,relatedView:s}=this,{model:o,paper:a}=s;Array.isArray(r)&&(this.hideNonSelectedHandles(r,t),this.updateConstraintPoints(n),this.focus(),o.startBatch("lane-resize",{ui:!0,tool:this.cid}),i.stopPropagation||s.notifyPointerdown(...a.getPointerArgs(e)))},hideNonSelectedHandles:function(t,e){t.forEach(n=>n===e?n.show():n.hide())},updateConstraintPoints:function(t){const{relatedView:e,options:n}=this,i=n.laneId,r=e.model,s=n.minSizeConstraints,o=n.maxSizeConstraints;let a,l;_t(s)&&(a=s(r,i,t)),_t(o)&&(l=o(r,i,t)),this.minConstraintPoints=Array.isArray(a)?a.map(c=>new M(c)):[],this.maxConstraintPoints=Array.isArray(l)?l.map(c=>new M(c)):[]},onHandleChanging:function(t,e){const{options:n,relatedView:i}=this,{model:r,paper:s}=i,{laneId:o,stopPropagation:a}=n,l=r.getBBox(),c=r.angle(),h=l.center(),u=t.options,d=u.axis,f=u.side,p=this.getHandlesPositionInfo().find(N=>N.side===f).position,g=at(e),v=s.snapToGrid(g.clientX,g.clientY),x=v.clone().rotate(h,c).round(),S=p.clone().rotate(h,c).round(),C=x.difference(S),P=C.y!==0,k=C.x!==0;if(d===us.Y&&P){const N=f===Ye.Top?-C.y:C.y;this.updateLaneHeight(o,N,f,l,c)}else if(d===us.X&&k){const N=f===Ye.Left?-C.x:C.x;this.updateLaneWidth(o,N,r,f,l,c)}this.updateHandlePosition(t,p),a||i.notifyPointermove(g,v.x,v.y)},onHandleChangeEnd:function(t,e){const{options:n,relatedView:i}=this,{paper:r,model:s}=i,o=at(e),{x:a,y:l}=r.snapToGrid(o.clientX,o.clientY);this.render(),this.blur(),s.stopBatch("lane-resize",{ui:!0,tool:this.cid}),n.stopPropagation||i.notifyPointerup(o,a,l),i.checkMouseleave(o)},updateLaneHeight:function(t,e,n,i,r){const s=this.relatedView.model,o=Le(s.prop("lanes")),a=this.getNeighbourLanesIds(s,t,n),l=this.getSublanesAndMostEmbeddedLaneId(s,t,n),c=a.foundNeighbourLaneId===void 0,h=[a.foundNeighbourLaneId,...a.sublaneIds],u=[t,...l.sublaneIds,...a.laneIdsPathToNeighbour];e=this.getDiffWithinConstraints(t,e,n,i.center(),r),e=this.getDiffWithinLaneSizeLimits(s,e,l.mostEmbeddedLaneId,a.mostEmbeddedLaneId),u.forEach(d=>this.addSizeToLane(s,o,d,e)),c?this.resizeShape(s,i.width,i.height+e,n):h.forEach(d=>this.addSizeToLane(s,o,d,-e)),s.prop("lanes",o,{ui:!0,tool:this.cid,autoResize:!1})},getSublanesAndMostEmbeddedLaneId:function(t,e,n){const i=this.getIdsOfClosestSublanesToTheSide(t,e,n),r=i[0]||e;return{sublaneIds:i,mostEmbeddedLaneId:r}},getOppositeHandleSide:function(t){switch(t){case Ye.Top:return Ye.Bottom;case Ye.Right:return Ye.Left;case Ye.Bottom:return Ye.Top;case Ye.Left:return Ye.Right}},getNeighbourLanesIds:function(t,e,n){const i=this.getOppositeHandleSide(n),{foundNeighbourLaneId:r,laneIdsPathToNeighbour:s}=this.findNeighbourLane(t,e,n),o=this.getIdsOfClosestSublanesToTheSide(t,r,i),a=o[0]||r;return{foundNeighbourLaneId:r,laneIdsPathToNeighbour:s,sublaneIds:o,mostEmbeddedLaneId:a}},addSizeToLane:function(t,e,n,i){const s=this.getLaneBBoxHeight(t,n)+i,o=t.getLanePath(n);o.push("size"),Go({lanes:e},o,s)},updateLaneWidth:function(t,e,n,i,r,s){e=this.getDiffWithinConstraints(t,e,i,r.center(),s);const o=n.getMinimalSize().width,a=Math.max(r.width+e,o);this.resizeShape(n,a,r.height,i)},resizeShape:function(t,e,n,i){t.resize(e,n,{ui:!0,tool:this.cid,direction:i})},getLaneBBoxHeight:function(t,e){return t.getLaneBBox(e).height},getDiffWithinLaneSizeLimits:function(t,e,n,i){const r=Math.sign(e),s=i!==void 0,o=this.getLaneBBoxHeight(t,n),a=s?this.getLaneBBoxHeight(t,i):1/0,l=o+e,c=a-e,h=this.getMinSize();return l<h?e=(o-h)*r:c<h&&(e=(a-h)*r),Math.round(e)},getMinSize:function(){let t=this.options.minSize;const e=this.options.constraintsPadding*2;return e>t&&(t=e),t},getDiffWithinConstraints:function(t,e,n,i,r){const o=this.relatedView.model.getLaneBBox(t),a=this.getConstraintPaddingRelativeToHandleSide(e),l=dr.inflatedOnSide(o,i,r,a,n),c=dr.inflatedOnSide(o,i,r,e+a,n),h=this.getMaxConstraintPointsInsideLane(c),u=this.getMinConstraintPointsOutsideLane(c,n);if(h.length>0){const d=l.findClosestPointToLine(h,n);e=l.getDistanceFromLineToPoint(d,n)}else if(u.length>0){const d=l.findFurthestPointFromLine(u,n);e=l.getDistanceFromLineToPoint(d,n)}return e},getConstraintPaddingRelativeToHandleSide:function(t){const e=t<0?-1:1;return this.options.constraintsPadding*e},getMaxConstraintPointsInsideLane:function(t){return this.maxConstraintPoints.filter(e=>t.isPointInside(e))},getMinConstraintPointsOutsideLane:function(t,e){return this.minConstraintPoints.filter(n=>{const i=t.isPointToTheRightOfLine(n,e),r=t.isPointOnLine(n,e);return i||r})},findNeighbourLane:function(t,e,n){const{metrics:i}=t,r=[],s=n===Ye.Top;let o,a=e;for(;a;){const l=t.getLaneMetrics(a),c=l.parentId,h=l.laneIndexWithinGroup;if(s?h===0:h===l.parentSublanesCount-1)c&&r.unshift(c),a=c;else{const d=s?h-1:h+1;o=this.getSublaneIdOfParent(i.lanes,c,d);break}}return{foundNeighbourLaneId:o,laneIdsPathToNeighbour:r}},getSublaneIdOfParent:function(t,e,n){return Object.keys(t).find(r=>{const s=t[r],o=s.parentId===e,a=s.laneIndexWithinGroup===n;return o&&a})},getIdsOfClosestSublanesToTheSide:function(t,e,n){const i=[];let r=e;for(;r;){const o=t.getLaneMetrics(r).sublanesCount,a=n===Ye.Top?0:o-1,l=`${r}_${a}`;t.getLaneMetrics(l)!==null?(i.unshift(l),r=l):r=void 0}return i},getMinConstraintsToEmbeds:function(t,e,n){const i=[],s=t.getBBox().center(),o=t.angle(),a=t.getLaneBBox(e),l=new dr(a,s,o),c=t.getEmbeddedCells({deep:!0}),h=n===Ye.Left||n===Ye.Right;if(this.getEmbedPointsInsideLane(l,c,n).forEach(d=>i.push(d)),h&&c.length>0){const{leftMostPoint:d,rightMostPoint:f}=this.findLeftMostAndRightMostEmbedPoints(t,l,c);i.push(d),i.push(f)}return i},getMaxConstraintsToEmbeds:function(t,e,n){const i=[],r=t.angle(),s=t.getBBox().center(),o=t.getEmbeddedCells({deep:!0}),a=this.findNeighbourLane(t,e,Ye.Top).foundNeighbourLaneId,l=this.findNeighbourLane(t,e,Ye.Bottom).foundNeighbourLaneId;if(a!==void 0){const c=t.getLaneBBox(a),h=new dr(c,s,r);this.getEmbedPointsInsideLane(h,o,n,{addOverflowingEmbedsOnlyOnHandleSide:!0}).forEach(d=>i.push(d))}if(l!==void 0){const c=t.getLaneBBox(l),h=new dr(c,s,r);this.getEmbedPointsInsideLane(h,o,n,{addOverflowingEmbedsOnlyOnHandleSide:!0}).forEach(d=>i.push(d))}return i},getEmbedPointsInsideLane:function(t,e,n,i){const r=[];return e.forEach(s=>{const o=s.angle(),a=s.getBBox(),l=a.center();if(!s.isLink()){const c=this.getBBoxCornerPoints(a,l,o);this.isElementInsideLane(t,c,l,n,i)&&c.forEach(u=>r.push(u))}}),r},isElementInsideLane:function(t,e,n,i,r={}){const s=r.addOverflowingEmbedsOnlyOnHandleSide,o=t.isPointInsideOrOnLine(n);if(s){const a=this.getOppositeHandleSide(i),l=e.every(d=>t.isPointInsideOrOnLine(d));let c;const h=e.some(d=>{const f=t.isPointToTheLeftOfLine(d,a),p=t.isPointOnLine(d,a);return f||p}),u=e.some(d=>t.isPointToTheRightOfLine(d,a));return c=h&&u,o&&(l||c)}return o},getBBoxCornerPoints:function(t,e,n){const i=t.topLeft().rotate(e,-n).round(),r=t.topRight().rotate(e,-n).round(),s=t.bottomLeft().rotate(e,-n).round(),o=t.bottomRight().rotate(e,-n).round();return[i,r,s,o]},findLeftMostAndRightMostEmbedPoints:function(t,e,n){const i=t.angle(),r=t.getBBox(),s=r.center(),o=new dr(r,s,i),a=[];n.forEach(u=>{if(!u.isLink()){const d=u.getBBox(),f=d.center(),p=u.angle();this.getBBoxCornerPoints(d,f,p).forEach(g=>a.push(g))}});const l=o.findFurthestPointFromLine(a,Ye.Left),c=this.getLeftMostPointCorrectedToPoolHeaders(t,l,o.left,e.left),h=o.findFurthestPointFromLine(a,Ye.Right);return{leftMostPoint:c,rightMostPoint:h}},getLeftMostPointCorrectedToPoolHeaders:function(t,e,n,i){const r=this.getTotalLaneHeadersWidth(t),s=t.metrics.padding.left,o=i.pointOffset(n.start)-s-r,a=n.closestPoint(e),l=new gt(a,e),c=l.length()+o;return l.setLength(c),l.end},getTotalLaneHeadersWidth:function(t){const e=t.metrics.lanes;let n=0;return Object.keys(e).forEach(i=>{let r=i,s=0;for(;r;){const o=t.metrics.lanes[r];s+=o.headerSize||0,r=o.parentId}n=s>n?s:n}),n}},{TransformHandle:Hv});function ad(t,...e){const n={};return e.forEach(i=>{if(Array.isArray(i))i.forEach(r=>{t&&t.hasOwnProperty(r)&&(n[r]=t[r])},n);else if(_t(i))for(const r in t){if(!t.hasOwnProperty(r))continue;const s=t[r];i(s,r)&&(n[r]=s)}}),n}function Uv(t){return Array.isArray(t)?t:[t]}const du=gn.extend({defaults:{cmdBeforeAdd:null,cmdNameRegex:/^(?:add|remove|change:\w+)$/,applyOptionsList:["propertyPath"],revertOptionsList:["propertyPath"],storeReducedOptions:!0,stackLimit:1/0},PREFIX_LENGTH:7,initialize:function(t){hn(this,"initBatchCommand","storeBatchCommand"),this.graph=t.graph,this.reset(),this.listen()},listen:function(){this.listenTo(this.graph,"all",this.addCommand,this),this.listenTo(this.graph,"batch:start",this.initBatchCommand,this),this.listenTo(this.graph,"batch:stop",this.storeBatchCommand,this),this.listenTo(this.graph,"reset",this.reset,this)},createCommand:function(t){var e={action:void 0,data:{id:void 0,type:void 0,previous:{},next:{}},batch:t&&t.batch};return e},push:function(t,e){this.redoStack=[],t.batch?(this.lastCmdIndex=Math.max(this.lastCmdIndex,0),this.trigger("batch",t)):(this._push(this.undoStack,t),this.notifyStackChange("push",t,e),this.trigger("add",t))},_push:function(t,e){const{stackLimit:n=1/0}=this.attributes;t.push(e),t.length>n&&t.splice(0,t.length-n)},squashUndo:function(t){this.constructor.squashCommands(this.undoStack,t)},squashRedo:function(t){this.constructor.squashCommands(this.redoStack,t)},addCommand:function(t,e,n,i){if(i||(i={}),i.dry||!this.get("cmdNameRegex").test(t)||typeof this.get("cmdBeforeAdd")=="function"&&!this.get("cmdBeforeAdd").apply(this,arguments))return;var r=void 0,s=e instanceof On;if(this.batchCommand){r=this.batchCommand[Math.max(this.lastCmdIndex,0)];var o=s&&!r.graphChange||r.data.id!==e.id,a=r.action!==t;if(this.lastCmdIndex>=0&&(o||a)){var l=this.batchCommand.findIndex(function(u,d){return(s&&u.graphChange||u.data.id===e.id)&&u.action===t});l<0||t==="add"||t==="remove"?r=this.createCommand({batch:!0}):(r=this.batchCommand[l],this.batchCommand.splice(l,1)),this.lastCmdIndex=this.batchCommand.push(r)-1}}else r=this.createCommand({batch:!1});const{storeReducedOptions:c}=this.attributes;if(t==="add"||t==="remove"){r.action=t,r.data.id=e.id,r.data.type=e.attributes.type,r.data.attributes=Te({},e.toJSON()),r.options=c?this.reduceOptions(i):i,this.push(r,i);return}var h=t.substr(this.PREFIX_LENGTH);(!r.batch||!r.action)&&(r.action=t,r.data.previous[h]=we(e.previous(h)),r.options=c?this.reduceOptions(i):i,s?r.graphChange=!0:(r.data.id=e.id,r.data.type=e.attributes.type)),r.data.next[h]=we(e.get(h)),this.push(r,i)},reduceOptions:function(t){const{applyOptionsList:e,revertOptionsList:n}=this.attributes;return ad(t,e,n)},initBatchCommand:function(){this.batchCommand?this.batchLevel++:(this.batchCommand=[this.createCommand({batch:!0})],this.lastCmdIndex=-1,this.batchLevel=0)},storeBatchCommand:function(t){if(this.batchCommand&&this.batchLevel<=0){var e=this.constructor.filterBatchCommand(this.batchCommand);e.length>0&&(this.redoStack=[],this._push(this.undoStack,e),this.notifyStackChange("push",e,t),this.trigger("add",e)),this.batchCommand=null,this.lastCmdIndex=null,this.batchLevel=null}else this.batchCommand&&this.batchLevel>0&&this.batchLevel--},revertCommand:function(t,e){this.stopListening();var n;Array.isArray(t)?n=this.constructor.sortBatchCommand(t):n=[t];for(var i=this.graph,r=n.length-1;r>=0;r--){var s=n[r],o=H({commandManager:this.id||this.cid},e,ad(s.options,this.get("revertOptionsList")));switch(s.action){case"add":{const a=i.getCell(s.data.id);a&&a.remove(o);break}case"remove":{i.addCell(s.data.attributes,o);break}default:{const a=s.graphChange?i:i.getCell(s.data.id),l=s.action.substr(this.PREFIX_LENGTH);a.set(l,s.data.previous[l],o);break}}}this.listen()},applyCommand:function(t,e){this.stopListening();var n;Array.isArray(t)?n=this.constructor.sortBatchCommand(t):n=[t];for(var i=this.graph,r=0;r<n.length;r++){var s=n[r],o=s.graphChange?i:i.getCell(s.data.id),a=H({commandManager:this.id||this.cid},e,ad(s.options,this.get("applyOptionsList")));switch(s.action){case"add":i.addCell(s.data.attributes,a);break;case"remove":o.remove(a);break;default:var l=s.action.substr(this.PREFIX_LENGTH);o.set(l,s.data.next[l],a);break}}this.listen()},undo:function(t){var e=this.undoStack.pop();e&&(this.revertCommand(e,t),this.redoStack.push(e),this.notifyStackChange("undo",e,t))},redo:function(t){var e=this.redoStack.pop();e&&(this.applyCommand(e,t),this.undoStack.push(e),this.notifyStackChange("redo",e,t))},cancel:function(t){var e=this.undoStack.pop();e&&(this.revertCommand(e,t),this.redoStack=[],this.notifyStackChange("cancel",e,t))},reset:function(t){this.undoStack=[],this.redoStack=[],this.notifyStackChange("reset",null,t)},hasUndo:function(){return this.undoStack.length>0},hasRedo:function(){return this.redoStack.length>0},notifyStackChange:function(t,e,n={}){let i;e?i=[Uv(e),n]:i=[n],this.trigger(`stack:${t}`,...i),this.trigger("stack",n)},toJSON(){const{undoStack:t,redoStack:e}=this,n=this.exportBatchCommands(t),i=this.exportBatchCommands(e);return{undo:n,redo:i}},fromJSON(t,e){if(!t||!Array.isArray(t.undo)||!Array.isArray(t.redo))throw new Error("dia.CommandManager: JSON must contain undo and redo arrays.");this.undoStack=Le(t.undo),this.redoStack=Le(t.redo),this.notifyStackChange("reset",null,e)},exportBatchCommands:function(t){const{storeReducedOptions:e}=this.attributes;return t.map(n=>Uv(n).map(i=>{const r=we(i);return e||(r.options=this.reduceOptions(r.options)),Le(r)}))}},{squashCommands:function(t,e=1/0){const{length:n}=t;if(n<2)return;e=Math.min(n,e);const i=[];for(;e>0;){let s=t.pop();Array.isArray(s)||(s.batch=!0,s=[s]),i.unshift(...s),e--}const r=this.filterBatchCommand(i);return t.push(r),r},sortBatchCommand:function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n],r=null;if(i.action==="add"){for(var s=i.data.id,o=0;o<n;o++)if(t[o].data.id===s){r=o;break}}r!==null?e.splice(r,0,i):e.push(i)}return e},filterBatchCommand:function(t){for(var e=t.slice(),n=[];e.length>0;){var i=e.shift(),r=i.data.id;if(!(i.action==null||r==null&&!i.graphChange)){if(i.action==="add"){var s=e.findIndex(function(a){return a.action==="remove"&&a.data&&a.data.id===r});if(s>=0){e=e.filter(function(a,l){return l>s||a.data.id!==r});continue}}else if(i.action==="remove"){var o=e.findIndex(function(a){return a.action==="add"&&a.data&&a.data.id==r});if(o>=0){e.splice(o,1);continue}}else if(i.action.indexOf("change")===0&&ke(i.data.previous,i.data.next))continue;n.push(i)}}return n}});du.sortBatchCommands=du.sortBatchCommand;du.prototype.filterBatchCommand=function(t){return this.constructor.filterBatchCommand(t)};const Cz=gn.extend({initialize:function(t){this._map={},this._commandManager=t.commandManager,this.listenTo(this._commandManager,"add",this._onCommand)},defaults:{cancelInvalid:!0},_onCommand:function(t){return Array.isArray(t)?t.find(function(e){return!this._validateCommand(e)},this):this._validateCommand(t)},_validateCommand:function(t){if(t.options&&t.options.validation===!1)return!0;var e;return pt(this._map[t.action]).forEach(function(n){var i=0;function r(s){var o=n[i++];try{if(o)o(s,t,r);else{e=s;return}}catch(a){r(a)}}r(e)}),e?(this.get("cancelInvalid")&&this._commandManager.cancel(),this.trigger("invalid",e),!1):!0},validate:function(t){var e=Array.prototype.slice.call(arguments,1);e.forEach(function(i){if(!_t(i))throw new Error(t+" requires callback functions.")});const n=this._map;return t.split(" ").forEach(i=>{let r=n[i];r||(r=n[i]=[]),r.push(e)}),this}}),Pz=kr.extend({LOCAL_STORAGE_KEY:"joint.ui.Clipboard.cells",defaults:{useLocalStorage:!0,deep:!1,origin:"center",translate:{dx:20,dy:20}},constructor:function(t){kr.prototype.constructor.call(this,[],t),this.defaults=H({},this.defaults,t),this.cid=Jr()},copyElements:function(t,e,n){n=H({},this.defaults,n);const i=Array.isArray(t)?t:t.toArray();let r;n.deep?(r=[],i.forEach(o=>{r.push(o,...o.getEmbeddedCells({deep:!0}))})):r=i;const s=tn(Object.values(e.cloneSubgraph(r,n)),o=>o.attributes.z||0);return this.reset(s),n.useLocalStorage&&window.localStorage&&localStorage.setItem(this.LOCAL_STORAGE_KEY,JSON.stringify(this.toJSON())),r},cutElements:function(t,e,n){n=H({},this.defaults,n);var i=this.copyElements(t,e,n);const r=n.removeCellOptions||{};return r.clipboard=this.cid,e.startBatch("cut"),Ue(i,"remove",r),e.stopBatch("cut"),i},pasteCells:function(t,e){e=H({},this.defaults,e),e.useLocalStorage&&this.updateFromStorage(t);let n=t.maxZIndex();const i=this.toArray().map(o=>(n+=1,this.modifyCell(o,e,n))),r=e.addCellOptions||{};r.clipboard=this.cid;const s=tn(i,o=>o.isLink()?2:1);return t.startBatch("paste"),t.addCells(s,r),t.stopBatch("paste"),this.copyElements(this,t,e),s},pasteCellsAtPoint:function(t,e,n){n=H({},this.defaults,n),n.useLocalStorage&&this.updateFromStorage(t);const i=tn(Object.values(t.cloneSubgraph(this.toArray(),n)),d=>d.attributes.z||0),r=t.get("cells").cellNamespace,s=new On([],{cellNamespace:r});s.resetCells(i,{sort:!1});const o=this.getOriginPoint(i,s,n.origin);if(!o)return[];const a={dx:e.x-o.x,dy:e.y-o.y};n.translate=a;let l=t.maxZIndex();const c=this.toArray().map(d=>(l+=1,this.modifyCell(d,n,l))),h=n.addCellOptions||{};h.clipboard=this.cid;const u=tn(c,d=>d.isLink()?2:1);return t.startBatch("paste"),t.addCells(u,h),t.stopBatch("paste"),this.copyElements(i,s,n),u},isEmpty:function(t){if(t=H({},this.defaults,t),this.length>0)return!1;if(t.useLocalStorage){const e=this.getJSONFromStorage();if(e&&e.length)return!1}return!0},clear:function(t){t=H({},this.defaults,t),this.reset([]),t.useLocalStorage&&window.localStorage&&localStorage.removeItem(this.LOCAL_STORAGE_KEY)},modifyCell:function(t,e,n){if(t.set("z",n),t.isLink()&&e.link&&t.set(e.link),e.translate){const{dx:i,dy:r}=e.translate;t.translate(isFinite(i)?i:0,isFinite(r)?r:0)}return t.collection=null,t},updateFromStorage:function(t){const e=this.getJSONFromStorage();if(!e)return;const n={cells:e},i=t.get("cells").cellNamespace,r=new On([],{cellNamespace:i}).fromJSON(n,{sort:!1,dry:!0});this.reset(r.getCells())},getJSONFromStorage:function(){return window.localStorage&&JSON.parse(localStorage.getItem(this.LOCAL_STORAGE_KEY))||null},getOriginPoint:function(t,e,n){const i=e.getCellsBBox(t);return i?Os(i,n):null}}),Pn=q,ol=ce.extend({className:"select-box",events:{"click .select-box-selection":"onToggle"},options:{options:[],width:void 0,openPolicy:"auto",target:null,keyboardNavigation:!0,selected:void 0,selectBoxOptionsClass:void 0,disabled:!1},init:function(){this.options.target=this.options.target||document.body,hn(this,"onOutsideClick","onOptionSelect"),Pn(document).on("click.selectBox",this.onOutsideClick),Pn.data.set(this.el,"view",this),this.options.selected===void 0?this.selection=pt(this.options.options).find(function(t){return t.selected===!0})||this.options.options[0]:this.selection=this.options.options[this.options.selected]},render:function(){return this.$el.empty(),this.$selection=null,this.renderSelection(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions();var t=this.options,e={selectBoxView:this,parentClassName:ee(this,"className")||null,extraClassName:ee(t,"selectBoxOptionsClass")||null,options:t.options};t.width&&(e.width=t.width),t.theme&&(e.theme=t.theme);var n=this.optionsView=new this.constructor.OptionsView(e);n.render(),this.listenTo(n,"option:select",this.onOptionSelect),this.listenTo(n,"option:hover",this.onOptionHover),this.listenTo(n,"options:mouseout",this.onOptionsMouseOut),this.$options=n.$el,this.$optionsArrow=n.$arrow,this.$target=Pn(t.target)},setOptions:function(t,e){this.options.options=t;let n=this.getSelectionValue(this.selection);!n&&e!=null&&(n=t[e].value);const i=this.options.options||[];for(let r=0;r<i.length;r++){const s=i[r];if(s.value===void 0&&s.content===n)return this.select(r);if(s.value!==void 0&&ke(s.value,n))return this.select(r)}this.selection=null,this.renderSelection(),this.trigger("option:select"),this.selectByValue(n,null)},onOptionHover:function(t,e){this.trigger("option:hover",t,e)},onOptionsMouseOut:function(t){this.trigger("options:mouseout",t)},onOptionSelect:function(t,e){this.select(t,e)},removeOptions:function(){this.optionsView&&(this.stopListening(this.optionsView),this.optionsView.remove(),this.optionsView=null)},renderSelection:function(t){if(this.$selection||(this.$selection=Pn("<div/>").addClass("select-box-selection"),this.$el.append(this.$selection)),this.$selection.empty(),t){var e=this.constructor.OptionsView.prototype.renderOptionContent.call(void 0,t);this.$selection.append(e)}else if(this.options.placeholder){var n=Pn("<div/>").addClass("select-box-placeholder").html(this.options.placeholder);this.$selection.append(n)}},onToggle:function(t){this.toggle()},onOutsideClick:function(t){!this.el.contains(t.target)&&this.$el.hasClass("opened")&&this.close()},getSelection:function(){return this.selection},getSelectionValue:function(t){return t=t||this.selection,t&&(t.value===void 0?t.content:t.value)},getSelectionIndex:function(){return pt(this.options.options).findIndex((function(t){return t===this.selection}).bind(this))},select:function(t,e={}){this.selection=this.options.options[t],this.renderSelection(this.selection),this.trigger("option:select",this.selection,t,e),this.close()},selectByValue:function(t,e){for(var n=this.options.options||[],i=0;i<n.length;i++){var r=n[i];if(r.value===void 0&&r.content===t)return this.select(i,e);if(r.value!==void 0&&ke(r.value,t))return this.select(i,e)}},isOpen:function(){return this.$el.hasClass("opened")},toggle:function(){this.isOpen()?this.close():this.open()},position:function(){var t=this.$(".select-box-selection"),e=t.outerHeight(),n=t.offset(),i=n.left,r=n.top,s=this.$options.outerHeight(),o={left:0,top:0};this.options.target!==document.body?(o=this.$target.offset(),o.width=this.$target.outerWidth(),o.height=this.$target.outerHeight(),o.left-=this.$target.scrollLeft(),o.top-=this.$target.scrollTop()):(o.width=Pn(window).width(),o.height=Pn(window).height());var a=i,l="auto",c=this.options.openPolicy;switch(c==="selected"&&!this.selection&&(c="auto"),c){case"above":l=r-s;break;case"coverAbove":l=r-s+e;break;case"below":l=r+e;break;case"coverBelow":l=r;break;case"selected":var h=this.$options.find(".selected").position();l=r-h.top;break;default:var u=r-this.$target.scrollTop()+s>o.top+o.height;l=u?r-s+e:r;break}a-=o.left,l-=o.top,this.$options.css({left:a,top:l})},open:function(){this.isDisabled()||(this.renderOptions(),this.$options.appendTo(this.options.target),this.$options.addClass("rendered"),this.position(),this.$el.addClass("opened"),this.respectWindowBoundaries(),this.alignOptionsArrow())},respectWindowBoundaries:function(){var t=this.calculateElOverflow(this.$options,this.$target),e={left:0,top:0};this.$options.outerWidth()<=this.$target.innerWidth()&&(t.left&&t.right||(t.left?e.left=t.left:t.right&&(e.left=-t.right))),this.$options.outerHeight()<=this.$target.innerHeight()&&(t.top&&t.bottom||(t.top?e.top=t.top:t.bottom&&(e.top=-t.bottom)));const n=parseFloat(this.$options.css("left"))||0,i=parseFloat(this.$options.css("top"))||0;this.$options.css({left:n+e.left,top:i+e.top})},alignOptionsArrow:function(){var t=this.$el[0].getBoundingClientRect(),e=this.$options[0].getBoundingClientRect(),n=t.left+t.width/2;n-=e.left,n-=this.$optionsArrow.outerWidth()/2,this.$optionsArrow.css({left:n})},close:function(){this.removeOptions(),this.$el.removeClass("opened"),this.trigger("close")},onRemove:function(){this.removeOptions(),Pn(document).off(".selectBox",this.onOutsideClick)},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.close(),this.$el.addClass("disabled")},onSetTheme:function(t,e){this.$options&&(t&&this.$options.removeClass(this.themeClassNamePrefix+t),this.$options.addClass(this.themeClassNamePrefix+e))},calculateElOverflow:function(t,e){e||(e=window),t instanceof Pn&&(t=t[0]),e instanceof Pn&&(e=e[0]);var n={},i=t.getBoundingClientRect(),r;if(e===window){var s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;r={width:s,height:o,left:0,top:0,right:s,bottom:o}}else r=e.getBoundingClientRect();return["left","top"].forEach(function(a){n[a]=Math.min(0,i[a]-r[a])}),["right","bottom"].forEach(function(a){n[a]=Math.min(0,r[a]-i[a])}),Jt(n,function(a,l){n[l]=Math.abs(Math.round(a))}),n}},{OptionsView:ce.extend({events:{"mouseover .select-box-option":"onOptionHover","click .select-box-option":"onOptionClick"},className:function(){var t=["select-box-options"],e=this.options.parentClassName;return e&&t.push(e),t.join(" ")},init:function(){hn(this,"onMouseout","onKeydown"),Pn(document).on({"keydown.selectBoxOptions":this.onKeydown,"mouseleave.selectBoxOptions mouseout.selectBoxOptions":this.onMouseout})},render:function(){var t=this.options.extraClassName;return t&&this.$el.addClass(t),this.options.width&&this.$el.css("width",this.options.width),pt(this.options.options).forEach(function(e,n){var i=this.renderOption(e,n);this.options.selectBoxView.selection===e&&i.addClass("selected hover"),this.$el.append(i)},this),this.$arrow=Pn("<div/>").addClass("select-box-options-arrow").appendTo(this.$el),this},renderOption:function(t,e){var n=this.renderOptionContent(t);return n.addClass("select-box-option"),n.data("index",e),n},renderOptionContent:function(t){var e=Pn("<div/>").addClass("select-box-option-content").html(t.content);return t.icon&&e.prepend(Pn("<img/>").addClass("select-box-option-icon").attr("src",t.icon)),e},select:function(t,e={}){this.trigger("option:select",t,e)},hover:function(t){var e=this.options.options[t];this.markOptionHover(t),this.trigger("option:hover",e,t)},onOptionClick:function(t){var e=this.getOptionIndex(t.target);this.select(e,{ui:!0})},onOptionHover:function(t){var e=this.getOptionIndex(t.target);this.hover(e)},onMouseout:function(t){this.trigger("options:mouseout",t)},onKeydown:function(t){var e=this.options.selectBoxView;if(e.options.keyboardNavigation&&e.isOpen()){var n;switch(t.which){case 39:case 40:n=1;break;case 38:case 37:n=-1;break;case 13:var i=this.getOptionHoverIndex();i>=0&&this.select(i);return;case 27:return e.close();default:return}t.preventDefault();var r=this.getOptionHoverIndex(),s=r+n,o=this.options.options;s<0&&(s=o.length-1),s>=o.length&&(s=0),this.hover(s)}},onRemove:function(){Pn(document).off(".selectBoxOptions")},markOptionHover:function(t){this.$el.find(".hover").removeClass("hover"),Pn(this.$el.find(".select-box-option")[t]).addClass("hover")},getOptionHoverIndex:function(){const t=this.el.querySelector(".select-box-option.hover");return Array.prototype.indexOf.call(t.parentNode.children,t)},getOptionIndex:function(t){return Number(t.closest(".select-box-option").dataset.index)}})}),ld=q,J_=ol.extend({className:"select-box color-palette",position:function(){var t=this.$(".select-box-selection"),e=t.outerHeight(),n=t.offset(),i=n.left,r=n.top+e;if(this.options.target!==document.body){this.$target=this.$target||ld(this.options.target);var s=this.$target.offset();i-=s.left-this.$target.scrollLeft(),r-=s.top-this.$target.scrollTop()}this.$options.css({left:i,top:r})}},{OptionsView:ol.OptionsView.extend({renderOptionContent:function(t){var e=ld("<div/>").addClass("select-box-option-content");return e.css("background-color",t.content),t.icon&&e.prepend(ld("<img/>").addClass("select-box-option-icon").attr("src",t.icon)),e}})}),_c=q,Q_=ce.extend({className:"context-toolbar",eventNamespace:"context-toolbar",events:{"click .tool":"onToolPointerdown","touchstart .tool":"onToolPointerdown"},options:{padding:20,autoClose:!0,vertical:!1,anchor:"top",position:"bottom",scale:1},documentEvents:{mousedown:"onDocumentPointerdown",touchstart:"onDocumentPointerdown"},init:function(){hn(this,"onDocumentPointerdown")},render:function(){const t=this.options,e=this.constructor;return e.opened&&e.close(),t.autoClose&&setTimeout(this.delegateAutoCloseEvents.bind(this),0),t.type&&(this.el.dataset.type=t.type),this.beforeMount(),this.getRoot().append(this.el),this.renderContent(),this.position(),this.scale(),e.opened=this,this},delegateAutoCloseEvents:function(){this.delegateDocumentEvents(),document.addEventListener("mousedown",this.onDocumentPointerdown,!0),document.addEventListener("touchstart",this.onDocumentPointerdown,!0)},undelegateAutoCloseEvents:function(){this.undelegateDocumentEvents(),document.removeEventListener("mousedown",this.onDocumentPointerdown,!0),document.removeEventListener("touchstart",this.onDocumentPointerdown,!0)},beforeMount:function(){this.$el.toggleClass("joint-vertical",!!this.options.vertical)},renderContent:function(){const t=_c("<div/>").addClass("tools");this.options.tools&&pt(this.options.tools).forEach(function(e){var n;e.icon?n=_c("<img/>").prop("src",e.icon):n=e.content;var i=_c("<button/>").addClass("tool").html(n).data("action",e.action);e.attrs&&i.attr(e.attrs),t.append(i)}),this.$el.append(t)},getRoot:function(){return _c(this.options.root||document.documentElement)[0]},position:function(){const{target:t,padding:e,position:n,anchor:i}=this.options,{$el:r}=this,s={x:0,y:0};if(L.toNode(t)!==void 0){const h=ws(t),u=Os(h,n);s.x=u.x,s.y=u.y;const d=Os(new Z().inflate(e),n);s.x+=d.x,s.y+=d.y}else{const h=new M(t);s.x=h.x,s.y=h.y}const o=r.outerWidth(),a=r.outerHeight(),l=Os(new Z(0,0,o,a),i);s.x-=l.x,s.y-=l.y;const c=ws(this.getRoot());s.x-=c.x,s.y-=c.y,r.css({left:s.x,top:s.y})},scale(){const{scale:t,anchor:e}=this.options;if(t){this.el.style.transform=`scale(${t}, ${t})`;const n=zw(e).split("-");n[0]==="corner"&&(n[0]="bottom",n[1]="right"),n[0]==="origin"&&(n[0]="top",n[1]="left"),n[1]==="middle"&&(n[1]=null),this.el.style.transformOrigin=`${n[0]} ${n[1]?n[1]:""}`}},onRemove:function(){this.undelegateAutoCloseEvents(),this.constructor.opened=void 0},onToolPointerdown:function(t){const e=t.currentTarget.dataset.action;e&&this.trigger("action:"+e,t)},onDocumentPointerdown:function(t){const{el:e,options:n}=this,{target:i}=n,r=t.target;L.toNode(i)!==void 0&&(!i||i.contains(r))||e.contains(r)||(this.constructor.close(),this.remove())}},{opened:void 0,close:function(){const{opened:t}=this;t&&(t.trigger("close"),t.remove(),this.opened=null)},update:function(){this.opened&&this.opened.position()}}),zr=q,Nn=ce.extend({className:"dialog",events:{"click .bg":"action","click .btn-close":"action","click .controls button":"action","mousedown .titlebar":"onDragStart","touchstart .titlebar":"onDragStart"},options:{draggable:!1,closeButtonContent:"&times;",closeButton:!0,inlined:!1,modal:!0,width:0,title:"",buttons:null,type:"",content:null},init:function(){hn(this,"onDrag","onDragEnd"),this.buttons=this.options.buttons},render:function(){var t=zr("<div/>").addClass("bg").data("action","close"),e=zr("<div/>").addClass("fg"),n=zr("<div/>").addClass("titlebar"),i=zr("<div/>").addClass("body"),r=zr("<button/>").addClass("btn-close").html(this.options.closeButtonContent).data("action","close"),s=zr("<div/>").addClass("controls");if(this.$el.toggleClass("draggable",!!this.options.draggable),this.options.type&&(this.el.dataset.type=this.options.type),this.options.inlined&&this.$el.addClass("inlined"),this.options.modal&&this.$el.addClass("modal"),this.options.width&&e.css("width",this.options.width),this.options.title?n.append(this.options.title):n.addClass("empty"),this.options.content&&i.append(this.options.content),this.buttons){var o=[],a=[],l=[];this.buttons.forEach(function(c){var h=zr("<button/>").addClass("control-button").html(c.content).data("action",c.action);c.position?c.position==="left"?(h.addClass(c.position),l.push(h)):c.position==="center"?(h.addClass(c.position),a.push(h)):(h.addClass(c.position),o.push(h)):o.push(h)}),o.reverse().forEach(function(c){s.append(c)}),l.forEach(function(c){s.append(c)}),a.forEach(function(c){s.append(c)})}return e.append(n,i,s),this.options.closeButton&&e.append(r),this.$el.empty().append(t,e),this},open:function(t){return this.delegateEvents(),this.on("action:close",this.close,this),zr(t||document.body).append(this.render().el),this.$el.addClass("rendered"),this},close:function(){return this.remove(),this.trigger("close"),this},action:function(t){var e=t.target.closest("[data-action]"),n=e.dataset.action;n&&this.trigger("action:"+n)},onDragStart:function(t){if(this.options.draggable){t.preventDefault(),t=at(t);const e=this.$el.find(".fg").offset();this.delegateDocumentEvents({mousemove:this.onDrag,touchmove:this.onDrag,mouseup:this.onDragEnd,touchend:this.onDragEnd},{dx:t.clientX-e.left,dy:t.clientY-e.top})}},onDrag:function(t){t=at(t);const{data:e}=t;this.$(".fg").offset({top:t.clientY-e.dy,left:t.clientX-e.dx})},onDragEnd:function(){this.undelegateDocumentEvents()}}),tS=Nn.extend({className:Nn.prototype.className+" flash-message",options:Te({},Nn.prototype.options,{closeButton:!0,modal:!1,cascade:!0,closeAnimation:{delay:2e3,duration:200,easing:"ease-in-out",properties:{opacity:0}},openAnimation:{duration:200,easing:"ease-in-out",properties:{opacity:1}}}),init:function(){hn(this,"startCloseAnimation"),Nn.prototype.init.apply(this,arguments),this.on("close:animation:complete",this.close,this)},open:function(){Nn.prototype.open.apply(this,arguments);var t=this.$(".fg");return this._foregroundHeight=t.height(),this.addToCascade(),t.css("height",0),this.startOpenAnimation(),this.options.closeAnimation&&this.options.closeAnimation.delay&&setTimeout(this.startCloseAnimation,this.options.closeAnimation.delay),this},close:function(){return Nn.prototype.close.apply(this,arguments),this.removeFromCascade(),this},addToCascade:function(){if(this.options.cascade){var t=this.constructor.top;this.$(".fg").css("top",t),this.constructor.top+=this._foregroundHeight+this.constructor.padding}this.constructor.opened.push(this)},removeFromCascade:function(){if(this.options.cascade){for(var t=this.constructor.opened,e=!1,n=0;n<t.length;n++){var i=t[n];if(i.options.cascade&&e){var r=parseInt(i.$(".fg").css("top"),10);i.$(".fg").css("top",r-this._foregroundHeight-this.constructor.padding)}i===this&&(e=!0)}e&&(this.constructor.top-=this._foregroundHeight+this.constructor.padding)}this.constructor.opened=Vo(this.constructor.opened,this)},startCloseAnimation:function(){const{closeAnimation:t}=this.options,{properties:e}=t;this.$(".fg").animate(e,H({complete:()=>this.trigger("close:animation:complete")},Qe(t,"delay")))},startOpenAnimation:function(){const{openAnimation:t}=this.options,e=H({},t.properties,{height:this._foregroundHeight});this.$(".fg").animate(e,H({complete:()=>this.trigger("open:animation:complete")},t))}},{top:20,padding:15,opened:[],open:function(t,e,n){return n=n||{},new tS(H({title:e,type:"info",content:t},n)).open(n.target)},close:function(){Ue(this.opened,"close")}}),Sc=q,eS=ce.extend({className:"free-transform",events:{"mousedown .resize":"startResizing","mousedown .rotate":"startRotating","touchstart .resize":"startResizing","touchstart .rotate":"startRotating"},DIRECTIONS:["nw","n","ne","e","se","s","sw","w"],POSITIONS:["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],options:{cellView:void 0,rotateAngleGrid:15,resizeGrid:void 0,preserveAspectRatio:!1,minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,allowOrthogonalResize:!0,resizeDirections:null,allowRotation:!0,clearAll:!0,clearOnBlankPointerdown:!0,usePaperScale:!1,padding:3},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup"},init:function(){var t=this.options;t.cellView?me(t,{cell:t.cellView.model,paper:t.cellView.paper,graph:t.cellView.paper.model}):t.paper&&t.cell&&me(t,{cellView:t.cell.findView(t.paper),graph:t.paper.model});const{paper:e,clearAll:n}=t;n&&this.constructor.clear(e),this.startListening(),e.$el.append(this.el),this.constructor.registerInstanceToPaper(this,e)},startListening:function(){const{cell:t,paper:e,graph:n,clearOnBlankPointerdown:i}=this.options;this.listenTo(t,"change:size change:position change:angle",this.onCellAttributeChange),this.listenTo(e,"transform",()=>this.requestUpdate()),this.listenTo(n,"reset",()=>this.remove()),this.listenTo(t,"remove",()=>this.remove()),i&&this.listenTo(e,"blank:pointerdown",()=>this.remove())},onCellAttributeChange:function(t,e,n){n.updateHandled||this.requestUpdate()},renderHandles:function(){const{options:t,POSITIONS:e}=this;var n=Sc("<div/>").prop("draggable",!1),i=n.clone().addClass("rotate"),r=e.map(o=>n.clone().addClass("resize").data("position",o));const{resizeDirections:s}=t;Array.isArray(s)&&r.forEach((o,a)=>{s.includes(e[a])||o.css("display","none")}),this.$el.empty().append(r,i)},render:function(){const{options:t,$el:e}=this,{cell:n,preserveAspectRatio:i,allowRotation:r,allowOrthogonalResize:s}=t;e.data("type",n.get("type")),e.toggleClass("no-orthogonal-resize",i||!s),e.toggleClass("no-rotation",!r),this.renderHandles(),this.requestUpdate()},requestUpdate:function(t){const{UPDATE_PRIORITY:e,options:n}=this;n.paper.requestViewUpdate(this,1,e,t)},confirmUpdate:function(){this.update()},update:function(){this.options.usePaperScale?this.updateFrameScaled():this.updateFrameNoScale(),this.updateHandleDirections()},updateFrameScaled:function(){const{paper:t,cell:e,padding:n}=this.options,{left:i,right:r,top:s,bottom:o}=Re(n);let{x:a,y:l,width:c,height:h}=e.getBBox().moveAndExpand({x:-i,y:-s,width:i+r,height:s+o});const u=e.angle(),d=t.matrix().translate(a,l).translate(c/2,h/2).rotate(u).translate(-c/2,-h/2),f=L.matrixToTransformString(d);this.$el.css({width:c,height:h,left:0,top:0,"transform-origin":"0 0",transform:f,"-webkit-transform":f,"-ms-transform":f})},updateFrameNoScale:function(){const{paper:t,cell:e,padding:n}=this.options,{left:i,right:r,top:s,bottom:o}=Re(n),{a,d:l,e:c,f:h}=t.matrix(),u=e.getBBox(),d=e.angle();u.x*=a,u.x+=c,u.y*=l,u.y+=h,u.width*=a,u.height*=l,u.moveAndExpand({x:-i,y:-s,width:i+r,height:s+o});const f=`rotate(${d}deg)`;this.$el.css({width:u.width,height:u.height,left:u.x,top:u.y,"transform-origin":"50% 50%",transform:f,"-webkit-transform":f,"-ms-transform":f})},updateHandleDirections:function(){var t=this.options.cell.angle(),e=Math.floor(t*(this.DIRECTIONS.length/360));if(e!=this._previousDirectionsShift){var n=this.DIRECTIONS.slice(e).concat(this.DIRECTIONS.slice(0,e));Array.from(this.$(".resize").removeClass(this.DIRECTIONS.join(" "))).forEach(function(i,r){Sc(i).addClass(n[r])}),this._previousDirectionsShift=e}},calculateTrueDirection:function(t){var e=this.options.cell,n=nn(e.get("angle")),i=this.POSITIONS.indexOf(t);return i+=Math.floor(n*(this.POSITIONS.length/360)),i%=this.POSITIONS.length,this.POSITIONS[i]},startResizing:function(t){t.stopPropagation();const{options:e}=this,{cell:n,graph:i,paper:r}=e;i.startBatch("free-transform",{freeTransform:this.cid});var s=t.target.dataset.position,o=this.calculateTrueDirection(s),a=0,l=0;s.split("-").forEach(function(P){a={left:-1,right:1}[P]||a,l={top:-1,bottom:1}[P]||l});var c=this.toValidResizeDirection(s),h={"top-right":"bottomLeft","top-left":"corner","bottom-left":"topRight","bottom-right":"origin"}[c];const{minWidth:u,minHeight:d,maxWidth:f,maxHeight:p}=e,g=typeof u=="function"?u.call(this,n,this):u,v=typeof d=="function"?d.call(this,n,this):d,x=typeof f=="function"?f.call(this,n,this):f,S=typeof p=="function"?p.call(this,n,this):p,C={action:"resize",angle:n.angle(),resizeX:a,resizeY:l,selector:h,direction:c,relativeDirection:s,trueDirection:o,maxHeight:S,minHeight:v,maxWidth:x,minWidth:g,cellView:n.findView(r)};this.startOp(t.target),this.eventData(t,C),this.trigger(`${C.action}:start`,t),this.delegateDocumentEvents(null,t.data)},toValidResizeDirection:function(t){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[t]||t},startRotating:function(t){t.stopPropagation();const e=at(t);this.options.graph.startBatch("free-transform",{freeTransform:this.cid});var n=this.options.cell.getBBox().center(),i=this.options.paper.snapToGrid({x:e.clientX,y:e.clientY});const r={action:"rotate",centerRotation:n,modelAngle:nn(this.options.cell.get("angle")||0),startAngle:oe(i).theta(n)};this.startOp(t.target),this.eventData(t,r),this.trigger(`${r.action}:start`,t),this.delegateDocumentEvents(null,t.data)},pointermove:function(t){var e=this.eventData(t);const{action:n,maxHeight:i,maxWidth:r,minHeight:s,minWidth:o,cellView:a}=e;if(n){t=at(t);var l=this.options,c=l.cell,h=l.paper.snapToGrid({x:t.clientX,y:t.clientY}),u=l.paper.options.gridSize,d=l.resizeGrid||{},f=d.width||u,p=d.height||u;switch(n){case"resize":var g=c.getBBox(),v=oe(h).rotate(g.center(),e.angle),x=v.difference(g[e.selector]()),S=e.resizeX?x.x*e.resizeX:g.width,C=e.resizeY?x.y*e.resizeY:g.height;if(S=pi(S,f),C=pi(C,p),S=Math.max(S,o||f),C=Math.max(C,s||p),S=Math.min(S,r),C=Math.min(C,i),l.preserveAspectRatio){var P=g.width*C/g.height,k=g.height*S/g.width;P>S?C=k:S=P}if(g.width!=S||g.height!=C){const m={freeTransform:this.cid,direction:e.direction,relativeDirection:e.relativeDirection,trueDirection:e.trueDirection,ui:!0,minWidth:o,minHeight:s,maxWidth:r,maxHeight:i,preserveAspectRatio:l.preserveAspectRatio};a.scalableNode&&(m.async=!1),c.resize(S,C,m)}break;case"rotate":var N=e.startAngle-oe(h).theta(e.centerRotation);c.rotate(pi(e.modelAngle+N,l.rotateAngleGrid),!0,null,{freeTransform:this.cid});break}this.trigger(`${n}`,t)}},pointerup:function(t){this.undelegateDocumentEvents();const e=this.eventData(t);e.action&&(this.stopOp(),this.trigger(`${e.action}:stop`,t),this.options.graph.stopBatch("free-transform",{freeTransform:this.cid}))},onRemove:function(){eS.unregisterInstanceFromPaper(this,this.options.paper)},startOp:function(t){t&&(Sc(t).addClass("in-operation"),this._elementOp=t),this.$el.addClass("in-operation"),this.options.paper.undelegateEvents()},stopOp:function(){this._elementOp&&(Sc(this._elementOp).removeClass("in-operation"),this._elementOp=null),this.$el.removeClass("in-operation"),this.options.paper.delegateEvents()}},{instancesByPaper:{},clear:function(t){t.trigger("freetransform:create"),this.removeInstancesForPaper(t)},removeInstancesForPaper:function(t){Ue(this.getInstancesForPaper(t),"remove")},getInstancesForPaper:function(t){return this.instancesByPaper[t.cid]||{}},registerInstanceToPaper:function(t,e){this.instancesByPaper[e.cid]||(this.instancesByPaper[e.cid]={}),this.instancesByPaper[e.cid][t.cid]=t},unregisterInstanceFromPaper:function(t,e){this.instancesByPaper[e.cid]&&(this.instancesByPaper[e.cid][t.cid]=null)}}),Ia=q,Iz={N:"n",NW:"nw",W:"w",SW:"sw",S:"s",SE:"se",E:"e",NE:"ne"};var nS=function(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"direction",position:"se",events:{pointerdown:"directionSwap"},icon:null}],bbox:function(t){const{paper:e}=t;return e.localToPaperPoint(t.getPointAtRatio(.5))},typeCssName:"type-link",tinyThreshold:-1,smallThreshold:-1,boxContent:!1}};nS.prototype.directionSwap=function(){var t=this.options.cellView.model;t.set({source:t.get("target"),target:t.get("source")},{halo:this.cid})};var ln=function(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"},icon:null},{name:"clone",position:"n",events:{pointerdown:"startCloning",pointermove:"doClone",pointerup:"stopCloning"},icon:null},{name:"link",position:"e",events:{pointerdown:"startLinking",pointermove:"doLink",pointerup:"stopLinking"},icon:null},{name:"fork",position:"ne",events:{pointerdown:"startForking",pointermove:"doFork",pointerup:"stopForking"},icon:null},{name:"unlink",position:"w",events:{pointerdown:"unlinkElement"},icon:null},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"},icon:null}],bbox:function(t,e){return t.getBBox({useModelGeometry:e.options.useModelGeometry})},typeCssName:"type-element",tinyThreshold:40,smallThreshold:80,boxContent:function(t,e){var n=Xn("x: <%= x %>, y: <%= y %>, width: <%= width %>, height: <%= height %>, angle: <%= angle %>"),i=t.model,r=i.getBBox();return n({x:Math.floor(r.x),y:Math.floor(r.y),width:Math.floor(r.width),height:Math.floor(r.height),angle:Math.floor(i.get("angle")||0)})},magnet:function(t){return t.el},loopLinkPreferredSide:"top",loopLinkWidth:40,rotateAngleGrid:15,rotateEmbeds:!1,linkAttributes:{},smoothLinks:void 0}};ln.prototype.startLinking=function(t,e,n){this.startBatch();var i=this.options,r=i.paper,s=i.graph,o=this.createLinkConnectedToSource(t);o.set({target:{x:e,y:n}}).addTo(s,{validation:!1,halo:this.cid,async:!1}),r.undelegateEvents();var a=this._linkView=o.findView(r);a.startArrowheadMove("target",{whenNotAllowed:"remove"})};ln.prototype.startForking=function(t,e,n){var i=this.options,r=i.paper,s=i.graph;this.startBatch();const[o,...a]=this.cloneCell({fork:!0}),l=[o,...tn(a,f=>f.isLink())];s.addCells(l,{halo:this.cid,async:!1}),this.centerElementAtCursor(o,e,n);var c=this.createLinkConnectedToSource(t),h=o.findView(r),u=this.getElementMagnet(h,"target",t),d=this.getLinkEnd(h,u,t);c.set("target",d).addTo(s,{halo:this.cid,async:!1}),h.pointerdown(t,e,n),this.eventData(t,{cloneView:h})};ln.prototype.getElementMagnet=function(t,e,n){var i=this.options.magnet;if(_t(i)){var r=i.call(this,t,e,n);if(r instanceof SVGElement)return r}throw new Error("ui.Halo: magnet() has to return an SVGElement.")},ln.prototype.getLinkEnd=function(t,e,n){var i={id:t.model.id};if(e!==t.el){var r=t.findAttribute("port",e);r?i.port=r:i.selector=t.getSelector(e)}return i},ln.prototype.createLinkConnectedToSource=function(t){var e=this.options,n=e.paper,i=e.cellView,r=this.getElementMagnet(i,"source",t),s=this.getLinkEnd(i,r,t),o=n.getDefaultLink(i,r).set("source",s);return o.attr(e.linkAttributes),jp(e.smoothLinks)&&o.set("smooth",e.smoothLinks),o},ln.prototype.startResizing=function(t){this.startBatch(),this._flip=[1,0,0,1,1,0,0,1][Math.floor(nn(this.options.cellView.model.get("angle"))/45)]};ln.prototype.startRotating=function(t,e,n){this.startBatch();var i=this.options.cellView.model,r=i.getBBox().center(),s=[i];this.options.rotateEmbeds&&i.getEmbeddedCells({deep:!0}).reduce(function(o,a){return a.isElement()&&o.push(a),o},s),this.eventData(t,{center:r,elements:s,rotationStartAngles:s.map(function(o){return o.angle()}),clientStartAngle:new M(e,n).theta(r)})};ln.prototype.doResize=function(t,e,n,i,r){var s=this.options.cellView.model.get("size"),o=Math.max(s.width+(this._flip?i:r),1),a=Math.max(s.height+(this._flip?r:i),1);this.options.cellView.model.resize(o,a,{absolute:!0,halo:this.cid})};ln.prototype.doRotate=function(t,e,n){var i=this.eventData(t),r=i.clientStartAngle-new M(e,n).theta(i.center);i.elements.forEach(function(s,o){var a=i.rotationStartAngles[o],l=pi(a+r,this.options.rotateAngleGrid);s.rotate(l,!0,i.center,{halo:this.cid})},this)};ln.prototype.doClone=function(t,e,n){var i=this.eventData(t),r=i.cloneView;r&&r.pointermove(t,e,n)};ln.prototype.startCloning=function(t,e,n){const{options:i}=this,{paper:r}=i,{model:s}=r;this.startBatch();const[o,...a]=this.cloneCell({clone:!0}),l=[o,...tn(a,h=>h.isLink())];s.addCells(l,{halo:this.cid,async:!1}),this.centerElementAtCursor(o,e,n);const c=o.findView(r);c.pointerdown(t,e,n),this.eventData(t,{cloneView:c})};ln.prototype.centerElementAtCursor=function(t,e,n){var i=t.getBBox().center(),r=e-i.x,s=n-i.y;t.translate(r,s,{deep:!0,halo:this.cid})};ln.prototype.doFork=function(t,e,n){var i=this.eventData(t),r=i.cloneView;r&&r.pointermove(t,e,n)};ln.prototype.doLink=function(t,e,n){this._linkView&&this._linkView.pointermove(t,e,n)};ln.prototype.stopLinking=function(t,e,n){var i=this._linkView;if(i){i.pointerup(t,e,n);var r=i.model;r.hasLoop()&&this.makeLoopLink(r),this.triggerAction("link","add",r),this.stopBatch(),this._linkView=null}this.options.paper.delegateEvents()};ln.prototype.stopForking=function(t,e,n){var i=this.eventData(t),r=i.cloneView;r&&r.pointerup(t,e,n),this.stopBatch()};ln.prototype.stopCloning=function(t,e,n){var i=this.eventData(t),r=i.cloneView;r&&r.pointerup(t,e,n),this.stopBatch()};ln.prototype.unlinkElement=function(t){this.startBatch(),this.options.graph.removeLinks(this.options.cellView.model),this.stopBatch()};ln.prototype.makeLoopLink=function(t){const{loopLinkPreferredSide:e,loopLinkWidth:n,paper:i}=this.options,{width:r,height:s}=i.getComputedSize(),o=new Z({x:0,y:0,width:r,height:s}),a=i.paperToLocalRect(this.options.cellView.getBBox());let l,c;Ii([e,"top","bottom","left","right"]).find(function(d){let f,p=0,g=0;switch(d){case"top":f=new M(a.x+a.width/2,a.y-n),p=n/2;break;case"bottom":f=new M(a.x+a.width/2,a.y+a.height+n),p=n/2;break;case"left":f=new M(a.x-n,a.y+a.height/2),g=n/2;break;case"right":f=new M(a.x+a.width+n,a.y+a.height/2),g=n/2;break}return l=f.clone().offset(-p,-g),c=f.clone().offset(p,g),o.containsPoint(l)&&o.containsPoint(c)},this)&&t.set("vertices",[l,c],{halo:this.cid})};const kz=ce.extend({PIE_INNER_RADIUS:20,PIE_OUTER_RADIUS:50,className:"halo",events:{"mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown","mousedown .pie-toggle":"onPieTogglePointerDown","touchstart .pie-toggle":"onPieTogglePointerDown"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup"},options:{clearAll:!0,clearOnBlankPointerdown:!0,useModelGeometry:!1,clone:function(t,e){return t.clone().unset("z")},type:"surrounding",pieSliceAngle:45,pieStartAngleOffset:0,pieIconSize:14,pieToggles:[{name:"default",position:"e"}]},init:function(){var t=this.options,e=t.cellView,n=e.model,i=n.isLink()?new nS:new ln;H(this,Qe(i,"options"));var r=e.paper,s=r.model;me(t,i.options,{paper:r,graph:s}),hn(this,"render","update"),t.clearAll&&this.constructor.clear(r),this.listenTo(s,"reset",this.close),this.listenTo(n,"remove",this.close),this.listenTo(r,"halo:create",this.close),t.clearOnBlankPointerdown&&this.listenTo(r,"blank:pointerdown",this.close),this.listenTo(s,"all",this.update),this.listenTo(r,"transform",this.update),this.handles=[],pt(t.handles).forEach(this.addHandle,this)},render:function(){var t=this.options;switch(this.$el.empty(),this.$handles=Ia("<div/>").addClass("handles").appendTo(this.el),this.$box=Ia("<label/>").addClass("box").appendTo(this.el),this.$pieToggles={},this.$el.addClass(t.type),this.$el.addClass(this.cellTypeCssClass()),this.el.dataset.type=t.cellView.model.get("type"),this.$handles.append(pt(this.handles).map(this.renderHandle,this)),t.type){case"toolbar":case"surrounding":this.hasHandle("fork")&&this.toggleFork();break;case"pie":pt(this.options.pieToggles).forEach(function(e){var n=Ia("<div/>");n.addClass("pie-toggle "+(e.position||"e")),n.data("name",e.name),Ns(n,e.attrs),n.appendTo(this.el),this.$pieToggles[e.name]=n},this);break;default:throw new Error("ui.Halo: unknown type")}return this.update(),this.$el.addClass("animate").appendTo(t.paper.el),this.setPieIcons(),this},setPieIcons:function(){if(this.options.type!=="pie")return;const t=this.$el.find(".handle");for(let l=0;l<t.length;l++){const c=t[l];var e,n=Ia(c),i=c.dataset.action,r=this.getHandle(i);if(r&&r.icon)return;var s=window.getComputedStyle(c,":before").getPropertyValue("content");s&&s!=="none"&&(e=n.find(".slice-text-icon"),e.length>0&&L(e[0]).text(s.replace(/['"]/g,"")));const u=window.getComputedStyle(c).backgroundImage;if(u){var o=u.match(/url\(['"]?([^'"]+)['"]?\)/);if(o){var a=o[1];e=n.find(".slice-img-icon"),e.length>0&&L(e[0]).attr("xlink:href",a)}}}},update:function(){if(this.isRendered()){this.updateBoxContent();var t=this.getBBox();this.$el.toggleClass("tiny",t.width<this.options.tinyThreshold&&t.height<this.options.tinyThreshold),this.$el.toggleClass("small",!this.$el.hasClass("tiny")&&t.width<this.options.smallThreshold&&t.height<this.options.smallThreshold),this.$el.css({width:t.width,height:t.height,left:t.x,top:t.y}),this.hasHandle("unlink")&&this.toggleUnlink()}},getBBox:function(){var t=this.options.cellView,e=this.options.bbox,n=_t(e)?e(t,this):e;return n=me({},n,{x:0,y:0,width:1,height:1}),xr(n)},cellTypeCssClass:function(){return this.options.typeCssName},updateBoxContent:function(){var t=this.options.boxContent,e=this.options.cellView;if(_t(t)){var n=t.call(this,e,this.$box[0]);n&&this.$box.html(n)}else t?this.$box.html(t):this.$box.remove()},extendHandles:function(t){Jt(t,(function(e){var n=this.getHandle(e.name);n&&H(n,e)}).bind(this))},addHandles:function(t){return pt(t).forEach(this.addHandle,this),this},addHandle:function(t){var e=this.getHandle(t.name);return e||(this.handles.push(t),Jt(t.events,(function(n,i){ne(n)?this.on("action:"+t.name+":"+i,this[n],this):this.on("action:"+t.name+":"+i,n)}).bind(this)),this.$handles&&this.renderHandle(t).appendTo(this.$handles)),this},renderHandle:function(t){var e=this.getHandleIdx(t.name),n=Ia("<div/>").addClass("handle").addClass(t.name).data("action",t.name).prop("draggable",!1);switch(this.options.type){case"toolbar":case"surrounding":n.addClass(t.position),t.content&&n.html(t.content);break;case"pie":var i=this.PIE_OUTER_RADIUS,r=this.PIE_INNER_RADIUS,s=(i+r)/2,o=oe(i,i),a=un(this.options.pieSliceAngle),l=e*a+un(this.options.pieStartAngleOffset),c=l+a,h=L.createSlicePathData(r,i,l,c),u=L("svg").addClass("slice-svg"),d=L("path").attr("d",h).translate(i,i).addClass("slice"),f=oe.fromPolar(s,-l-a/2,o),p=this.options.pieIconSize,g=L("image").attr(f).addClass("slice-img-icon");f.y=f.y+p-2;var v=L("text",{"font-size":p}).attr(f).addClass("slice-text-icon");g.attr({width:p,height:p}),g.translate(-p/2,-p/2),v.translate(-p/2,-p/2),u.append([d,g,v]),n.append(u.node);break}return t.icon&&this.setHandleIcon(n,t.icon),Ns(n,t.attrs),n},setHandleIcon:function(t,e){switch(this.options.type){case"pie":var n=t.find(".slice-img-icon");L(n[0]).attr("xlink:href",e);break;case"toolbar":case"surrounding":t.css("background-image","url("+e+")");break}},removeHandles:function(){for(;this.handles.length;)this.removeHandle(this.handles[0].name);return this},removeHandle:function(t){var e=this.getHandleIdx(t),n=this.handles[e];return n&&(Jt(n.events,(function(i,r){this.off("action:"+t+":"+r)}).bind(this)),this.$(".handle."+t).remove(),this.handles.splice(e,1)),this},changeHandle:function(t,e){var n=this.getHandle(t);return n&&(this.removeHandle(t),this.addHandle(Te({name:t},n,e))),this},hasHandle:function(t){return this.getHandleIdx(t)!==-1},getHandleIdx:function(t){return pt(this.handles).findIndex(function(e){return e.name===t})},getHandle:function(t){return pt(this.handles).find(function(e){return e.name===t})},toggleHandle:function(t,e){var n=this.getHandle(t);if(n){var i=this.$(".handle."+t);e===void 0&&(e=!i.hasClass("selected")),i.toggleClass("selected",e);var r=e?n.iconSelected:n.icon;r&&this.setHandleIcon(i,r)}return this},selectHandle:function(t){return this.toggleHandle(t,!0)},deselectHandle:function(t){return this.toggleHandle(t,!1)},deselectAllHandles:function(){return pt(this.handles).forEach(function(t){this.deselectHandle(t.name)},this),this},onHandlePointerDown:function(t){var e=this._action=t.currentTarget.dataset.action;if(!e)return;t.preventDefault(),t.stopPropagation(),t=at(t);const{x:n,y:i}=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY});this._localX=n,this._localY=i,this._evt=t,t.type==="mousedown"&&t.button===2?this.triggerAction(e,"contextmenu",t,n,i):(this.triggerAction(e,"pointerdown",t,n,i),this.delegateDocumentEvents(null,t.data))},onPieTogglePointerDown:function(t){t.stopPropagation();var e=t.target.closest(".pie-toggle"),n=e.dataset.name;this.isOpen(n)?this.toggleState(n):this.isOpen()?(this.toggleState(),this.toggleState(n)):this.toggleState(n)},triggerAction:function(t,e,n){var i=Array.prototype.slice.call(arguments,2);i.unshift("action:"+t+":"+e),this.trigger.apply(this,i)},stopBatch:function(){const{graph:t}=this.options;t.hasActiveBatch("halo")&&t.stopBatch("halo",{halo:this.cid})},startBatch:function(){this.options.graph.startBatch("halo",{halo:this.cid})},pointermove:function(t){if(this._action){t.preventDefault(),t.stopPropagation(),t=at(t);var e=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY}),n=e.x-this._localX,i=e.y-this._localY;this._localX=e.x,this._localY=e.y,this._evt=t,this.triggerAction(this._action,"pointermove",t,e.x,e.y,n,i)}},pointerup:function(t){var e=this._action;if(e){this._action=null,this._evt=null;var n=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY});this.triggerAction(e,"pointerup",t,n.x,n.y),this.undelegateDocumentEvents()}},onRemove:function(){this._action&&this._evt&&this.pointerup(this._evt),this.stopBatch()},close:function(){return this.closed||(this.closed=!0,this.remove(),this.trigger("close")),this},onSetTheme:function(){this.setPieIcons()},removeElement:function(){this.options.cellView.model.remove()},toggleUnlink:function(){var t=this.options.graph.getConnectedLinks(this.options.cellView.model).length>0;this.$handles.children(".unlink").toggleClass("hidden",!t)},toggleFork:function(){const t=this.canFork();this.$handles.children(".fork").toggleClass("hidden",!t)},canFork:function(){const{cellView:t,paper:e}=this.options,{validateConnection:n}=e.options;if(typeof n!="function")return!0;const[i]=this.cloneCell({fork:!0,validation:!0}),r=e.createViewForModel(i),s=n.call(e,t,null,r,null,"target");return r.remove(),s},cloneCell:function(t={}){const{cellView:e,clone:n}=this.options,i=n(e.model,t);if(i instanceof an)return[i];if(Array.isArray(i)&&i.length>0&&i.every(r=>r instanceof an))return i;throw new Error('ui.Halo: option "clone" has to return a cell.')},toggleState:function(t){if(this.isRendered()){var e=this.$el;if(Jt(this.$pieToggles,function(i){i.removeClass("open")}),this.isOpen())this.trigger("state:close",t),e.removeClass("open");else{if(this.trigger("state:open",t),t){var n=pt(this.options.pieToggles).find(function(i){return i.name===t});n&&(this.el.dataset.pieTogglePosition=n.position,this.el.dataset.pieToggleName=n.name),this.$pieToggles[t].addClass("open")}e.addClass("open")}}},isOpen:function(t){return this.isRendered()?t?this.$pieToggles[t].hasClass("open"):this.$el.hasClass("open"):!1},isRendered:function(){return this.$box!==void 0}},{clear:function(t){t.trigger("halo:create")},HandlePosition:Iz}),hs=q,cg=ce.extend({className:"select-button-group",events:{"click .select-button-group-button":"onSelect","mouseover .select-button-group-button":"onOptionHover",mouseleave:"onMouseOut","mousedown .select-button-group-button":"pointerdown","touchstart .select-button-group-button":"pointerdown","mouseup .select-button-group-button":"pointerup","touchend .select-button-group-button":"pointerup"},options:{options:[],disabled:!1,multi:!1,selected:void 0,singleDeselect:!1,noSelectionValue:void 0,width:void 0,buttonWidth:void 0,buttonHeight:void 0,iconWidth:void 0,iconHeight:void 0},init:function(){hn(this,"onSelect","pointerup"),hs.data.set(this.el,"view",this);var t=this.options.options,e=this.options.multi,n=this.options.selected;if(n===void 0){var i=pt(t).filter(function(r){return r&&r.selected===!0});e?this.selection=i:this.selection=i[0]}else e?this.selection=Array.isArray(n)?t.filter(function(r,s){return n.includes(s)}):[t[n]]:this.selection=t[n]},render:function(){return this.renderOptions(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions(),pt(this.options.options).forEach(function(t,e){var n=this.options.multi?this.selection.includes(t):this.selection===t,i=this.renderOption(t,e,n);this.$el.append(i),n&&i.addClass("selected")},this)},removeOptions:function(){this.$el.empty()},renderOption:function(t,e,n){var i=this.renderOptionContent(t,n);i.data("index",e);var r=t.buttonWidth||this.options.buttonWidth;r&&i.css("width",r);var s=t.buttonHeight||this.options.buttonHeight;return s&&i.css("height",s),i},renderOptionContent:function(t,e){var n=hs("<div/>").addClass("select-button-group-button").html(t.content);if(t.icon||e&&t.iconSelected){var i=hs("<img/>").addClass("select-button-group-button-icon").attr("src",e&&t.iconSelected?t.iconSelected:t.icon),r=t.iconWidth||this.options.iconWidth;r&&i.css("width",r);var s=t.iconHeight||this.options.iconHeight;s&&i.css("height",s),n.prepend(i)}return Ns(n,t.attrs),n},setOptions:function(t,e){this.options.options=t,this.selection=e,this.render(),this.trigger("option:select",this.selection)},getOptionIndex:function(t){return Number(t.closest(".select-button-group-button").dataset.index)},onSelect:function(t){if(!this.isDisabled()){var e=this.getOptionIndex(t.target);this.select(e,{ui:!0})}},onOptionHover:function(t){if(!this.isDisabled()){var e=this.getOptionIndex(t.target);this.trigger("option:hover",this.options.options[e],e)}},onMouseOut:function(t){this.isDisabled()||this.trigger("mouseout",t)},getSelection:function(){return this.selection},getSelectionValue:function(t){t=t||this.selection;var e=this.options.noSelectionValue,n=this.options.multi;if(n){var i=pt(t);return i.length===0?e!==void 0?e:[]:i.map(function(s){var o=s.value;return o!==void 0?o:s.content})}if(!t)return e!==void 0?e:void 0;var r=t.value;return r!==void 0?r:t.content},select:function(t,e){var n=hs(this.$(".select-button-group-button")[t]),i=this.options.options[t],r=null,s=null,o=null,a=null,l;if(this.options.multi)n.toggleClass("selected"),l=n.hasClass("selected"),l?(o=t,a=i,this.selection.indexOf(i)===-1&&this.selection.push(i),i.iconSelected&&n.find(".select-button-group-button-icon").attr("src",i.iconSelected)):(r=t,s=i,this.selection=Vo(this.selection,i),i.iconSelected&&n.find(".select-button-group-button-icon").attr("src",i.icon));else{var c=this.$(".selected");let d=-1;if(c.length>0){const[f]=c;d=Array.prototype.indexOf.call(f.parentNode.children,f)}var h=this.options.options[d];n.toggleClass("selected"),l=n.hasClass("selected"),l?(h&&(r=d,s=h,c.removeClass("selected"),h.iconSelected&&c.find(".select-button-group-button-icon").attr("src",h.icon)),o=t,a=i,this.selection=i,i.iconSelected&&n.find(".select-button-group-button-icon").attr("src",i.iconSelected)):this.options.singleDeselect?(r=t,s=i,this.selection=void 0,i.iconSelected&&n.find(".select-button-group-button-icon").attr("src",i.icon)):n.addClass("selected")}var u=H({},e);u.deselectedIndex=r,u.deselectedOption=s,u.selectedIndex=o,u.selectedOption=a,this.trigger("option:select",this.selection,t,u)},selectByValue:function(t,e){Array.isArray(t)||(t=[t]);for(var n=this.options.options||[],i=0;i<n.length;i++){var r=n[i];if(r.value===void 0&&t.includes(r.content))this.select(i,e);else if(r.value!==void 0){var s=t.find(function(o){return ke(o,r.value)});s&&this.select(i,e)}}},deselect:function(){this.$(".selected").removeClass("selected"),this.options.multi?this.selection=[]:this.selection=void 0},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},pointerdown:function(t){var e=this.getOptionIndex(t.target),n=hs(this.$(".select-button-group-button")[e]);n.addClass("is-in-action"),hs(document).on("mouseup.select-button-group touchend.select-button-group",this.pointerup)},pointerup:function(){this.$(".is-in-action").removeClass("is-in-action"),hs(document).off("mouseup.select-button-group touchend.select-button-group")}}),iS=ce.extend({className:"radio-group",events:{"click input":"onOptionClick"},options:{options:[],name:void 0},currentValue:void 0,groupOptions:void 0,name:void 0,inputOptions:{},init:function(){this.groupOptions=this.options.options||[],this.name=this.options.name||this.cid},render:function(){return this.renderOptions(),this},renderOptions:function(){this.el.innerHTML="",this.inputOptions={},this.groupOptions.forEach((t,e)=>{this.renderOption(t,e)})},renderOption:function(t,e){const n=document.createElement("label");n.setAttribute("tabindex",0);const i=document.createElement("input");i.type="radio",i.value=t.value,i.name=this.name,n.appendChild(i),this.inputOptions[t.value]={input:i,index:e};const r=document.createElement("span");r.innerHTML=t.content,n.appendChild(r),this.el.appendChild(n)},getSelectionIndex:function(){return this.inputOptions[this.currentValue].index},getCurrentValue:function(){return this.currentValue},select:function(t){const e=this.groupOptions[t].value;e&&this.selectByValue(e)},selectByValue:function(t){const e=this.inputOptions[t];if(e){const n=e.input;n&&n.value!==this.currentValue&&(n.checked=!0,this.currentValue=n.value,this.trigger("option:select",this.currentValue,this))}},onOptionClick:function(t){const e=t.target;e.value!==this.currentValue&&this.selectByValue(e.value)},setOptions:function(t){this.groupOptions=t,this.renderOptions();const e=this.inputOptions[this.currentValue];e&&e.input?e.input.checked=!0:(this.currentValue=null,this.trigger("option:select",this.currentValue,this))}});class Oz{constructor(){this.dependencies={}}subscribe(e,n){e.forEach(i=>{const r=i.path;this.dependencies[r]||(this.dependencies[r]=[]),this.dependencies[r].push({callback:n,dependency:i})})}changed(e){Object.getOwnPropertyNames(this.dependencies).filter(r=>this.isSubPathOrSuperPath(r,e)).forEach(r=>{this.dependencies[r].forEach(s=>{s.callback(s.dependency,e)})})}clear(){this.dependencies={}}isSubPathOrSuperPath(e,n){const i=e.split("/"),r=n.split("/");return i.length>r.length?!r.some((s,o)=>!ke(s,i[o])):!i.some((s,o)=>!ke(s,r[o]))}}class Lz{constructor(e,n,i){this.inspector=e,this.dependencyService=n,this.sources={},this.options=i||{}}add(e,n,i){if(this.sources[e]={sourceOption:n,updateFunction:i,initialized:!1},n.dependencies){const r=n.dependencies.map(s=>({name:s,path:this.resolveDependency(e,s)}));this.dependencyService.subscribe(r,(s,o)=>{const a={};a[s.name]={path:s.path,changedPath:o},this.refresh(e,{dependencies:a})})}}initSources(){for(const e in this.sources){const n=this.sources[e];n.initialized||(this.refresh(e,{initialized:!0}),n.initialized=!0)}}refresh(e,n={}){const i=this.sources[e];if(i){const r=this.inspector.getModel(),s=n.dependencies||{};i.sourceOption.dependencies&&i.sourceOption.dependencies.forEach(a=>{const l=this.resolveDependency(e,a);s[a]||(s[a]={path:l,changedPath:null}),s[a].value=r.prop(l)});const o=i.sourceOption.source({dependencies:s,inspector:this.inspector,model:r,initialized:!!n.initialized,path:e});o instanceof Promise?o.then(a=>{i.updateFunction(a)}).catch(a=>{console.error("Inspector source resolving: "+a)}):i.updateFunction(o)}}refreshAll(){for(const e in this.sources)this.refresh(e)}resolveDependency(e,n){const i=this.options.wildcard,r=n.split("/"),s=e.split("/");return r.reduce((o,a,l)=>a===i?o+s[l]+"/":o+a+"/","").slice(0,-1)}clear(){this.sources={}}}const Lt=q;function jv(t,e){const n=[];for(let i=0;i<t.length;i++){const r=t[i];r.matches(e)||n.push(r)}return n}const $a=ce.extend({className:"inspector",options:{cellView:void 0,cell:void 0,live:!0,validateInput:function(t,e,n,i){return t.validity?t.validity.valid:!0},renderFieldContent:void 0,renderLabel:void 0,focusField:void 0,operators:{},multiOpenGroups:!0,container:null,stateKey:function(t){return t.id}},events:{"change [data-attribute]:not([data-custom-field])":"onChangeInput","click .group-label":"onGroupLabelClick","click .btn-list-add":"addListItem","click .btn-list-del":"deleteListItem","mousedown .field":"pointerdown","touchstart .field":"pointerdown","focusin .field":"pointerfocusin","focusout .field":"pointerfocusout"},HTMLEntities:{lt:"<",gt:">",amp:"&",nbsp:" ",quot:'"',cent:"",pound:"",euro:"",yen:"",copy:"",reg:""},init:function(){var t=this.options.groups=this.options.groups||{};hn(this,"stopBatchCommand","pointerup","onContentEditableBlur","replaceHTMLEntity"),this.DEFAULT_PATH_WILDCARD="${index}",this.pathWildcard=this.options.pathWildcard,this.widgets={},this._byPath={},this._attributeKeysInUse=[],this.flatAttributes=this.flattenInputs(this.options.inputs),this.expandAttributes=this.expandAttrs(this.options.inputs||{}),this._when={},this.dependencyService=new Oz,this.sourceService=new Lz(this,this.dependencyService,{wildcard:this.pathWildcard||this.DEFAULT_PATH_WILDCARD});var e=Object.keys(this.flatAttributes).map(function(s){var o=this.flatAttributes[s];return this._registerDependants.call(this,o,s),o.path=s,o},this);for(var n in t){var i=t[n];i&&t.hasOwnProperty(n)&&this.extractExpressionPaths(i.when).forEach(function(s){this._when[s]||(this._when[s]=[])},this)}var r=tn(e,"index");this.groupedFlatAttributes=tn(r,(function(s){var o=this.options.groups[s.group];return o&&o.index||Number.MAX_VALUE}).bind(this)),this.listenTo(this.getModel(),"all",this.onCellChange,this)},_registerDependants:function(t,e){if(t.when){const n=t.when,i={expression:n,path:e};this.extractExpressionPaths(n).forEach(function(r){(this._when[r]||(this._when[r]=[])).push(i)},this)}this._registerNestedDependants.call(this,t,e)},_registerNestedDependants:function(t,e){const n=Array.isArray(e)?e:e.split("/");if(t.type==="object"&&t.properties){const i=t.properties;Object.keys(i).forEach(function(r){const s=i[r],o=n.concat(r);this._registerDependants(s,o)},this)}else if(t.type==="list"&&t.item){const i=t.item,r=n.concat(null);this._registerDependants(i,r)}else typeof t.type!="string"&&Object.keys(t).forEach(function(i){const r=t[i];if(typeof r=="object"){const s=n.concat(i);this._registerDependants(r,s)}},this)},cacheInputs:function(){var t={};Array.from(this.$("[data-attribute]")).forEach(function(e){var n=e.dataset.attribute;t[n]=Lt(e)},this),this._byPath=t,this._attributeKeysInUse=this.getAttributeKeysInUse()},updateGroupsVisibility:function(){for(var t=this.$groups,e=0,n=t.length;e<n;e++){var i=Lt(t[e]),r=i.data("name"),s=this.options.groups[r],o=i.find(":scope > .field:not(.hidden)").length===0;i.toggleClass("empty",o);var a=!!(s&&s.when&&!this.isExpressionValid(s.when));i.toggleClass("hidden",a)}},expandAttrs:function(t){for(var e={},n=Object.keys(t),i=0;i<n.length;i++){var r=n[i],s=t[r],o=r.split("/");Go(e,o,Ce(s)?this.expandAttrs(s):s)}return e},flattenInputs:function(t){return qp(t,"/",function(e){return typeof e.type=="string"})},getModel:function(){return this.options.cell||this.options.cellView.model},onCellChange:function(t,e,n,i){if(i=i||{},i.inspector!=this.cid)switch(t){case"remove":this.constructor.instance&&this.trigger("close"),this.remove();break;case"change:position":this.updateInputPosition();break;case"change:size":this.updateInputSize();break;case"change:angle":this.updateInputAngle();break;case"change:source":case"change:target":case"change:vertices":break;default:var r="change:";if(t.slice(0,r.length)===r){var s=t.slice(r.length);this._attributeKeysInUse.includes(s)?this.render({refresh:!0}):this.dependencyService.changed(s)}break}},render:function(t){var e=t&&t.refresh;e&&this.options.storeGroupsState&&this.storeGroupsState(),this.sourceService.clear(),this.dependencyService.clear(),this.$el.empty(),this.removeWidgets();var n,i=[],r;return this.groupedFlatAttributes.forEach(function(s){if(n!==s.group){var o=this.options.groups[s.group];r=Lt(this.renderGroup({name:s.group,label:o&&o.label})),e||(o&&o.closed?this.closeGroup(r,{init:!0}):this.openGroup(r,{init:!0})),i.push(r)}this.renderTemplate(r,s,s.path),n=s.group},this),this.$document=Lt(this.el.ownerDocument),this.$groups=Lt(i),this.$el.append(i),e&&this.options.restoreGroupsState&&this.restoreGroupsState(),this.afterRender(),this},getAttributeKeysInUse:function(){var t=Object.keys(this._byPath).map(function(i){return i.substring(0,i.indexOf("/"))||i}),e=pt(this._bound),n=Object.keys(this._when);return Ii([].concat(t,e,n))},getCellAttributeValue:function(t,e){var n=this.getModel(),i=yn(n.attributes,t,"/");if(e=e||this.flatAttributes[t],!e)return i;if(i===void 0&&e.defaultValue!==void 0&&(i=e.defaultValue),e.valueRegExp){if(i===void 0)throw new Error("Inspector: defaultValue must be present when valueRegExp is used.");var r=i.match(new RegExp(e.valueRegExp));i=r&&r[2]}return i},resolvableTypes:["select","select-box","color-palette","select-button-group","radio-group"],resolveBindings:function(t){if(this.resolvableTypes.indexOf(t.type)>-1){var e=t.options||[];if(ne(e)){const n=e;e={dependencies:[n],source:i=>{const{value:r}=i.dependencies[n];return Array.isArray(r)?r.map(s=>ne(s)?{value:s,content:s}:s):[]}}}Array.isArray(e)&&!Vt(e[0])&&(e=pt(e).map(function(n){return{value:n,content:n}})),e.source?(t._optionsSource=e,t.items=[]):t.items=e}},renderFieldContent:function(t,e,n){var i;if(_t(this.options.renderFieldContent)&&(i=Lt(this.options.renderFieldContent(t,e,n,this)),i.length>0))return i.data("attribute",e),i.data("type",t.type),i.data("customField",!0),i.toArray();var r,s,o,a;switch(t.type){case"select-box":s=pt(t.items).findIndex(function(d){var f=d.value,p=n;if(f===void 0&&d.content===p)return!0;var g=t.key;return g&&(p=yn(p,g,"/"),f=yn(f,g,"/")),ke(f,p)});var l=H({theme:this.options.theme,target:this.options.container},Qe(t,"type","group","index","selectBoxOptionsClass","options"),{options:t.items,selected:s,selectBoxOptionsClass:[kn("inspector-select-box-options"),t.selectBoxOptionsClass].filter(function(d){return!!d}).join(" ")});r=new ol(l),r.el.dataset.attribute=e,r.el.dataset.type=t.type,t.overwrite!=null&&(r.el.dataset.overwrite=t.overwrite),r.render(),a=Lt(this.renderOwnLabel(t,e)),i=Lt("<div/>").append(a,r.el),t.previewMode?(o=r.selection,r.on("options:mouseout close",function(){r.selection=o,this.processInput(r.el,{previewCancel:!0,dry:!0})},this),r.on("option:hover",function(d,f){r.selection=d,this.processInput(r.el,{dry:!0})},this),r.on("option:select",function(d,f){var p=o===void 0?void 0:r.getSelectionValue(o),g=r.getSelectionValue(d),v=p===g;this.processInput(r.el,{previewDone:!0,dry:v,originalValue:p}),o=d},this)):r.on("option:select",function(d,f){this.processInput(r.el)},this),t._optionsSource&&this.sourceService.add(e,t._optionsSource,d=>{const f=this.getModel().prop(e);let p=d.findIndex(g=>{var v=g.value,x=f;if(v===void 0&&g.content===x)return!0;var S=t.key;return S&&(x=yn(x,S,"/"),v=yn(v,S,"/")),ke(v,x)});p===-1&&(p=void 0),r.setOptions(d,p)}),this.widgets[e]=r;break;case"color-palette":s=pt(t.items).findIndex(function(d){return d.value===n||d.value===void 0&&d.content===n});var c=H({theme:this.options.theme,target:this.options.container},Qe(t,"type","group","index","options"),{options:t.items,selected:s});r=new J_(c),r.el.dataset.attribute=e,r.el.dataset.type=t.type,r.render(),a=Lt(this.renderOwnLabel(t,e)),i=Lt("<div/>").append(a,r.el),t.previewMode?(o=r.selection,r.on("options:mouseout close",function(){r.selection=o,this.processInput(r.el,{previewCancel:!0,dry:!0})},this),r.on("option:hover",function(d,f){r.selection=d,this.processInput(r.el,{dry:!0})},this),r.on("option:select",function(d,f){var p=o===void 0?void 0:r.getSelectionValue(o),g=r.getSelectionValue(d),v=p===g;this.processInput(r.el,{previewDone:!0,dry:v,originalValue:p}),o=d},this)):r.on("option:select",function(d,f){this.processInput(r.el)},this),t._optionsSource&&this.sourceService.add(e,t._optionsSource,d=>{const f=this.getModel().prop(e);let p=d.findIndex(g=>g.value===f||g.value===void 0&&g.content===f);p===-1&&(p=void 0),r.setOptions(d,p)}),this.widgets[e]=r;break;case"select-button-group":{var h=(d,f)=>{var p,g,v=pt(d);return t.multi?(p=[],g=[],v.forEach(function(x,S){var C=x.value===void 0?x.content:x.value,P=t.key;P&&(C=yn(C,P,"/"));var k=pt(f).find(function(N){return P&&(N=yn(N,P,"/")),ke(C,N)});k&&(g.push(x),p.push(S))})):(g=void 0,p=v.findIndex(function(x){var S=x.value,C=f;if(S===void 0&&x.content===C)return!0;var P=t.key;return P&&(C=yn(C,P,"/"),S=yn(S,P,"/")),ke(S,C)}),p>-1&&(g=v[p])),{selectedIndex:p,selected:g}},u=H({theme:this.options.theme},Qe(t,"type","group","index","options"),{options:t.items,selected:h(t.items,n).selectedIndex});r=new cg(u),r.el.dataset.attribute=e,r.el.dataset.type=t.type,t.overwrite!=null&&(r.el.dataset.overwrite=t.overwrite),r.render(),a=Lt(this.renderOwnLabel(t,e)),i=Lt("<div/>").append(a,r.el),t.previewMode?(o=r.selection,r.on("mouseout",function(){r.selection=o,this.processInput(r.el,{previewCancel:!0,dry:!0})},this),r.on("option:hover",function(d,f){t.multi?r.selection=Ii(r.selection.concat([d])):r.selection=d,this.processInput(r.el,{dry:!0})},this),r.on("option:select",function(d,f){var p=o===void 0?void 0:r.getSelectionValue(o),g=r.getSelectionValue(d),v=ke(p,g);this.processInput(r.el,{previewDone:!0,dry:v,originalValue:p}),o=d},this)):r.on("option:select",function(d,f){this.processInput(r.el)},this),t._optionsSource&&this.sourceService.add(e,t._optionsSource,d=>{const f=this.getModel().prop(e);var p=h(d,f).selected;r.setOptions(d,p)}),this.widgets[e]=r;break}case"radio-group":{const d=H({theme:this.options.theme},Qe(t,"type","group","index","options"),{options:t.items,name:e}),f=new iS(d);f.render(),f.el.setAttribute("data-attribute",e),f.el.setAttribute("data-type",t.type),t.overwrite!=null&&f.el.setAttribute("data-overwrite",t.overwrite),a=Lt(this.renderOwnLabel(t,e)),i=Lt("<div/>").append(a,f.el),f.selectByValue(n),f.on("option:select",p=>{this.processInput(f.el)}),t._optionsSource&&this.sourceService.add(e,t._optionsSource,p=>{f.setOptions(p)}),this.widgets[e]=f;break}default:return this.renderOwnFieldContent({options:t,type:t.type,overwrite:t.overwrite,label:t.label||e,attribute:e,value:n})}return i.toArray()},renderGroup:function(t){const e=document.createElement("div");e.classList.add("group"),e.dataset.name=t.name;const n=document.createElement("h3");return n.classList.add("group-label"),n.textContent=t.label||t.name,e.appendChild(n),e},renderOwnLabel:function(t,e){var n,i=this.options.renderLabel;return typeof i=="function"&&(n=i(t,e,this)),n!==void 0?Lt(n).toArray():Lt("<label/>").html(t.label||e).toArray()},renderOwnFieldContent:function(t){var e,n,i,r,s,o,a,l;switch(l=Lt(this.renderOwnLabel(t.options,t.attribute)),t.type){case"number":n=Lt("<input/>").attr({type:"number",min:t.options.min,max:t.options.max,step:t.options.step}).val(t.value),e=[l,Lt("<div/>").addClass("input-wrapper").append(n)];break;case"range":l.addClass("with-output"),r=Lt("<output/>").text(t.value),s=Lt("<span/>").addClass("units").text(t.options.unit),n=Lt("<input/>").attr({type:"range",name:t.type,min:t.options.min,max:t.options.max,step:t.options.step}).val(t.value),n.on("change input",function(){r.text(n.val())}),e=[l,r,s,n];break;case"textarea":n=Lt("<textarea/>").text(t.value),e=[l,Lt("<div/>").addClass("input-wrapper").append(n)];break;case"content-editable":{const{value:u,options:d={}}=t,{html:f=!0,readonly:p=!1}=d;let g;ne(u)?g=(f?Ww(u):this.encodeHTMLEntities(u)).replace(/\n/g,"<br>"):g="",n=Lt("<div/>").prop("contentEditable",!p).toggleClass("content-editable-readonly",!!p).css("display","inline-block").html(g).on("blur",this.onContentEditableBlur),e=[l,Lt("<div/>").addClass("input-wrapper").append(n)];break}case"select":var c=t.options.items;n=Lt("<select/>"),t.options.multiple&&(n.prop("size",t.options.size||c.length),n.prop("multiple",!0));var h=function(u){return t.options.multiple?pt(t.value).find(function(d){return ke(u,d)}):ke(u,t.value)};pt(c).forEach(function(u){var d=Lt("<option/>").text(u.content).val(u.value);h(u.value)&&d.attr("selected","selected"),n.append(d)}),t.options._optionsSource&&this.sourceService.add(t.attribute,t.options._optionsSource,u=>{n.empty();const d=this.getModel().prop(t.attribute),f=p=>t.options.multiple?pt(d).find(function(g){return ke(p,g)}):ke(p,d);u.forEach(p=>{var g=Lt("<option/>",{value:p.value}).text(p.content);f(p.value)&&g.attr("selected","selected"),n.append(g)})}),e=[l,n];break;case"toggle":o=Lt("<span><i/></span>"),n=Lt("<input/>").attr("type","checkbox").prop("checked",!!t.value),i=Lt("<div/>").addClass(t.type),e=[l,i.append(n,o)];break;case"color":n=Lt("<input/>").attr("type","color").val(t.value),e=[l,n];break;case"text":n=Lt("<input/>").attr("type","text").val(t.value),e=[l,Lt("<div/>").addClass("input-wrapper").append(n)];break;case"object":n=Lt("<div/>"),a=Lt("<div/>").addClass("object-properties"),e=[l,n.append(a)];break;case"list":o=Lt("<button/>").addClass("btn-list-add").text(t.options.addButtonLabel||"+"),a=Lt("<div/>").addClass("list-items"),n=Lt("<div/>"),e=[l,n.append(o,a)];break}if(n&&n.length>0){n.addClass(t.type);const[u]=n;u.dataset.type=t.type,u.dataset.attribute=t.attribute,t.overwrite!=null&&(u.dataset.overwrite=t.overwrite)}return e.map(u=>u.toArray()).flat()},onContentEditableBlur:function(t){var e=Lt("<input/>").prop("disabled",!0).prop("tabIndex",-1).css({width:"1px",height:"1px",border:"none",margin:0,padding:0}).appendTo(this.$el);const[n]=e;n.focus(),n.setSelectionRange(0,0),n.blur(),e.remove(),t.target.dispatchEvent(new CustomEvent("change",{bubbles:!0}))},replaceHTMLEntity:function(t,e){return this.HTMLEntities[e]||""},encodeHTMLEntities:function(t){return t.replace(/[\u00A0-\u9999<>&]/g,function(e){return`&#${e.charCodeAt(0)};`})},renderObjectProperty:function(t={}){const e=document.createElement("div");return e.classList.add("object-property"),e.dataset.property=t.property,e},renderListItem:function(t={}){const e=document.createElement("button");e.classList.add("btn-list-del"),e.textContent=t.options.removeButtonLabel||"-";const n=document.createElement("div");return n.classList.add("list-item"),n.dataset.index=t.index,n.appendChild(e),n},renderFieldContainer:function(t={}){const e=document.createElement("div");return e.classList.add("field"),e.classList.add(`${t.type}-field`),e.dataset.field=t.path,e},renderTemplate:function(t,e,n,i){const r=Lt(t||this.el);i=i||{},this.resolveBindings(e),typeof e.type!="string"&&(e={type:"object",properties:e});const s=Lt(this.renderFieldContainer({path:n,type:e.type}));i.hidden&&s.addClass("hidden");const o=this.getCellAttributeValue(n,e),a=Lt(this.renderFieldContent(e,n,o));if(s.append(a),Ns(s,e.attrs),e.type==="list"&&e.item){pt(o).forEach(function(u,d){const f=this.renderListItem({index:d,options:e});this.renderTemplate(f,e.item,n+"/"+d),a.children(".list-items").append(f)},this);const l=o&&o.length,c=e&&e.min,h=e&&e.max;this.fixListButtons(a,l,c,h)}else if(e.type==="object"&&e.properties){const l=this.flattenInputs(e.properties);let c=Object.keys(l).map(function(h){const u=l[h];return u.path=h,u});c=tn(c,function(h){return h.index}),c.forEach(function(h){const u=this.renderObjectProperty({property:h.path});this.renderTemplate(u,h,n+"/"+h.path),a.children(".object-properties").append(u)},this)}if(i.replace){const[l]=r.find('[data-field="'+n+'"]');l&&s.length>0&&l.parentNode.replaceChild(s[0],l)}else r.append(s)},updateInputPosition:function(){var t=this._byPath["position/x"],e=this._byPath["position/y"],n=this.getModel().get("position");t&&t.val(n.x),e&&e.val(n.y)},updateInputSize:function(){var t=this._byPath["size/width"],e=this._byPath["size/height"],n=this.getModel().get("size");t&&t.val(n.width),e&&e.val(n.height)},updateInputAngle:function(){var t=this._byPath.angle,e=this.getModel().get("angle");t&&t.val(e)},validateInput:function(t,e,n){switch(t){case"select-box":case"color-palette":var i=this.widgets[n];return i?i.getSelectionIndex()!==-1:!1;case"select-button-group":return!!this.widgets[n];default:return this.options.validateInput(e,n,t,this)}},refreshSources:function(){this.sourceService.refreshAll()},refreshSource:function(t){this.sourceService.refresh(t)},focusField:function(t){const e=this.getOptionsFromPath(t),n=this._byPath[t];if(n)this._focusFieldInternal(e,t,n[0]);else throw"path not found"},_focusListField(t,e,n){const i=n.querySelector("[data-attribute]:not(.hidden)");i&&this._focusFieldInternal(t.item,i.getAttribute("data-attribute"),i)},_focusObjectField(t,e,n){const i=n.querySelector("[data-attribute]:not(.hidden)");if(i){const r=i.getAttribute("data-attribute"),s=this.getOptionsFromPath(r);this._focusFieldInternal(s,r,i)}},_focusFieldInternal(t,e,n){switch(t.type){case"number":case"text":case"range":case"color":case"toggle":case"select":case"textarea":case"content-editable":n.focus();break;case"object":this._focusObjectField(t,e,n);break;case"list":this._focusListField(t,e,n);break;default:this.options.focusField&&this.options.focusField(t,e,n,this);break}},onChangeInput:function(t){t.target===t.currentTarget&&this.processInput(t.target)},processInput:function(t,e){var n=t.dataset.attribute,i=t.dataset.type;if(this.validateInput(i,t,n)){this.options.live&&this.updateCell(t,n,e);var r=this.getFieldValue(t,i),s=this.parse(i,r,t);(!e||!e.dry)&&this.dependencyService.changed(n),this.trigger("change:"+n,s,t,e)}},updateFieldsVisibility:function(){this._attributeKeysInUse.forEach(t=>{this.updateDependants(t)})},updateDependants:function(t){const e=this._when,n=Object.keys(e),i=this._byPath,r=Object.keys(i),s=this.flatAttributes;l.call(this,n,t).forEach(d=>{const f=d.path;pt(e[f]).forEach(g=>{const v=g.path,x=g.expression,S=this._getBareExpression(x),C=this._getExpressionExtras(x);c(r,v).forEach(k=>{const N=k.path,m=k.comparisonWildcardValues,b=i[N],w=b.closest(".field"),T=w.hasClass("hidden"),E=a.call(this,S,m),D=this.isExpressionValid(E);w.toggleClass("hidden",!D);const $=C.otherwise;if($&&$.unset&&this.options.live)if(D)T&&this.updateCell(b,N);else{this.unsetProperty(N);const z=u(s,N);z&&this.renderTemplate(null,z,N,{replace:!0,hidden:!0}),this.afterPartialRender([N])}},this)},this)},this);function a(d,f){const p={};for(const v in d){const x=d[v];if(Array.isArray(x)){const S=v,C=x;p[S]=[];const P=C.length;for(let k=0;k<P;k++){const N=C[k],m=a.call(this,N,f);p[S].push(m)}}else if(this._isComposite(d)){const S=v,C=x,P=a.call(this,C,f);p[S]=P}else{const S=v,C=x;g.call(this,S,C,f,p)}}return p;function g(v,x,S,C){C[v]={};for(const k in x){const N=x[k],m=P.call(this,k,S);C[v][m]=N}function P(k,N){const m=this.pathWildcard||this.DEFAULT_PATH_WILDCARD,b=[];let w=0;const T=k.split("/"),E=T.length;for(let D=0;D<E;D++){let $=T[D];$===m&&($=N[w]||m,w+=1),b.push($)}return b.join("/")}}}function l(d,f){const p=f.split("/"),g=this.pathWildcard||this.DEFAULT_PATH_WILDCARD;return h(d,p,{pathWildcard:g})}function c(d,f){if(!Array.isArray(f))return[{path:f,pathWildcardValues:[],comparisonWildcardValues:[]}];const p=f;return p.indexOf(null)===-1?[{path:p.join("/"),pathWildcardValues:[],comparisonWildcardValues:[]}]:h(d,p,{comparisonWildcard:null})}function h(d,f,p){const{pathWildcard:g,comparisonWildcard:v}=p,x=[],S=f.length,C=d.length;for(let k=0;k<C;k++){const N=d[k],m=P(N),b=m.length;if(b!==S)continue;let w=!0;const T=[],E=[];for(let D=0;D<b;D++){const $=m[D],z=f[D],j=$===g,O=z===v;if($!==z&&!j&&!O){w=!1;break}j?T.push(z):O&&E.push($)}w&&x.push({path:N,pathWildcardValues:T,comparisonWildcardValues:E})}return x;function P(k){return Array.isArray(k)?k:k.split("/")}}function u(d,f){let p=d[f];if(p!=null)return p;const g=f.split("/"),v=g.length;let x=g[0];p=d[x];let S=p;for(let C=1;C<v;C++){const P=g[C];if(p===void 0){x+="/"+P,S===void 0?p=d[x]:p=S[x];continue}if(S=p,p.type==="object"&&p.properties)p=p.properties[P];else if(p.type==="list"&&p.item)p=p.item;else if(typeof p.type!="string")p=p[P];else break;x=P}return p}},unsetProperty:function(t,e){e=e||{},e.inspector=this.cid,e["inspector_"+this.cid]=!0,this.getModel().removeProp(t,e)},getOptions:function(t){if(t.length!==0){var e=t.data("attribute");return this.getOptionsFromPath(e)}},markForRemoval:function(t,e){var n=this.findParentListByPath(t);if(n){var i=t.substr(n.length+1),r=parseInt(i,10);Number.isFinite(r)&&(e.remove[n]=e.remove[n]||[],e.remove[n].includes(r)||e.remove[n].push(r))}},markForUpdate:function(t,e,n,i){var r=t.substr(i.length+1);e.update[i]&&Go(e.update[i].value,r,n,"/")},updateCell:function(t,e,n){var i=this.getModel(),r={};t?r[e]=Lt(t):r=this._byPath,this.startBatchCommand();var s={},o={update:{},remove:{}};Jt(r,(function(l,c){if(l.closest(".field").hasClass("hidden"))return;const[h]=l;var u=h.dataset.type,d=h.dataset.overwrite,f=d!=="false"&&d!==void 0,p=l.hasClass("remove");switch(u){case"list":p&&this.markForRemoval(c,o);break;case"object":p&&this.markForRemoval(c,o);break;default:if(!this.validateInput(u,h,c))return;var g=this.getFieldValue(h,u),v=this.parse(u,g,h),x=this.getOptionsFromPath(c);if(x.valueRegExp){var S=yn(i.attributes,c,"/")||x.defaultValue;v=S.replace(new RegExp(x.valueRegExp),"$1"+v+"$3")}if(p)this.markForRemoval(c,o);else{var C=x.parent;if(C&&C.type==="object"&&C.overwrite!==void 0&&C.overwrite!==!1){var P={},k=c.split("/"),N=k[k.length-1];P[N]=v,o.update[C.path]={value:P,overwrite:!0}}else s[c]={value:v,overwrite:f}}break}}).bind(this)),Jt(s,(function(l,c){this.setProperty(c,l.value,H({overwrite:l.overwrite},n))}).bind(this));var a=tn(Object.keys(o.remove),function(l){return l.split("/").length}).reverse();a.forEach((function(l){var c=o.remove[l];this.removeProperty(l,c,H({rewrite:!0},n))}).bind(this)),Jt(o.update,(function(l,c){this.setProperty(c,this.compactDeep(l.value),H({rewrite:!0,overwrite:l.overwrite},n))}).bind(this)),this.updateFieldsVisibility(),this.updateGroupsVisibility(),this.stopBatchCommand()},compactDeep:function(t){return Array.isArray(t)?t.reduce((function(e,n){return n&&e.push(this.compactDeep(n)),e}).bind(this),[]):t},findParentListByPath:function(t){var e=t.split("/");e.pop();for(var n=e;n.length;){var i=this.getOptionsFromPath(n.join("/"));if(i&&i.type==="list")return e.slice(0,n.length).join("/");n.pop()}return null},getOptionsFromPath:function(t){for(var e=t.split("/"),n=this.expandAttributes,i,r=[];e.length;){var s,o=s;n&&n.type==="object"?s="properties":(s=e.shift(),(e.length||n.type==="list")&&(i=n,r.push(s)));var a=!Number.isNaN(parseInt(s));if(s=a&&n.type==="list"?"item":s,Object(n)===n&&(s in n||n[t]))n=n[s]||n[t];else return{}}return n=H({},n),i=H({},i),i.path=r.join("/"),o&&o==="properties"&&(i.type="object"),n.parent=i,n},getFieldValue:function(t,e){if(_t(this.options.getFieldValue)){var n=this.options.getFieldValue(t,e,this);if(n)return n.value}var i=Lt(t);switch(e){case"select-box":case"color-palette":case"select-button-group":var r=t.dataset.attribute;return this.widgets[r].getSelectionValue();case"radio-group":return this.widgets[t.dataset.attribute].currentValue;case"select":return t.multiple?Array.from(t.selectedOptions).map(s=>s.value):t.value;case"content-editable":return i.html().replace(/((<br\s*\/*>)?<\/div>)|(((&nbsp;)|(<br\s*\/*>))?<\/p>)|(<br\s*\/*>)/ig,`
`).replace(/(<([^>]+)>)/ig,"").replace(/&(\w+);/ig,this.replaceHTMLEntity).replace(/\n$/,"");default:return t.value}},removeProperty:function(t,e,n){var i=this.getModel(),r=an.prototype.prop,s=r.call(i,t);if(s){var o=s.reduce(function(l,c,h){return e.includes(h)||l.push(c),l},[]),a=this.flatAttributes[t];Array.isArray(o)&&o.length===0&&!a&&(o=null),r.call(i,t,o,n)}},setProperty:function(t,e,n){n=n||{},n.inspector=this.cid;var i=an.prototype.prop,r=this.getModel(),s=n.overwrite||!1;if(n.previewDone&&i.call(r,t,n.originalValue,{rewrite:!0,silent:!0}),e===void 0)an.prototype.removeProp.call(r,t,n);else{var o;if(Vt(e)&&!s){var a=i.call(r,t),l=Array.isArray(e)?[]:{};o=Te(l,a,e)}else o=we(e);s&&(n.rewrite=!0),i.call(r,t,o,n)}},parse:function(t,e,n){switch(t){case"number":case"range":e=parseFloat(e);break;case"toggle":e=n.checked;break}return e},startBatchCommand:function(){if(!this.inBatch){this.inBatch=!0;var t=this.getModel();t instanceof an&&t.startBatch("inspector",{cid:this.cid})}},stopBatchCommand:function(){if(this.inBatch){var t=this.getModel();t instanceof an&&t.stopBatch("inspector",{cid:this.cid}),this.inBatch=!1}},afterRender:function(){this.cacheInputs(),this.updateFieldsVisibility(),this.updateGroupsVisibility(),this.sourceService.initSources(),this.trigger("render")},afterPartialRender:function(t){this.cacheInputs(),this.updateGroupsVisibility(),this.sourceService.initSources(),t&&t.forEach(e=>{this.dependencyService.changed(e)}),this.trigger("render")},addListItem:function(t){const e=t.target.parentNode;var n=e.matches("[data-attribute]")?Lt(e):Lt(),i=this.getOptions(n),r=n.children(".list-items"),s=r.children(".list-item"),o=Lt(s[s.length-1]),a=o.length===0?-1:Number(o.data("index")),l=a+1,c=this.renderListItem({index:l,options:i}),h=n.data("attribute")+"/"+l;this.renderTemplate(c,i.item,h),r.append(c),s=r.children(".list-item");var u=jv(s,".remove").length;this.fixListButtons(n,u,i.min,i.max),this.afterPartialRender([h]);let d=c;i.item.type!=="object"&&i.item.type!=="list"&&(d=d.querySelector("[data-attribute]")),this.options.live&&this.updateCell(),this._focusFieldInternal(i.item,h,d)},deleteListItem:function(t){var e=Lt(t.target),n=e.closest("[data-attribute]"),i=this.getOptions(n),r=e.closest(".list-item");r.css("display","none"),r.addClass("remove"),r.find("[data-field]").css("display","none").addClass("remove"),r.find("[data-attribute]").css("display","none").addClass("remove");var s=n.children(".list-items"),o=s.children(".list-item"),a=jv(o,".remove").length;this.fixListButtons(n,a,i.min,i.max);const l=n.data("attribute");this.afterPartialRender([l]),this.options.live&&this.updateCell()},fixListButtons:function(t,e,n,i){var r=function(h,u){return typeof u!="number"||typeof h!="number"?!0:h<u},s=function(h,u){return typeof u!="number"||u<=0?!0:typeof h!="number"||h<=0?!1:h>u},o=t.children(".btn-list-add"),a=r(e,i);a?o.removeClass("hidden"):o.addClass("hidden");var l=t.children(".list-items").children(".list-item").children(".btn-list-del"),c=s(e,n);c?l.removeClass("hidden"):l.addClass("hidden")},bindDocumentEvents:function(){var t=this.getEventNamespace();this.$document.on("mouseup"+t+" touchend"+t,this.pointerup)},unbindDocumentEvents:function(){this.$document.off(this.getEventNamespace())},pointerdown:function(t){t.stopPropagation(),this.bindDocumentEvents(),this.startBatchCommand(),this._$activeField=Lt(t.currentTarget).addClass("is-in-action")},pointerup:function(){this.unbindDocumentEvents(),this.stopBatchCommand(),this._$activeField&&(this._$activeField.removeClass("is-in-action"),this._$activeField=null)},pointerfocusin:function(t){t.stopPropagation(),Lt(t.currentTarget).addClass("is-focused")},pointerfocusout:function(t){t.stopPropagation(),Lt(t.currentTarget).removeClass("is-focused")},onRemove:function(){this.unbindDocumentEvents(),this.removeWidgets(),this===this.constructor.instance&&(this.constructor.instance=null)},removeWidgets:function(){var t=this.widgets;for(var e in t)t[e].remove();this.widgets={}},onGroupLabelClick:function(t){t.preventDefault(),this.options.multiOpenGroups||this.closeGroups();var e=Lt(t.target.closest(".group"));this.toggleGroup(e)},toggleGroup:function(t){var e=ne(t)?this.$('.group[data-name="'+t+'"]'):Lt(t);e.hasClass("closed")?this.openGroup(e):this.closeGroup(e)},closeGroup:function(t,e){e=e||{};var n=ne(t)?this.$('.group[data-name="'+t+'"]'):Lt(t);(e.init||!n.hasClass("closed"))&&(n.addClass("closed"),this.trigger("group:close",n.data("name"),e))},openGroup:function(t,e){e=e||{};var n=ne(t)?this.$('.group[data-name="'+t+'"]'):Lt(t);(e.init||n.hasClass("closed"))&&(n.removeClass("closed"),this.trigger("group:open",n.data("name"),e))},closeGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.closeGroup(this.$groups[t])},openGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.openGroup(this.$groups[t])},COMPOSITE_OPERATORS:["not","and","or","nor"],PRIMITIVE_OPERATORS:["eq","ne","regex","text","lt","lte","gt","gte","in","nin","equal"],_isComposite:function(t){return Zd(this.COMPOSITE_OPERATORS,Object.keys(t)).length>0},_isPrimitive:function(t){var e=Object.keys(this.options.operators).concat(this.PRIMITIVE_OPERATORS);return Zd(e,Object.keys(t)).length>0},_evalCustomPrimitive:function(t,e,n,i){return!!this.options.operators[t].apply(this,[this.getModel(),e].concat(n).concat([i]))},_evalPrimitive:function(t){return Object.keys(t).reduce((function(e,n){var i=t[n];return Object.keys(i).reduce((function(r,s){var o=i[s],a=this.getCellAttributeValue(s);if(_t(this.options.operators[n]))return this._evalCustomPrimitive(n,a,o,s);switch(n){case"eq":return o==a;case"ne":return o!=a;case"regex":return new RegExp(o).test(a);case"text":return!o||ne(a)&&a.toLowerCase().indexOf(o)>-1;case"lt":return a<o;case"lte":return a<=o;case"gt":return a>o;case"gte":return a>=o;case"in":return Array.isArray(o)&&o.includes(a);case"nin":return Array.isArray(o)&&!o.includes(a);case"equal":return ke(o,a);default:return r}}).bind(this),!1)}).bind(this),!1)},_evalExpression:function(t){if(this._isPrimitive(t))return this._evalPrimitive(t);if(!this._isComposite(t))throw new Error('Inspector: Invalid custom operator used in an expression. The operator "'+Object.keys(t)[0]+'" must be registered in the `operators` property.');return Object.keys(t).reduce((function(e,n){var i=t[n];if(n=="not")return!this._evalExpression(i);var r=pt(i).map(this._evalExpression,this);switch(n){case"and":return r.every(function(s){return!!s});case"or":return r.some(function(s){return!!s});case"nor":return!r.some(function(s){return!!s});default:return e}}).bind(this),!1)},_getBareExpression:function(t){return Qe(t,"otherwise","dependencies")},_getExpressionExtras:function(t){return{otherwise:we(t.otherwise),dependencies:we(t.dependencies)}},_extractVariables:function(t){return Array.isArray(t)||this._isComposite(t)?pt(t).reduce((function(e,n){return e.concat(this._extractVariables(n))}).bind(this),[]):pt(t).reduce(function(e,n){return Object.keys(n)},[])},isExpressionValid:function(t){const e=this._getBareExpression(t);return this._evalExpression(e)},extractExpressionPaths:function(t){var e=t&&t.dependencies||[];const n=this._getBareExpression(t);return Ii(this._extractVariables(n).concat(e))},getGroupsStateKey:function(){if(_t(this.options.stateKey))return this.options.stateKey(this.getModel());throw new Error("Inspector: Option stateKey must be a function")},storeGroupsState:function(){var t=this.getGroupsStateKey(),e=pt(this.$(".group.closed"));$a.groupStates[t]=e.map(function(n){return n.dataset.name})},getGroupsState:function(){return $a.groupStates[this.getGroupsStateKey()]},restoreGroupsState:function(){var t=function(n,i){Jt(i.options.groups,(function(r,s){n(r,s)?this.closeGroup(s):this.openGroup(s)}).bind(i))},e=this.getGroupsStateKey();$a.groupStates[e]?t(function(n,i){return $a.groupStates[e].includes(i)},this):t(function(n){return n.closed},this)}},{groupStates:{},instance:null,create:function(t,e){e=e||{},me(e,{updateCellOnClose:!0,restoreGroupsState:!0,storeGroupsState:!0});var n=e.cell||e.cellView.model,i=this.instance;return(!i||i.getModel()!==n)&&(i&&i.el.parentNode&&(e.storeGroupsState&&i.storeGroupsState(),e.updateCellOnClose&&i.updateCell(),i.trigger("close"),i.remove()),i=new this(e).render(),this.instance=i,Lt(t).html(i.el),e.restoreGroupsState&&i.restoreGroupsState()),i},close:function(){var t=this.instance;if(t){const{activeElement:e}=document;t.el!==e&&t.el.contains(e)&&e.blur(),t.trigger("close"),t.remove()}}}),Gn=function(t={}){hn(this,"handleKey"),this.options=H({},t),this.parser=new Po,this.enable()};H(Gn.prototype,rn);Gn.prototype.on=function(t,e,n){return rn.on.call(this,this.normalizeEvent(t),e,n),this};Gn.prototype.off=function(t,e,n){var i=t?this.normalizeEvent(t):null;return rn.off.call(this,i,e,n),this};Gn.prototype.normalizeEvent=function(t){if(typeof t=="object"){for(var e=Object.keys(t),n={},i=0,r=e.length;i<r;i++){var s=e[i];n[this.normalizeEvent(s)]=t[s]}return n}return this.normalizeShortcut(t)};Gn.prototype.normalizeShortcut=function(t){var e=t.toLowerCase();if(e in lf)return lf[e];for(var n=this.parser.toEventObjectList(t),i=[],r=0;r<n.length;r++)i.push(this.hash(n[r]));return i.join(" ")};Gn.prototype.enable=function(){window.addEventListener?(document.addEventListener("keydown",this.handleKey,!1),document.addEventListener("keypress",this.handleKey,!1),document.addEventListener("keyup",this.handleKey,!1)):window.attachEvent&&(document.attachEvent("keydown",this.handleKey,!1),document.attachEvent("keypress",this.handleKey,!1),document.attachEvent("keyup",this.handleKey,!1))};Gn.prototype.disable=function(){window.removeEventListener?(document.removeEventListener("keydown",this.handleKey,!1),document.removeEventListener("keypress",this.handleKey,!1),document.removeEventListener("keyup",this.handleKey,!1)):window.detachEvent&&(document.detachEvent("keydown",this.handleKey,!1),document.detachEvent("keypress",this.handleKey,!1),document.detachEvent("keyup",this.handleKey,!1))};Gn.prototype.isActive=function(t,e){return this.isModifierActive(t,e)};Gn.prototype.isModifierActive=function(t,e){for(var n=this.parser.toEventObjectList(t),i=0;i<n.length;i++)if(n[i].modifiersCompare(e))return!0;return!1};Gn.prototype.isKeyPrintable=function(t){if(!t)return!1;const{key:e}=t;return e?e.length===1||e==="Unidentified":!1};Gn.prototype.hash=function(t){var e=function(i){return i?1:0},n=[t.type,":",t.which,e(t.shiftKey),e(t.ctrlKey),e(t.altKey),e(t.metaKey)];return n.join("")};Gn.prototype.handleKey=function(t){const e=this.options.filter;if(typeof e=="function"){if(!e.call(this,t,this))return}else if(this.isConsumerElement(t))return;var n=Wo.fromNative(t);rn.trigger.call(this,this.hash(n),t),this.isKeyPrintable(t)&&rn.trigger.call(this,`${t.type}:printable`,t)};Gn.prototype.isConsumerElement=function(t){const e=t.target||t.srcElement;if(e){const n=e.tagName.toUpperCase();return n==="INPUT"||n==="SELECT"||n==="TEXTAREA"||e.isContentEditable}return!1};var Po=function(){};Po.prototype={constructor:Po,parseEventString:function(t){t=t||"";var e=t.split("+"),n,i=new Wo(0),r;for(r=0;r<e.length;r++){n=e[r];var s=this.getModifierPropertyName(n);s&&(i[s]=!0),(e.length===1||s===void 0)&&(i.which=Po.getCode(n))}return i},toEventObjectList:function(t){var e=t.replace(/\s*\+\s*/gi,"+").split(" ");return e.map(this.composeEventObject,this)},composeEventObject:function(t){var e=t.split(":"),n=ts.KEYDOWN,i=e[0];if(e.length>1&&(i=e[1],n=e[0]),Mz.indexOf(n)===-1)throw t+": invalid shortcut definition";var r=this.parseEventString(i);return n===ts.KEYUP&&Io[r.which]&&(r[Io[r.which]]=!1),r.setType(n)},getModifierPropertyName:function(t){var e=rS[t];return Io[e]}};Po.getCode=function(t){return sS[t]||t.toUpperCase().charCodeAt(0)};var rS={"":16,shift:16,"":18,alt:18,option:18,"":17,ctrl:17,control:17,"":91,command:91,meta:91},Io={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"},af={226:"\\",57392:"ctrl",63289:"num",59:";",61:"=",173:"-"},sS={backspace:8,tab:9,shift:16,ctrl:17,alt:18,meta:91,clear:12,enter:13,return:13,esc:27,escape:27,capslock:20,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,insert:45,ins:45,pageup:33,pagedown:34,plus:187,minus:189,"-":189,",":188,".":190,"/":191,"`":192,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123},lf={all:"all",printable:"keypress:printable","keypress:printable":"keypress:printable","keydown:printable":"keydown:printable","keyup:printable":"keyup:printable"};H(Gn,{keyMap:sS,modifierMap:Io,modifiers:rS,charCodeAlternatives:af,eventNamesMap:lf});var ts={KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup"},Mz=[ts.KEYPRESS,ts.KEYDOWN,ts.KEYUP],Wo=function(t,e,n,i,r,s){this.which=t,this.shiftKey=e||!1,this.ctrlKey=n||!1,this.altKey=i||!1,this.metaKey=r||!1,this.type=s||ts.KEYDOWN};Wo.fromNative=function(t){var e=t.which;t.type===ts.KEYPRESS&&(e=String.fromCharCode(t.which).toUpperCase().charCodeAt(0)),af[e]&&(e=Po.getCode(af[e]));var n=new Wo(e,t.shiftKey,t.ctrlKey,t.altKey,t.metaKey,t.type);return t.type===ts.KEYUP&&Io[e]&&(n[Io[e]]=!1),n};Wo.prototype.modifiersCompare=function(t){return(this.shiftKey?this.shiftKey===t.shiftKey:!0)&&(this.ctrlKey?this.ctrlKey===t.ctrlKey:!0)&&(this.altKey?this.altKey===t.altKey:!0)&&(this.metaKey?this.metaKey===t.metaKey:!0)};Wo.prototype.setType=function(t){return this.type=t,this};const cd=q,Dz=Nn.extend({className:Nn.prototype.className+" lightbox",options:Te({},Nn.prototype.options,{closeButton:!0,modal:!0,downloadable:!1,downloadAction:"download",fileName:"Image",closeAnimation:{duration:200,easing:"ease-in-out",properties:{opacity:0}},top:100,windowArea:.8,openAnimation:!1}),init:function(){if(hn(this,"startCloseAnimation","positionAndScale"),Nn.prototype.init.apply(this,arguments),this.options.image&&(this.$image=cd("<img/>").on("load",this.positionAndScale),this.options.content=this.$image),this.options.downloadable){var t={action:this.options.downloadAction,content:"Download",position:"center"};this.buttons=Array.isArray(this.buttons)?this.buttons.slice():[],this.buttons.push(t)}this.on("action:"+this.options.downloadAction,this.download),cd(window).on("resize",this.positionAndScale),this.on("close:animation:complete",()=>{Nn.prototype.close.apply(this,arguments)})},open:function(){return Nn.prototype.open.apply(this,arguments),this.$image&&this.$image.attr("src",this.options.image),this.positionAndScale(),this.startOpenAnimation(),this},positionAndScale:function(){var t=this.$(".fg"),e=this.$(".body > img"),n=this.$(".titlebar"),i=this.$(".controls"),r=this.options.windowArea,s=window.innerWidth*r;this.$el.css("margin-top",this.options.top),n.css("width",s);var o=n.height(),a=i.height(),l=window.innerHeight*r-this.options.top-o-a;t.css({width:s,height:l});var c=e.width(),h=e.height();t.css({width:c,height:h}),n.css("width","auto"),n.hasClass("empty")||i.css("top",n.outerHeight())},download:function(){Zp(this.options.image,(function(t,e){Xw(e,this.options.fileName)}).bind(this))},close:function(){return this.options.closeAnimation?this.startCloseAnimation():Nn.prototype.close.apply(this,arguments),this},onRemove:function(){Nn.prototype.onRemove.apply(this,arguments),cd(window).off("resize",this.positionAndScale),this.$image&&this.$image.off("load",this.positionAndScale)},startCloseAnimation:function(){this.$el.animate(this.options.closeAnimation.properties,H({complete:(function(){this.trigger("close:animation:complete")}).bind(this)},this.options.closeAnimation))},startOpenAnimation:function(){this.$el.animate(H({},this.options.openAnimation.properties,{height:this._foregroundHeight}),H({complete:(function(){this.trigger("open:animation:complete")}).bind(this)},this.options.openAnimation))}}),Wv=q,Nz=ce.extend({className:"navigator",events:{mousedown:"startAction",touchstart:"startAction"},documentEvents:{mousemove:"doAction",touchmove:"doAction",mouseup:"stopAction",touchend:"stopAction"},options:{paperConstructor:Ai,paperOptions:{},zoomOptions:null,zoom:{min:.5,max:2},width:300,height:200,padding:10},init:function(){this.options.zoomOptions?this.options.zoom=H({},this.options.zoom,this.options.zoomOptions):this.options.zoom&&(this.options.zoom=me({},this.options.zoom,this.constructor.prototype.options.zoom)),hn(this,"updateCurrentView","doAction","stopAction","scrollTo"),this.updateCurrentView=Nl(this.updateCurrentView,0);var t=this.options.paperScroller,e=this.sourcePaper=t.options.paper;this.toggleUseContentBBox(this.options.useContentBBox),this.targetPaper=new this.options.paperConstructor(Te({model:e.model,interactive:!1,frozen:!0},this.options.paperOptions))},startListening:function(){const{options:t,sourcePaper:e}=this,{useContentBBox:n,paperScroller:i}=t;n?this.listenTo(e,"render:done",()=>this.updatePaper()):this.listenTo(e,"resize",()=>this.updatePaper()),this.listenTo(i,"scroll",()=>this.updateCurrentView())},render:function(){if(this.targetPaper.$el.appendTo(this.el),this.targetPaper.unfreeze(),this.$currentView=Wv("<div>").addClass("current-view"),this.options.zoom){var t=Wv("<div>").addClass("current-view-control");this.$currentView.append(t)}return this.$el.append(this.$currentView).css({width:this.options.width,height:this.options.height,padding:this.options.padding}),this.updatePaper(),this},freeze(t){this.targetPaper.freeze(t)},unfreeze(t){this.targetPaper.unfreeze(t)},CONTENT_BBOX_CLASS_NAME:"navigator-use-content-bbox",NO_CONTENT_CLASS_NAME:"navigator-no-content",toggleUseContentBBox:function(t=!1){const{CONTENT_BBOX_CLASS_NAME:e,$el:n,targetPaper:i}=this;this.options.useContentBBox=t,this.stopListening(),this.startListening(),n.toggleClass(e,!!t),i&&this.updatePaper()},updatePaper:function(){const{sourcePaper:t,targetPaper:e,options:n,$el:i,NO_CONTENT_CLASS_NAME:r}=this,{useContentBBox:s}=n,o=s?t.getContentBBox(s):t.getComputedSize(),a=i.hasClass(r);if(o.width>0&&o.height>0)a&&(i.removeClass(r),e.unfreeze({key:"navigator"})),this.updatePaperWithBBox(o),this.updateCurrentView();else{if(a)return;i.addClass(r),e.freeze({key:"navigator"})}},updatePaperWithBBox:function(t){let{width:e,height:n,x:i=0,y:r=0}=t;if(!e||!n)return;const{sourcePaper:s,targetPaper:o,options:a}=this,{a:l,d:c,e:h,f:u}=s.matrix(),{padding:d,preserveAspectRatio:f=!0}=a,p=a.width-2*d,g=a.height-2*d;e/=l,n/=c;let v=p/e,x=g/n;if(f){const k=Math.min(v,x);v=k,x=k}this.ratioX=v,this.ratioY=x,e*=v,n*=x;const S=(h-i)*v/l,C=(u-r)*x/c;o.setDimensions(e,n);const P=o.matrix();P.e=S,P.f=C,P.a=v,P.d=x,o.matrix(P)},updateCurrentView:function(){if(this.$currentView){var t=this.ratioX,e=this.ratioY,n=this.sourcePaper.scale(),i=this.options.paperScroller,r=i.clientToLocalPoint(0,0),s=this.targetPaper.$el.position(),o=this.targetPaper.translate();o.ty=o.ty||0,this.currentViewGeometry={top:s.top+r.y*e+o.ty,left:s.left+r.x*t+o.tx,width:i.el.clientWidth*t/n.sx,height:i.el.clientHeight*e/n.sy},this.$currentView.css(this.currentViewGeometry)}},startAction:function(t){t=at(t);const{clientX:e,clientY:n}=t,i=t.target.classList.contains("current-view-control");!i&&!t.target.classList.contains("current-view")&&this.scrollTo(t);const s=i?"zooming":"panning",{options:o,currentViewGeometry:a,sourcePaper:l}=this,{paperScroller:c}=o;switch(this.delegateDocumentEvents(null,{action:s,startClientX:e,startClientY:n,startScrollLeft:c.el.scrollLeft,startScrollTop:c.el.scrollTop,startZoom:c.zoom(),startGeometry:a,startScale:l.scale()}),s){case"panning":{this.trigger("pan:start",t);break}case"zooming":{this.trigger("zoom:start",t);break}}},doAction:function(t){t=at(t);const{clientX:e,clientY:n,data:i}=t,{sourcePaper:r,options:s,ratioX:o,ratioY:a}=this,{action:l,startClientX:c,startClientY:h,startScrollLeft:u,startScrollTop:d,startZoom:f,startGeometry:p,startScale:g,frameId:v}=i,{paperScroller:x,zoom:S}=s;switch(l){case"panning":{const{sx:C,sy:P}=r.scale(),k=(e-c)*C,N=(n-h)*P;x.el.scrollLeft=u+k/o,x.el.scrollTop=d+N/a;break}case"zooming":{const{width:C}=p,P=1+(c-e)/C/g.sx;ks(v),i.frameId=Ho(()=>{x.zoom(P*f,me({absolute:!0},S))});break}}},stopAction:function(t){switch(this.undelegateDocumentEvents(),t.data.action){case"panning":{this.trigger("pan:stop",t);break}case"zooming":{this.trigger("zoom:stop",t);break}}},scrollTo:function(t){t=at(t);const{x:e,y:n}=this.targetPaper.clientToLocalPoint({x:t.clientX,y:t.clientY}),{paperScroller:i}=this.options;i.scroll(e,n)},onRemove:function(){this.targetPaper.remove()}}),qs=function(t,e){this.options=H({friction:.92},e),this.onInertiaMove=t,this._isDragging=!1,this.initialize()};qs.prototype.initialize=function(){this._dragLastX=0,this._dragLastY=0,this._dragDeltaX=0,this._dragDeltaY=0,this._dragLastDeltaX=0,this._dragLastDeltaY=0,this._velocityX=0,this._velocityY=0,this._requestAnimationFrameId=-1};qs.prototype.approxZero=function(t){return Math.abs(t)<.5};qs.prototype.updateVelocity=function(){const{_velocityX:t,_velocityY:e,_isDragging:n,options:i,onInertiaMove:r}=this;if(!n&&this.approxZero(t)&&this.approxZero(e)){this.initialize();return}if(this._requestAnimationFrameId=Ho(this.updateVelocity.bind(this)),n)this._dragLastDeltaX=this._dragDeltaX,this._dragLastDeltaY=this._dragDeltaY,this._dragDeltaX=this._dragLastX,this._dragDeltaY=this._dragLastY,this._velocityX=this._dragDeltaX-this._dragLastDeltaX,this._velocityY=this._dragDeltaY-this._dragLastDeltaY;else{const s=t,o=e,{friction:a}=i;this._velocityX*=a,this._velocityY*=a,typeof r=="function"&&r(s,o)}};qs.prototype.handleDragStart=function(t){this._isDragging=!0,ks(this._requestAnimationFrameId),this.initialize(),this._dragLastX=t.clientX,this._dragLastY=t.clientY,this._dragDeltaX=t.clientX,this._dragDeltaY=t.clientY,this.updateVelocity()};qs.prototype.handleDragMove=function(t){this._dragLastX=t.clientX,this._dragLastY=t.clientY};qs.prototype.handleDragEnd=function(t){this._isDragging=!1};function Rz(t){return t<=0?0:t>=1?1:.5-Math.cos(t*Math.PI)/2}function $z(t,e,n){const{duration:i=400,timingFunction:r=Rz,complete:s}=n,o=Date.now(),a=o+i,l=t.scrollLeft,c=t.scrollTop,h=e.scrollLeft||l,u=e.scrollTop||c,d=h-l,f=u-c;let p;function g(){const v=Date.now(),x=(v-o)/(a-o),S=r(x),C=Math.round(l+d*S),P=Math.round(c+f*S);if(t.scrollLeft=C,t.scrollTop=P,v>=a){s&&s();return}if(t.scrollLeft!==C&&t.scrollTop!==P){s&&s();return}p=setTimeout(g,0)}return g(),()=>clearTimeout(p)}const Bz=q,al=ce.extend({className:"paper-scroller",events:{scroll:"onScroll"},options:{paper:void 0,padding:function(){var t=this.getClientSize(),e=Math.max(this.options.minVisiblePaperSize,1)||1,n={};return n.left=n.right=Math.max(t.width-e,0),n.top=n.bottom=Math.max(t.height-e,0),n},scrollWhileDragging:!1,minVisiblePaperSize:50,autoResizePaper:!1,baseWidth:void 0,baseHeight:void 0,contentOptions:void 0,cursor:"default",inertia:!1,borderless:!1},_padding:{left:0,top:0},init:function(){hn(this,"startPanning","stopPanning","pan","onBackgroundEvent");const{options:t,el:e}=this,{paper:n,autoResizePaper:i,scrollWhileDragging:r,cursor:s,inertia:o,baseWidth:a,baseHeight:l}=t;var c=n.scale();this._sx=c.sx,this._sy=c.sy;const{width:h,height:u}=n.options;if(!Number.isFinite(h)||!Number.isFinite(u))throw new Error("PaperScroller: paper dimension must be a number");a===void 0&&(t.baseWidth=h),l===void 0&&(t.baseHeight=u),this.$background=Bz("<div/>").addClass("paper-scroller-background").css({width:n.options.width,height:n.options.height}).append(n.el).appendTo(e),this.listenTo(n,"scale",this.onScale).listenTo(n,"resize",this.onResize).listenTo(n,"beforeprint beforeexport",this.storeScrollPosition).listenTo(n,"afterprint afterexport",this.restoreScrollPosition),i&&this.listenTo(n,"render:done",this.onPaperRenderDone),r&&(this.listenTo(n,"cell:pointermove",this.onCellPointermove),this.listenTo(n,"cell:pointerup",this.onCellPointerup)),this.debouncedStoreCenter=Nl(()=>this.storeCenter()),this.storeCenter(n.options.width/2,n.options.height/2),this.delegateBackgroundEvents(),this.setCursor(s),o&&(this.inertia=new qs((function(f,p){const{el:g}=this;g.scrollTop-=p,g.scrollLeft-=f}).bind(this),o));const d=new ResizeObserver(()=>this.storeCenter());d.observe(e),this.resizeObserver=d},onCellPointermove:function(t,e,n,i){const{scrollWhileDragging:r}=this.options;r&&this.scrollWhileDragging(e,n,i,r)},onCellPointerup:function(t,e){this.stopScrollWhileDragging(e)},scrollWhileDragging:function(t,e,n,i={}){const{el:r}=this,{interval:s=25,padding:o=-20,scrollingFunction:a=w=>w<20?5:20}=i;let{scrollId:l}=this.eventData(t);const c=new M(e,n),{top:h,left:u,right:d,bottom:f}=Re(o),p=this.getVisibleArea().moveAndExpand({x:-u,y:-h,width:u+d,height:h+f});if(p.containsPoint(c)){clearInterval(l),this.eventData(t,{scrollId:null});return}const v=p.pointNearestToPoint(c).distance(c),x=a.call(this,v,t),{x:S,y:C,width:P,height:k}=p,N=e<S?-1:e>S+P?1:0,m=n<C?-1:n>C+k?1:0;if(this.eventData(t,{scrollX:N,scrollY:m,scrollPerTick:x,container:r}),l)return;const b=this.eventData(t);l=setInterval(({scrollPerTick:w,scrollX:T,scrollY:E,container:D})=>{D.scrollLeft+=w*T,D.scrollTop+=w*E},s,b),b.scrollId=l},stopScrollWhileDragging:function(t){const{scrollId:e}=this.eventData(t);e&&clearInterval(e)},onPaperRenderDone:function(t){t.priority<2&&this.adjustPaper()},lock:function(){return this.$el.css("overflow","hidden"),this},unlock:function(){return this.$el.css("overflow","scroll"),this},setCursor:function(t){switch(t){case"grab":this.$el.css("cursor","");break;default:this.$el.css("cursor",t);break}return this.$el.attr("data-cursor",t),this.options.cursor=t,this},delegateBackgroundEvents:function(t){t||(t=ee(this.options.paper,"events"));var e=this.paperEvents=Object.keys(t||{}).reduce(n.bind(this),{});Object.keys(e).forEach(i,this);function n(r,s){var o=t[s];return s.indexOf(" ")===-1&&(r[s]=_t(o)?o:this.options.paper[o]),r}function i(r){this.delegate(r,{guarded:!1},this.onBackgroundEvent)}return this},onBackgroundEvent:function(t){const[e]=this.$background;if(e===t.target){var n=this.paperEvents[t.type];_t(n)&&n.apply(this.options.paper,arguments)}},onScroll:function(t){this.trigger("scroll",t),this.debouncedStoreCenter()},onResize:function(){this.restoreCenter()},onScale:function(t,e,n,i){this.adjustScale(t,e),this._sx=t,this._sy=e,(n||i)&&this.center(n,i);const{contentOptions:r,borderless:s}=this.options;(typeof r=="function"||s)&&this.adjustPaper()},storeScrollPosition:function(){this._scrollLeftBeforePrint=this.el.scrollLeft,this._scrollTopBeforePrint=this.el.scrollTop},restoreScrollPosition:function(){this.el.scrollLeft=this._scrollLeftBeforePrint,this.el.scrollTop=this._scrollTopBeforePrint,this._scrollLeftBeforePrint=null,this._scrollTopBeforePrint=null},beforePaperManipulation:function(){(_s.test("msie")||_s.test("msedge"))&&this.$el.css("visibility","hidden")},afterPaperManipulation:function(){(_s.test("msie")||_s.test("msedge"))&&this.$el.css("visibility","visible")},clientToLocalPoint:function(t,e){var n=this.options.paper.matrix();return t+=this.getLTRScrollLeft()-this._padding.left-n.e,t/=n.a,e+=this.el.scrollTop-this._padding.top-n.f,e/=n.d,new M(t,e)},localToBackgroundPoint:function(t,e){var n=new M(t,e),i=this.options.paper.matrix(),r=this._padding;return L.transformPoint(n,i).offset(r.left,r.top)},getPadding:function(){var t=this.options.padding;return _t(t)&&(t=t.call(this,this)),Re(t)},computeRequiredPadding:function(t){const{sx:e,sy:n}=this.options.paper.scale();let{x:i,y:r}=this.getCenter();i*=e,r*=n;const s=t.x,o=t.y,a=s+t.width,l=o+t.height,c=this.getClientSize(),h=c.width/2,u=c.height/2,{left:d,right:f,top:p,bottom:g}=this.getPadding();return{left:Math.max(h-d-i+s,0)+d,right:Math.max(h-f+i-a,0)+f,top:Math.max(u-p-r+o,0)+p,bottom:Math.max(u-g+r-l,0)+g}},addPadding:function(){const{borderless:t,paper:e}=this.options;let n,i,r,s;if(t)n=i=r=s=0;else{const{sx:l,sy:c}=e.scale(),h=e.getArea(),u=this.computeRequiredPadding(h.scale(l,c,{x:0,y:0}));n=Math.round(u.left),i=Math.round(u.right),r=Math.round(u.top),s=Math.round(u.bottom)}this._padding={left:n,top:r,bottom:s,right:i};const{width:o,height:a}=e.getComputedSize();return this.$background.css({width:n+o+i,height:r+a+s}),e.$el.css({left:n,top:r}),this},storeCenter:function(t,e){const n=Nt(t)?new M(t,e):this.computeCenter();this._center=n},restoreCenter:function(){const t=this._center;t&&this.center(t.x,t.y)},getCenter:function(){return this._center||(this._center=this.options.paper.getArea().center()),this._center},computeCenter:function(){const{width:t,height:e}=this.getClientSize();return this.clientToLocalPoint(t/2,e/2)},adjustPaper:function(){let{paper:t,borderless:e,contentOptions:n}=this.options;typeof n=="function"&&(n=n.call(this,this));var i=H({gridWidth:this.options.baseWidth,gridHeight:this.options.baseHeight,allowNewOrigin:"negative"},n);if(e){const r=t.getFitToContentArea(this.transformContentOptions(i)),{sx:s,sy:o}=t.scale();r.x*=s,r.y*=o,r.width*=s,r.height*=o;const{left:a,right:l,top:c,bottom:h}=this.computeRequiredPadding(r);r.moveAndExpand({x:-a,y:-c,width:a+l,height:c+h}),t.translate(-r.x,-r.y),t.setDimensions(r.width,r.height)}else t.fitToContent(this.transformContentOptions(i));return this},adjustScale:function(t,e){const{paper:n}=this.options,i=n.options,r=t/this._sx,s=e/this._sy,{tx:o,ty:a}=n.translate();n.translate(o*r,a*s),n.setDimensions(i.width*r,i.height*s)},transformContentOptions:function(t){var e=this._sx,n=this._sy;return t.gridWidth&&(t.gridWidth*=e),t.gridHeight&&(t.gridHeight*=n),t.minWidth&&(t.minWidth*=e),t.minHeight&&(t.minHeight*=n),Vt(t.padding)?t.padding={left:(t.padding.left||0)*e,right:(t.padding.right||0)*e,top:(t.padding.top||0)*n,bottom:(t.padding.bottom||0)*n}:Nt(t.padding)&&(t.padding=t.padding*e),t},center:function(t,e,n){const{paper:i}=this.options,{a:r,d:s,e:o,f:a}=i.matrix(),l=Nt(t),c=Nt(e);let h;if(!l&&!c){h=t;const u=i.getComputedSize(),d=-o,f=-a;t=(d+u.width)/2,e=(f+u.height)/2,t/=r,e/=s}else h=n,l||(t=this.getVisibleArea().center().x),c||(e=this.getVisibleArea().center().y);return this.storeCenter(t,e),this.addPadding(),this.scroll(t,e,h),this},centerContent:function(t){return this.positionContent("center",t)},centerElement:function(t,e){return this.checkElement(t,"centerElement"),this.positionElement(t,"center",e)},positionContent:function(t,e){var n=this.options.paper.getContentArea(e);return this.positionRect(n,t,e)},positionElement:function(t,e,n){this.checkElement(t,"positionElement");var i=t.getBBox();return this.positionRect(i,e,n)},positionRect:function(t,e,n){var i;switch(e){case"center":return i=t.center(),this.positionPoint(i,"50%","50%",n);case"top":return i=t.topMiddle(),this.positionPoint(i,"50%",0,n);case"top-right":return i=t.topRight(),this.positionPoint(i,"100%",0,n);case"right":return i=t.rightMiddle(),this.positionPoint(i,"100%","50%",n);case"bottom-right":return i=t.bottomRight(),this.positionPoint(i,"100%","100%",n);case"bottom":return i=t.bottomMiddle(),this.positionPoint(i,"50%","100%",n);case"bottom-left":return i=t.bottomLeft(),this.positionPoint(i,0,"100%",n);case"left":return i=t.leftMiddle(),this.positionPoint(i,0,"50%",n);case"top-left":return i=t.topLeft(),this.positionPoint(i,0,0,n);default:throw new Error("Provided positionName ('"+e+"') was not recognized.")}},positionPoint:function(t,e,n,i){i=i||{};var r=Re(i.padding),s=new Z(this.getClientSize()),o=s.clone().moveAndExpand({x:r.left,y:r.top,width:-r.right-r.left,height:-r.top-r.bottom}),a=je(e);e=parseFloat(e),a&&(e=e/100*Math.max(0,o.width)),e<0&&(e=o.width+e);var l=je(n);n=parseFloat(n),l&&(n=n/100*Math.max(0,o.height)),n<0&&(n=o.height+n);var c=o.origin().offset(e,n),h=s.center(),u=h.difference(c),d=this.zoom(),f=u.scale(1/d,1/d),p=t.clone().offset(f);return this.center(p.x,p.y,i)},scroll:function(t,e,n){const i=this.options.paper.matrix(),r=this.getClientSize(),s={};if(Nt(t)){var o=r.width/2;s.scrollLeft=this.getScrollLeftFromLTR(t*i.a-o+i.e+(this._padding.left||0))}if(Nt(e)){var a=r.height/2;s.scrollTop=e*i.d-a+i.f+(this._padding.top||0)}if(n&&n.animation)this._cancelAnimation&&this._cancelAnimation(),this._cancelAnimation=$z(this.el,s,n.animation);else{const{el:l}=this;s.scrollLeft!==void 0&&(l.scrollLeft=s.scrollLeft),s.scrollTop!==void 0&&(l.scrollTop=s.scrollTop)}},scrollToContent:function(t){var e=this.options.paper.getContentArea(t).center();return this.scroll(e.x,e.y,t)},scrollToElement:function(t,e){this.checkElement(t,"scrollToElement");var n=t.getBBox().center();return this.scroll(n.x,n.y,e)},zoom:function(t,e={}){if(t===void 0)return this._sx;var n=this.computeCenter(),i=t,r=t,s,o;if(!e.absolute){const h=(u,d)=>(u*1e12+d*1e12)/1e12;i=h(this._sx,i),r=h(this._sy,r)}if(e.grid&&(i=Math.round(i/e.grid)*e.grid,r=Math.round(r/e.grid)*e.grid),e.max&&(i=Math.min(e.max,i),r=Math.min(e.max,r)),e.min&&(i=Math.max(e.min,i),r=Math.max(e.min,r)),e.ox===void 0||e.oy===void 0)s=n.x,o=n.y;else{var a=i/this._sx,l=r/this._sy;s=e.ox-(e.ox-n.x)/a,o=e.oy-(e.oy-n.y)/l}return this.beforePaperManipulation(),this.options.paper.scale(i,r),this.center(s,o),this.afterPaperManipulation(),this},zoomToRect:function(t,e={}){t=new Z(t);const n=this.options.paper,i=H({},n.options.origin);if(!e.fittingBBox){const s=this.el.getBoundingClientRect();e.fittingBBox=H({},new M(i),{width:s.width,height:s.height})}e.contentArea=t,this.beforePaperManipulation(),n.scaleContentToFit(e);const r=t.center();return this.adjustPaper(),this.center(r.x,r.y),this.afterPaperManipulation(),this},zoomToFit:function(t={}){const n=this.options.paper.getContentArea(t);return this.zoomToRect(n,t),this},transitionClassName:"transition-in-progress",transitionEventName:"transitionend.paper-scroller-transition",transitionToPoint:function(t,e,n){Vt(t)&&(n=e,e=t.y,t=t.x),n||(n={});var i=this._sx,r=Math.max(n.scale||i,1e-6),s=new M(t,e),o=this.computeCenter(),a,l;if(i===r){var c=o.difference(s).scale(i,i).round();a="translate("+c.x+"px,"+c.y+"px)"}else{var h=r/(i-r)*s.distance(o),u=o.clone().move(s,h),d=this.localToBackgroundPoint(u).round();a="scale("+r/i+")",l=d.x+"px "+d.y+"px"}return this.$el.addClass(this.transitionClassName),this.$background.off(this.transitionEventName).on(this.transitionEventName,(function(f){var p=this.paperScroller;p.syncTransition(this.scale,{x:this.x,y:this.y});var g=this.onTransitionEnd;_t(g)&&g.call(p,f)}).bind({paperScroller:this,scale:r,x:t,y:e,onTransitionEnd:n.onTransitionEnd})).css({transition:"transform",transitionDuration:n.duration||"1s",transitionDelay:n.delay,transitionTimingFunction:n.timingFunction,transformOrigin:l,transform:a}),this},syncTransition:function(t,e){return this.beforePaperManipulation(),this.options.paper.scale(t),this.removeTransition().center(e.x,e.y),this.afterPaperManipulation(),this},removeTransition:function(){return this.$el.removeClass(this.transitionClassName),this.$background.off(this.transitionEventName).css({transition:"",transitionDuration:"",transitionDelay:"",transitionTimingFunction:"",transform:"",transformOrigin:""}),this},transitionToRect:function(t,e={}){t=new Z(t);const n=e.maxScale||1/0,i=e.minScale||Number.MIN_VALUE,r=e.scaleGrid||null,s=e.visibility||1,o=e.center?new M(e.center):t.center(),a=this.getClientSize(),l=a.width*s,c=a.height*s;let u=new Z({x:o.x-l/2,y:o.y-c/2,width:l,height:c}).maxRectUniformScaleToFit(t,o);return u=Math.min(u,n),r&&(u=Math.floor(u/r)*r),u=Math.max(i,u),this.transitionToPoint(o,me({scale:u},e)),this},startPanning:function(t){t=at(t),this._clientX=t.clientX,this._clientY=t.clientY,this.trigger("pan:start",t),this.delegatePanning(),this.options.inertia&&this.inertia.handleDragStart(t)},pan:function(t){t=at(t);var e=t.clientX-this._clientX,n=t.clientY-this._clientY;this.el.scrollTop-=n,this.el.scrollLeft-=e,this._clientX=t.clientX,this._clientY=t.clientY,this.options.inertia&&this.inertia.handleDragMove(t)},stopPanning:function(t){this.undelegatePanning(),t&&(t=at(t)),this.trigger("pan:stop",t),this.options.inertia&&this.inertia.handleDragEnd(t)},delegatePanning(){this.$el.addClass("is-panning"),this.delegateDocumentEvents({mousemove:"pan",touchmove:"pan",mouseup:"stopPanning",touchend:"stopPanning",touchcancel:"stopPanning"})},undelegatePanning(){this.$el.removeClass("is-panning"),this.undelegateDocumentEvents()},getClientSize:function(){const{clientWidth:t,clientHeight:e}=this.el;return{width:t,height:e}},getVisibleArea:function(){var t=this.options.paper.matrix(),e=this.getClientSize(),n={x:this.getLTRScrollLeft(),y:this.el.scrollTop||0,width:e.width,height:e.height},i=L.transformRect(n,t.inverse());return i.x-=(this._padding.left||0)/this._sx,i.y-=(this._padding.top||0)/this._sy,new Z(i)},isElementVisible:function(t,e){this.checkElement(t,"isElementVisible"),e=e||{};var n=e.strict?"containsRect":"intersect";return!!this.getVisibleArea()[n](t.getBBox())},isPointVisible:function(t){return this.getVisibleArea().containsPoint(t)},checkElement:function(t,e){if(!(t&&t instanceof Kt))throw new TypeError("ui.PaperScroller."+e+"() accepts instance of dia.Element only")},onRemove:function(){this.undelegatePanning(),this.resizeObserver.disconnect()},isRTLDirection(){return getComputedStyle(this.el).direction==="rtl"},getLTRScrollLeft(){const{el:t}=this;if(this.isRTLDirection()){const{scrollLeft:e,scrollWidth:n,clientWidth:i}=t;return n-i+e}return t.scrollLeft},getScrollLeftFromLTR(t){if(this.isRTLDirection()){const{scrollWidth:e,clientWidth:n}=this.el;return t-(e-n)}return t}});_s.addTest("msie",function(){var t=window.navigator.userAgent;return t.indexOf("MSIE")!==-1||t.indexOf("Trident")!==-1});_s.addTest("msedge",function(){return/Edge\/\d+/.test(window.navigator.userAgent)});const Fz=q,Vz=ce.extend({tagName:"g",svgElement:!0,className:"path-drawer",events:{"mousedown .start-point":"onStartPointPointerDown",mousedown:"onPointerDown","touchstart .start-point":"onStartPointPointerDown",touchstart:"onPointerDown",dblclick:"onDoubleClick",contextmenu:"onContextMenu"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{pathAttributes:{class:null,fill:"#ffffff",stroke:"#000000","stroke-width":1,"pointer-events":"none"},startPointMarkup:'<circle r="5"/>',snapRadius:0,enableCurves:!0},init:function(){const t=this.svgTarget=L(this.options.target);this.path=new K,this.$document=Fz(t.node.ownerDocument),this.action="awaiting-input",this.render()},onRemove:function(){const{pathNode:t}=this;t&&L(t).remove(),this.clear()},clear:function(){const{path:t,pathNode:e}=this;e&&t&&t.segments.length<=1&&L(e).remove(),this.svgStart.remove(),this.svgControl.remove(),this.pathNode=null,this.path=new K,this.undelegateDocumentEvents(),this.action="awaiting-input",this.trigger("clear")},render:function(){const{options:t}=this;return this.svgPathTemplate=L("path").attr(t.pathAttributes),this.svgStart=L(t.startPointMarkup).addClass("start-point"),this.svgControl=L("path").addClass("control-path"),this.vel.append(L("rect",{x:0,y:0,width:"100%",height:"100%",fill:"transparent",stroke:"none"})),this.svgTarget.append(this.el),this},createPath:function(t,e){const n=this.svgPathTemplate.clone(),i=this.pathNode=n.node,r=this.svgStart.translate(t,e,{absolute:!0});this.trigger("path:create",i),this.addMoveSegment(t,e),this.vel.before(n),this.vel.append(r)},closePath:function(){const{path:t,pathNode:e}=this,n=t.getSegment(0),i=t.getSegment(t.segments.length-1);i.type==="L"?t.replaceSegment(t.segments.length-1,K.createSegment("Z")):(i.end.x=n.end.x,i.end.y=n.end.y,t.appendSegment(K.createSegment("Z"))),e.setAttribute("d",t.toString()),this.finishPath("path:close")},finishPath:function(t){const{path:e,pathNode:n}=this;e&&this.numberOfVisibleSegments()>0?(this.trigger("path:finish",n),this.trigger(t,n)):this.trigger("path:abort",n),this.clear()},numberOfVisibleSegments:function(){const{path:t}=this;let e=t.segments.length;return e-=1,t.getSegment(t.segments.length-1).type==="Z"&&(e-=1),e},addMoveSegment:function(t,e){const{path:n,pathNode:i}=this,r=K.createSegment("M",t,e);n.appendSegment(r),i.setAttribute("d",n.toString()),this.trigger("path:segment:add",i),this.trigger("path:move-segment:add",i)},addLineSegment:function(t,e){const{path:n,pathNode:i}=this,r=K.createSegment("L",t,e);n.appendSegment(r),i.setAttribute("d",n.toString()),this.trigger("path:segment:add",i),this.trigger("path:line-segment:add",i)},addCurveSegment:function(t,e,n,i,r,s){const{path:o,pathNode:a}=this,l=K.createSegment("C",n,i,r||t,s||e,t,e);o.appendSegment(l),a.setAttribute("d",o.toString()),this.trigger("path:segment:add",a),this.trigger("path:curve-segment:add",a)},adjustLastSegment:function(t,e,n,i,r,s){const{path:o,pathNode:a}=this,l=this.options.snapRadius;if(l){const h=this.snapLastSegmentCoordinates(t,e,l);t=h.x,e=h.y}const c=o.getSegment(o.segments.length-1);t!=null&&(c.end.x=t),e!=null&&(c.end.y=e),n!=null&&(c.controlPoint1.x=n),i!=null&&(c.controlPoint1.y=i),r!=null&&(c.controlPoint2.x=r),s!=null&&(c.controlPoint2.y=s),a.setAttribute("d",o.toString()),this.trigger("path:edit",a),this.trigger("path:last-segment:adjust",a)},snapLastSegmentCoordinates:function(t,e,n){const{path:i}=this;let r=!1,s=!1,o=t,a=e;for(let l=i.segments.length-2;l>=0&&!(r&&s);l--){const c=i.getSegment(l),h=c.end.x,u=c.end.y;!r&&Math.abs(h-t)<n&&(o=h,r=!0),!s&&Math.abs(u-e)<n&&(a=u,s=!0)}return new M(o,a)},removeLastSegment:function(){const{path:t,pathNode:e}=this;t.removeSegment(t.segments.length-1),e.setAttribute("d",t.toString()),this.trigger("path:edit",e),this.trigger("path:last-segment:remove",e)},findControlPoint:function(t,e){const{path:n}=this,i=n.getSegment(n.segments.length-1);return new M(t,e).reflection({x:i.end.x,y:i.end.y})},replaceLastSegmentWithCurve:function(){const{path:t,pathNode:e}=this,n=t.getSegment(t.segments.length-1),i=t.getSegment(t.segments.length-2),r=K.createSegment("C",i.end.x,i.end.y,n.end.x,n.end.y,n.end.x,n.end.y);t.replaceSegment(t.segments.length-1,r),e.setAttribute("d",t.toString()),this.trigger("path:edit",e),this.trigger("path:last-segment:replace-with-curve",e)},adjustControlPath:function(t,e,n,i){const{pathNode:r}=this,s=this.svgControl.node,o=new K([K.createSegment("M",t,e),K.createSegment("L",n,i)]);s.setAttribute("d",o.toString()),this.vel.append(s),this.trigger("path:interact",r),this.trigger("path:control:adjust",r)},removeControlPath:function(){const{pathNode:t}=this,e=this.svgControl.node;e.removeAttribute("d"),this.vel.append(e),this.trigger("path:interact",t),this.trigger("path:control:remove",t)},onPointerDown:function(t){const e=at(t);if(e.stopPropagation(),e.which>1||e.originalEvent.detail>1||!this.el.parentNode)return;const n=this.vel.toLocalPoint(e.clientX,e.clientY);switch(this.action){case"awaiting-input":this.createPath(n.x,n.y),this.options.enableCurves?this.action="path-created":(this.addLineSegment(n.x,n.y),this.action="adjusting-line-end"),this.delegateDocumentEvents();break;case"adjusting-line-end":this.options.enableCurves?this.action="awaiting-line-end":this.addLineSegment(n.x,n.y);break;case"adjusting-curve-end":this.action="awaiting-curve-control-2";break}this._timeStamp=e.timeStamp},MOVEMENT_DETECTION_THRESHOLD:150,onPointerMove:function(t){const e=at(t);if(e.stopPropagation(),this.action=="awaiting-input")return;let n,i;const r=this.vel.toLocalPoint(e.clientX,e.clientY),s=this._timeStamp;if(s)if(s&&e.timeStamp-s<this.MOVEMENT_DETECTION_THRESHOLD)switch(this.action){case"path-created":this.options.enableCurves&&(n=this.svgStart.translate(),this.adjustControlPath(n.tx,n.ty,r.x,r.y));break;case"adjusting-line-end":case"awaiting-line-end":case"adjusting-curve-control-1":this.adjustLastSegment(r.x,r.y);break;case"awaiting-curve-control-2":this.adjustLastSegment(r.x,r.y,null,null,r.x,r.y);break}else switch(this.action){case"path-created":this.options.enableCurves&&(this.action="adjusting-curve-control-1");break;case"awaiting-line-end":this.options.enableCurves&&(this.replaceLastSegmentWithCurve(),this.action="adjusting-curve-control-2");break;case"adjusting-line-end":this.options.enableCurves||this.adjustLastSegment(r.x,r.y);break;case"awaiting-curve-control-2":this.action="adjusting-curve-control-2";break;case"adjusting-curve-control-1":n=this.svgStart.translate(),this.adjustControlPath(n.tx,n.ty,r.x,r.y);break;case"adjusting-curve-control-2":i=this.findControlPoint(r.x,r.y),this.adjustLastSegment(null,null,null,null,i.x,i.y),this.adjustControlPath(i.x,i.y,r.x,r.y);break}else switch(this.action){case"adjusting-line-end":this.adjustLastSegment(r.x,r.y);break;case"adjusting-curve-end":this.adjustLastSegment(r.x,r.y,null,null,r.x,r.y);break}},onPointerUp:function(t){this._timeStamp=null;const e=at(t);if(e.stopPropagation(),e.which>1||e.originalEvent.detail>1)return;const n=this.vel.toLocalPoint(e.clientX,e.clientY);switch(this.action){case"path-created":case"awaiting-line-end":this.addLineSegment(n.x,n.y),this.action="adjusting-line-end";break;case"awaiting-curve-control-2":this.removeControlPath(),this.addLineSegment(n.x,n.y),this.action="adjusting-line-end";break;case"adjusting-curve-control-1":case"adjusting-curve-control-2":this.addCurveSegment(n.x,n.y,n.x,n.y),this.action="adjusting-curve-end";break}},onStartPointPointerDown:function(t){const e=at(t);e.stopPropagation(),!(e.which>1)&&(e.originalEvent.detail>1||this.closePath())},onDoubleClick:function(t){const e=at(t);e.preventDefault(),e.stopPropagation(),!(e.which>1)&&this.pathNode&&this.numberOfVisibleSegments()>0&&(this.removeLastSegment(),this.finishPath("path:stop"))},onContextMenu:function(t){const e=at(t);e.preventDefault(),e.stopPropagation(),!(e.originalEvent.detail>1)&&this.pathNode&&this.numberOfVisibleSegments()>0&&(this.removeLastSegment(),this.finishPath("path:stop"))}}),ka=q,zz=ce.extend({tagName:"g",svgElement:!0,className:"path-editor",events:{"mousedown .anchor-point":"onAnchorPointPointerDown","mousedown .control-point":"onControlPointPointerDown","mousedown .segment-path":"onSegmentPathPointerDown","touchstart .anchor-point":"onAnchorPointPointerDown","touchstart .control-point":"onControlPointPointerDown","touchstart .segment-path":"onSegmentPathPointerDown","dblclick .anchor-point":"onAnchorPointDoubleClick","dblclick .control-point":"onControlPointDoubleClick","dblclick .segment-path":"onSegmentPathDoubleClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{anchorPointMarkup:'<circle r="2.5"/>',controlPointMarkup:'<circle r="2.5"/>'},init:function(){const t=this.pathNode=L(this.options.pathElement).normalizePath().node;this.path=K.parse(this.options.pathElement.getAttribute("d")),this.svgRoot=L(t.ownerSVGElement),this.$document=ka(t.ownerDocument),this.render()},onRemove:function(){this.undelegateDocumentEvents(),this.clear()},clear:function(){const{vel:t}=this;t.empty(),this.directionPaths=[],this.segmentPaths=[],this.segmentPathElements=[],this.controlPoints=[],this.anchorPoints=[],this._subPathIndices=[0],this.trigger("clear",this.pathNode)},_transformPoint:function(t,e,n){return L.transformPoint(new M(t,e),n)},_getPathCTM:function(){return this.pathNode.getCTM()},render:function(){this.clear();const{path:t,vel:e,anchorPoints:n,controlPoints:i,directionPaths:r,segmentPaths:s,segmentPathElements:o}=this,a=this._getPathCTM(),l=L(this.options.anchorPointMarkup).addClass("anchor-point"),c=L(this.options.controlPointMarkup).addClass("control-point"),h=L('<path class="direction-path"/>'),u=L('<path class="segment-path"/>'),d=this._subPathIndices;for(let p=0,g=0,v=0;p<t.segments.length;p++){const x=t.getSegment(p),S=this._transformPoint(x.end.x,x.end.y,a);let C=S.x,P=S.y;if(x.type!=="Z"&&(n[p]=l.clone().attr({index:p,cx:C,cy:P})),x.type!=="M"){const k=new K;switch(k.appendSegment(new K.createSegment("M",g,v)),x.type){case"Z":{const m=t.getSegment(d[0]),b=this._transformPoint(m.end.x,m.end.y,a);C=b.x,P=b.y,k.appendSegment(new K.createSegment("L",C,P)),d.unshift(p+1);break}case"L":{k.appendSegment(new K.createSegment("L",C,P));break}case"C":{const m=this._transformPoint(x.controlPoint1.x,x.controlPoint1.y,a),b=c.clone().attr({index:p,"attribute-index":1,cx:m.x,cy:m.y}),w=this._transformPoint(x.controlPoint2.x,x.controlPoint2.y,a),T=c.clone().attr({index:p,"attribute-index":2,cx:w.x,cy:w.y});i[p]=[b,T],k.appendSegment(new K.createSegment("C",m.x,m.y,w.x,w.y,C,P)),r[p]=[h.clone().attr("d",["M",g,v,"L",m.x,m.y].join(" ")),h.clone().attr("d",["M",C,P,"L",w.x,w.y].join(" "))];break}}s[p]=k;const N=u.clone().attr("index",p).node;N.setAttribute("d",k.toString()),o[p]=N}g=C,v=P}const f=[];o.forEach(function(p){p&&f.push(p)}),r.forEach(function(p){p&&Array.prototype.push.apply(f,p)}),n.forEach(function(p){p&&f.push(p)}),i.forEach(function(p){p&&Array.prototype.push.apply(f,p)}),e.append(f),this.svgRoot.append(e)},startMoving:function(t){const e=at(t),n=this.$point=ka(e.target);this.prevClientX=e.clientX,this.prevClientY=e.clientY;const i=parseInt(this.$point.attr("index"),10);if(this.trigger("path:interact"),n.hasClass("anchor-point"))this.trigger("path:anchor-point:select",i);else if(n.hasClass("control-point")){const r=parseInt(this.$point.attr("attribute-index"),10);this.trigger("path:control-point:select",i,r)}else this.trigger("path:segment:select",i);e.stopPropagation(),e.preventDefault(),this.index=void 0,this.controlPointIndex=void 0,this.segPoint=void 0,this.pathEditedEventType=void 0},move:function(t){const{$point:e}=this;if(!e)return;const n=at(t),i=n.clientX-this.prevClientX,r=n.clientY-this.prevClientY,s=parseInt(e.attr("index"),10);if(e.hasClass("anchor-point"))this.adjustAnchorPoint(s,i,r,n);else if(e.hasClass("control-point")){const o=parseInt(e.attr("attribute-index"),10);this.adjustControlPoint(s,o,i,r,n)}else this.adjustSegment(s,i,r,n);this.prevClientX=n.clientX,this.prevClientY=n.clientY},adjustSegment:function(t,e,n,i,{dry:r=void 0}={}){this.adjustAnchorPoint(t-1,e,n,{dry:!0}),this.adjustAnchorPoint(t,e,n,{dry:!0}),r||(this.pathEditedEventType="path:segment:adjust",this.index=t,this.trigger("path:editing",this.pathNode,i),this.trigger("path:segment:adjusting",this.pathNode,i,{index:t}))},adjustControlPoint:function(t,e,n,i,r,{dry:s=void 0}={}){const o=this._getPathCTM(),{path:a,controlPoints:l}=this,c=a.getSegment(t),h=o.inverse();h.e=0,h.f=0;const u=this._transformPoint(n,i,h),d="controlPoint"+e;c[d].x+=u.x,c[d].y+=u.y;const f=this._transformPoint(c[d].x,c[d].y,o),p=new M(f);if(l[t][e-1].attr({cx:f.x,cy:f.y}).hasClass("locked")){const v=this.getBoundIndex(t,e),x=e===1?2:1,S=a.getSegment(v),C="controlPoint"+x,P=new M(e===1?S.end.x:c.end.x,e===1?S.end.y:c.end.y),k=new M(c[d].x,c[d].y),N=P.distance(new M(S[C].x,S[C].y)),m=P.move(k,N);S[C].x=m.x,S[C].y=m.y;const b=this._transformPoint(S[C].x,S[C].y,o);l[v][x-1].attr({cx:b.x,cy:b.y}),this.updateDirectionPaths(v),this.updateSegmentPath(v)}this.updateDirectionPaths(t),this.updateSegmentPath(t),s||(this.pathEditedEventType="path:control-point:adjust",this.index=t,this.controlPointIndex=e,this.segPoint=p,this.trigger("path:editing",this.pathNode,r),this.trigger("path:control-point:adjusting",this.pathNode,r,{index:t,controlPointIndex:e,segPoint:p}))},findSubpathIndex:function(t){const e=this._subPathIndices;for(let n=0,i=e.length;n<i;n++)if(e[n]<t)return e[n]},findReversedSubpathIndex:function(t){const e=this._subPathIndices;for(let n=e.length-1;n>=0;n--)if(e[n]>t)return e[n]},adjustAnchorPoint:function(t,e,n,i,{dry:r=void 0}={}){const s=this._getPathCTM(),{path:o,anchorPoints:a,controlPoints:l}=this;let c=o.getSegment(t);c.type==="Z"&&(t=this.findSubpathIndex(t),c=o.getSegment(t));const h=a.length-1;if((t===0||t===h)&&l[1]&&l[h]){const v=l[1][0],x=l[h][1];v&&v.hasClass("locked")&&v.removeClass("locked"),x&&x.hasClass("locked")&&x.removeClass("locked")}const u=s.inverse();u.e=0,u.f=0;const d=this._transformPoint(e,n,u);c.end.x+=d.x,c.end.y+=d.y;const f=this._transformPoint(c.end.x,c.end.y,s),p=new M(f);if(a[t].attr({cx:f.x,cy:f.y}),c.type==="C"){c.controlPoint2.x+=d.x,c.controlPoint2.y+=d.y;const v=this._transformPoint(c.controlPoint2.x,c.controlPoint2.y,s);l[t][1].attr({cx:v.x,cy:v.y})}const g=t+1<o.segments.length?o.getSegment(t+1):0;if(g){if(g.type==="C"){g.controlPoint1.x+=d.x,g.controlPoint1.y+=d.y;const v=this._transformPoint(g.controlPoint1.x,g.controlPoint1.y,s);l[t+1][0].attr({cx:v.x,cy:v.y}),this.updateDirectionPaths(t+1)}this.updateSegmentPath(t+1)}this.updateDirectionPaths(t),this.updateSegmentPath(t),r||(this.pathEditedEventType="path:anchor-point:adjust",this.index=t,this.segPoint=p,this.trigger("path:editing",this.pathNode,i),this.trigger("path:anchor-point:adjusting",this.pathNode,i,{index:t,segPoint:p}))},updateDirectionPaths:function(t){const e=this._getPathCTM(),{path:n}=this,i=n.getSegment(t),r=this._transformPoint(i.end.x,i.end.y,e),s=t>0?n.getSegment(t-1):null,o=s?this._transformPoint(s.end.x,s.end.y,e):null,a=this.directionPaths[t];Array.isArray(a)&&a.forEach(function(l,c){c++;const h=this._transformPoint(i["controlPoint"+c].x,i["controlPoint"+c].y,e);l.attr("d",["M",c>1||!s?r.x:o.x,c>1||!s?r.y:o.y,h.x,h.y].join(" "))},this)},updateSegmentPath:function(t){const{path:e,_subPathIndices:n}=this;if(n.includes(t)){let u=this.findReversedSubpathIndex(t)||this.path.segments.length;if(u--,e.getSegment(u).type!=="Z")return;t=u}let i=this.segmentPaths[t];if(!i)return;const r=this._getPathCTM(),s=e.getSegment(t-1),o=this._transformPoint(s.end.x,s.end.y,r);i=new K;let a=K.createSegment("M",o.x,o.y);i.appendSegment(a);const l=e.getSegment(t),c=this._transformPoint(l.end.x,l.end.y,r);switch(l.type){case"Z":{const u=e.getSegment(this.findSubpathIndex(t)),d=this._transformPoint(u.end.x,u.end.y,r);a=K.createSegment("L",d.x,d.y);break}case"L":{a=K.createSegment("L",c.x,c.y);break}case"C":{const u=this._transformPoint(l.controlPoint1.x,l.controlPoint1.y,r),d=this._transformPoint(l.controlPoint2.x,l.controlPoint2.y,r);a=K.createSegment("C",u.x,u.y,d.x,d.y,c.x,c.y);break}}i.appendSegment(a),this.segmentPaths[t]=i;const h=this.segmentPathElements[t];h&&h.setAttribute("d",i.toString()),this.pathNode.setAttribute("d",e.toString())},stopMoving:function(t){const e=at(t);if(this.$point=void 0,this.pathEditedEventType){const{pathNode:n,index:i,controlPointIndex:r,segPoint:s}=this;this.trigger("path:edit",n,e),this.trigger(this.pathEditedEventType,n,e,{index:i,controlPointIndex:r,segPoint:s})}this.index=void 0,this.controlPointIndex=void 0,this.segPoint=void 0,this.pathEditedEventType=void 0},createAnchorPoint:function(t){const e=at(t),n=L(e.target).attr("index"),{pathNode:i,path:r}=this,s=L(i).toLocalPoint(e.pageX,e.pageY),o=r.getSegment(n);switch(o.type){case"Z":{const l=new gt(o.start,o.end).closestPoint(s);r.insertSegment(n,K.createSegment("L",l.x,l.y));break}case"L":{const l=new gt(o.start,o.end).closestPoint(s);r.insertSegment(n,K.createSegment("L",l.x,l.y));break}case"C":{const l=new le(o.start,o.controlPoint1,o.controlPoint2,o.end).closestPointT(s),c=o.divideAtT(l);r.insertSegment(n,c[0]),o.controlPoint1.x=c[1].controlPoint1.x,o.controlPoint1.y=c[1].controlPoint1.y,o.controlPoint2.x=c[1].controlPoint2.x,o.controlPoint2.y=c[1].controlPoint2.y;break}}this.render(),this.pathNode.setAttribute("d",r.toString()),this.trigger("path:edit",i,e),this.trigger("path:anchor-point:create",i,e)},removeAnchorPoint:function(t){const e=at(t),n=parseInt(ka(e.target).attr("index"),10),{pathNode:i,path:r}=this,s=r.getSegment(n);let o,a;switch(s.type){case"M":o=r.getSegment(n+1),a=K.createSegment("M",o.end.x,o.end.y),r.replaceSegment(n+1,a),r.removeSegment(n);break;case"L":r.removeSegment(n);break;case"C":n+1<=r.segments.length-1&&(o=r.getSegment(n+1),o.type==="C"&&(o.controlPoint1.x=s.controlPoint1.x,o.controlPoint1.y=s.controlPoint1.y)),r.removeSegment(n);break}this.render(),this.pathNode.setAttribute("d",r.toString()),this.trigger("path:edit",i,e),this.trigger("path:anchor-point:remove",i,e);let l=r.segments.length;r.getSegment(r.segments.length-1).type==="Z"&&(l-=1),l<2&&this.trigger("path:invalid",i,e)},lockControlPoint:function(t){const e=at(t),n=ka(e.target),i=parseInt(n.attr("index")),r=parseInt(n.attr("attribute-index"),10),s=this.getBoundIndex(i,r),o=r===1?2:1,a=this.controlPoints[s];if(a){const l=n.hasClass("locked");n.toggleClass("locked"),a[o-1].toggleClass("locked"),this.trigger("path:interact"),l?this.trigger("path:control-point:unlock",i,r):(this.trigger("path:control-point:lock",i,r),this.adjustControlPoint(i,r,0,0,{dry:!0}))}},getBoundIndex:function(t,e){let n;const{path:i,anchorPoints:r}=this;let s,o,a,l=r.length-1,c,h;return e===1?(n=t-1,n===0&&(s=i.segments.length-1,o=i.getSegment(s).type,a=o==="Z",c=r[0].attr("cx")===r[l].attr("cx"),h=r[0].attr("cy")===r[l].attr("cy"),a&&c&&h&&(n=l))):(n=t+1,n===l+1&&(s=i.segments.length-1,o=i.getSegment(s).type,a=o==="Z",c=r[0].attr("cx")===r[l].attr("cx"),h=r[0].attr("cy")===r[l].attr("cy"),a&&c&&h&&(n=1))),n},getControlPointLockedStates:function(){const{controlPoints:t}=this,e=[];for(let n=0;n<t.length;n++)if(t[n]){e[n]=[];for(let i=0;i<=1;i++){if(!t[n][i])continue;const r=i+1;t[n][i].hasClass("locked")?e[n][r]=!0:e[n][r]=!1}}return e},setControlPointLockedStates:function(t){const{controlPoints:e}=this;for(let n=0;n<e.length;n++)if(t[n]&&e[n])for(let i=1;i<=2;i++)t[n][i]&&e[n][i-1]&&(t[n][i]===!0?e[n][i-1].addClass("locked"):e[n][i-1].removeClass("locked"))},convertSegmentPath:function(t){const e=at(t),n=L(e.target).attr("index"),{pathNode:i,path:r}=this,s=r.getSegment(n);switch(s.type){case"Z":r.insertSegment(n,K.createSegment("C",s.start.x,s.start.y,s.end.x,s.end.y,s.end.x,s.end.y));break;case"L":r.replaceSegment(n,K.createSegment("C",s.start.x,s.start.y,s.end.x,s.end.y,s.end.x,s.end.y));break;case"C":r.replaceSegment(n,K.createSegment("L",s.end.x,s.end.y));break}this.render(),this.pathNode.setAttribute("d",r.toString()),this.trigger("path:edit",i,e),this.trigger("path:segment:convert",i,e)},addClosePathSegment:function(t){const e=at(t),n=parseInt(ka(e.target).attr("index"),10),{path:i,pathNode:r}=this;(n===0||n===i.segments.length-1)&&i.getSegment(i.segments.length-1).type!=="Z"&&(i.appendSegment(K.createSegment("Z")),this.render(),this.pathNode.setAttribute("d",i.toString()),this.trigger("path:edit",r,e),this.trigger("path:closepath-segment:add",r,e))},removeClosePathSegment:function(t){const e=at(t),n=L(e.target).attr("index"),{path:i,pathNode:r}=this;i.getSegment(n).type==="Z"&&(i.removeSegment(n),this.render(),this.pathNode.setAttribute("d",i.toString()),this.trigger("path:edit",r,e),this.trigger("path:closepath-segment:remove",r,e))},isMoreThanFirstClick:function(){return this.clickCounter=this.clickCounter||0,this.clickCounter+=1,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.clickCounter=0},400),this.clickCounter>=2?(this.clickCounter=0,clearTimeout(this.timeout),!0):!1},onAnchorPointPointerDown:function(t){const e=at(t);e.stopPropagation(),e.which===1&&(this.isMoreThanFirstClick()||(this.startMoving(e),this.delegateDocumentEvents()))},onControlPointPointerDown:function(t){const e=at(t);e.stopPropagation(),e.which===1&&(this.isMoreThanFirstClick()||(this.startMoving(e),this.delegateDocumentEvents()))},onSegmentPathPointerDown:function(t){const e=at(t);e.stopPropagation(),e.which===1&&(this.isMoreThanFirstClick()||(this.startMoving(e),this.delegateDocumentEvents()))},onPointerMove:function(t){const e=at(t);e.stopPropagation(),this.move(e)},onPointerUp:function(t){this.undelegateDocumentEvents();const e=at(t);e.stopPropagation(),this.stopMoving(e)},onAnchorPointDoubleClick:function(t){const e=at(t);e.stopPropagation(),e.preventDefault(),e.which===1&&this.removeAnchorPoint(e)},onControlPointDoubleClick:function(t){const e=at(t);e.stopPropagation(),e.preventDefault(),e.which===1&&this.lockControlPoint(e)},onSegmentPathDoubleClick:function(t){const e=at(t);e.stopPropagation(),e.preventDefault(),e.which===1&&this.createAnchorPoint(e)}}),Gz=Q_.extend({className:"popup",eventNamespace:"popup",events:{},beforeMount(){const{anchor:t,arrowPosition:e}=this.options;this.$el.removeClass("left right top bottom top-left top-right bottom-left bottom-right"),e?this.$el.addClass(e==="none"?"":e):this.$el.addClass(t==="center"?"":t)},renderContent:function(){const{content:t,arrowPosition:e,anchor:n}=this.options,i=_t(t)?t(this.el):t;if(i&&this.$el.html(i),e!=="none"||n==="center"){const r=document.createElement("div");r.classList.add("popup-arrow");const s=document.createElement("div");s.classList.add("popup-arrow-mask"),this.el.append(r,s)}}}),Oa=q,Hz={N:"n",NW:"nw",W:"w",SW:"sw",S:"s",SE:"se",E:"e",NE:"ne"},Ec={NONE:"none",SUBGRAPH:"subgraph",ALL:"all"},Uz=ce.extend({options:{paperScroller:void 0,paper:void 0,graph:void 0,boxContent:function(t){return Xn("<%= length %> elements selected.")({length:this.model.length})},handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElements"}},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"}},{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"}}],useModelGeometry:!1,strictSelection:!1,rotateAngleGrid:15,allowTranslate:!0,translateConnectedLinks:Ec.ALL,allowCellInteraction:!1},className:"selection",events:{"mousedown .selection-box":"onSelectionBoxPointerDown","touchstart .selection-box":"onSelectionBoxPointerDown","mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown",mousewheel:"onMousewheel"},documentEvents:{mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},_action:null,init:function(){this.options.model&&(this.options.collection=this.options.model);var t=this.collection=this.options.collection||this.collection||new kr;t.comparator||(t.comparator=this.constructor.depthComparator,t.sort()),this.model=t;const e=this.options.paper;if(e instanceof Ai)me(this.options,{graph:e.model});else if(typeof al=="function"&&e instanceof al)this.options.paperScroller=e,this.options.paper=e.options.paper,this.options.graph=e.options.paper.model;else throw new Error("Selection: paper required");hn(this,"startSelecting","stopSelecting","adjustSelection","pointerup"),this.options.paper.$el.append(this.$el),this._boxCount=0,this.$selectionWrapper=this.createSelectionWrapper(),this.handles=[],pt(this.options.handles).forEach(this.addHandle,this),this.startListening()},onCellPointerdown:function(t,e){const{collection:n}=this;n.length!==0&&n.has(t.model)&&(n.length>1&&t.preventDefaultInteraction(e),this.startSelectionInteraction(e,t))},startListening:function(){var t=this.options.paper;this.listenTo(t,"transform",this.onPaperTransformation),this.options.allowCellInteraction&&this.listenTo(t,"cell:pointerdown",this.onCellPointerdown,this);var e=this.options.graph;this.listenTo(e,"reset",this.cancelSelection),this.listenTo(e,"change remove",this.onGraphChange);var n=this.collection;this.listenTo(n,"remove",this.onRemoveElement),this.listenTo(n,"reset",this.onResetElements),this.listenTo(n,"add",this.onAddElement)},onPaperTransformation:function(){this.updateSelectionBoxes({async:!1})},onGraphChange:function(t,e){e.selection!==this.cid&&this.updateSelectionBoxes()},cancelSelection:function(){this.model.reset([],{ui:!0})},addHandle:function(t){this.handles.push(t);var e=Oa("<div/>").addClass("handle "+(t.position||"")+" "+(t.name||"")).data("action",t.name);return t.icon&&e.css("background-image","url("+t.icon+")"),e.html(t.content||""),Ns(e,t.attrs),this.$selectionWrapper.append(e),Jt(t.events,(function(n,i){ne(n)?this.on("action:"+t.name+":"+i,this[n],this):this.on("action:"+t.name+":"+i,n)}).bind(this)),this},stopSelecting:function(t){var e,n=this.options.paper,i=this.eventData(t),r=i.action;switch(r){case"selecting":{var s=this.$el.offset(),o=this.$el.width(),a=this.$el.height();e=n.pageToLocalPoint(s.left,s.top);var l=n.scale();o/=l.sx,a/=l.sy;var c=xr(e.x,e.y,o,a),h=this.getElementsInSelectedArea(c),u=this.options.filter;Array.isArray(u)?h=h.filter(function(f){return!u.includes(f.model)&&!u.includes(f.model.get("type"))}):_t(u)&&(h=h.filter(function(f){return!u(f.model)}));var d=h.map(function(f){return f.model});this.model.reset(d,{ui:!0});break}case"translating":{i.interactionPrevented||this.options.graph.stopBatch("selection-translate"),e=n.snapToGrid(t.clientX,t.clientY),this.notify("selection-box:pointerup",t,e.x,e.y);break}default:{r||this.cancelSelection();break}}this._action=null},removeHandle:function(t){var e=pt(this.handles).findIndex(function(i){return i.name===t}),n=this.handles[e];return n&&(Jt(n.events,(function(i,r){this.off("action:"+t+":"+r)}).bind(this)),this.$(".handle."+t).remove(),this.handles.splice(e,1)),this},startSelecting:function(t){t=at(t),this.cancelSelection();const{paperScroller:e,paper:n}=this.options,i=n.localToPaperPoint(n.clientToLocalPoint({x:t.clientX,y:t.clientY}));this.$el.css({width:0,height:0,left:i.x,top:i.y}),this.showLasso();const r=e&&e.options.scrollWhileDragging;this.eventData(t,{action:"selecting",clientX:t.clientX,clientY:t.clientY,origin:i,scrollWhileDragging:r}),this.delegateDocumentEvents(null,t.data),this._action="selecting"},changeHandle:function(t,e){var n=pt(this.handles).find(function(i){return i&&i.name===t});return n&&(this.removeHandle(t),this.addHandle(Te({name:t},n,e))),this},onMousewheel:function(t){t.preventDefault()},onSelectionBoxPointerDown:function(t){t.stopPropagation(),t=at(t);const e=this.getCellView(t.target);this.startSelectionInteraction(t,e)},startSelectionInteraction:function(t,e){const{paper:n,allowTranslate:i}=this.options,r=e;i&&(!r||r.can("elementMove"))?this.startTranslatingSelection(t):this.eventData(t,{action:"translating",interactionPrevented:!0}),this.eventData(t,{activeElementView:r});const s=n.snapToGrid(t.clientX,t.clientY);this.notify("selection-box:pointerdown",t,s.x,s.y),this.delegateDocumentEvents(null,t.data)},startTranslatingSelection:function(t){const{paperScroller:e,paper:n,graph:i}=this.options;i.startBatch("selection-translate");const r=n.snapToGrid(t.clientX,t.clientY),s=e&&e.options.scrollWhileDragging;this.eventData(t,{action:"translating",snappedClientX:r.x,snappedClientY:r.y,scrollWhileDragging:s}),this._action="translating"},adjustSelection:function(t){t=at(t);let e,n;const{collection:i}=this,{paperScroller:r,paper:s,graph:o}=this.options,a=s.clientToLocalPoint({x:t.clientX,y:t.clientY}),l=this.eventData(t),{action:c,scrollWhileDragging:h,interactionPrevented:u=!1}=l;switch(c){case"selecting":{const m=s.localToPaperPoint(a);e=m.x-l.origin.x,n=m.y-l.origin.y;const b=Math.abs(e),w=Math.abs(n),T=parseFloat(window.getComputedStyle(this.el).getPropertyValue("border-width"));this.$el.css({left:e<0?m.x:l.origin.x,top:n<0?m.y:l.origin.y,width:b-T*2,height:w-T*2});break}case"translating":{var d=s.snapToGrid(t.clientX,t.clientY),f=d.x,p=d.y;if(u){this.notify("selection-box:pointermove",t,f,p);break}e=f-l.snappedClientX,n=p-l.snappedClientY;var g=s.getRestrictedArea();if(g){var v=i.toArray(),x=o.getCellsBBox(v),S=g.x-x.x,C=g.y-x.y,P=g.x+g.width-(x.x+x.width),k=g.y+g.height-(x.y+x.height);e<S&&(e=S),n<C&&(n=C),e>P&&(e=P),n>k&&(n=k)}if(e||n){if(this.translateSelectedElements(e,n),this.boxesUpdated)(i.length>1||s.isAsync()||this.options.allowCellInteraction)&&this.updateSelectionBoxes();else{var N=s.scale();const m=this.$el.children(".selection-box").add(this.$selectionWrapper);for(let b=0;b<m.length;b++){const w=m[b],T=parseFloat(w.style.top)||0,E=parseFloat(w.style.left)||0;w.style.top=`${T+n*N.sy}px`,w.style.left=`${E+e*N.sx}px`}}l.snappedClientX=f,l.snappedClientY=p}this.notify("selection-box:pointermove",t,f,p);break}default:{c&&this.pointermove(t);break}}this.boxesUpdated=!1,h&&r.scrollWhileDragging(t,a.x,a.y,h)},translateSelectedElements:function(t,e){var n={};const{collection:i}=this,{graph:r,translateConnectedLinks:s}=this.options;i.toArray().forEach(o=>{if(n[o.id])return;const a={selection:this.cid};o.translate(t,e,a),n[o.id]=!0,o.getEmbeddedCells({deep:!0}).forEach(function(l){n[l.id]=!0}),s!==Ec.NONE&&r.getConnectedLinks(o).forEach(function(c){if(!n[c.id]){if(s===Ec.SUBGRAPH){const h=c.getSourceCell();if(h&&!i.get(h))return;const u=c.getTargetCell();if(u&&!i.get(u)||!h||!u)return}c.translate(t,e,a),n[c.id]=!0}})})},notify:function(t,e){var n=this.eventData(e),i=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t,n.activeElementView].concat(i))},getElementsInSelectedArea:function(t){var e=this.options.paper,n={strict:this.options.strictSelection};if(this.options.useModelGeometry){var i=e.model.findModelsInArea(t,n);return i.map(e.findViewByModel,e).filter(function(r){return!!r})}return e.findViewsInArea(t,n)},pointerup:function(t){const e=this.eventData(t),{action:n,scrollWhileDragging:i}=e;if(!n)return;t=at(t);const{paper:r,paperScroller:s}=this.options,{x:o,y:a}=r.snapToGrid({x:t.clientX,y:t.clientY});n!=="selecting"&&n!=="translating"&&this.triggerAction(n,"pointerup",t,o,a),i&&s.stopScrollWhileDragging(t),this.stopSelecting(t),this.undelegateDocumentEvents(),this._action=null},destroySelectionBox:function(t){this.$('[data-model="'+t.get("id")+'"]').remove(),this.$el.children(".selection-box").length===0&&this.hide(),this._boxCount=Math.max(0,this._boxCount-1)},hide:function(){this.$el.removeClass("lasso selected")},showSelected:function(){this.$el.addClass("selected")},showLasso:function(){this.$el.addClass("lasso")},destroyAllSelectionBoxes:function(){this.hide(),this.$el.children(".selection-box").remove(),this._boxCount=0},createSelectionBox:function(t){const e=this.getCellBBox(t);if(!e)return;const n=Oa("<div/>").addClass("selection-box").data("model",t.id).css({left:e.x,top:e.y,width:e.width,height:e.height}).appendTo(this.el);this.options.allowCellInteraction&&n.addClass("selection-box-no-events"),this.showSelected(),this._boxCount++},createSelectionWrapper:function(){var t=Oa("<div/>").addClass("selection-wrapper").data("selectionLength",this.model.length),e=Oa("<div/>").addClass("box");return t.append(e),this.$el.prepend(t),t},getCellBBox(t){const{paper:e,useModelGeometry:n}=this.options,i=e.findViewByModel(t);return i?i.getBBox({useModelGeometry:n}):null},getWrapperBBox(){const t=[];return this.collection.models.forEach(e=>{const n=this.getCellBBox(e);n&&t.push(n)}),Z.fromRectUnion(...t)},updateSelectionWrapper:function(){const{collection:t,$selectionWrapper:e}=this;let n,i,r,s;const o=this.getWrapperBBox();o?{x:n,y:i,width:r,height:s}=o:(n="",i="",r=0,s=0),e.css({left:n,top:i,width:r,height:s}),e.data("selectionLength",t.length),this.updateBoxContent()},updateBoxContent:function(){const{boxContent:t}=this.options;if(_t(t)){const e=this.$(".box"),n=t.call(this,e[0]);n&&e.html(n)}},updateSelectionBoxes:function(t){this.collection.length!==0&&(this.boxesUpdated=!0,this.options.paper.requestViewUpdate(this,1,this.UPDATE_PRIORITY,t))},confirmUpdate:function(){this._updateSelectionBoxes()},_updateSelectionBoxes:function(){if(this._boxCount){this.hide();for(var t=this.$el.children(".selection-box"),e=0,n=t.length;e<n;e++){var i=t[e],r=Oa(i).remove().data("model"),s=this.model.get(r);s&&this.createSelectionBox(s)}this.updateSelectionWrapper()}},onHandlePointerDown:function(t){var e=t.currentTarget.dataset.action;if(!e)return;const{paperScroller:n,paper:i}=this.options;t.preventDefault(),t.stopPropagation(),t=at(t);const{x:r,y:s}=i.snapToGrid({x:t.clientX,y:t.clientY});if(t.type==="mousedown"&&t.button===2)this.triggerAction(e,"contextmenu",t,r,s);else{this.triggerAction(e,"pointerdown",t,r,s);const o=n&&n.options.scrollWhileDragging;this.eventData(t,{action:e,clientX:t.clientX,clientY:t.clientY,startClientX:t.clientX,startClientY:t.clientY,scrollWhileDragging:o}),this.delegateDocumentEvents(null,t.data)}this._action=e},getCellView:function(t){var e=this.model.get(t.getAttribute("data-model"));return e&&e.findView(this.options.paper)},pointermove:function(t){const e=this.eventData(t),{action:n}=e;if(!n)return;const{clientX:i,clientY:r}=t,{paper:s}=this.options,{x:o,y:a}=s.snapToGrid(i,r),{x:l,y:c}=s.snapToGrid(e.clientX,e.clientY),h=o-l,u=a-c;this.triggerAction(n,"pointermove",t,o,a,h,u),e.clientX=i,e.clientY=r},triggerAction:function(t,e,n){var i=Array.prototype.slice.call(arguments,2);i.unshift("action:"+t+":"+e),this.trigger.apply(this,i)},onRemoveElement:function(t){this.destroySelectionBox(t),this.updateSelectionWrapper()},onResetElements:function(t){this.destroyAllSelectionBoxes(),t.toArray().forEach(this.createSelectionBox.bind(this)),this.updateSelectionWrapper()},onAddElement:function(t){this.createSelectionBox(t),this.updateSelectionWrapper()},removeElements:function(t){var e=this.collection.toArray();this.cancelSelection(),this.options.graph.removeCells(e,{selection:this.cid})},startRotating:function(t){const{paper:e,graph:n}=this.options;n.trigger("batch:start");const i=this.collection.toArray(),r=n.getCellsBBox(this.model.models).center(),s=e.snapToGrid(t.clientX,t.clientY),o=i.reduce(function(l,c){return l[c.id]=c.angle(),l},{}),a=i.reduce(function(l,c){return c.isLink()&&(l[c.id]={source:c.getSourceCell()?null:c.get("source"),target:c.getTargetCell()?null:c.get("target"),vertices:c.vertices()}),l},{});this.eventData(t,{center:r,clientAngle:s.theta(r),initialAngles:o,initialPoints:a})},startResizing:function(t){const{options:e,collection:n}=this,{paperScroller:i,paper:r,graph:s}=e,{gridSize:o}=r.options,a=n.toArray(),{width:l,height:c}=s.getCellsBBox(a),{x:h,y:u}=r.snapToGrid(t.clientX,t.clientY),d=a.map(P=>{const k=P.angle(),N=P.getBBox(),m=N.bbox(k);let b;return k<=90?b=k/90:k<=270?b=Math.abs(180-k)/90:b=Math.abs(k-360)/90,{angle:k,unrotatedBBox:N,bbox:m,factor:b,center:m.center()}}),f=d.reduce((P,k)=>{const N=k.unrotatedBBox;return N.width<P?N.width:P},1/0),p=d.reduce((P,k)=>{const N=k.unrotatedBBox;return N.height<P?N.height:P},1/0),g=s.getSubgraph(a),v=g.filter(P=>P.isLink()),x=v.map(P=>({source:P.getSourceCell()?null:P.get("source"),target:P.getTargetCell()?null:P.get("target"),vertices:P.vertices()})),S=s.getCellsBBox(g),C=i&&i.options.scrollWhileDragging;this.eventData(t,{size:{width:l,height:c},rotatedBBox:s.getCellsBBox(a),minWidth:o*l/f,minHeight:o*c/p,x0:h,y0:u,pointerX:h,pointerY:u,elements:a,elementsRecords:d,links:v,linksRecords:x,cellsBBox:S,scrollWhileDragging:C}),s.trigger("batch:start")},doResize:function(t){const e=this.eventData(t),{size:n,rotatedBBox:i,minWidth:r,minHeight:s,x0:o,y0:a,pointerX:l,pointerY:c,elements:h,elementsRecords:u,links:d,linksRecords:f,cellsBBox:p}=e,{x:g,y:v}=this.options.paper.snapToGrid(t.clientX,t.clientY);if(g===l&&v===c)return;e.lastX=g,e.lastY=v;const{width:x,height:S}=n;let C=Math.max(x+g-o,r),P=Math.max(S+v-a,s);if(this.options.preserveAspectRatio){const m=x*P/S,b=S*C/x;m>C?P=b:C=m}const k=Math.max(C/x,0),N=Math.max(P/S,0);for(let m=0,b=h.length;m<b;m++){const w=h[m],{bbox:T,unrotatedBBox:E,factor:D,center:$,angle:z}=u[m],j=new M(k,N).lerp(new M(N,k),D),O=E.clone().scale(j.x,j.y,$),B=O.bbox(z);let V=B.width-T.width,F=B.height-T.height;Math.abs(V)<.001&&(V=0),Math.abs(F)<.001&&(F=0);const At=new M(i.x,0).distance(new M(T.x,0)),vt=new M(0,i.y).distance(new M(0,T.y));let zt=V/2+At*k-At,re=F/2+vt*N-vt;if(Math.abs(zt)<.001&&(zt=0),Math.abs(re)<.001&&(re=0),O.translate(zt,re),m===0&&w.getBBox().equals(O))return;w.set({position:{x:O.x,y:O.y},size:{width:O.width,height:O.height}},{selection:this.cid})}for(let m=0,b=d.length;m<b;m++){const w=d[m],{source:T,target:E,vertices:D}=f[m],$={};if(D.length>0&&($.vertices=D.map(z=>{const j=new M(z);return j.scale(k,N,p.origin()),j.toJSON()})),T){const z=new M(T);z.scale(k,N,p.origin()),$.source=z.toJSON()}if(E){const z=new M(E);z.scale(k,N,p.origin()),$.target=z.toJSON()}w.set($,{selection:this.cid})}this.updateSelectionBoxes()},doRotate:function(t){var e=this.eventData(t),n=this.options.rotateAngleGrid,i=this.options.paper.snapToGrid(t.clientX,t.clientY),r=e.clientAngle-oe(i).theta(e.center);Math.abs(r)>.001&&(this.collection.toArray().forEach(s=>{const o=pi(e.initialAngles[s.id]+r,n);if(s.isLink()){const{source:a,target:l,vertices:c}=e.initialPoints[s.id],h=d=>M(d).rotate(e.center,-o),u={};return a&&(u.source=h(a)),l&&(u.target=h(l)),c.length>0&&(u.vertices=c.map(h)),s.set(u,{selection:this.cid})}else s.rotate(o,!0,e.center,{selection:this.cid})}),this.updateSelectionBoxes())},stopBatch:function(){this.options.graph.trigger("batch:stop")},getAction:function(){return this._action}},{depthComparator:function(t){return t.getAncestors().length},HandlePosition:Hz,ConnectedLinksTranslation:Ec}),Yv=q,jz={N:"n",NW:"nw",W:"w",SW:"sw",S:"s",SE:"se",E:"e",NE:"ne"},Wz=ce.extend({options:{paper:void 0,usePaperGrid:!1,distance:10,canSnap:null,additionalSnapPoints:null},className:"snaplines",documentEvents:{mouseup:"hide",touchend:"hide"},init:function(){hn(this,"hide"),this.render(),this.enable(),this.prepareFilters()},render:function(){const{$el:t,options:e}=this,n=this.$horizontal=Yv("<div>").addClass("snapline horizontal"),i=this.$vertical=Yv("<div>").addClass("snapline vertical");t.css("display","none").append([n,i]).appendTo(e.paper.el)},startListening:function(){this.enable()},_isEnabled:!1,enable:function(){const{paper:t}=this.options;this.disable(),this.listenTo(t,"element:pointerdown",this.captureCursorOffset),this.listenTo(t,"element:pointermove",this.snapWhileMoving),this.listenTo(t.model,"batch:stop",this.onBatchStop),this.delegateDocumentEvents(),this._isEnabled=!0},disable:function(){const{paper:t}=this.options;this.stopListening(t,"element:pointerdown",this.captureCursorOffset),this.stopListening(t,"element:pointermove",this.snapWhileMoving),this.stopListening(t.model,"batch:stop",this.onBatchStop),this.undelegateDocumentEvents(),this._isEnabled=!1},isDisabled:function(){return!this._isEnabled},prepareFilters:function(){this.filterTypes={},this.filterCells={},this.filterFunction=void 0,Array.isArray(this.options.filter)?this.options.filter.forEach(function(t){ne(t)?this.filterTypes[t]=!0:this.filterCells[t.id]=!0},this):_t(this.options.filter)&&(this.filterFunction=this.options.filter)},onBatchStop:function(t){t=t||{},t.batchName==="resize"&&this.snapWhileResizing(t.cell,t)},captureCursorOffset:function(t,e,n,i){var r=t.getDelegatedView();if(!r)return;var s=r.model.get("position");let o;_t(this.options.additionalSnapPoints)&&(o=this.options.additionalSnapPoints.call(this,t,{type:"move"})),this.eventData(e,{cursorOffset:{x:n-s.x,y:i-s.y},points:o})},snapWhileResizing:function(t,e){if(!(!e.ui||e.snapped||!e.direction||!e.trueDirection)){var n=this.options,i=n.paper,r=i.findViewByModel(t);if(!(!r||!r.model.isElement()||!this.canElementSnap(r))){var s=t.getBBox(),o=s.bbox(t.get("angle")),a=o.origin(),l=o.corner(),c=nn(t.get("angle")),h=n.distance,u=null,d=null,f=i.options.gridSize,p={vertical:0,horizontal:0},g=e.direction,v=e.trueDirection,x=e.relativeDirection;if(v.indexOf("right")!==-1?p.vertical=l.x:p.vertical=a.x,v.indexOf("bottom")!==-1?p.horizontal=l.y:p.horizontal=a.y,_t(this.options.additionalSnapPoints)){const z=this.options.additionalSnapPoints.call(this,r,{type:"resize"});for(let j=0;j<z.length;j++){const O=z[j];if(u===null&&Math.abs(O.x-p.vertical)<h&&(u=O.x),d===null&&Math.abs(O.y-p.horizontal)<h&&(d=O.y),Nt(u)&&Nt(d))break}}if(Nt(u)&&Nt(d)||i.model.getElements().find(function(z){if(z.id===t.id||z.isEmbeddedIn(t)||this.filterTypes[z.get("type")]||this.filterCells[z.id]||this.filterFunction&&this.filterFunction(z))return!1;var j=z.getBBox().bbox(z.get("angle")),O=j.origin(),B=j.corner();n.usePaperGrid&&(O.snapToGrid(f),B.snapToGrid(f));var V={vertical:[O.x,B.x],horizontal:[O.y,B.y]};return Jt(V,function(F,At){F=F.map(function(vt){return{position:vt,distance:Math.abs(vt-p[At])}}),F=F.filter(function(vt){return vt.distance<h}),F=tn(F,function(vt){return vt.distance}),V[At]=F}),u===null&&V.vertical.length>0&&(u=V.vertical[0].position),d===null&&V.horizontal.length>0&&(d=V.horizontal[0].position),Nt(u)&&Nt(d)},this),this.hide(),Nt(u)||Nt(d)){var S=0;Nt(u)&&(v.indexOf("right")!==-1?S=u-o.corner().x:S=o.origin().x-u);var C=0;Nt(d)&&(v.indexOf("bottom")!==-1?C=d-o.corner().y:C=o.origin().y-d);var P=0,k=0,N=!(c%90);if(N)c===90||c===270?(P=C,k=S):(P=S,k=C);else{var m;c>=0&&c<90?m=1:c>=90&&c<180?m=4:c>=180&&c<270?m=3:m=2,d&&u&&(C>S?(C=0,d=null):(S=0,u=null));var b=un(c%90);S&&(m===3?P=S/Math.cos(b):P=S/Math.sin(b)),C&&(m===3?k=C/Math.cos(b):k=C/Math.sin(b));var w=m===1||m===3;switch(x){case"top":case"bottom":C?k=C/(w?Math.cos(b):Math.sin(b)):k=S/(w?Math.sin(b):Math.cos(b));break;case"left":case"right":S?P=S/(w?Math.cos(b):Math.sin(b)):P=C/(w?Math.sin(b):Math.cos(b));break}}switch(x){case"top":case"bottom":P=0;break;case"left":case"right":k=0;break}var T=Math.max(s.width+P,f),E=Math.max(s.height+k,f);e.minWidth&&e.minWidth>f&&(T=Math.max(T,e.minWidth)),e.minHeight&&e.minHeight>f&&(E=Math.max(E,e.minHeight)),e.maxWidth&&(T=Math.min(T,e.maxWidth)),e.maxHeight&&(E=Math.min(E,e.maxHeight)),e.preserveAspectRatio&&(P>k?E=T*(s.height/s.width):T=E*(s.width/s.height)),(T!==s.width||E!==s.height)&&t.resize(T,E,{snaplines:this.cid,direction:g,relativeDirection:x,trueDirection:v,snapped:!0});var D=t.getBBox().bbox(c),$=1;u&&Math.abs(D.x-u)>$&&Math.abs(D.width+D.x-u)>$&&(u=null),d&&Math.abs(D.y-d)>$&&Math.abs(D.height+D.y-d)>$&&(d=null),this.show({vertical:u,horizontal:d})}}}},canElementSnap:function(t,e){let n=!0,i=!1;return _t(this.options.canSnap)&&(n=this.options.canSnap.call(this,t)),e&&(i=t.isDefaultInteractionPrevented(e)),n&&this.canElementMove(t)&&!i},canElementMove:function(t){return t&&t.model.isElement()&&t.can("elementMove")},snapWhileMoving:function(t,e,n,i){var r=t.eventData(e);const s=this.eventData(e);var o=r.delegatedView||t;if(this.canElementSnap(o,e)){var a=o.model,l=a.get("size"),c=xr(H({x:n-s.cursorOffset.x,y:i-s.cursorOffset.y},l)),h=c.center(),u=c.bbox(a.get("angle")),d=u.origin(),f=u.corner(),p=this.options,g=p.paper,v=p.distance,x=null,S=null,C=0,P=0;if(s.points){const w=s.points;for(let T=0;T<w.length;T++){const E=w[T];if(x===null&&(Math.abs(E.x-h.x)<v?(x=E.x,C=.5):Math.abs(E.x-d.x)<v?x=E.x:Math.abs(E.x-f.x)<v&&(x=E.x,C=1)),S===null&&(Math.abs(E.y-h.y)<v?(S=E.y,P=.5):Math.abs(E.y-d.y)<v?S=E.y:Math.abs(E.y-f.y)<v&&(S=E.y,P=1)),Nt(x)&&Nt(S))break}}if(Nt(x)&&Nt(S)||g.model.getElements().find(function(w){if(w===a||w.isEmbeddedIn(a)||this.filterTypes[w.get("type")]||this.filterCells[w.id]||this.filterFunction&&this.filterFunction(w))return!1;var T=w.getBBox().bbox(w.get("angle")),E=T.center(),D=T.origin(),$=T.corner();return x===null&&(Math.abs(E.x-h.x)<v?(x=E.x,C=.5):Math.abs(D.x-d.x)<v?x=D.x:Math.abs(D.x-f.x)<v?(x=D.x,C=1):Math.abs($.x-f.x)<v?(x=$.x,C=1):Math.abs($.x-d.x)<v&&(x=$.x)),S===null&&(Math.abs(E.y-h.y)<v?(S=E.y,P=.5):Math.abs(D.y-d.y)<v?S=D.y:Math.abs(D.y-f.y)<v?(S=D.y,P=1):Math.abs($.y-f.y)<v?(S=$.y,P=1):Math.abs($.y-d.y)<v&&(S=$.y)),Nt(x)&&Nt(S)},this),this.hide(),Nt(x)||Nt(S)){Nt(x)&&(u.x=x-C*u.width),Nt(S)&&(u.y=S-P*u.height);var k=u.center(),N=k.x-c.width/2,m=k.y-c.height/2,b=new M(N,m);p.usePaperGrid&&b.snapToGrid(g.options.gridSize),a.position(b.x,b.y,{restrictedArea:g.getRestrictedArea(o,n,i),deep:!0,snapped:!0}),this.show({vertical:x,horizontal:S})}}},show:function(t={}){const{vertical:e,horizontal:n}=t,{options:i,$horizontal:r,$vertical:s,$el:o}=this,{a,d:l,e:c,f:h}=i.paper.matrix();Nt(n)?r.css("top",n*l+h).css("display",""):r.css("display","none"),Nt(e)?s.css("left",e*a+c).css("display",""):s.css("display","none"),o.css("display","")},hide:function(){this.$el.css("display","none")}},{HandlePosition:jz});class Yz extends gn{constructor(e){super(e),this.update()}defaults(){return{stackGap:10,stackElementGap:10,direction:fn.Directions.TopBottom,stackIndexAttributeName:"stackIndex",stackElementIndexAttributeName:"stackElementIndex"}}update(){const e=fn.layout(this.elements,this.attributes);this.bbox=e.bbox,this.stacks=e.stacks,this.trigger("update")}getStackFromPoint(e){for(let n=0;n<this.stacks.length;n++){const i=this.stacks[n],{bbox:r}=i;if((this.direction===fn.Directions.BottomTop||this.direction===fn.Directions.TopBottom)&&e.x>=r.x&&e.x<r.x+r.width||(this.direction===fn.Directions.RightLeft||this.direction===fn.Directions.LeftRight)&&e.y>=r.y&&e.y<r.y+r.height)return i}return null}getInsertElementIndexFromPoint(e,n){const{elements:i}=e,r=i.length;if(r===0)return 0;switch(this.direction){case fn.Directions.TopBottom:{for(let s=0;s<r;s++){const o=i[s],a=o.position().y+o.size().height/2;if(n.y<a)return s}return r}case fn.Directions.BottomTop:{for(let s=0;s<r;s++){const o=i[s],a=o.position().y+o.size().height/2;if(n.y>a)return s}return r}case fn.Directions.LeftRight:for(let s=0;s<r;s++){const o=i[s],a=o.position().x+o.size().width/2;if(n.x<a)return s}return r;case fn.Directions.RightLeft:for(let s=0;s<r;s++){const o=i[s],a=o.position().x+o.size().width/2;if(n.x>a)return s}return r}}getStackFromElement(e){return this.stacks[e.get(this.stackIndexAttributeName)]}hasElement(e){return e.has(this.stackIndexAttributeName)}insertElement(e,n,i,r){const s=this.get("graph");s.startBatch("stack-layout-insert"),s.getCell(e)||s.addCell(e,r);const{stackIndexAttributeName:o,stackElementIndexAttributeName:a}=this,l=this.stacks[n];let c;if(l){const{elements:h}=l,u=h[i],{length:d}=h;if(u){c=u.get(a);for(let f=i;f<d;f++){const p=h[f],g=p.get(a)||0;p.set(a,g+1,r)}}else d>0?c=(h[h.length-1].get(a)||0)+1:c=0}else c=0;e.set({[o]:n,[a]:c},r),this.update(),s.stopBatch("stack-layout-insert")}get elements(){return this.get("graph").getElements().filter(n=>n.has(this.stackIndexAttributeName))}get direction(){return this.get("direction")}get stackIndexAttributeName(){return this.get("stackIndexAttributeName")}get stackElementIndexAttributeName(){return this.get("stackElementIndexAttributeName")}}const Xz=(t,e)=>{const{direction:n}=e.model,{targetStack:i,invalid:r}=t,s=L("path",{stroke:r?"#ccc":"#333","stroke-width":2});switch(n){case fn.Directions.RightLeft:case fn.Directions.LeftRight:{const{height:o}=i.bbox;s.attr("d",`M 0 ${-o/2} v ${o}`);break}case fn.Directions.TopBottom:case fn.Directions.BottomTop:default:{const{width:o}=i.bbox;s.attr("d",`M ${-o/2} 0 h ${o}`);break}}return s.node},qz=(t,e)=>!0,Kz=(t,e,n)=>t.insertElementIndex,Zz=(t,e)=>e.model.hasElement(t.model);class Jz extends ce{constructor(e){super(e),this.currentEventData={},this.paper=e.paper,this.model||(this.model=new Yz(Object.assign({},e.layoutOptions,{graph:this.paper.model}))),this.previewFunction=e.preview||Xz,this.validateMoving=e.validateMoving||qz,this.canInteract=e.canInteract||Zz,this.modifyInsertElementIndex=e.modifyInsertElementIndex||Kz,this.startListening()}preinitialize(){this.svgElement=!0,this.tagName="g"}startListening(){const{paper:e}=this;this.listenTo(e,"element:pointerdown",this.onPaperPointerdown),this.listenTo(e,"element:pointermove",this.onPaperPointermove),this.listenTo(e,"element:pointerup",this.onPaperPointerup)}getPreviewPosition(e,n){const i=this.model.get("stackElementGap")/2,{direction:r}=this.model,{bbox:s,elements:o}=e,a=o.length,l=o[n],c={x:0,y:0};switch(r){case fn.Directions.TopBottom:{if(c.x=s.x+s.width/2,l)c.y=l.position().y-i;else{const h=o[a-1];h?c.y=h.position().y+h.size().height+i:c.y=s.y-i}break}case fn.Directions.BottomTop:{if(c.x=s.x+s.width/2,l)c.y=l.position().y+l.size().height+i;else{const h=o[a-1];h?c.y=h.position().y-i:c.y=s.y+s.height+i}break}case fn.Directions.LeftRight:if(c.y=s.y+s.height/2,l)c.x=l.position().x-i;else{const h=o[a-1];h?c.x=h.position().x+h.size().width+i:c.x=s.x-i}break;case fn.Directions.RightLeft:if(c.y=s.y+s.height/2,l)c.x=l.position().x+l.size().width+i;else{const h=o[a-1];h?c.x=h.position().x-i:c.x=s.x+s.width+i}break}return c}createGhost(e){const{vel:n}=e,i=n.clone();return i.attr("opacity",.4),i.node.style.transform="",i.addClass("stack-layout-ghost"),i}dragstart(e,n,i){const r=this.model.getStackFromElement(e);this.currentEventData||(this.currentEventData={}),Object.assign(this.currentEventData,{sourceStack:r})}drag(e,n,i){if(!this.currentEventData)return;const r={x:n,y:i},{sourceStack:s}=this.currentEventData;let{preview:o}=this.currentEventData;const a=this.model.getStackFromPoint(r);if(a){let l;s&&(l=s.elements.findIndex(h=>h.id===e.id));let c=this.model.getInsertElementIndexFromPoint(a,r);if(c=this.modifyInsertElementIndex({sourceStack:s,sourceElement:e,targetStack:a,insertElementIndex:c},new M(r),this),a!==s||c!==l&&c!==l+1){if(a!==this.currentEventData.targetStack||c!==this.currentEventData.insertElementIndex){const h=!this.validateMoving({sourceStack:s,sourceElement:e,targetStack:a,insertElementIndex:c},this);o&&o.remove(),o=L(this.previewFunction({sourceStack:s,sourceElement:e,targetStack:a,insertElementIndex:c,invalid:h},this)),o.addClass("stack-layout-preview"),h&&o.addClass("stack-layout-preview-invalid"),o.appendTo(this.paper.getLayerNode(Ai.Layers.FRONT));const u=this.getPreviewPosition(a,c);L(o).attr("transform",`translate(${u.x},${u.y})`),Object.assign(this.currentEventData,{invalid:h,preview:o,targetStack:a,insertElementIndex:c})}return}}o&&o.remove(),delete this.currentEventData.invalid,delete this.currentEventData.preview,delete this.currentEventData.targetStack,delete this.currentEventData.insertElementIndex}dragend(e,n,i){if(!this.currentEventData)return;const{preview:r,targetStack:s,insertElementIndex:o,invalid:a}=this.currentEventData;r&&r.remove(),!(!s||a)&&(this.model.insertElement(e,s.index,o,{stackLayoutView:this.cid}),delete this.currentEventData)}cancelDrag(){if(!this.currentEventData)return;const{preview:e}=this.currentEventData;e&&e.remove(),delete this.currentEventData}canDrop(){if(!this.currentEventData)return!1;const{targetStack:e,invalid:n}=this.currentEventData;return e&&!n}onPaperPointerdown(e,n,i,r){if(!this.canInteract(e,this)){delete this.currentEventData;return}if(e.can("elementMove"))throw new Error('ui.StackLayoutView: requires the "elementMove" interactivity set to false. e.g. paper.setInteractivity(false)');const{model:s}=e;this.dragstart(s,i,r);const o=s.position();Object.assign(this.currentEventData,{ghost:this.createGhost(e),dx:i-o.x,dy:r-o.y})}onPaperPointermove(e,n,i,r){const{currentEventData:s}=this;if(!s)return;const{model:o}=e;this.drag(o,i,r);const{ghost:a,dx:l,dy:c,invalid:h}=s;a&&(a.attr("transform",`translate(${i-l},${r-c})`),a.parent()||a.appendTo(this.paper.getLayerNode(Ai.Layers.FRONT)),a.toggleClass("stack-layout-ghost-invalid",!!h))}onPaperPointerup(e,n,i,r){const{currentEventData:s}=this;if(!s)return;const{ghost:o}=s;o&&o.remove();const{model:a}=e;this.dragend(a,i,r)}}const ai=q;var Xv={options:function(){return{columnWidth:(this.options.width-2*10-10*(2-1))/2,columns:2,rowHeight:80,rowGap:10,columnGap:10,marginX:10,marginY:10,resizeToFit:!0}},layoutGroup:function(t,e){var n=this.options.layout;if(e=e||{},!of)throw new Error("ui.Stencil: joint.layout.GridLayout is not available.");of.layout(t,H({},n,e.layout))}};const ug=ce.extend({className:"stencil",events:{"click .btn-expand":"openGroups","click .btn-collapse":"closeGroups","click .groups-toggle > .group-label":"openGroups","click .group > .group-label":"onGroupLabelClick","touchstart .group > .group-label":"onGroupLabelClick","input .search":"onSearch","focusin .search":"pointerFocusIn","focusout .search":"pointerFocusOut"},documentEvents:{mousemove:"onDrag",touchmove:"onDrag",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"},options:{width:200,height:800,label:"Stencil",groups:null,groupsToggleButtons:!1,dropAnimation:!1,search:null,layout:null,snaplines:null,scaleClones:!1,usePaperGrid:!1,dragStartClone:function(t){return t.clone()},dragEndClone:function(t){return t.clone()},canDrag:null,layoutGroup:null,paperOptions:null,paperDragOptions:null,paperPadding:10,contentOptions:null,container:null},DEFAULT_GROUP:"__default__",init:function(){this.setPaper(this.options.paperScroller||this.options.paper),this.graphs={},this.papers={},this.$groups={},this.onSearch=Nl(this.onSearch,200),this.delegateEvents(),this.initializeLayout()},initializeLayout:function(){var t=this.options.layout;t&&(_t(t)?this.layoutGroup=t:(this.layoutGroup=Xv.layoutGroup.bind(this),this.options.layout=Vt(t)?t:Xv.options.call(this)))},setPaper:function(t){var e=this.options;if(t instanceof Ai)e.paperScroller=null,e.paper=t,e.graph=t.model;else if(typeof al=="function"&&t instanceof al)e.paperScroller=t,e.paper=t.options.paper,e.graph=t.options.paper.model;else throw new Error("ui.Stencil: paper required")},freeze(t){const{papers:e}=this;Object.keys(e).forEach(n=>{e[n].freeze(t)})},unfreeze(t){const{papers:e}=this;Object.keys(e).forEach(n=>{e[n].unfreeze(t)})},renderContent:function(){return ai("<div/>").addClass("content")},createDraggingPaper:function(){if(this._paperDrag)return;const{options:t}=this,e=document.createElement("div");e.classList.add("stencil-paper-drag");const n=ee(t,"paperOptions")||{},i=ee(t,"paperDragOptions")||{},r=this._graphDrag=i.model||n.model||new On({},{cellNamespace:this.defaultCellNamespace}),s=H({cellViewNamespace:this.defaultCellViewNamespace},i,{el:e,width:1,height:1,model:r,sorting:Ai.sorting.NONE}),o=new Ai(s);o.el.style.position="absolute",this._paperDrag=o},renderSearch:function(){const t=ai("<input/>").addClass("search").attr({type:"search",placeholder:"search"});return ai("<div/>").addClass("search-wrap").append(t)},renderToggleAll:function(){return[ai("<div/>").addClass("groups-toggle").append(ai("<label/>").addClass("group-label").html(this.options.label)).append(ai("<button/>").addClass("btn btn-expand").text("+")).append(ai("<button/>").addClass("btn btn-collapse").text("-"))]},renderElementsContainer:function(){return ai("<div/>").addClass("elements")},renderGroup:function(t){t=t||{};var e=ai("<div/>").addClass("group").data("name",t.name).toggleClass("closed",!!t.closed),n=ai("<h3/>").addClass("group-label").html(t.label||t.name),i=this.renderElementsContainer();return e.append(n,i)},render:function(){this.dispose();var t=this.options;this.$content=this.renderContent(),this.$el.empty().append(this.$content),t.search&&this.$el.addClass("searchable").prepend(this.renderSearch()),t.groupsToggleButtons&&this.$el.addClass("collapsible").prepend(this.renderToggleAll()),this.el.dataset.textNoMatchesFound="No matches found";var e=Object.keys(t.groups||{}),n=e.length>0;if(t.paperOptions&&!_t(t.paperOptions)&&t.paperOptions.model)throw new Error("ui.Stencil: the `paperOptions` has to be a function if there is the property `model` defined.");if(n){var i=tn(e,(function(r){return this[r].index}).bind(t.groups));i.forEach(function(r){var s=this.options.groups[r],o=this.$groups[r]=this.renderGroup({name:r,label:s.label,closed:s.closed}).appendTo(this.$content);if(s.paperOptions&&s.paperOptions.model)throw new Error("ui.Stencil: the `model` property is not allowed in the `paperOptions` for the groups.");const[a]=o.find(".elements"),l=this.getGroupPaperOptions(r),c=this.createGroupGraph(r,l),h=H({cellViewNamespace:this.defaultCellViewNamespace},l,{el:a,model:c,interactive:!1,preventDefaultBlankAction:!1,width:s.width||t.width,height:s.height||t.height}),u=new Ai(h);this.graphs[r]=c,this.papers[r]=u},this)}else{const[r]=this.renderElementsContainer().appendTo(this.$content),s=this.getGroupPaperOptions(null),o=this.createGroupGraph(null,s),a=H({cellViewNamespace:this.defaultCellViewNamespace},s,{el:r,model:o,width:t.width,height:t.height,interactive:!1,preventDefaultBlankAction:!1}),l=new Ai(a);this.graphs[this.DEFAULT_GROUP]=o,this.papers[this.DEFAULT_GROUP]=l}return this.createDraggingPaper(),this.startListening(),this},getGroupPaperOptions:function(t){const{options:e}=this,n=ee(e,"paperOptions"),i=[{},n];if(t){const r=ee(this.getGroup(t),"paperOptions");i.push(r)}return H(...i)},createGroupGraph:function(t,e){let n;return e.model?n=e.model:n=new On({},{cellNamespace:this.defaultCellNamespace}),n.set("group",t),n},paperEvents:{"cell:pointerdown":"onDragStart"},startListening:function(){this.stopListening();const{paperEvents:t,papers:e}=this;for(let n in t){let i=t[n];typeof i!="function"&&(i=this[i]),i&&Jt(e,r=>{this.listenTo(r,n,i)})}},load:function(t,e){Array.isArray(t)?this.loadGroup(t,e):Vt(t)&&Jt(this.options.groups,(function(n,i){t[i]&&this.loadGroup(t[i],i)}).bind(this))},loadGroup:function(t,e){const{options:n}=this,i=this.getGraph(e);i.resetCells(t);let r=n.height;e&&(r=this.getGroup(e).height),this.isLayoutEnabled()&&this.layoutGroup(i,this.getGroup(e)),r||this.fitPaperToContent(this.getPaper(e))},isLayoutEnabled:function(){return!!this.options.layout},getGraph:function(t){var e=this.graphs[t||this.DEFAULT_GROUP];if(!e)throw new Error("ui.Stencil: group "+t+" does not exist.");return e},getPaper:function(t){return this.papers[t||this.DEFAULT_GROUP]},hasSnaplinesEnabled:function(){const{snaplines:t}=this.options;return!!t&&!t.isDisabled()},preparePaperForDragging:function(t,e,n){const{_paperDrag:i,_graphDrag:r,options:s}=this,{snaplines:o,usePaperGrid:a,scaleClones:l,paper:c,container:h}=s;this.stopListening(r),i.$el.stop(),i.$el.addClass("dragging").appendTo(h||document.body),this.positionCell(t,0,0),r.resetCells([t]);let u=5;if(o&&(u+=o.options.distance),o||a||l){const{sx:x,sy:S}=c.scale();i.scale(x,S),u*=Math.max(x,S)}else i.scale(1,1);i.fitToContent({padding:u,allowNewOrigin:"any"});const d=t.findView(i),f=d.getBBox({useModelGeometry:!0}),p=f.origin().difference(d.getBBox().origin()),g=this.setPaperDragOffset(e,n,{cloneGeometryBBox:f,cloneViewDeltaOrigin:p,paperDragPadding:u}),v=ai(h).offset();return v&&(g.left-=v.left,g.top-=v.top),{clone:t,cloneView:d,cloneBBox:t.getBBox(),cloneGeometryBBox:f,cloneViewDeltaOrigin:p,paperDragPadding:u,paperDragInitialOffset:g}},removePaperAfterDragging:function(){const{_paperDrag:t,_graphDrag:e}=this;e.resetCells([]),this.$el.append(t.$el).removeClass("dragging"),t.$el.removeClass("dragging")},setPaperDragOffset:function(t,e,{cloneViewDeltaOrigin:n,cloneGeometryBBox:i,paperDragPadding:r}){const{body:s,documentElement:o}=document,a=s.scrollTop||o.scrollTop,l=t-n.x-i.width/2-r,c=e-n.y-i.height/2-r+a;return this._paperDrag.$el.offset({left:l,top:c}),{left:l,top:c}},onCloneSnapped:function(t,e,n){const{_dragging:i}=this;if(!i)return;const{snapped:r,tx:s,ty:o}=n;if(r){const{cloneBBox:a,cloneView:l}=i;this.positionCell(t,a.x+s,a.y+o,{silent:!0}),l.translate(),t.set("position",e,{silent:!0}),i.snapOffset={x:s,y:o}}else i.snapOffset=null},_dragging:null,onDragStart:function(t,e){const{canDrag:n,dragStartClone:i}=this.options,r=t.model,{group:s=null}=r.graph.attributes;if(typeof n=="function"&&!n.call(this,t,e,s))return;const o=i(r);if(r===o||!(o instanceof an))throw new Error("ui.Stencil: `dragStartClone` must return a clone of the cell");this.startDragging(o,e)},startDragging(t,e){const{options:n,_graphDrag:i}=this,{snaplines:r,usePaperGrid:s}=n;this.createDraggingPaper(),this.$el.addClass("dragging");const{clientX:o=0,clientY:a=0}=e,l=this.preparePaperForDragging(t,o,a),{cloneView:c}=l;this._dragging=l;const h=!1,u=this.getCloneArea(c,e,h);H(l,{clientX:o,clientY:a,validDropTarget:h,cloneArea:u}),this.positionCell(t,u.x,u.y,{silent:!0}),t.isElement()&&this.hasSnaplinesEnabled()&&(r.captureCursorOffset(c,e,u.x,u.y),this.listenTo(i,"change:position",this.onCloneSnapped.bind(this)));const d=e.data||(e.data={});this.delegateDocumentEvents(null,d),this.trigger("element:dragstart",c,e,u.clone(),h),c.stopListening(),this.isDragCanceled()&&(this.notifyDragEnd(c,e,u,h),this._dragging=null)},onDrag:function(t){const{_dragging:e,options:n}=this;if(!e)return;t.preventDefault();const i=at(t);if(this.isDragCanceled()){const{cloneView:v,validDropTarget:x,cloneArea:S}=e;this.notifyDragEnd(v,i,S,x),this._dragging=null;return}const{clone:r,cloneView:s}=e,{paper:o,snaplines:a,usePaperGrid:l}=n,c=this.insideValidArea({x:i.clientX,y:i.clientY}),h=this.getCloneArea(s,i,c&&l),{x:u,y:d}=h.center(),{x:f,y:p}=o.localToClientPoint(u,d);H(e,{clientX:f,clientY:p,validDropTarget:c,cloneArea:h}),this.setPaperDragOffset(f,p,e),this.positionCell(r,0,0,{silent:!0}),s.translate(),this.positionCell(r,h.x,h.y,{stencil:this.cid}),this.hasSnaplinesEnabled()&&(c?a.snapWhileMoving(s,i,h.x,h.y):a.hide());const{embeddingMode:g}=o.options;if(g&&r.isElement()){s.eventData(i,{paper:o});const v=e.cloneViewEventData=s.eventData(i);c?s.processEmbedding(v,t,u,d):s.clearEmbedding(v)}s.startListening(),this.trigger("element:drag",s,i,h.clone(),c),s.stopListening(),this.isDragCanceled()&&(this.notifyDragEnd(s,i,h,c),this._dragging=null)},onDragEnd:function(t){const{_dragging:e,options:n}=this;if(!e)return;const i=at(t),{clone:r,clientX:s,clientY:o,validDropTarget:a,cloneArea:l,cloneView:c,cloneBBox:h,snapOffset:u}=e;let d=h.x,f=h.y;if(u&&(d+=u.x,f+=u.y),this.positionCell(r,d,f,{silent:!0}),this.notifyDragEnd(c,i,l,a),this.isDragCanceled()){this._dragging=null;return}const p=n.paper.clientToLocalPoint(s,o),g=!u;a?this.onDrop(c,i,p,g):this.onDropInvalid(c,i,p,g),this._dragging=null},notifyDragEnd:function(t,e,n,i){t.startListening(),this.trigger("element:dragend",t,e,n.clone(),i),t.stopListening(),this.undelegateDocumentEvents()},onDrop:function(t,e,n,i){const{options:r}=this,{paper:s,graph:o}=r,{embeddingMode:a}=s.options,{model:l}=t;o.startBatch("stencil-drag");const c=r.dragEndClone(l);if(l===c||!(c instanceof an))throw new Error("ui.Stencil: `dragEndClone` must return a clone of the cell");this.drop(c,n,i),a&&l.isElement()&&(t.eventData(e,{model:c,paper:s,initialParentId:Kp(),whenNotAllowed:"remove"}),t.finalizeEmbedding(t.eventData(e))),o.getCell(c)?(this.trigger("element:drop",c.findView(s),e,n.x,n.y),this.removePaperAfterDragging(l)):this.onDropInvalid(t,e,n,i),o.stopBatch("stencil-drag")},onDropInvalid:function(t,e,n,i){const{model:r}=t,s=this.options.dragEndClone(r);this.trigger("drop:invalid",e,s,n.x,n.y),this.cancelDrag()},cancelDrag:function({dropAnimation:t}=this.options){const{_dragging:e,options:n,_paperDrag:i}=this;if(!e)return;const{clone:r,cloneView:s,cloneViewEventData:o,paperDragInitialOffset:a}=e,{paper:l,snaplines:c}=n;if(l.options.embeddingMode&&o&&r.isElement()&&s.clearEmbedding(o),this.hasSnaplinesEnabled()&&c.hide(),e.canceled=!0,t){const{duration:h=150,easing:u="ease-in-out"}=t;i.$el.animate(a,{duration:h,easing:u,complete:this.removePaperAfterDragging.bind(this,r)})}else this.removePaperAfterDragging(r)},isDragCanceled:function(){const{_dragging:t}=this;return t?!!t.canceled:!1},drop:function(t,e,n){const{options:i}=this,{paper:r,graph:s}=i,o=t.getBBox(),a=new M({x:e.x+o.x-o.width/2,y:e.y+o.y-o.height/2});n&&a.snapToGrid(r.options.gridSize),t.unset("z"),this.positionCell(t,a.x,a.y),s.addCell(t,{stencil:this.cid})},insideValidArea:function(t){const{paper:e,paperScroller:n}=this.options,i=this.getDropArea(this.el);let r;if(!n)r=this.getDropArea(e.el);else if(n.options.autoResizePaper)r=this.getDropArea(n.el);else{const s=this.getDropArea(n.el);r=this.getDropArea(e.el).intersect(s)}return!!(r&&r.containsPoint(t)&&!i.containsPoint(t))},getDropArea:function(t){const e=ai(t),{left:n,top:i}=e.offset(),{body:r,documentElement:s}=document,o=r.scrollTop||s.scrollTop,a=r.scrollLeft||s.scrollLeft,l=parseInt(e.css("border-left-width"),10)||0,c=parseInt(e.css("border-top-width"),10)||0;return new Z({x:n+l-a,y:i+c-o,width:t.clientWidth,height:t.clientHeight})},getCloneArea(t,e,n){const{paper:i}=this.options,{model:r}=t,{clientX:s,clientY:o}=e,{x:a,y:l}=i.clientToLocalPoint(s,o),{width:c,height:h}=r.getBBox();let u=a-c/2,d=l-h/2;if(n){const{x:f,y:p}=i.snapToGrid(i.localToClientPoint(u,d));u=f,d=p}return new Z(u,d,c,h)},filter:function(t,e=this.options.search){var n=Object.keys(this.papers).reduce((i,r)=>{var s=this.papers[r],o=r===this.DEFAULT_GROUP?null:r,a=s.model.getCells().filter(u=>{var d=!1;e&&(_t(e)?d=e.call(this,u,t,o,this):d=this.isCellMatched(u,t,e,t.toLowerCase()!==t));var f=s.findViewByModel(u);return f&&f.vel.toggleClass("unmatched",!d),d}),l=!En(a);const c=this.getGroupPaperOptions(o),h=this.createGroupGraph(o,c);return h.resetCells(a),this.trigger("filter",h,r,t),this.isLayoutEnabled()&&this.layoutGroup(h,this.getGroup(r)),this.$groups[r]&&this.$groups[r].toggleClass("unmatched",!l),this.fitPaperToContent(s),i||l},!1);this.$el.toggleClass("not-found",!n)},isCellMatched:function(t,e,n,i){return e?Object.keys(n).some(function(r){var s=n[r];if(r!="*"&&t.get("type")!=r)return!1;var o=s.some(function(a){var l=yn(t.attributes,a,"/");return l==null?!1:(l=l.toString(),i||(l=l.toLowerCase()),l.indexOf(e)>=0)});return o}):!0},fitPaperToContent:function(t){const{options:e}=this,{width:n}=t.getComputedSize(),i=H({minWidth:n,padding:e.paperPadding},e.contentOptions);t.fitToContent(i)},getGroup:function(t){return this.options.groups&&this.options.groups[t]||{}},onSearch:function(t){const e=t.target.value;this.$el.toggleClass("stencil-filtered",e.length>0),this.filter(e,this.options.search)},pointerFocusIn:function(){this.$el.addClass("is-focused")},pointerFocusOut:function(){this.$el.removeClass("is-focused")},onGroupLabelClick:function(t){if(t.type==="touchstart")this._groupLabelClicked=!0;else if(this._groupLabelClicked&&t.type==="click"){this._groupLabelClicked=!1;return}var e=t.target.closest(".group");this.toggleGroup(e.dataset.name)},toggleGroup:function(t){this.isGroupOpen(t)?this.closeGroup(t):this.openGroup(t)},closeGroup:function(t){var e=this.$groups[t];!e||!this.isGroupOpen(t)||(this.trigger("group:close",t),e.addClass("closed"))},openGroup:function(t){var e=this.$groups[t];!e||this.isGroupOpen(t)||(this.trigger("group:open",t),e.removeClass("closed"))},isGroupOpen:function(t){var e=this.$groups[t];return e?!e.hasClass("closed"):!1},closeGroups:function(){Object.keys(this.$groups).forEach(function(t){this.closeGroup(t)},this)},openGroups:function(){Object.keys(this.$groups).forEach(function(t){this.openGroup(t)},this)},positionCell:function(t,e,n,i){if(t.isElement())t.position(e,n,i);else{const r=t.getBBox();t.translate(e-r.x,n-r.y,i)}},onRemove:function(){this.dispose()},dispose:function(){Ue(this.papers,"remove"),this.papers={},this._paperDrag&&(this._paperDrag.remove(),this._paperDrag=null),this.undelegateDocumentEvents()}});Object.defineProperty(ug.prototype,"defaultCellNamespace",{enumerable:!0,get:function(){return this.options.paper.model.get("cells").cellNamespace}});Object.defineProperty(ug.prototype,"defaultCellViewNamespace",{enumerable:!0,get:function(){return this.options.paper.options.cellViewNamespace}});const{mergeAttrs:oS}=L,{isEqual:aS,isEmpty:qv,flattenObject:Kv,setByPath:Qz}=aF;function wo(t,e,n={}){const{merge:i=oS}=n,r={};return t.forEach(s=>{const{start:o,end:a,attrs:l}=s;(o===void 0&&a===void 0||e>=o&&e<a)&&i(r,l)}),r}function cf(t,e,n,i={}){const{delim:r="/",merge:s=oS}=i,o=L.findAnnotationsBetweenIndexes(t,e,n);if(e===n)return wo(o,e,i);let a;for(let c=e;c<n;c++){var l=wo(o,c,i);if(a&&!aS(a,l)){a=Kv(s({},a),r),l=Kv(s({},l),r);const h={};for(let u in l)a[u]===l[u]&&Qz(h,u,l[u],r);a=h}else a=l}return a}function t6(t,e={}){const{compare:n=aS}=e,i=[],r=t.reduce((s,o)=>{const{end:a}=o;return a===void 0?s:Math.max(s,a)},0);for(let s=-1,o=r;s<o;s++){let a=null;for(let l=s+1;l<=o;l++){const c=cf(t,l-1,l,e);if(!a){a=c;continue}n(c,a)||(l--,qv(a)||i.push({start:s,end:l,attrs:a}),a=null,s=l)}if(a){s<o&&!qv(a)&&i.push({start:s,end:o,attrs:a});break}}return i}const Dn=q,ca=ce.extend({options:{text:void 0,newlineCharacterBBoxWidth:10,placeholder:void 0,focus:!0,debug:!1,selectAllThreshold:20,useNativeSelection:!0,annotateUrls:!1,urlAnnotation:{attrs:{class:"url-annotation",fill:"lightblue","text-decoration":"underline"}},textareaAttributes:{autocorrect:"off",autocomplete:"off",autocapitalize:"off",spellcheck:"false",tabindex:"0"}},className:"text-editor",events:{"keyup textarea":"onKeyup","input textarea":"onInput","copy textarea":"onCopy","cut textarea":"onCut","paste textarea":"onPaste","mousedown .char-selection-box":"onMousedown","dblclick .char-selection-box":"onDoubleClick","click .char-selection-box":"onTripleClick"},selection:{start:null,end:null},selecting:!1,_textCursor:null,AFTER_KEYDOWN_DELAY:10,DEFAULT_FONT_SIZE:12,init:function(){hn(this,"onMousedown","onMousemove","onMouseup","onDoubleClick","onTripleClick","onKeydown","onAfterPaste","onAfterKeydown","onDocumentPointerdown");const t=this.options.text;if(!t)throw new Error("ui.TextEditor: text option is mandatory");this.setTextElement(t),document.addEventListener("pointerdown",this.onDocumentPointerdown,{capture:!0}),Dn(document.body).on("mousemove",this.onMousemove),Dn(document.body).on("mouseup",this.onMouseup),Dn(document.body).on("keydown",this.onKeydown),this.$viewport=Dn(t),this.options.annotations&&this.setAnnotations(this.options.annotations)},setTextElement:function(t){this.options.text=t,this.bindTextElement(t)},bindTextElement:function(t){if(this.unbindTextElement(),!t)return;const e=Dn(t);e.on("mousedown",this.onMousedown),e.on("dblclick",this.onDoubleClick),e.on("click",this.onTripleClick),this.elText=t},unbindTextElement:function(){const{elText:t}=this;if(!t)return;const e=Dn(t);e.off("mousedown",this.onMousedown),e.off("dblclick",this.onDoubleClick),e.off("click",this.onTripleClick),this.elText=null},render:function(t){this.$caret=Dn("<div>").addClass("caret"),this.$selection=Dn("<div>"),this.$selectionBox=Dn("<div>").addClass("char-selection-box"),this.$el.append(this.$caret,this.$selection),this.$textareaContainer=Dn("<div>").addClass("textarea-container"),this.$textarea=Dn("<textarea>").attr(this.options.textareaAttributes),this.textarea=this.$textarea[0],this._textContent=this.textarea.value=this.getTextContent(),this._textareaValueBeforeInput=this.textarea.value,this.$textareaContainer.append(this.textarea),this.options.focus&&this.$el.append(this.$textareaContainer),Dn(t||document.body).append(this.$el);const e=L(this.options.text),n=e.bbox();return this.$textareaContainer.css({left:n.x,top:n.y}),this.focus(),this._textCursor=e.attr("cursor"),e.attr("cursor","text"),this.selectAll(),this},annotateURLBeforeCaret:function(t){if(t===0)return!1;const e=Math.max(t-1,0),n=this.getURLBoundary(e),i=this.getAnnotations()||[];return n?(this.annotateURL(i,n[0],n[1]),!0):!!L.findAnnotationsAtIndex(i,e).some(s=>s.url)},hasSelection:function(){return Nt(this.selection.start)&&Nt(this.selection.end)&&this.selection.start!==this.selection.end},textContentHasChanged:function(){return this._textContent!==this.textarea.value},restoreTextAreaSelectionDirection:function(){this._selectionDirection&&(this.textarea.selectionDirection=this._selectionDirection)},storeSelectionDirection:function(){this._selectionDirection=this.textarea.selectionDirection},updateSelectionFromTextarea:function(){const{selectionStart:t,selectionEnd:e}=this.textarea;t===e?this.setCaret(t):this.select(t,e)},textSelectionHasChanged:function(){const{selection:t,textarea:e}=this;return!t||!e?!1:t.start!==e.selectionStart||t.end!==e.selectionEnd},isModifierKey:function(t){var e=[16,18,17,91];return e.some(n=>t.which===n)},isArrowKey:function(t){return t.which>=37&&t.which<=40},copyToClipboard:function(){var t=document.queryCommandSupported&&document.queryCommandSupported("copy");t&&(this._copied=!0,document.execCommand("copy"))},findAnnotationsUnderCursor:function(t,e){return L.findAnnotationsAtIndex(t,e)},findAnnotationsInSelection:function(t,e,n){return L.findAnnotationsBetweenIndexes(t,e,n)},inferTextOperationType:function(t,e,n){if(t.start===t.end&&e.start===e.end&&n>0)return"insert";if(t.start===t.end&&e.start===e.end&&n<=0)return"delete-single";if(t.start!==t.end&&e.start===e.end&&e.start===t.start)return"delete";if(t.start!==t.end&&e.start!==t.start)return"delete-insert"},annotate:function(t,e,n,i){var r=[],s=this.inferTextOperationType(e,n,i);return pt(t).forEach(function(o){var a,l;switch(s){case"insert":o.start<e.start&&e.start<=o.end?o.end+=i:o.start>=e.start&&(o.start+=i,o.end+=i);break;case"delete-single":o.start<e.start&&e.start<=o.end&&e.start!==n.start||o.start<=e.start&&e.start<o.end&&e.start===n.start?o.end+=i:o.start>=e.start&&(o.start+=i,o.end+=i);break;case"delete":o.start<=e.start&&e.start<=o.end?e.end<=o.end?o.end+=i:o.end+=n.start-o.end:o.start>=e.start&&o.start<e.end?(a=o.end-o.start,l=e.end-o.start,o.start=e.start,o.end=o.start+a-l):o.start>=e.end&&(o.start+=i,o.end+=i);break;case"delete-insert":if(o.start<=e.start&&e.start<=o.end)e.start<o.end&&(e.end>o.end?o.end=n.end:o.end=n.end+(o.end-e.end));else if(o.start>=e.start&&o.start<=e.end){var c=n.start-e.start;l=e.end-o.start,a=o.end-o.start,o.start=e.start+c,o.end=o.start+a-l}else o.start>=e.start&&o.end<=e.end?o.start=o.end=0:o.start>=e.end&&(o.start+=i,o.end+=i);break;default:this.options.debug&&console.log("ui.TextEditor: Unknown text operation.");break}o.end>o.start&&r.push(o)},this),r},shiftAnnotations:function(t,e,n){return L.shiftAnnotations(t,e,n)},setCurrentAnnotation:function(t){this._currentAnnotationAttributes=t},setAnnotations:function(t){this._annotations=t},getAnnotations:function(){return this._annotations},getCombinedAnnotationAttrsAtIndex:function(t,e){return wo(pt(e),t)},getSelectionAttrs:function(t,e){const{start:n,end:i=n}=t;return n===i?wo(e,n-1):cf(e,n,i)},getTextContent:function(){var t=this.options.text,e=L(t).find(".v-line");return e.length===0?t.textContent:e.reduce(function(n,i,r,s){var o=i.node.textContent;return i.hasClass("v-empty-line")&&(o=""),r===s.length-1?n+o:n+o+`
`},"")},startSelecting:function(){this.selecting=!0},stopSelecting:function(){this.selecting=!1},selectionInProgress:function(){return this.selecting===!0},selectAll:function(){return this.select(0,this.getNumberOfChars())},select:function(t,e){const{options:n,selection:i}=this;n.debug&&console.log("select(",t,e,")");const r=i.start,s=i.end;e===void 0&&(e=t),Nt(t)&&(i.start=t),Nt(e)&&(i.end=e),Nt(i.end)||(i.end=i.start);const{start:o,end:a}=i;if(Nt(o)&&Nt(a)){if((r!==o||s!==a)&&this.setCurrentAnnotation(null),o===a)this.clearSelection(),this.focus(),this.setCaret(o);else{this.hideCaret(),this.setTextAreaSelection(o,a);const c=this.textarea.value;o>a&&this.constructor.isLineEnding(c,a)?this.constructor.isLineStart(c,o)&&a!==o-1?this.renderSelection(a,o-2):this.renderSelection(a,o-1):this.renderSelection(o,a)}this.trigger("select:change",o,a)}return this},setTextAreaSelection:function(t,e){var n={start:t,end:e};n=this.normalizeSelectionRange(n),this.textarea.focus(),this.textarea.selectionStart=n.start,this.textarea.selectionEnd=n.end},renderSelection:function(t,e){this.options.debug&&console.log("renderSelection()");var n={start:t,end:e};if(n=this.normalizeSelectionRange(n),this.clearSelection(),this.options.useNativeSelection){this.$viewport&&(this._viewportUserSelectBefore=this.$viewport.css("user-select"),this.$viewport.css({"-webkit-user-select":"all","-moz-user-select":"all","user-select":"all"}));var i=n.end-n.start;this.selectTextInElement(this.options.text,n.start,i)}else this.renderSelectionBoxes(n.start,n.end)},normalizeSelectionStartAndLength:function(t,e,n){var i=t.substr(0,e),r=t.substr(e,n),s=this.countLineBreaks(i),o=this.countLineBreaks(r);e-=s,n-=o;var a=this.countEmptyLines(i),l=this.countEmptyLines(r);return e+=a,n+=a,n-=a,n+=l,{start:e,length:n}},selectTextInElement:function(t,e,n){if(_t(t.selectSubString)&&this.selectTextInElementUsingSelectSubString(t,e,n),!this.actualSelectionMatchesExpectedSelection(e,n))try{this.selectTextInElementUsingRanges(t,e,n)}catch(i){this.options.debug&&console.log(i),_t(t.selectSubString)&&this.selectTextInElementUsingSelectSubString(t,e,n)}},selectTextInElementUsingSelectSubString:function(t,e,n){var i=this.normalizeSelectionStartAndLength(this.getTextContent(),e,n);try{t.selectSubString(i.start,i.length)}catch(r){this.options.debug&&console.log(r)}},selectTextInElementUsingRanges:function(t,e,n){var i=window.getSelection();i.removeAllRanges();var r=this.normalizeSelectionStartAndLength(this.getTextContent(),e,n);e=0+r.start,n=0+r.length;for(var s=this.getTextNodesFromDomElement(t),o,a,l,c,h,u=0,d=e+n,f=document.createRange();n>0&&s.length>0;)o=s.shift(),a=u,l=u+o.length,(a>=e&&a<d||l>e&&l<=d||e>=a&&e<l||d>a&&d<=l)&&(c=Math.max(e-a,0),h=Math.min(c+Math.min(n,o.length),l),f.collapsed&&f.setStart(o,c),f.setEnd(o,h),n-=h-c),u+=o.length;f.collapsed||i.addRange(f)},actualSelectionMatchesExpectedSelection:function(t,e){var n=window.getSelection(),i=n.toString(),r=this.getExpectedSelectedContent(t,e);return i=i.replace(/\s/g," "),r===i},getExpectedSelectedContent:function(t,e){var n=this.getTextContent(),i=n.substr(t,e);return i.search(/(\n\r|\r|\n)/)===0&&(i="-"+i),i=i.replace(/(\n\r|\r|\n){2,}/g,r=>Array.from({length:r.length-1},()=>"-").join("")),i=i.replace(/\n\r|\r|\n/g,""),i=i.replace(/\s/g," "),i},getTextNodesFromDomElement:function(t){for(var e=[],n=0,i=t.childNodes.length;n<i;n++){var r=t.childNodes[n];r.tagName!==void 0?e=e.concat(this.getTextNodesFromDomElement(r)):e.push(r)}return e},renderSelectionBoxes:function(t,e){this.options.debug&&console.log("renderSelectionBoxes()"),this.$selection.empty();for(var n=this.getFontSize(),i=this.getTextTransforms(),r=i.rotation,s,o,a,l=t;l<e;l++){var c=this.$selectionBox.clone();try{a=this.getCharBBox(l)}catch{this.trigger("select:out-of-range",t,e);break}if(o&&r===0&&Math.round(a.y)===Math.round(o.y)&&Math.round(a.height)===Math.round(o.height)&&Math.round(a.x)===Math.round(o.x+o.width)){const h=parseInt(s.css("width"),10);s.css("width",h+a.width)}else c.css({left:a.x,top:a.y-a.height,width:a.width,height:a.height,"-webkit-transform":"rotate("+r+"deg)","-webkit-transform-origin":"0% 100%","-moz-transform":"rotate("+r+"deg)","-moz-transform-origin":"0% 100%"}),this.$selection.append(c),s=c;o=a}a&&this.$textareaContainer.css({left:a.x,top:a.y-n*i.scaleY})},clearSelection:function(){return this.options.debug&&console.log("clearSelection()"),this.$selection.empty(),this.options.text.selectSubString&&(this.$viewport&&this._viewportUserSelectBefore&&this.$viewport.css({"-webkit-user-select":this._viewportUserSelectBefore,"-moz-user-select":this._viewportUserSelectBefore,"user-select":this._viewportUserSelectBefore}),window.getSelection().removeAllRanges()),this},deselect:function(){return this.options.debug&&console.log("deselect()"),this.stopSelecting(),this.clearSelection(),this.setTextAreaSelection(this.selection.start,this.selection.end),this},getSelectionStart:function(){return this.selection.start},getSelectionEnd:function(){return this.selection.end},getSelectionRange:function(){return this.normalizeSelectionRange(this.selection)},normalizeSelectionRange:function(t){return t=we(t),t.start>t.end&&(t.end=[t.start,t.start=t.end][0]),t},getSelectionLength:function(){var t=this.getSelectionRange();return t.end-t.start},getSelection:function(){var t=this.getSelectionRange();return this.getTextContent().slice(t.start,t.end)},getWordBoundary:function(t){for(var e=this.textarea.value,n=/\W/,i=t;i;){if(n.test(e[i])){i+=1;break}i-=1}for(var r=this.getNumberOfChars(),s=t;s<r&&!n.test(e[s]);)s+=1;return i<s?[i,s]:[s,i]},getURLBoundary:function(t){for(var e=this.textarea.value,n=/\s/,i=/[-a-zA-Z0-9@:%_+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&//=]*)?/,r=t;r>-1;){if(n.test(e[r])){r+=1;break}r-=1}r=Math.max(r,0);for(var s=this.getNumberOfChars(),o=Math.max(r,t);o<=s&&!n.test(e[o]);)o+=1;if(o=Math.min(o,s),i.test(e.substring(r,o)))return[r,o]},annotateURL:function(t,e,n){const i=this.textarea.value.substring(e,n);if(t.some(o=>o.url===i&&o.start===e&&o.end===n))return t;let r;const{urlAnnotation:s}=this.options;if(typeof s=="function"){if(r=s(i),!r)return t}else r=H({},s);return H(r,{url:i,start:e,end:n}),t.push(r),t},getCharBBox:function(t){if(this.isLineEnding(t)){var e=this.getCharBBox(t-1);return e.x=e.x2,e.y=e.y2,e.width=this.options.newlineCharacterBBoxWidth||10,e}var n=this.realToSvgCharNum(t),i=this.options.text,r=i.getStartPositionOfChar(n),s=i.getEndPositionOfChar(n),o=i.getExtentOfChar(n);r=this.localToScreenCoordinates(r),s=this.localToScreenCoordinates(s);var a=this.getTextTransforms(),l=r.x,c=r.y,h=o.width*a.scaleX,u=o.height*a.scaleY;return{x:l,y:c,width:h,height:u,x2:s.x,y2:s.y}},realToSvgCharNum:function(t){for(var e=0,n=0;n<=t;n++)this.isLineEnding(n)&&(e+=1);return t-e},selectionStartToSvgCharNum:function(t){return t-this.nonEmptyLinesBefore(t)},svgToRealCharNum:function(t){for(var e=0,n=0;n<=t+e;n++)this.isLineEnding(n)&&(e+=1);return t+e},localToScreenCoordinates:function(t){return L.transformPoint(t,this.options.text.getCTM())},getNumberOfChars:function(){return this.getTextContent().length},getCharNumFromEvent:function(t){const e=this.options.text,n=L(e).toLocalPoint(t.clientX,t.clientY);return this.getCharNumAtPosition(n)},getCharNumAtPosition:function(t){var e=this.options.text,n=e.getCharNumAtPosition(t);if(n<0){var i=L(e).getBBox();i.inflate(-1);var r=i.containsPoint(t);if(!r&&this.hasSelection()&&i.clone().inflate(this.options.selectAllThreshold).containsPoint(t))return this.selection.end;var s=r?t:i.pointNearestToPoint(t),o=L.createSVGPoint(s.x,s.y),a=e.getCharNumAtPosition(o),l=t.x>i.x;if(a===-1){var c=i.x,h=i.x+i.width,u,d=(c+h)/2;do{o.x=d;var f=e.getCharNumAtPosition(o);f>-1&&(a=f),u=d,l&&f>-1||!l&&f===-1?(d=(d+h)/2,c=u):(d=(c+d)/2,h=u)}while(Math.abs(u-d)>1)}if(a>-1){const v=this.svgToRealCharNum(a);return!l||this.getTextContent()[v]===`
`?v:v+1}return t.x<i.x&&t.y<i.y+i.height?0:this.getNumberOfChars()}var p=this.localToScreenCoordinates(t),g=this.getCharBBox(this.svgToRealCharNum(n));return Math.abs(g.x-p.x)<Math.abs(g.x+g.width-p.x)?this.svgToRealCharNum(n):this.svgToRealCharNum(n)+1},lineNumber:function(t){var e=this.textarea.value.substr(0,t);return this.countLineBreaks(e)},emptyLinesBefore:function(t){for(var e=this.textarea.value.split(/\n\r|\r|\n/g),n=this.lineNumber(t),i=0,r=n-1;r>=0;r--)e[r]||(i+=1);return i},countLineBreaks:function(t){return(t.match(/\n\r|\r|\n/g)||[]).length},countEmptyLines:function(t){let e=(t.match(/(\n\r|\r|\n){2,}/g)||[]).reduce((n,i)=>n+(i.length-1),0);return t.search(/(\n\r|\r|\n)/)===0&&e++,e},nonEmptyLinesBefore:function(t){return this.lineNumber(t)-this.emptyLinesBefore(t)},isEmptyLine:function(t){var e=this.textarea.value.split(/\n\r|\r|\n/g);return!e[t]},isEmptyLineUnderSelection:function(t){var e=this.lineNumber(t);return this.isEmptyLine(e)},isLineEnding:function(t){return this.constructor.isLineEnding(this.textarea.value,t)},getTextTransforms:function(){var t=this.options.text.getCTM();return L.decomposeMatrix(t)},getFontSize:function(){const{DEFAULT_FONT_SIZE:t,options:e}=this,n=parseFloat(e.text.getAttribute("font-size"));return Number.isNaN(n)?t:n},getFontFill:function(){const{options:t}=this;return t.text.getAttribute("fill")||""},getTextAnchor:function(){const{options:t}=this;return t.text.getAttribute("text-anchor")||""},getCaretAttrs(t){const e=this.getAnnotations()||[],n=this._currentAnnotationAttributes;if(e.length===0&&!n)return{"font-size":this.getFontSize(),fill:this.getFontFill()};const i=[...e,{attrs:n}],r=wo(i,t-1),s=parseFloat(r["font-size"]),o=r.fill;return{"font-size":Number.isNaN(s)?this.getFontSize():s,fill:o||this.getFontFill()}},setCaret:function(t,e){Vt(t)&&(e=t,t=void 0),e=e||{};var n=this.getNumberOfChars(),i=this.selection.start;return typeof t<"u"&&(t=Math.min(Math.max(t,0),n),i=this.selection.start=this.selection.end=t),e.silent||this.trigger("caret:change",i),this.options.debug&&console.log("setCaret(",t,e,")","selectionStart",i,"isLineEnding",this.isLineEnding(i),"isEmptyLineUnderSelection",this.isEmptyLineUnderSelection(i),"svgCharNum",this.selectionStartToSvgCharNum(i),"nonEmptyLinesBefore",this.nonEmptyLinesBefore(i)),this.updateCaret(),this.setTextAreaSelection(i,i),this.focus(),this},updateCaret:function(){const{$caret:t,$textareaContainer:e,selection:n,options:i,textarea:r}=this,s=n.start,{text:o,placeholder:a}=i,l=this.getNumberOfChars();let c;try{let x;!this.isEmptyLineUnderSelection(s)&&(this.isLineEnding(s)||r.value.length===s)?(x=this.selectionStartToSvgCharNum(s)-1,c=o.getEndPositionOfChar(x)):(x=this.selectionStartToSvgCharNum(s),c=o.getStartPositionOfChar(x))}catch{this.trigger("caret:out-of-range",s),c={x:0,y:0}}var{x:h,y:u}=this.localToScreenCoordinates(c);const{rotation:d,scaleY:f}=this.getTextTransforms(),p=this.getCaretAttrs(s),g=p["font-size"]*f,v=p.fill;if(a){const x=typeof a=="string"?a:"Enter text...";t.data("placeholderText",x),t.toggleClass("placeholder",l===0)}t.css({left:h,top:u-g,height:g,"line-height":`${g}px`,"font-size":`${g}px`,"-webkit-transform":`rotate(${d}deg)`,"-webkit-transform-origin":"0% 100%","-moz-transform":`rotate(${d}deg)`,"-moz-transform-origin":"0% 100%","background-color":v}).attr({"text-anchor":this.getTextAnchor()}),t.css("display",""),e.css({left:h,top:u-g})},focus:function(){return this.options.debug&&console.log("focus()"),this.showCaret(),this},blur:function(){return this.options.debug&&console.log("blur()"),this.hideCaret(),this},showCaret:function(){return this.options.debug&&console.log("showCaret()"),this.$caret.css("display",""),this},hideCaret:function(){return this.options.debug&&console.log("hideCaret()"),this.$caret.css("display","none"),this},onRemove:function(){const{text:t,cellView:e=null}=this.options;this.deselect(),this.unbindTextElement(),document.removeEventListener("pointerdown",this.onDocumentPointerdown,{capture:!0}),Dn(document.body).off("mousemove",this.onMousemove),Dn(document.body).off("mouseup",this.onMouseup),Dn(document.body).off("keydown",this.onKeydown),L(t).attr("cursor",this._textCursor),this.trigger("close",t,e)},onDocumentPointerdown:function(t){const{text:e,onOutsidePointerdown:n}=this.options,{target:i}=t;e!==i&&(e.contains(i)||typeof n=="function"&&n.call(this,t,this))},onKeydown:function(t){this.options.debug&&console.log("onKeydown(): ",t.keyCode);const e=this.options.onKeydown;typeof e=="function"&&(e.call(this,t,this),t.isPropagationStopped())||this.isModifierKey(t)||(this.hasSelection()&&(this.deselect(),this.restoreTextAreaSelectionDirection()),setTimeout(this.onAfterKeydown,this.AFTER_KEYDOWN_DELAY),this._copied=!1,this._selectionStartBeforeInput=this.textarea.selectionStart,this._selectionEndBeforeInput=this.textarea.selectionEnd)},onAfterKeydown:function(){this.textarea===document.activeElement&&(this.storeSelectionDirection(),this.setCurrentAnnotation(null),this.updateSelectionFromTextarea())},onKeyup:function(t){if(this.textContentHasChanged()&&this.onInput(t),this.textSelectionHasChanged()&&!this.isArrowKey(t)){const{selectionEnd:e,selectionStart:n}=this.textarea;e!==n&&this.updateSelectionFromTextarea()}},onCopy:function(t){this._copied||this.copyToClipboard()},onCut:function(t){this._copied||this.copyToClipboard()},onInput:function(t){if(this.textContentHasChanged()){var e=this.textarea.value.length-this._textareaValueBeforeInput.length,n={start:this._selectionStartBeforeInput,end:this._selectionEndBeforeInput},i={start:this.textarea.selectionStart,end:this.textarea.selectionEnd};this.selection.start=this.textarea.selectionStart,this.selection.end=this.textarea.selectionEnd,this.options.debug&&console.log("onInput()",t,"selectionBeforeInput",n,"selectionAfterInput",i,"diffLength",e);var r=this.inferTextOperationType(n,i,e),s=!1,o=this.getAnnotations();if(this.options.annotateUrls&&r==="insert"){var a=this.textarea.value.substr(n.start,e);this.options.debug&&console.log("onInput()","inserted text",a),/\s/.test(a)&&(s=this.annotateURLBeforeCaret(n.start),s&&(o=this.shiftAnnotations(o,i.end,e)))}if(o&&(s||(o=this.annotate(o,n,i,e)),this.options.debug&&console.log("onInput()","modified annotations",o),this._currentAnnotationAttributes&&r==="insert")){var l={start:n.start,end:i.end,attrs:this._currentAnnotationAttributes};o.push(l),this.setCurrentAnnotation(null),this.options.debug&&console.log("onInput()","insert annotation",l,"final annotations",o)}this._annotations=o,this.trigger("text:change",this.textarea.value,this._textareaValueBeforeInput,o,n,i),this._selectionBeforeInput=i,this._textareaValueBeforeInput=this.textarea.value,this._textContent=this.textarea.value}},onPaste:function(t){this.options.debug&&console.log("onPaste()"),this._textareaValueBeforeInput=this.textarea.value,setTimeout(this.onAfterPaste,0)},onAfterPaste:function(){this.setCaret(this.textarea.selectionStart)},onMousedown:function(t){if(t.originalEvent.detail!==3){this.options.debug&&console.log("onMousedown()");var e=this.getCharNumFromEvent(t);this.startSelecting(),this.select(e),t.preventDefault(),t.stopPropagation()}},onMousemove:function(t){if(this.selectionInProgress()){this.options.debug&&console.log("onMousemove()");let e=this.getCharNumFromEvent(t);this.storeSelectionDirection(),this.select(null,e),t.preventDefault(),t.stopPropagation()}},onMouseup:function(t){this.selectionInProgress()&&(this.options.debug&&console.log("onMouseup()"),this.stopSelecting(),this.trigger("select:changed",this.selection.start,this.selection.end))},onDoubleClick:function(t){this.options.debug&&console.log("onDoubleClick()");var e=this.getCharNumFromEvent(t),n=this.getWordBoundary(e);this.select(n[0],n[1]),t.preventDefault(),t.stopPropagation()},onTripleClick:function(t){t.originalEvent.detail===3&&(this.options.debug&&console.log("onTripleClick()"),this.hideCaret(),this.selectAll(),t.preventDefault(),t.stopPropagation())}},H({getTextElement:function(t){var e=t.tagName.toUpperCase();if(e==="TEXT"||e==="TSPAN"||e==="TEXTPATH")return e==="TEXT"?t:this.getTextElement(t.parentNode)},edit:function(t,e){e=e||{};var n=e.update!==!1;this.options=H({},e,{update:n});var i=this.getTextElement(t);if(!i){this.options.debug&&console.log("ui.TextEditor: cannot find a text element.");return}this.close(),this.ed=new ca(H({text:i},e)),this.ed.on("all",this.trigger,this);const{cellView:r=null}=e;this.trigger("open",i,r);var s;if(r){if(s=r.paper.el,this.cellViewUnderEdit=r,this.cellViewUnderEditInteractiveOption=this.cellViewUnderEdit.options.interactive,this.cellViewUnderEdit.options.interactive=!1,e.annotationsProperty&&!this.ed.getAnnotations()){var o=this.cellViewUnderEdit.model.prop(e.annotationsProperty);o&&this.ed.setAnnotations(ud(o))}}else{var a=L(i).svg();s=a.parentNode}return n&&this.ed.on("text:change",(l,c,h)=>{r?this.updateCellView(r,l,h):this.updateSVGTextNode(i,l,h)}),this.ed.render(s),this},updateCellView:function(t,e,n){const{textProperty:i,annotationsProperty:r}=this.options,{cid:s}=this.ed,{model:o}=t;i&&o.prop(i,e,{textEditor:s,async:!1}),r&&o.prop(r,ud(n),{rewrite:!0,textEditor:s,async:!1})},updateSVGTextNode:function(t,e,n){L(t).text(e,{annotations:n})},close:function(){if(this.ed){if(this.ed.options.annotateUrls){var t=this.ed.getSelectionStart(),e=this.findAnnotationsUnderCursor(),n=e.find(function(r){return r.url?r:!1});if(!n){var i=this.ed.annotateURLBeforeCaret(t);i&&this.applyAnnotations(this.getAnnotations())}}this.ed.remove(),this.cellViewUnderEdit&&(this.cellViewUnderEdit.options.interactive=this.cellViewUnderEditInteractiveOption),this.ed=this.cellViewUnderEdit=this.cellViewUnderEditInteractiveOption=void 0}},applyAnnotations:function(t){var e=this.options,n=this.ed;if(n&&e.update){e.cellView&&e.annotationsProperty?(e.cellView.model.prop(e.annotationsProperty,ud(t),{rewrite:!0,textEditor:n.cid}),n.setAnnotations(t)):L(n.options.text).text(n.getTextContent(),{annotations:t});var i=this.getSelectionRange(),r=this.getSelectionLength();r>0?n.select(i.start,i.end):n.setCaret()}},proxy:function(t,e){const{ed:n}=this;if(n)return n[t].apply(n,e)},isEmptyLine:function(t,e){const n=t[e-1],i=t[e];return e===0&&i===`
`||i===`
`&&n===`
`||e===t.length&&n===`
`},isLineEnding:function(t,e){return t[e]===`
`&&e>0&&t[e-1]!==`
`},isLineStart:function(t,e){return t[e]===`
`?!1:e===0||t[e-1]===`
`},getCombinedAnnotationAttrsAtIndex:wo,getCombinedAnnotationAttrsBetweenIndexes:cf,normalizeAnnotations:t6},rn));ca.findAnnotationsUnderCursor=function(){const{ed:t}=this;return t?this.proxy("findAnnotationsUnderCursor",[t.getAnnotations(),t.getSelectionStart()]):null};ca.findAnnotationsInSelection=function(){const{ed:t}=this;if(!t)return null;const{start:e,end:n}=t.getSelectionRange();return this.proxy("findAnnotationsInSelection",[t.getAnnotations(),e,n])};ca.getSelectionAttrs=function(t){const{ed:e}=this;return e?this.proxy("getSelectionAttrs",[e.getSelectionRange(),t]):null};["setCurrentAnnotation","getAnnotations","setCaret","deselect","selectAll","select","getNumberOfChars","getCharNumFromEvent","getWordBoundary","getSelectionLength","getSelectionRange"].forEach(t=>{ca[t]=function(){return this.proxy(t,arguments)}});function ud(t){try{return JSON.parse(JSON.stringify(t))}catch{return}}const Jn=ce.extend({className:"widget",references:[],constructor:function(t,e){this.availableReferences=e||{},ce.prototype.constructor.call(this,t)},updateAttrs:function(t){Ns(this.$el,t)},bindEvents:function(){},validateReferences:function(){var t=this.references||[],e=[];return t.forEach(function(n){this.availableReferences[n]===void 0&&e.push(n)},this),e},getReference:function(t){return this.availableReferences[t]},getReferences:function(){return this.availableReferences},enable:function(){},disable:function(){},isDisabled:function(){return!1}},{create:function(t,e,n={}){var i=Rl(ne(t)?t:t.type);if(!_t(n[i]))throw new Error('Widget: unable to find widget: "'+i+'"');var r=new n[i](t,e),s=r.validateReferences(e);if(s.length>0)throw new Error('Widget: "'+i+'" missing dependency: '+s.join(", "));return r.render(),r.updateAttrs(t.attrs),r.bindEvents(),r.el.dataset.type=i,t.name&&(r.el.dataset.name=t.name),r}}),cn=q,e6=Jn.extend({tagName:"label",events:{"input .input":"onInput","change .input":"onChange",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){hn(this,"pointerup")},render:function(){var t=this.options,e=cn("<span/>").text(t.label||"");return this.$input=cn("<input/>").addClass("input").attr("type","checkbox").prop("checked",!!t.value),this.$span=cn("<span/>"),this.$el.append([e,this.$input,this.$span]),this},onChange:function(t){this.trigger("change",!!t.target.checked,t)},onInput:function(t){this.trigger("input",!!t.target.checked,t)},pointerdown:function(t){t=at(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerclick:function(t){t=at(t),this.trigger("pointerclick",t)},pointerup:function(t){t=at(t),this.undelegateDocumentEvents(),this.trigger("pointerup",t),this.$el.removeClass("is-in-action"),t.type==="touchend"&&(this.$input[0].click(),t.preventDefault())},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$el.removeClass("disabled"),this.$input.prop("disabled",!1)},disable:function(){this.$el.addClass("disabled"),this.$input.prop("disabled",!0)}}),n6=Jn.extend({tagName:"label",events:{"input input.toggle":"onInput","change input.toggle":"onChange","click input.toggle":"pointerclick",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){hn(this,"pointerup")},render:function(){var t=this.options,e=cn("<span/>").text(t.label||""),n=cn("<span><i/></span>");this.$input=cn("<input/>").addClass("toggle").attr("type","checkbox").prop("checked",!!t.value);var i=cn("<div/>").addClass(t.type);return this.$el.append([e,i.append(this.$input,n)]),this},onInput:function(t){this.trigger("input",!!t.target.checked,t)},onChange:function(t){this.trigger("change",!!t.target.checked,t)},pointerclick:function(t){t=at(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=at(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerup:function(t){t=at(t),this.undelegateDocumentEvents(),this.$el.removeClass("is-in-action"),this.trigger("pointerup",t),t.type==="touchend"&&(this.$input[0].click(),t.preventDefault())},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$el.removeClass("disabled"),this.$input.prop("disabled",!1)},disable:function(){this.$el.addClass("disabled"),this.$input.prop("disabled",!0)}}),i6=Jn.extend({render:function(){return this.options.width&&this.$el.css({width:this.options.width}),this}}),r6=Jn.extend({tagName:"label",render:function(){return this.$el.text(this.options.text),this}}),lS=Jn.extend({events:{"change .input":"onChange","input .input":"onChange"},render:function(){var t=this.options,e;return this.$output=cn("<output/>").text(t.value),e=cn("<span/>").addClass("units").text(t.unit),this.$input=cn("<input/>").addClass("input").attr({type:"range",name:t.type,min:t.min,max:t.max,step:t.step}).val(t.value),this.$el.append([this.$input,this.$output,e]),this},onChange:function(t){var e=this.getValue();e!==this.currentValue&&(this.currentValue=e,this.$output.text(e),this.trigger("change",e,t))},getValue:function(){return parseInt(this.$input.val(),10)},setValue:function(t,e={}){this.$input.val(t),e.silent?(t=this.getValue(),this.currentValue=t,this.$output.text(t)):this.$input[0].dispatchEvent(new CustomEvent("change",{bubbles:!0}))},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$input.prop("disabled",!1)},disable:function(){this.$input.prop("disabled",!0)}}),s6=Jn.extend({render:function(){var t=Qe(this.options,"type","group","index");return this.selectBox=new ol(t),this.selectBox.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectBox.on("all",this.trigger,this)},isDisabled:function(){return this.selectBox.isDisabled()},enable:function(){this.selectBox.enable()},disable:function(){this.selectBox.disable()}}),qi=Jn.extend({events:{mousedown:"pointerdown",mouseup:"pointerup",touchend:"pointerup",touchstart:"pointerdown",click:"pointerclick"},tagName:"button",render:function(){var t=this.options;return this.$el.text(t.text),this},pointerclick:function(t){t=at(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=at(t),this.trigger("pointerdown",t)},pointerup:function(t){t=at(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.el.click(),t.preventDefault())},isDisabled:function(){return this.$el.prop("disabled")},enable:function(){this.$el.prop("disabled",!1)},disable:function(){this.$el.prop("disabled",!0)}}),o6=Jn.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout",input:"onInput",change:"onChange"},tagName:"div",render:function(){var t=this.options;return this.$label=cn("<label/>").text(t.label),this.$text=cn("<input/>").addClass("input").attr("type","text").val(t.value),this.$input=cn("<div/>").addClass("input-wrapper").append(this.$text),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=at(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=at(t),this.trigger("pointerdown",t),t.type==="touchstart"&&this.$text[0].focus()},pointerup:function(t){t=at(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.$text[0].click(),t.preventDefault())},pointerfocusin:function(t){t=at(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=at(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},onInput:function(t){this.trigger("input",t.target.value,t)},onChange:function(t){this.trigger("change",t.target.value,t)},isDisabled:function(){return this.$text.prop("disabled")},enable:function(){this.$text.prop("disabled",!1)},disable:function(){this.$text.prop("disabled",!0)}}),a6=Jn.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout",input:"onInput",change:"onChange"},tagName:"div",render:function(){var t=this.options;return this.$label=cn("<label/>").text(t.label),this.$number=cn("<input/>").addClass("number").attr({type:"number",max:t.max,min:t.min}).val(t.value),this.$input=cn("<div/>").addClass("input-wrapper").append(this.$number),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=at(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=at(t),this.trigger("pointerdown",t),t.type==="touchstart"&&this.$number[0].focus()},pointerup:function(t){t=at(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.$number[0].click(),t.preventDefault())},pointerfocusin:function(t){t=at(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=at(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},onInput:function(t){this.trigger("input",t.target.value,t)},onChange:function(t){this.trigger("change",t.target.value,t)},isDisabled:function(){return this.$number.prop("disabled")},enable:function(){this.$number.prop("disabled",!1)},disable:function(){this.$number.prop("disabled",!0)}}),l6=Jn.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout",input:"onInput",change:"onChange"},tagName:"div",render:function(){var t=this.options;return this.$label=cn("<label/>").text(t.label),this.$textarea=cn("<textarea/>").addClass("textarea").text(t.value),this.$input=cn("<div/>").addClass("input-wrapper").append(this.$textarea),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t.preventDefault(),t=at(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=at(t),this.trigger("pointerdown",t),t.type==="touchstart"&&this.$textarea[0].focus()},pointerup:function(t){t=at(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.$textarea[0].click(),t.preventDefault())},pointerfocusin:function(t){t=at(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=at(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},onInput:function(t){this.trigger("input",t.target.value,t)},onChange:function(t){this.trigger("change",t.target.value,t)},isDisabled:function(){return this.$textarea.prop("disabled")},enable:function(){this.$textarea.prop("disabled",!1)},disable:function(){this.$textarea.prop("disabled",!0)}}),c6=Jn.extend({render:function(){var t=Qe(this.options,"type","group","index");return this.selectButtonGroup=new cg(t),this.selectButtonGroup.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectButtonGroup.on("all",this.trigger,this)},isDisabled:function(){return this.selectButtonGroup.isDisabled()},enable:function(){this.selectButtonGroup.enable()},disable:function(){this.selectButtonGroup.disable()}}),u6=qi.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},bindEvents:function(){if(!this.options.autoToggle)return;const{paperScroller:t}=this.getReferences();this.updateAvailability(t),this.listenTo(t.options.paper,"scale",()=>this.updateAvailability(t))},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(e.step,{max:e.max,grid:e.step}),qi.prototype.pointerdown.call(this,t)},updateAvailability:function(t){t.zoom()<this.options.max?this.enable():this.disable()}}),h6=qi.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},bindEvents:function(){if(!this.options.autoToggle)return;const{paperScroller:t}=this.getReferences();this.updateAvailability(t),this.listenTo(t.options.paper,"scale",()=>this.updateAvailability(t))},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(-e.step,{min:e.min,grid:e.step}),qi.prototype.pointerdown.call(this,t)},updateAvailability:function(t){t.zoom()>this.options.min?this.enable():this.disable()}}),d6=qi.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2,useModelGeometry:!1,padding:20},pointerdown:function(t){const{options:e}=this;this.getReferences().paperScroller.zoomToFit({padding:e.padding,scaleGrid:e.step,minScale:e.min,maxScale:e.max,useModelGeometry:e.useModelGeometry}),qi.prototype.pointerdown.call(this,t)}}),f6=lS.extend({references:["paperScroller"],options:{min:20,max:500,step:20,value:100,unit:" %"},bindEvents:function(){const{paperScroller:t}=this.getReferences();this.on("change",function(e){t.zoom(e/100,{absolute:!0,grid:this.options.step/100})},this),this.listenTo(t.options.paper,"scale",e=>{this.setValue(Math.floor(e*100),{silent:!0})})}}),p6=qi.extend({references:["commandManager"],bindEvents:function(){if(!this.options.autoToggle)return;const{commandManager:t}=this.getReferences();this.updateAvailability(t),this.listenTo(t,"stack",()=>this.updateAvailability(t))},pointerclick:function(){this.getReferences().commandManager.undo()},updateAvailability:function(t){t.hasUndo()?this.enable():this.disable()}}),g6=qi.extend({references:["commandManager"],bindEvents:function(){if(!this.options.autoToggle)return;const{commandManager:t}=this.getReferences();this.updateAvailability(t),this.listenTo(t,"stack",()=>this.updateAvailability(t))},pointerclick:function(){this.getReferences().commandManager.redo()},updateAvailability:function(t){t.hasRedo()?this.enable():this.disable()}}),m6=qi.extend({onRender:function(){const[t]=cn(this.options.target);this.target=t,t&&(window.top.document===t||!window.top.document.contains(t))&&(this.el.style.display="none")},pointerclick:function(){Qw(this.target)}}),v6=Jn.extend({events:{"change .input ":"change","input .input ":"input"},render:function(){const t=this.options,e="#FFFFFF";return this.inputEl=document.createElement("input"),this.inputEl.classList.add("input"),this.inputEl.setAttribute("type","color"),t.value?this.setValue(t.value):this.inputEl.value=e,this.el.appendChild(this.inputEl),this},_validateHexCode:function(t){return/^#(?:[0-9a-fA-F]{6})$/.test(t)},change:function(t){t=at(t),this.trigger("change",t.target.value,t)},input:function(t){t=at(t),this.trigger("input",t.target.value,t)},disable:function(){this.el.classList.add("disabled"),this.inputEl.disabled=!0},enable:function(){this.el.classList.remove("disabled"),this.inputEl.disabled=!1},setValue:function(t,e={}){this._validateHexCode(t)&&(this.inputEl.value=t,e.silent||this.trigger("change"))}}),cS={checkbox:e6,toggle:n6,separator:i6,label:r6,range:lS,selectBox:s6,button:qi,inputText:o6,inputNumber:a6,textarea:l6,selectButtonGroup:c6,zoomIn:u6,zoomOut:h6,zoomToFit:d6,zoomSlider:f6,undo:p6,redo:g6,fullscreen:m6,colorPicker:v6},y6={Left:"left",Right:"right"},b6=ce.extend({options:{autoToggle:!1,widgetNamespace:null},align:["left","right"],className:"toolbar",defaultGroup:"default",widgets:[],groupViews:[],init:function(){this.tools=pt(this.options.tools),this.groups=this.options.groups||{}},getWidgetByName:function(t){return this.widgets.find(function(e){return e.options.name===t})},getWidgets:function(){return this.widgets},groupsWithItemsPairs:function(){var t={};this.tools.forEach(function(a){var l=a.group||this.defaultGroup;t[l]=t[l]||{items:[],group:{}},t[l].items.push(a),t[l].group=this.groups[l]||{}},this);for(var e=Object.keys(t),n=[],i=0,r=e.length;i<r;i++){var s=e[i];n.push([s,t[s]])}var o=tn(n,function(a){return a[1].group.index});return tn(o,function(a){return a[1].group.align||"left"})},render:function(){var t=this.groupsWithItemsPairs(),e=!1;return t.forEach(function(n){var i=n[0],r=n[1],s=this.renderGroup(i,r);!e&&r.group.align&&r.group.align==="right"&&(e=!0,s.addClass("group-first")),s.appendTo(this.el)},this),this},renderGroup:function(t,e){const{references:n,autoToggle:i,widgetNamespace:r}=this.options;var s=new x6({name:t,align:e.group.align,items:e.items,references:n,autoToggle:i,widgetNamespace:r});return this.groupViews.push(s),s.on("all",(function(){this.trigger.apply(this,arguments)}).bind(this)),s.render(),this.widgets=this.widgets.concat(s.widgets),s.$el},onRemove:function(){Ue(this.groupViews,"off"),Ue(this.groupViews,"remove")}},{Align:y6});var x6=ce.extend({className:"toolbar-group",init:function(){this.widgets=[]},onRender:function(){this.el.dataset.group=this.options.name,this.$el.addClass(this.options.align),this.renderItems()},renderItems:function(){pt(this.options.items).forEach(function(t){var e=this.createWidget(t);this.$el.append(e.$el)},this)},createWidget:function(t){const{references:e,autoToggle:n,widgetNamespace:i}=this.options,r=ne(t)?{autoToggle:n,type:t}:H({autoToggle:n},t);var s=Jn.create(r,e,i||cS);return t.name!==void 0&&s.on("all",(function(o){var a=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t.name+":"+o].concat(a))}).bind(this)),this.widgets.push(s),s},onRemove:function(){Ue(this.widgets,"off"),Ue(this.widgets,"remove")}});const lr=q,w6={Left:"left",Top:"top",Bottom:"bottom",Right:"right"},_6={Left:"left",Top:"top",Bottom:"bottom",Right:"right",Auto:"auto",Off:"off"},S6=ce.extend({className:"tooltip",options:{left:void 0,right:void 0,top:void 0,bottom:void 0,position:void 0,positionSelector:void 0,direction:"auto",minResizedWidth:100,padding:0,rootTarget:null,target:null,container:null,trigger:"hover",viewport:{selector:null,padding:0},dataAttributePrefix:"tooltip",template:'<div class="tooltip-arrow"></div><div class="tooltip-arrow-mask"></div><div class="tooltip-content"></div>',animation:!1},init:function(){this.eventNamespace=("."+this.className+this.cid).replace(/ /g,"_"),this.settings={};const{trigger:t,rootTarget:e,target:n,animation:i=!1,container:r}=this.options;let s;r&&(s=lr(r)[0]),r||(s=document.body),this.container=s;var o=t.split(" ");hn(this,"render","hide","show","toggle","isVisible","position"),e?(this.$rootTarget=lr(e),o.forEach(function(a){switch(a){case"click":this.$rootTarget.on("click"+this.eventNamespace,this.options.target,this.toggle);break;case"hover":this.$rootTarget.on("mouseover"+this.eventNamespace,this.options.target,this.render);break;case"focus":this.$rootTarget.on("focusin"+this.eventNamespace,this.options.target,this.render);break}},this)):(this.$target=lr(n),o.forEach(function(a){switch(a){case"click":this.$target.on("click"+this.eventNamespace,this.toggle);break;case"hover":this.$target.on("mouseover"+this.eventNamespace,this.render);break;case"focus":this.$target.on("focusin"+this.eventNamespace,this.render);break}},this)),i&&this.animate(i),this.$el.append(this.options.template)},animate:function({duration:t="500ms",delay:e="400ms",timingFunction:n="ease"}={}){this.$el.addClass("animated").css({animationDelay:e,animationDuration:t,animationTimingFunction:n})},onRemove:function(){this.options.rootTarget?this.$rootTarget.off(this.eventNamespace):this.$target.off(this.eventNamespace)},hide:function(){var t=this.settings;t&&(t.currentTarget&&this.unbindHideActions(t.currentTarget),this.$el.removeClass(t.className),this.$el.remove(),this.trigger("close"))},show:function(t){this.render(t||{target:this.options.target})},toggle:function(t){this.isVisible()?this.hide():this.show(t)},isVisible:function(){return document.body.contains(this.el)},render:function(t){let e=null;t.x!==void 0&&t.y!==void 0&&(e={x:t.x,y:t.y});let n=null;t.target&&([n]=lr(t.target).closest(this.options.target));const i=this.settings=this.getTooltipSettings(n);this.$(".tooltip-content").html(i.calculatedContent),n?(i.currentTarget=n,this.bindHideActions(n)):i.currentTarget=null;let r;e?r={x:e.x,y:e.y,width:1,height:1}:r=ws(n),this.el.style.display="none",this.$el.removeClass("left right top bottom"),this.$el.addClass(i.className),i.shouldRender&&lr(this.container).append(this.$el);let s=this.$("img");s.length?s.on("load",(function(){this.position(r),this.$el.addClass("rendered")}).bind(this)):(this.position(r),this.$el.addClass("rendered"))},unbindHideActions:function(t){var e=this.eventNamespace+".remove";lr(t).off(e),clearInterval(this.interval)},bindHideOnRemoveTarget:function(t){clearInterval(this.interval),this.interval=setInterval((function(){(document===t||!document.contains(t))&&(clearInterval(this.interval),this.hide())}).bind(this),500)},bindHideActions:function(t){var e=this.settings,n=lr(t),i=this.eventNamespace+".remove";this.bindHideOnRemoveTarget(t),this.options.trigger.split(" ").forEach(function(r){var s={hover:["mouseout","mousedown"],focus:["focusout"]},o=s[r]||[];e.hideTrigger&&(o=e.hideTrigger.split(" ")||[]),o.forEach(function(a){n.on(a+i,this.hide)},this)},this)},getTooltipSettings:function(t){const e=this.loadDefinitionFromElementData(t);return this.evaluateOptions(t,e)},evaluateOptions:function(t,e={}){const n=this.settings=H({},e,this.options);let i=!0,r=n.dataAttributeContent;return Jt(n,(s,o)=>{if(o==="content")if(_t(s)){const a=n.content.call(this,t,this);if(a==null)return;if(a===!1){i=!1;return}r=a}else r=s;else{const a=_t(s)?s(t):s;n[o]=a??e[o]}}),n.shouldRender=i,n.calculatedContent=r,this.normalizePosition(n),n},loadDefinitionFromElementData:function(t){if(!t)return{};var e=function(r){return r==="left"||r==="bottom"||r==="top"||r==="right"},n=this.getAllAttrs(t,"data-"+this.options.dataAttributePrefix),i={};return Jt(n,function(r,s){s===""&&(s="dataAttributeContent"),e(s)||(i[s]=r)}),i},getAllAttrs:function(t,e){for(var n=e||"",i=t.attributes,r={},s=0,o=i.length;s<o;s++){var a=i[s];if(a&&a.name.startsWith(n)){var l=Rl(a.name.slice(n.length));r[l]=a.value}}return r},normalizePosition:function(t){var e=t.left||t.right||t.top||t.bottom;!t.position&&e&&(t.left&&(t.position="left"),t.right&&(t.position="right"),t.top&&(t.position="top"),t.bottom&&(t.position="bottom")),!t.positionSelector&&e&&(t.positionSelector=e)},position:function(t){var e=this.settings;this.el.style.display="",this.$el.css("width","auto");var n=ws(this.container),i=this.getTooltipBBox(t,n);this.$el.css({left:i.x,top:i.y,width:i.width||"auto"});var r={};e.position==="left"||e.position==="right"?r.top=t.y+t.height/2-i.y:e.position==="top"||e.position==="bottom"?r.left=t.x+t.width/2-i.x:r.top=t.y+t.height/2-i.y,r.top-=n.y,r.left-=n.x,this.$(".tooltip-arrow, .tooltip-arrow-mask").attr("style",null).css(r),e.direction&&e.direction!=="off"&&this.$el.addClass(e.direction==="auto"?e.position||"left":e.direction)},getViewportViewBBox:function(){const{settings:t}=this,{selector:e,padding:n=0}=t.viewport;let i;e?[i]=lr(t.currentTarget).closest(e):i=document.documentElement;const r=ws(i);if(!e){const{clientWidth:s,clientHeight:o}=window.document.documentElement;r.width=s+window.scrollX,r.height=o+window.scrollY}return r.x+=n,r.y+=n,r.width-=2*n,r.height-=2*n,r},basePositions:{left:function(t,e){var n={x:e.positionedBBox.x+e.positionedBBox.width+e.padding,y:e.targetBBox.y+e.targetBBox.height/2-e.tooltipBBox.height/2};if(t){var i=e.viewport.x+e.viewport.width-n.x;if(i>e.minWidth&&i<e.tooltipBBox.width+e.padding&&(n.width=i),i<e.minWidth)return this.settings.position="right",this.basePositions.right(!1,e)}return n},right:function(t,e){var n={x:e.positionedBBox.x-e.tooltipBBox.width-e.padding,y:e.targetBBox.y+e.targetBBox.height/2-e.tooltipBBox.height/2};if(t){var i=e.positionedBBox.x-e.padding-e.viewport.x;if(i>e.minWidth&&i<e.tooltipBBox.width+e.padding&&(n.width=i,n.x=e.viewport.x),i<e.minWidth)return this.settings.position="left",this.basePositions.left(!1,e)}return n},top:function(t,e){var n={x:e.targetBBox.x+e.targetBBox.width/2-e.tooltipBBox.width/2,y:e.positionedBBox.y+e.positionedBBox.height+e.padding};if(t){var i=e.viewport.y+e.viewport.height-(e.positionedBBox.y+e.positionedBBox.height+e.padding);if(i<e.tooltipBBox.height)return this.settings.position="bottom",this.basePositions.bottom(!1,e)}return n},bottom:function(t,e){var n={x:e.targetBBox.x+e.targetBBox.width/2-e.tooltipBBox.width/2,y:e.positionedBBox.y-e.tooltipBBox.height-e.padding};if(t){var i=e.positionedBBox.y-e.padding-e.viewport.y;if(i<e.tooltipBBox.height)return this.settings.position="top",this.basePositions.top(!1,e)}return n}},getTooltipBBox:function(t,e){var n=this.settings,i=lr(n.positionSelector),r=i[0]?ws(i[0]):t,s=this.measureTooltipElement(),o=this.getViewportViewBBox(),a=n.position||"left",l=n.padding,c=Math.min(n.minResizedWidth,s.width+l),h={padding:l,targetBBox:t,positionedBBox:r,tooltipBBox:s,viewport:o,minWidth:c},u=this.basePositions[a].call(this,c>0,h);return u.x-=e.x,u.y-=e.y,u.y<o.y?u.y=o.y:u.y+s.height>o.y+o.height&&(u.y=o.y+o.height-s.height),u.x<o.x?u.x=o.x:u.x+s.width>o.x+o.width&&(u.x=o.x+o.width-s.width),u},measureTooltipElement:function(){var t=this.el.cloneNode(!0);t.style.visibility="hidden",t.style.left="-1000px",t.style.top="-500px",document.body.appendChild(t);var e={width:t.offsetWidth,height:t.offsetHeight};return document.body.removeChild(t),e}},{TooltipPosition:w6,TooltipArrowPosition:_6}),hd=q,E6=ce.extend({MINIMAL_PREVIEW_SIZE:10,className:"tree-layout",documentEvents:{mousemove:"onPointermove",touchmove:"onPointermove",mouseup:"onPointerup",touchend:"onPointerup"},options:{previewAttrs:{parent:{rx:2,ry:2}},useModelGeometry:!1,clone:function(t){return t.clone()},canInteract:function(){return!0},validateConnection:null,validatePosition:null,paperConstructor:Ai,paperOptions:null,reconnectElements:null,translateElements:null,layoutFunction:null},init:function(){this.startListening(),this.render(),this.onSetTheme(null,this.theme)},startListening:function(){this.enable()},_isEnabled:!1,_onPointerdown:null,enable:function(){const{paper:t}=this.options;this.disable();const e=this.canInteract(this.onPointerdown);this._isEnabled=!0,this.listenTo(t,"element:pointerdown",e),this._onPointerdown=e},disable:function(){const{_onPointerdown:t,options:e}=this,{paper:n}=e;this._isEnabled=!1,t&&(this.stopListening(n,"element:pointerdown",t),this._onPointerdown=null)},isDisabled:function(){return!this._isEnabled},render:function(){var t=this.options.paper;this.$activeBox=hd("<div>").addClass("tree-layout-box active hidden").appendTo(this.el);const e=this.options.paperOptions||{},n=e.model||new On({},{cellNamespace:t.model.get("cells").cellNamespace}),i=H({cellViewNamespace:t.options.cellViewNamespace},e,{interactive:!1,width:"100%",height:"100%",model:n});return this.draggingPaper=new this.options.paperConstructor(i),this.draggingPaper.undelegateEvents(),this.$translateBox=hd("<div>").addClass("tree-layout-box translate hidden").append(this.draggingPaper.render().el).appendTo(this.el),this.$mask=hd("<div>").addClass("tree-layout-mask"),this.svgViewport=L(t.cells),this.svgPreviewChild=L(this.renderChildPreview()).attr(this.options.previewAttrs.child||{}).addClass("tree-layout-preview child"),this.svgPreviewConnection=L(this.renderConnectionPreview()).attr(this.options.previewAttrs.link||{}).addClass("tree-layout-preview link"),this.svgPreviewParent=L(this.renderParentPreview()).attr(this.options.previewAttrs.parent||{}).addClass("tree-layout-preview parent"),this.svgPreview=L("g").addClass("tree-layout-preview-group").append([this.svgPreviewConnection,this.svgPreviewParent,this.svgPreviewChild]),this.$el.appendTo(t.el),this},renderChildPreview:function(){return L("circle")},renderParentPreview:function(){return L("rect")},renderConnectionPreview:function(){return L("path")},onSetTheme:function(t,e){var n=[this.svgPreview,this.$mask];n.forEach(function(i){i&&(t&&i.removeClass(this.themeClassNamePrefix+t),i.addClass(this.themeClassNamePrefix+e))},this)},onRemove:function(){this.svgPreview.remove(),this.$mask.remove()},toggleDropping:function(t){this.$mask.toggleClass("dropping-not-allowed",!t),this.$translateBox.toggleClass("no-drop",!t)},canDrop:function(){return this.isActive()&&!this.$translateBox.hasClass("no-drop")},isActive:function(){return!this.$translateBox.hasClass("hidden")},updateBox:function(t,e){t.css({width:e.width,height:e.height,left:e.x,top:e.y})},positionTranslateBox:function(t){var e=L.transformPoint(t,this.ctm);this.$translateBox.css({left:e.x,top:e.y})},prepareDraggingPaper:function(t){var e=this.options.clone(t).position(0,0);this.draggingPaper.scale(this.ctm.a,this.ctm.d),this.draggingPaper.model.resetCells([e])},dragstart:function(t,e,n){const{$translateBox:i,$activeBox:r,options:s}=this,{paper:o,useModelGeometry:a}=s;this.toggleDropping(!1),this.ctm=o.matrix();const[l]=t,c=l.findView(o);if(c){const h=c.getBBox({useModelGeometry:a});this.updateBox(i,me({x:e,y:n},h)),this.updateBox(r,h),r.removeClass("external")}else{const h=L.transformRect(l.getBBox(),this.ctm);this.updateBox(i,me({x:e,y:n},h)),r.addClass("external")}this.positionTranslateBox({x:e,y:n}),this.show(),this.prepareDraggingPaper(l)},drag:function(t,e,n){var i=this.model,r={x:e,y:n},s,o;if(this.candidate&&(this.candidate=null,this.hidePreview()),this.positionTranslateBox(r),s=i.getMinimalRootAreaByPoint(r),s&&(o=s.findMinimalAreaByPoint(r,{expandBy:Math.min(i.get("siblingGap"),i.get("gap"))/2})),o){var a=this.findDirection(o,r),l=o.getLayoutSiblings(a),c=l.getSiblingRankByPoint(r);pt(t).every(function(u){return this.isConnectionValid(u,l,c)},this)?(this.candidate={id:o.root.id,direction:a,siblingRank:c},this.updatePreview(l,c),this.showPreview(),this.toggleDropping(!0)):this.toggleDropping(!1)}else{let h=!0;const u=this.options.validatePosition;typeof u=="function"&&(h=pt(t).every(d=>u.call(this,d,e,n,this))),this.toggleDropping(h)}},dragend:function(t,e,n){var i=this.candidate,r=this.options;if(this.canDrop())if(i){var s=r.reconnectElements;typeof s=="function"?s.apply(this,[t,r.paper.getModelById(i.id),i.siblingRank,i.direction,this]):this.reconnectElements(t,i),this.candidate=null}else{var o=r.translateElements;typeof o=="function"?o.call(this,t,e,n,this):this.translateElements(t,e,n)}this.hide()},show:function(){const{$mask:t,$activeBox:e,$translateBox:n,options:i}=this,[r]=t;r&&!r.isConnected&&i.paper.el.appendChild(r),e.toggleClass("hidden",e.hasClass("external")),n.removeClass("hidden")},hide:function(){this.$mask.remove().removeClass("dropping-not-allowed"),this.$activeBox.addClass("hidden"),this.$translateBox.addClass("hidden"),this.hidePreview()},cancelDrag:function(){this.candidate=null,this.undelegateDocumentEvents(),this.hide()},reconnectElement:function(t,e){const{model:n,options:i}=this,{graph:r}=n;r.getCell(t)||(r.addCell(t),n.layoutTree(t));var s=e.siblingRank+.5,o={direction:e.direction,siblingRank:s,ui:!0,treeLayoutView:this.cid},a=n.reconnectElement(t,e.id,o);if(!a){var l=i.paper,c=l.getDefaultLink(t.findView(l));c.set({source:{id:e.id},target:{id:t.id}}),c.addTo(l.model,o),n.changeSiblingRank(t,s,o),n.changeDirection(t,e.direction,o);var h=n.getAttribute(t,"direction");n.updateDirections(t,[h,e.direction],o)}},reconnectElements:function(t,e){t.forEach(function(n){this.reconnectElement(n,e)},this),this.layout()},translateElement:function(t,e,n){const{model:i}=this,{graph:r}=i;var s=r.getConnectedLinks(t,{inbound:!0});Ue(s,"remove");var o=t.get("size");t.set("position",{x:e-o.width/2,y:n-o.height/2},{ui:!0,treeLayoutView:this.cid}),r.getCell(t)||r.addCell(t,{ui:!0,treeLayoutView:this.cid})},translateElements:function(t,e,n){t.forEach(function(i){this.translateElement(i,e,n)},this),this.layout()},layout:function(){_t(this.options.layoutFunction)?this.options.layoutFunction.call(this,this):this.model.layout({ui:!0,treeLayoutView:this.cid})},updatePreview:function(t,e){var n=t.parentArea.root,i=Math.max(this.model.get("siblingGap")/2,this.MINIMAL_PREVIEW_SIZE),r={width:i,height:i},s=t.getNeighborPointFromRank(e),o=t.getConnectionPoints(s,{ignoreSiblings:!0}),a=t.getParentConnectionPoint(),l=t.getChildConnectionPoint(s,r);this.updateParentPreview(n.position(),n.size(),n),this.updateChildPreview(s,r),this.updateConnectionPreview(a,l,o)},showPreview:function(){this.svgViewport.append(this.svgPreview)},hidePreview:function(){this.svgPreview.remove()},updateParentPreview:function(t,e){this.svgPreviewParent.attr({x:t.x,y:t.y,width:e.width,height:e.height})},updateChildPreview:function(t,e){this.svgPreviewChild.attr({cx:t.x,cy:t.y,r:e.width/2})},updateConnectionPreview:function(t,e,n){this.svgPreviewConnection.attr({d:v_(t,e,n,{})})},findDirection:function(t,e){var n,i=t.root.get("layout")||t.getType();switch(i){case"BL-BR":case"TL-TR":case"L-R":return n=i.split("-"),e.x>t.rootCX?n[1]:n[0];case"BL-TL":case"BR-TR":case"B-T":return n=i.split("-"),e.y>t.rootCY?n[0]:n[1];case"L":case"R":case"T":case"B":case"TR":case"TL":case"BR":case"BL":return i;default:return t.direction}},isConnectionValid:function(t,e,n){var i=e.parentArea.root;if(t.id==i.id||this.model.graph.isSuccessor(t,e.parentArea.root))return!1;var r=this.model.getLayoutArea(t);if(r&&r.parentArea&&r.parentArea==e.parentArea&&r.direction==e.direction){var s=r.siblingRank-n;if(s===0||s===1)return!1}var o=this.options.validateConnection;return typeof o=="function"?o.call(this,t,i,this,{siblingRank:n,direction:e.direction,level:e.parentArea.level+1,siblings:e.layoutAreas.map(a=>a.root)}):!0},canInteract:function(t){return(function(e,n){this.options.canInteract(e,n)&&t.apply(this,arguments)}).bind(this)},startDragging:function(t){var e=Array.isArray(t)?t:[t];En(e)||this.delegateDocumentEvents(null,{moveCounter:0,draggedElements:e})},onPointerdown:function(t,e){t.preventDefaultInteraction(e),this.startDragging(t.model)},onPointermove:function(t){const e=at(t);var n=e.data,i=this.options.paper,r=i.clientToLocalPoint({x:e.clientX,y:e.clientY});n.moveCounter===i.options.clickThreshold?this.dragstart(n.draggedElements,r.x,r.y):n.moveCounter>i.options.clickThreshold&&this.drag(n.draggedElements,r.x,r.y),n.moveCounter++},onPointerup:function(t){const e=at(t);var n=e.data,i=this.options.paper;if(n.moveCounter>=i.options.clickThreshold){var r=i.clientToLocalPoint({x:e.clientX,y:e.clientY});this.dragend(n.draggedElements,r.x,r.y)}this.undelegateDocumentEvents()}}),T6=q,hg=(t,e,n)=>{if(n=n||{},t===void 0)throw new Error("The the dia.Paper is a mandatory option.");t.trigger("beforeexport",n);const{svg:i}=t,r=n.fillFormControls!==!1;r&&Array.from(i.getElementsByTagName("select")).forEach(d=>L.ensureId(d));const s=L(i).clone();let o=s.node;const a=s.findOne("."+kn("layers")),l=n.area||t.getContentArea(),c=n.preserveDimensions;c&&s.attr({width:c.width||l.width,height:c.height||l.height}),s.removeAttr("style").attr("viewBox",[l.x,l.y,l.width,l.height].join(" ")),a.removeAttr("transform"),n.grid||s.findOne("."+kn("grid-layer")).remove(),n.useComputedStyles!==!1&&D6(t.svg,o);const h=n.stylesheet;ne(h)&&M6(s.node,h),t.trigger("afterexport",n);const u=d=>{r!==!1&&O6(o,t);const f=n.beforeSerialize;if(typeof f=="function"){const p=f.call(t,o,t);p instanceof SVGElement&&(o=p)}e(L6(o),d)};n.convertImagesToDataUris?C6(s.find("image,img")).then(()=>u()).catch(d=>{u(d)}):u()},A6=new RegExp(/^(data:)([\w\\+-]*)(;charset=[\w-]+|;base64){0,1},(.*)/gi);function C6(t){const e={};return t.forEach(n=>{let i=I6(n);i&&(i=i.trim(),!A6.test(i)&&(i in e?e[i].push(n):e[i]=[n]))}),Promise.all(Object.keys(e).map(n=>P6(n,e[n])))}function P6(t,e){return new Promise((n,i)=>{Zp(t,(r,s)=>{if(r||!s){i(r);return}e.forEach(o=>k6(o,s)),n()})})}function I6(t){switch(t.tagName()){case"IMAGE":return t.attr("xlink:href")||t.attr("href");case"IMG":default:return t.attr("src")}}function k6(t,e){switch(t.tagName()){case"IMAGE":{t.attr("xlink:href",e),t.attr("href")&&t.attr("href",null);break}case"IMG":default:{t.attr("src",e);break}}}function O6(t,e){Array.from(t.getElementsByTagName("input")).forEach(n=>{switch(n.type){case"checkbox":case"radio":n.checked?n.setAttribute("checked",!0):n.removeAttribute("checked");break;default:n.setAttribute("value",n.value);break}}),Array.from(t.getElementsByTagName("textarea")).forEach(n=>{n.textContent=n.value}),Array.from(t.getElementsByTagName("select")).forEach(n=>{const i=n.id;if(!i)return;const r=e.svg.getElementById(i);r&&Array.from(n.options).forEach((s,o)=>{r.options[o].selected?s.setAttribute("selected",!0):s.removeAttribute("selected")})})}function L6(t){return new XMLSerializer().serializeToString(t).replace(/&nbsp;/g,"")}function M6(t,e){const i=t.ownerDocument.implementation.createDocument(null,"xml",null);L(t).prepend(L("style",{type:"text/css"},[i.createCDATASection(e)]))}function D6(t,e){const n=Array.from(t.querySelectorAll("*")),i=Array.from(e.querySelectorAll("*")),r=t.ownerDocument,s=r.styleSheets.length,o=[];for(let c=s-1;c>=0;c--)o[c]=r.styleSheets[c],r.styleSheets[c].disabled=!0;const a={};n.forEach((c,h)=>{const u=window.getComputedStyle(c,null),d={};Jt(u,f=>{d[f]=u.getPropertyValue(f)}),a[h]=d}),s!=r.styleSheets.length&&o.forEach((c,h)=>{r.styleSheets[h]=c});for(let c=0;c<s;c++)r.styleSheets[c].disabled=!1;const l={};n.forEach((c,h)=>{const u=window.getComputedStyle(c,null),d=a[h],f={};Jt(u,p=>{isNaN(p)&&u.getPropertyValue(p)!==d[p]&&(f[p]=u.getPropertyValue(p))}),l[h]=f}),i.forEach((c,h)=>{T6(c).css(l[h])})}const N6=(t,e)=>{const n="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes",i=es("svg_output");hg(t,r=>{const s=window.open("",i,n),o="data:image/svg+xml,"+encodeURIComponent(r);s.document.write('<img src="'+o+'" style="max-height:100%" />')},H({convertImagesToDataUris:!0},e))},R6=Object.freeze(Object.defineProperty({__proto__:null,openAsSVG:N6,toSVG:hg},Symbol.toStringTag,{value:"Module"})),dh=(t,e,n={})=>{if(t===void 0)throw new Error("The dia.Paper is a mandatory argument.");const i=n.canvg||(typeof canvg<"u"?canvg:void 0),r=n.area||t.paperToLocalRect(t.getContentBBox()),s=z6(r,n),o=Nt(n.width)&&Nt(n.height)?n:s,a=H6(o,G6(n.size));if(!V6(a.width,a.height))throw new Error("dia.Paper: raster size exceeded.");const l=new Image;let c,h;l.onload=function(){let u,d,f;function p(){f=document.createElement("canvas"),f.width=a.width,f.height=a.height,d=f.getContext("2d"),d.fillStyle=n.backgroundColor||"white",d.fillRect(0,0,a.width,a.height)}function g(){const S=n.type,C=n.quality;if(S==="canvas"){if(x(d))throw new Error("Canvas Tainted");e(f,h)}else u=f.toDataURL(S,C),e(u,h);v()}function v(){f.svg&&_t(f.svg.stop)&&setTimeout(f.svg.stop,1)}function x(S){try{const C=S.getImageData(0,0,1,1);return!1}catch{return}}p();try{d.drawImage(l,0,0,a.width,a.height),g()}catch{if(typeof i>"u"){console.error("Canvas tainted. Canvg library required.");return}p();const C={ignoreDimensions:!0,ignoreClear:!0,ignoreMouse:!0,ignoreAnimation:!0,offsetX:0,offsetY:0,useCORS:!0};i(f,c,H(C,{forceRedraw:(function(){return this.called?!1:(this.called=!0,!0)}).bind({called:!1}),renderCallback:function(){try{g()}catch{v(),c=j6(c),p(),i(f,c,H(C,{renderCallback:g}))}}}))}},hg(t,(u,d)=>{c=u,h=d,l.src="data:image/svg+xml,"+encodeURIComponent(u)},{convertImagesToDataUris:!0,beforeSerialize:n.beforeSerialize,area:s,grid:n.grid,useComputedStyles:n.useComputedStyles,stylesheet:n.stylesheet,fillFormControls:n.fillFormControls,preserveDimensions:{width:a.width,height:a.height}})},uS=(t,e,n)=>{n=n||{},n.type="image/png",dh(t,e,n)},$6=(t,e,n)=>{n=n||{},n.type="image/jpeg",dh(t,e,n)},B6=(t,e,n)=>{n=n||{},n.type="canvas",dh(t,e,n)},F6=(t,e)=>{const n="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes",i=es("png_output");uS(t,function(r){window.open("",i,n).document.write('<img src="'+r+'"/>')},H({padding:10},e))};function V6(t,e){const n=document.createElement("canvas");n.width=t,n.height=e;const i=t-1,r=e-1,s=n.getContext("2d");try{s.fillStyle="rgb(1,1,1)",s.fillRect(i,r,1,1);const o=s.getImageData(i,r,1,1).data;if(o[0]!==1||o[1]!==1||o[2]!==1)return!1}catch{return!1}return!0}function z6(t,e){const n=U6(e),i=Z({x:-n.left,y:-n.top,width:n.left+n.right,height:n.top+n.bottom});if(e.width&&e.height){const r=t.width+n.left+n.right,s=t.height+n.top+n.bottom;i.scale(r/e.width,s/e.height)}return Z(t).moveAndExpand(i)}function G6(t){let e=1;if(t!==void 0&&(e=parseFloat(t),!Number.isFinite(e)||e===0))throw new Error("dia.Paper: invalid raster size ("+t+")");return e}function H6(t,e){return{width:Math.max(Math.round(t.width*e),1),height:Math.max(Math.round(t.height*e),1)}}function U6(t){const e=Re(t.padding);return t.width&&t.height&&(e.left+e.right>=t.width&&(e.left=e.right=0),e.top+e.bottom>=t.height&&(e.top=e.bottom=0)),e}function j6(t){return t.replace(/<image[^>]*>/g,function(e){const n=e.match(/href="([^"]*)"/),i=n&&n[1],r="data:image/svg+xml";if(i&&i.substr(0,r.length)===r){const s=atob(i.substr(i.indexOf(",")+1));return s.substr(s.indexOf("<svg"))}return e})}const W6=Object.freeze(Object.defineProperty({__proto__:null,openAsPNG:F6,toCanvas:B6,toDataURL:dh,toJPEG:$6,toPNG:uS},Symbol.toStringTag,{value:"Module"})),Y6=(t,e,n)=>{const r=new DOMParser().parseFromString(t,"text/xml");if(r.documentElement.nodeName=="parsererror")throw new Error("Error while parsing GEXF file.");const s=Array.from(r.documentElement.querySelectorAll("node")),o=Array.from(r.documentElement.querySelectorAll("edge")),a=[];return s.forEach(function(l){const c={id:l.getAttribute("id"),label:l.getAttribute("label")},h=l.querySelector("size");if(h){const g=parseFloat(h.getAttribute("value"));c.width=g,c.height=g}const u=l.querySelector("position");if(u){const g=parseFloat(u.getAttribute("x")),v=parseFloat(u.getAttribute("y")),x=parseFloat(u.getAttribute("z"));c.x=g,c.y=v,c.z=x}const d=l.querySelector("shape");if(d){const g=d.getAttribute("value");c.shape=g}const f=l.querySelector("color");if(f){const g=f.getAttribute("r"),v=f.getAttribute("g"),x=f.getAttribute("b"),S=f.getAttribute("a");S?c.color=`rgba(${g},${v},${x},${S})`:c.color=`rgb(${g},${v},${x})`}const p=e(c,l);a.push(p)}),o.forEach(function(l){const c={source:l.getAttribute("source"),target:l.getAttribute("target")},h=n(c,l);a.unshift(h)}),a},Es=q,X6=200,q6=200;function K6(t,e){var n=e8(e),i=J6(t,n),r=function(o){Z6(t,o,e)},s={sheetSizePx:hS(n)};n.ready(i,r,s)}var Zv=function(t,e,n){t.trigger("beforeprint",n);const i=document.createElement("div");i.className="printarea";const r=document.createElement("div");r.classList.add(kn("print-paper")),r.style.position="relative",n.size&&i.classList.add("printarea-size-"+n.size);var s=L(t.svg).clone(),o=s.findOne(`.${kn("layers")}`);n.grid||s.findOne("."+kn("grid-layer")).remove(),r.appendChild(s.node);var a=hS(n),l=t.getArea(),{sx:c,sy:h}=t.scale(),{tx:u,ty:d}=t.translate(),f=L.createSVGMatrix().translate(u/c,d/h),{scaleToFit:p,bBox:g}=t8(l,e,a);return r.style.left="0",r.style.top="0",s.attr({width:g.width*p,height:g.height*p,style:"position:relative",viewBox:[g.x,g.y,g.width,g.height].join(" ")}),o.attr("transform",L.matrixToTransformString(f)),r.appendChild(s.node),i.appendChild(r),i.classList.add("preview"),{el:i,sheetSizePx:a}},Z6=function(t,e,n){if(e){var i=Es(document.body);i.addClass("joint-print");var r=t.$el.children().detach();e.forEach(function(a){a.classList.remove("preview"),a.classList.add("print-ready"),i.append(a)});var s=!1,o=function(){s||(s=!0,i.removeClass("joint-print"),e.forEach(function(a){a.remove()}),t.$el.append(r),Es("#print-styles").remove(),t.trigger("afterprint",n),Es(window).off("afterprint",o))};Es(window).one("afterprint",o),setTimeout(o,200),window.print()}},J6=function(t,e){var n=r8(t,e),i=[],r;if(e.poster)for(var s=o8(n,e.poster),o=s8(n,s),a=0;a<o.length;a++)r=Zv(t,o[a],e),i.push(r.el);else r=Zv(t,n,e),i.push(r.el);if(r){var l={width:r.sheetSizePx.cssWidth,height:r.sheetSizePx.cssHeight};i8(l,e)}return i},Q6=function(t){return Object.keys(t).map(function(e){return e+":"+t[e]}).join(";")+";"},hS=function(t){var e=Re(t.margin),n=t.sheet;e.unit=t.marginUnit,n.unit=t.sheetUnit;var i="calc("+n.width+n.unit+" - "+(e.left+e.right)+e.unit+")",r="calc("+n.height+n.unit+" - "+(e.top+e.bottom)+e.unit+")",s=a8.measure(i,r,"");return{cssWidth:i,cssHeight:r,width:s.width,height:s.height}},t8=function(t,e,n){var i=new Z({x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}),r=i.width/i.height,s=n.width/n.height,o;return r>s?o=n.width/i.width:o=n.height/i.height,{bBox:i,scaleToFit:o,fitHorizontal:r>s}},e8=function(t){var e=er({},t,{area:null,poster:!1,sheet:{width:210,height:297},sheetUnit:"mm",ready:function(n,i,r){i(n)},margin:.4,marginUnit:"in",padding:5});return e.area||(e.printingAll=!0),e},n8=function(t){var e=Es("#print-styles"),n='<style type="text/css" id="print-styles">'+t+"</style>";e.length?e.html(t):Es("head").append(n)},i8=function(t,e){var n=Q6(t),i=Re(e.margin),r=e.marginUnit,s=[i.top+r,i.right+r,i.bottom+r,i.left+r].join(" "),o="size:"+(e.sheet.width+e.sheet.unit)+" "+(e.sheet.height+e.sheet.unit),a=["@media print {",".printarea.print-ready {",n,"}","@page {","margin:"+s+";",o,"}",".printarea.preview {",n,"}","}"];n8(a.join(""))},r8=function(t,e){var n=e.area;if(!n){var i=Re(e.padding);n=t.getContentArea().moveAndExpand({x:-i.left,y:-i.top,width:i.left+i.right,height:i.top+i.bottom})}return n},s8=function(t,e){for(var n=e.width,i=e.height,r,s=[],o=0,a=0,l=0,c=0;o<t.height;){for(;a<t.width&&(r=Z(t.x+a,t.y+o,n,i),s.push(r),a+=n,!(c>q6));)c++;if(a=0,c=0,o+=i,l>X6)break;l++}return s},o8=function(t,e){var n={width:e.width,height:e.height};return n.width||(n.width=Math.ceil(t.width/(e.columns||1))),n.height||(n.height=Math.ceil(t.height/(e.rows||1))),n},a8={supportedUnits:{px:function(t){return t},mm:function(t){return this.millimeterSize*t},cm:function(t){return this.millimeterSize*t*10},in:function(t){return this.millimeterSize*t*25.4},pt:function(t){return this.millimeterSize*(t*25.4/72)},pc:function(t){return this.millimeterSize*(t*25.4/6)}},measure:function(t,e,n){n=n||"";var i=Es("<div/>").css({display:"inline-block",position:"absolute",left:-15e3,top:-15e3,width:t+n,height:e+n}).appendTo(document.body),r={width:i.width(),height:i.height()};return i.remove(),r},toPx:function(t,e){if(this.millimeterSize||(this.millimeterSize=this.measure(1,1,"mm").width),e=(e||"").toLowerCase(),!this.supportedUnits[e])throw new Error("Unsupported unit "+e);return this.supportedUnits[e].call(this,t)}};const l8=qF,c8={ForceDirected:lz,GridLayout:of,StackLayout:fn,TreeLayout:Sz},u8={RecordScrollbar:Ez,SwimlaneBoundary:Tz,SwimlaneTransform:Az},h8={CommandManager:du,Validator:Cz},d8=H({},d4,c8);H({},h4,u8);const f8=H({},l8,w4),fh={standard:f8,bpmn2:Y4,chart:tz,measurement:az},p8=H({},L_,h8),wnt={Clipboard:Pz,ColorPalette:J_,ContextToolbar:Q_,Dialog:Nn,FlashMessage:tS,FreeTransform:eS,Halo:kz,Inspector:$a,Keyboard:Gn,Lightbox:Dz,Navigator:Nz,PaperScroller:al,PathDrawer:Vz,PathEditor:zz,Popup:Gz,RadioGroup:iS,SelectBox:ol,SelectButtonGroup:cg,Selection:Uz,Snaplines:Wz,StackLayoutView:Jz,Stencil:ug,TextEditor:ca,Toolbar:b6,Tooltip:S6,TreeLayoutView:E6,Widget:Jn,widgets:cS};Object.assign({},R6,W6,{gexf:{toCellsArray:Y6}},{print:K6});const Gc={PRIMARY:"primary",UNIQUE:"unique",INDEX:"index",NONE:"none"};function g8(t,e){for(var n=-1,i=t==null?0:t.length;++n<i&&e(t[n],n,t)!==!1;);return t}var dS=g8,m8=rs;function v8(t,e){return function(n,i){if(n==null)return n;if(!m8(n))return t(n,i);for(var r=n.length,s=e?r:-1,o=Object(n);(e?s--:++s<r)&&i(o[s],s,o)!==!1;);return n}}var y8=v8,b8=U0,x8=y8,w8=x8(b8),dg=w8,_8=Cl;function S8(t){return typeof t=="function"?t:_8}var E8=S8,T8=dS,A8=dg,C8=E8,P8=An;function I8(t,e){var n=P8(t)?T8:A8;return n(t,C8(e))}var k8=I8;const en=Zn(k8);var O8=Mu,L8=El;function M8(t,e,n){(n!==void 0&&!L8(t[e],n)||n===void 0&&!(e in t))&&O8(t,e,n)}var fS=M8,fu={exports:{}};fu.exports;(function(t,e){var n=Ji,i=e&&!e.nodeType&&e,r=i&&!0&&t&&!t.nodeType&&t,s=r&&r.exports===i,o=s?n.Buffer:void 0,a=o?o.allocUnsafe:void 0;function l(c,h){if(h)return c.slice();var u=c.length,d=a?a(u):new c.constructor(u);return c.copy(d),d}t.exports=l})(fu,fu.exports);var pS=fu.exports,Jv=X0;function D8(t){var e=new t.constructor(t.byteLength);return new Jv(e).set(new Jv(t)),e}var fg=D8,N8=fg;function R8(t,e){var n=e?N8(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var gS=R8;function $8(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}var mS=$8,B8=Qi,Qv=Object.create,F8=function(){function t(){}return function(e){if(!B8(e))return{};if(Qv)return Qv(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),V8=F8,z8=G0,G8=z8(Object.getPrototypeOf,Object),pg=G8,H8=V8,U8=pg,j8=$u;function W8(t){return typeof t.constructor=="function"&&!j8(t)?H8(U8(t)):{}}var vS=W8,Y8=rs,X8=tr;function q8(t){return X8(t)&&Y8(t)}var K8=q8,Z8=zs,J8=pg,Q8=tr,tG="[object Object]",eG=Function.prototype,nG=Object.prototype,yS=eG.toString,iG=nG.hasOwnProperty,rG=yS.call(Object);function sG(t){if(!Q8(t)||Z8(t)!=tG)return!1;var e=J8(t);if(e===null)return!0;var n=iG.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&yS.call(n)==rG}var oG=sG;function aG(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var bS=aG,lG=Mu,cG=El,uG=Object.prototype,hG=uG.hasOwnProperty;function dG(t,e,n){var i=t[e];(!(hG.call(t,e)&&cG(i,n))||n===void 0&&!(e in t))&&lG(t,e,n)}var xS=dG,fG=xS,pG=Mu;function gG(t,e,n,i){var r=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=i?i(n[a],t[a],a,n,t):void 0;l===void 0&&(l=t[a]),r?pG(n,a,l):fG(n,a,l)}return n}var Fl=gG;function mG(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var vG=mG,yG=Qi,bG=$u,xG=vG,wG=Object.prototype,_G=wG.hasOwnProperty;function SG(t){if(!yG(t))return xG(t);var e=bG(t),n=[];for(var i in t)i=="constructor"&&(e||!_G.call(t,i))||n.push(i);return n}var EG=SG,TG=z0,AG=EG,CG=rs;function PG(t){return CG(t)?TG(t,!0):AG(t)}var Vl=PG,IG=Fl,kG=Vl;function OG(t){return IG(t,kG(t))}var LG=OG,ty=fS,MG=pS,DG=gS,NG=mS,RG=vS,ey=Du,ny=An,$G=K8,BG=Sl,FG=lp,VG=Qi,zG=oG,GG=Ru,iy=bS,HG=LG;function UG(t,e,n,i,r,s,o){var a=iy(t,n),l=iy(e,n),c=o.get(l);if(c){ty(t,n,c);return}var h=s?s(a,l,n+"",t,e,o):void 0,u=h===void 0;if(u){var d=ny(l),f=!d&&BG(l),p=!d&&!f&&GG(l);h=l,d||f||p?ny(a)?h=a:$G(a)?h=NG(a):f?(u=!1,h=MG(l,!0)):p?(u=!1,h=DG(l,!0)):h=[]:zG(l)||ey(l)?(h=a,ey(a)?h=HG(a):(!VG(a)||FG(a))&&(h=RG(l))):u=!1}u&&(o.set(l,h),r(h,l,i,s,o),o.delete(l)),ty(t,n,h)}var jG=UG,WG=Gu,YG=fS,XG=F0,qG=jG,KG=Qi,ZG=Vl,JG=bS;function wS(t,e,n,i,r){t!==e&&XG(e,function(s,o){if(r||(r=new WG),KG(s))qG(t,e,o,n,wS,i,r);else{var a=i?i(JG(t,o),s,o+"",t,e,r):void 0;a===void 0&&(a=s),YG(t,o,a)}},ZG)}var QG=wS;function tH(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var eH=tH,nH=eH,ry=Math.max;function iH(t,e,n){return e=ry(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,s=ry(i.length-e,0),o=Array(s);++r<s;)o[r]=i[e+r];r=-1;for(var a=Array(e+1);++r<e;)a[r]=i[r];return a[e]=n(o),nH(t,this,a)}}var rH=iH;function sH(t){return function(){return t}}var oH=sH,aH=oH,sy=B0,lH=Cl,cH=sy?function(t,e){return sy(t,"toString",{configurable:!0,enumerable:!1,value:aH(e),writable:!0})}:lH,uH=cH,hH=800,dH=16,fH=Date.now;function pH(t){var e=0,n=0;return function(){var i=fH(),r=dH-(i-n);if(n=i,r>0){if(++e>=hH)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var gH=pH,mH=uH,vH=gH,yH=vH(mH),bH=yH,xH=Cl,wH=rH,_H=bH;function SH(t,e){return _H(wH(t,e,xH),t+"")}var EH=SH,TH=El,AH=rs,CH=cp,PH=Qi;function IH(t,e,n){if(!PH(n))return!1;var i=typeof e;return(i=="number"?AH(n)&&CH(e,n.length):i=="string"&&e in n)?TH(n[e],t):!1}var kH=IH,OH=EH,LH=kH;function MH(t){return OH(function(e,n){var i=-1,r=n.length,s=r>1?n[r-1]:void 0,o=r>2?n[2]:void 0;for(s=t.length>3&&typeof s=="function"?(r--,s):void 0,o&&LH(n[0],n[1],o)&&(s=r<3?void 0:s,r=1),e=Object(e);++i<r;){var a=n[i];a&&t(e,a,i,s)}return e})}var DH=MH,NH=QG,RH=DH,$H=RH(function(t,e,n){NH(t,e,n)}),BH=$H;const ll=Zn(BH);class fi extends fh.standard.HeaderedRectangle{static get COLUMN_ITEM_HEIGHT(){return 30}static get DEFAULT_WIDTH(){return 270}defaults(){const e={"gray-150":"#edf2f7","gray-700":"#334155","grey-darker":"#606F7B","grey-darker-lighter":"#94a3b8","cobalt-600":"#5A67D8",white:"#FFFFFF"},n=30,i=32,r=6,s=8,o=3,a=14,l=this.INDEX_HEADER_HEIGHT,c=this.INDEX_HEADER_HEIGHT/2;return er({type:"ds.TableShape",columnUuids:[],itemHeight:n,columnItemHeight:fi.COLUMN_ITEM_HEIGHT,indexItemHeight:i,indexItemSpaceY:r,iconWidth:a,iconHeight:14,iconPadding:o,indexItemXPadding:s,size:{width:fi.DEFAULT_WIDTH,height:80},attrs:{root:{magnet:!1,"data-testid":"canvas-table-single"},body:{stroke:"#FFF",fill:"#FFF",strokeWidth:1,filter:"url(#dropShadowMd)",rx:6,ry:6,width:"calc(w)"},tabColor:{x:-.5,y:0,width:"calc(w + 1)",height:this.TAB_COLOR_VISIBLE_HEIGHT*2,stroke:"none",fill:"#6C6C6C",strokeWidth:1,rx:6,ry:6,"data-testid":"canvas-table-single-header-color"},header:{y:8,fill:"#f1f5f9",stroke:"#f1f5f9",strokeWidth:1,height:this.HEADER_HEIGHT,width:"calc(w)"},headerLabel:{fill:e["gray-700"],fontWeight:"bold",y:32,textWrap:{ellipsis:!0,height:30,width:"calc(w - 50)"},x:"calc(w / 2)",textAnchor:"middle",textVerticalAnchor:"middle",fontSize:20,"data-testid":"canvas-table-single-header-label"},headerCommentRect:{width:34,height:28,x:"calc(w - 38)",y:16,fill:"url(#tableCommentGradientFadeOnLeft)"},headerCommentIcon:{width:20,height:28,href:"/svg/chat-bubble-bottom.svg",x:"calc(w - 28)",y:18,event:"table-shape:tooltip-button:pointerdown","data-testid":"canvas-table-has-comment","data-tooltip-class-name":"tooltip-type-table-shape","data-tooltip-type-table-shape":!0},headerDivider:{y:this.TAB_COLOR_VISIBLE_HEIGHT+this.HEADER_HEIGHT-.25,fill:"#cbd5e1",stroke:"#cbd5e1",strokeWidth:.25,height:.25,width:"calc(w)"},columnsContainer:{transform:`matrix(1,0,0,1,0,${52+this.COLUMN_CONTAINER_Y_PADDING})`,"data-testid":"canvas-columns-container"},columnWrappers:{fill:"currentColor"},columnBodies:{width:`calc(w - ${this.COLUMN_BODIES_X_PADDING*2})`,height:n,rx:6,ry:6,magnet:"passive"},columnKeyIcons:{pointerEvents:"none"},columnNames:{textAnchor:"start",textVerticalAnchor:"middle",fill:e["grey-darker"],pointerEvents:"none",fontFamily:'Inter, ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',fontSize:16,fontWeight:"Normal",letterSpacing:0},columnNames_primaryKeys:{fontWeight:"bold",pointerEvents:"none"},columnDataTypeRects:{height:n,pointerEvents:"none"},columnDataTypeLeftFades:{x:"calc(x - 24)",width:"calc(0 * w + 24)",height:n,fill:"url(#gradientFadeOnLeft)",pointerEvents:"none"},columnCommentIcons:{event:"table-shape:tooltip-button:pointerdown",x:`calc(x - ${o+a})`,"data-testid":"canvas-column-has-comment","data-tooltip-class-name":"tooltip-type-table-shape","data-tooltip-type-table-shape":!0},columnCommentDefaults:{event:"table-shape:tooltip-button:pointerdown",x:`calc(x - ${o+a})`,"data-testid":"canvas-column-has-column-attributes","data-tooltip-class-name":"tooltip-type-table-shape","data-tooltip-type-table-shape":!0},columnDataTypeTexts:{x:`calc(w - ${this.COLUMNS_CONTAINER_PADDING.right})`,textVerticalAnchor:"middle",fill:e["grey-darker-lighter"],textAnchor:"end",pointerEvents:"none"},columnIsNullables:{x:`calc(w - ${this.COLUMNS_CONTAINER_PADDING.right})`,text:"?",textVerticalAnchor:"middle",fill:e["grey-darker-lighter"],textAnchor:"end",pointerEvents:"none"},indexesSectionBody:{display:"none",ref:"columnsContainer",x:this.INDEX_SECTION_BODY_X_MARGIN,y:`calc(y + calc(h + ${this.INDEX_CONTAINER_Y_MARGIN}))`,width:`calc(w + ${this.COLUMN_BODIES_X_PADDING*2-this.INDEX_CONTAINER_X_PADDING*2})`,"data-testid":"index-columns-container",fill:e["gray-150"],rx:6,ry:6},indexesContainerLabel:{display:"none",ref:"indexesSectionBody",x:`calc(x + ${this.INDEX_SECTION_BODY_X_PADDING})`,y:`calc(y + ${c})`,fontSize:14,fontWeight:"bold",textAnchor:"start",textVerticalAnchor:"middle",fill:e["grey-darker"],text:"Indexes"},indexesContainer:{display:"none",ref:"indexesSectionBody",transform:`matrix(1,0,0,1,calc(x + ${this.INDEX_BODIES_X_PADDING}),calc(y + ${l}))`,"data-testid":"canvas-indexes-container",fill:e["gray-150"]},indexWrappers:{fill:"currentColor"},indexBodies:{event:"element:indexBodies:pointerup",width:`calc(w - ${2*(this.INDEX_CONTAINER_X_MARGIN+this.INDEX_BODIES_X_PADDING)})`,height:i,rx:4,ry:4},indexKeyIcons:{pointerEvents:"none"},indexNames:{textAnchor:"start",textVerticalAnchor:"middle",fill:e["grey-darker"],pointerEvents:"none",fontSize:16,fontWeight:"Normal",fontFamily:'Inter, ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',letterSpacing:0}},ports:{groups:{portsOutLeft:{position:{name:"left"},attrs:{root:{"data-testid":"ports-out-left"},portBody:{magnet:!0,r:6,fill:e["cobalt-600"],stroke:e["cobalt-600"]}},markup:[{tagName:"circle",selector:"portBody"}]},portsOutRight:{position:{name:"right"},attrs:{root:{"data-testid":"ports-out-right"},portBody:{magnet:!0,r:6,fill:e["cobalt-600"],stroke:e["cobalt-600"]}},markup:[{tagName:"circle",selector:"portBody"}]}}}},super.defaults)}preinitialize(){this.columnUuidsCache=[],this.indexUuidsCache=[],this.HEADER_HEIGHT=44,this.TAB_COLOR_VISIBLE_HEIGHT=8,this.COLUMN_CONTAINER_Y_PADDING=3,this.COLUMN_BODIES_X_PADDING=2,this.INDEX_BODIES_X_PADDING=8,this.INDEX_SECTION_BODY_X_MARGIN=8,this.INDEX_SECTION_BODY_X_PADDING=8,this.INDEX_CONTAINER_X_MARGIN=8,this.INDEX_CONTAINER_X_PADDING=8,this.INDEX_CONTAINER_Y_MARGIN=6,this.INDEX_CONTAINER_PADDING={top:0,bottom:8},this.INDEX_WRAPPER_X_PADDING=6,this.COLUMNS_PATH="markup/6/children",this.INDEX_HEADER_HEIGHT=28,this.COLUMNS_CONTAINER_PADDING={left:10,right:12},this.INDEXES_PATH="markup/10/children",this.markup=[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"tabColor"},{tagName:"rect",selector:"header",className:"table-header"},{tagName:"text",selector:"headerLabel"},{tagName:"rect",selector:"headerCommentRect"},{tagName:"image",selector:"headerCommentIcon",className:"table-comment-icon"},{tagName:"g",selector:"columnsContainer",className:"columns-container",children:[]},{tagName:"rect",selector:"headerDivider",children:[]},{tagName:"rect",selector:"indexesSectionBody",className:"indexes-section-body"},{tagName:"text",selector:"indexesContainerLabel"},{tagName:"g",selector:"indexesContainer",className:"indexes-container",children:[]}]}initialize(...e){super.initialize(...e),this.buildMarkup()}onChange(e,n){}onColumnsChange(){this.hasChanged("columns")&&this._setColumns(this.get("columns"))}setName(e,n){return this.attr(["headerLabel","text"],e,n)}getName(){return this.attr(["headerLabel","text"])}setColor(e){return this.attr(["tabColor","fill"],e)}getColor(){return this.attr(["tabColor","fill"])}setComment(e){return this.attr("headerCommentRect/display",e?"block":"none"),this.attr("headerCommentIcon/display",e?"block":"none"),this.attr(["headerCommentIcon","href"],e?"/svg/chat-bubble-bottom.svg":"")}setColumns(e){return this}getColumnUuids(){return this.columnUuidsCache}autoresize(e){const n=this.getMinimalSize(),{size:i}=this.attributes,{height:r,width:s}=i,o=n.height,a=Math.max(s,n.width);this.resize(a,o,e)}getHeightOfIndexesSection(e=!1){const n=this.prop(this.INDEXES_PATH).length,i=e?this.INDEX_CONTAINER_Y_MARGIN*2:0;return n===0?0:this.INDEX_CONTAINER_PADDING.top+this.INDEX_CONTAINER_PADDING.bottom+this.INDEX_HEADER_HEIGHT+this.attributes.indexItemHeight*n+this.attributes.indexItemSpaceY*(n-1)+i}recalculateIndexesSectionHeight(){if(!this.prop(this.INDEXES_PATH))return;const e=this.getHeightOfIndexesSection();if(e===0){this.attr("indexesContainerLabel/display","none"),this.attr("indexesSectionBody/display","none"),this.attr("indexesContainer/display","none");return}this.attr("indexesContainerLabel/display","block"),this.attr("indexesSectionBody/display","block"),this.attr("indexesContainer/display","block"),this.attr("indexesSectionBody/height",e)}getMinimalSize(){const e=this.prop(this.COLUMNS_PATH).length;return{width:0,height:this.TAB_COLOR_VISIBLE_HEIGHT+this.HEADER_HEIGHT+this.attributes.itemHeight*e+this.COLUMN_CONTAINER_Y_PADDING*2+this.getHeightOfIndexesSection(!0)}}buildMarkup(e){let n=this.prop("markup")??Le(this.markup),i=H({record:this.id,dry:!0},e);this.set("markup",n,i),this.autoresize()}buildColumnKeyIconMarkup(e,n,i){return{tagName:"image",selector:`columnKeyIcon_${e.uuid}`,groupSelector:"columnKeyIcons",attributes:{"data-testid":"canvas-column-key-icon",x:this.COLUMNS_CONTAINER_PADDING.left,y:i+(this.attributes.itemHeight-this.attributes.iconHeight)/2,width:this.attributes.iconWidth,height:this.attributes.iconHeight,href:n}}}buildColumnMarkup(e,n,i){const s=i*this.attributes.itemHeight,o=[{tagName:"rect",selector:`columnBody_${e.uuid}`,groupSelector:"columnBodies",attributes:{x:0+this.COLUMN_BODIES_X_PADDING,y:s}}];e.is_primary_key?o.push(this.buildColumnKeyIconMarkup(e,"/svg/key.svg",s)):e.is_unique_key?o.push(this.buildColumnKeyIconMarkup(e,"/svg/snowflake.svg",s)):e.is_index&&o.push(this.buildColumnKeyIconMarkup(e,"/svg/neuter.svg",s));const a=["columnNames"];return e.is_primary_key&&a.push("columnNames_primaryKeys"),o.push({tagName:"text",selector:`columnName_${e.uuid}`,groupSelector:a,attributes:{"data-testid":"canvas-column-name",x:this.attributes.iconWidth+this.attributes.iconPadding+this.COLUMNS_CONTAINER_PADDING.left,y:s+this.attributes.itemHeight/2}}),o.push({tagName:"rect",selector:`columnDataTypeRect_${e.uuid}`,groupSelector:"columnDataTypeRects",attributes:{y:s}}),o.push({tagName:"rect",selector:`columnDataTypeLeftFade_${e.uuid}`,groupSelector:"columnDataTypeLeftFades",className:"column-data-type-left-fades",attributes:{y:s}}),e.comment&&o.push({tagName:"image",selector:`columnCommentIcon_${e.uuid}`,groupSelector:"columnCommentIcons",className:"column-comment-icon",attributes:{y:s+(this.attributes.itemHeight-this.attributes.iconHeight)/2,width:this.attributes.iconWidth,height:this.attributes.iconHeight,href:"/svg/chat-bubble-bottom.svg"}}),this._columnHasExtraAttributes(e)&&o.push({tagName:"image",selector:`columnCommentDefault_${e.uuid}`,groupSelector:"columnCommentDefaults",className:"column-default-icon",attributes:{y:s+(this.attributes.itemHeight-this.attributes.iconHeight)/2,width:this.attributes.iconWidth,height:this.attributes.iconHeight,href:"/svg/bookmark.svg"}}),o.push({tagName:"text",selector:`columnDataTypeText_${e.uuid}`,groupSelector:"columnDataTypeTexts",attributes:{"data-testid":"canvas-column-data-type-text",y:s+this.attributes.itemHeight/2}}),e.is_nullable&&o.push({tagName:"text",selector:`columnIsNullable_${e.uuid}`,groupSelector:"columnIsNullables",attributes:{"data-testid":"canvas-column-is-nullable",y:s+this.attributes.itemHeight/2}}),{tagName:"g",selector:`columnWrapper_${e.uuid}`,groupSelector:"columnWrappers",className:"column-wrapper column-wrapper_"+e.uuid,children:o}}setColumnAttributes(e,n){this.attr(`columnWrapper_${e.uuid}`,{"data-testid":"canvas-column-single","data-uuid":e.uuid}),this.attr(`columnName_${e.uuid}`,{text:e.name,textWrap:{width:`calc(w - calc(0.1 * w + ${this.COLUMNS_CONTAINER_PADDING.left+this.COLUMNS_CONTAINER_PADDING.right+this.attributes.iconWidth+this.attributes.iconPadding+this.attributes.iconPadding}))`,height:this.attributes.itemHeight,ellipsis:!0,hyphen:"|||"}});const i=8,r=e.is_nullable?`calc(w - ${this.COLUMNS_CONTAINER_PADDING.right+i})`:`calc(w - ${this.COLUMNS_CONTAINER_PADDING.right})`;this.attr(`columnDataTypeText_${e.uuid}`,{text:n.dataTypeColumnText,x:r,textWrap:{width:"30%",height:this.attributes.itemHeight,ellipsis:!0}});const s=this.calcColumnDataTypeShiftLeftBy(e);this.attr("columnDataTypeRect_"+e.uuid,{ref:"columnDataTypeText_"+e.uuid,width:`calc(w + ${s})`,x:`calc(x - ${s})`}),this.attr("columnDataTypeLeftFade_"+e.uuid,{ref:"columnDataTypeRect_"+e.uuid}),e.comment&&this.attr("columnCommentIcon_"+e.uuid,{ref:"columnDataTypeText_"+e.uuid}),this._columnHasExtraAttributes(e)&&(e.comment?this.attr("columnCommentDefault_"+e.uuid,{ref:"columnCommentIcon_"+e.uuid}):this.attr("columnCommentDefault_"+e.uuid,{ref:"columnDataTypeText_"+e.uuid}))}shiftColumnsYPositionBy(e,n=0){const i=this.prop(this.COLUMNS_PATH);for(let r=n;r<i.length;r++){const s=i[r];this.addYDiffDeep(s,e)}this.prop(this.COLUMNS_PATH,i)}addYDiffDeep(e,n){for(let i in e)typeof e[i]=="object"&&e[i]!==null?this.addYDiffDeep(e[i],n):i==="y"&&(e[i]+=n)}calcColumnDataTypeShiftLeftBy(e){let n=0;return e.comment&&(n+=this.attributes.iconWidth+this.attributes.iconPadding+this.attributes.iconPadding),this._columnHasExtraAttributes(e)&&(n+=this.attributes.iconWidth+this.attributes.iconPadding+this.attributes.iconPadding),n}_columnHasExtraAttributes(e){return e.default||e.enum_values&&e.enum_values.length>0}reorderColumns(e){const n=this.prop(this.COLUMNS_PATH);en(this.columnUuidsCache,(r,s)=>{const a=(e.indexOf(r)-s)*this.attributes.itemHeight;this.addYDiffDeep(n[s],a)});const i=[];en(e,(r,s)=>{const o=this.columnUuidsCache.indexOf(r);i[s]=n[o]}),this.prop(this.COLUMNS_PATH,i,H({rewrite:!0})),this.columnUuidsCache=[...e],this.resetPorts()}addColumn(e,n,i={}){return i=ll({showPorts:!1},i),this.prop(this.COLUMNS_PATH+"/"+this.columnUuidsCache.length,this.buildColumnMarkup(e,n,this.columnUuidsCache.length)),this.setColumnAttributes(e,n),this.columnUuidsCache.push(e.uuid),this.buildMarkup(),i.showPorts&&this.showPortsForColumn(e.uuid,this.columnUuidsCache.length-1),this}updateColumn(e,n,i){const r=this.columnUuidsCache.indexOf(e.uuid);r!==-1&&e.uuid===this.columnUuidsCache[r]&&(this.prop(this.COLUMNS_PATH+"/"+r,this.buildColumnMarkup(e,n,r),{rewrite:!0}),this.setColumnAttributes(e,n))}deleteColumn(e){const n=this.columnUuidsCache.indexOf(e);if(n===-1)return;const i=this.prop(this.COLUMNS_PATH).slice();return i.splice(n,1),this.prop(this.COLUMNS_PATH,i,H({rewrite:!0})),this.columnUuidsCache.splice(n,1),this.shiftColumnsYPositionBy(-this.attributes.itemHeight,n),this.buildMarkup(),this.resetPorts(),this}buildIndexMarkup(e,n,i){const r=i*this.attributes.indexItemHeight+this.attributes.indexItemSpaceY*i,s=[{tagName:"rect",selector:`indexBody_${e.uuid}`,groupSelector:"indexBodies",ref:"indexesContainer",attributes:{y:r,x:0}}];let o=null;return e.type===Gc.PRIMARY?o="/svg/key.svg":e.type===Gc.UNIQUE?o="/svg/snowflake.svg":e.type===Gc.INDEX&&(o="/svg/neuter.svg"),o&&s.push(this.buildIndexKeyIconMarkup(e,o,r)),s.push({tagName:"text",selector:`indexNames_${e.uuid}`,groupSelector:"indexNames",attributes:{"data-testid":"canvas-index-names",x:this.attributes.iconWidth+this.attributes.iconPadding+this.INDEX_WRAPPER_X_PADDING,y:r+this.attributes.indexItemHeight/2}}),{tagName:"g",selector:`indexWrapper_${e.uuid}`,groupSelector:"indexWrappers",className:"index-wrapper index-wrapper_"+e.uuid,children:s}}buildIndexKeyIconMarkup(e,n,i){return{tagName:"image",selector:`indexKeyIcon_${e.uuid}`,groupSelector:"indexKeyIcons",attributes:{"data-testid":"canvas-index-key-icon",x:this.INDEX_WRAPPER_X_PADDING,y:i+(this.attributes.indexItemHeight-this.attributes.iconHeight)/2,width:this.attributes.iconWidth,height:this.attributes.iconHeight,href:n}}}setIndexAttributes(e,n){this.attr(`indexWrapper_${e.uuid}`,{"data-testid":"canvas-index-single","data-uuid":e.uuid,className:"index-wrapper"}),this.attr(`indexNames_${e.uuid}`,{text:n.columnNames,textWrap:{width:`calc(w - ${2*(this.INDEX_CONTAINER_X_MARGIN+this.INDEX_CONTAINER_X_PADDING)+this.attributes.iconWidth+2*this.attributes.iconPadding+this.attributes.indexItemXPadding})`,height:this.attributes.indexItemHeight,ellipsis:!0,hyphen:"|||"}})}shiftIndexesYPositionBy(e,n=0){const i=this.prop(this.INDEXES_PATH);for(let r=n;r<i.length;r++){const s=i[r];this.addYDiffDeep(s,e)}this.prop(this.INDEXES_PATH,i)}reorderIndexes(e){const n=this.prop(this.INDEXES_PATH);en(this.indexUuidsCache,(r,s)=>{const a=(e.indexOf(r)-s)*(this.attributes.indexItemHeight+this.attributes.indexItemSpaceY);this.addYDiffDeep(n[s],a)});const i=[];en(e,(r,s)=>{const o=this.indexUuidsCache.indexOf(r);i[s]=n[o]}),this.prop(this.INDEXES_PATH,i,H({rewrite:!0})),this.indexUuidsCache=e}addIndex(e,n){return this.prop(this.INDEXES_PATH+"/"+this.indexUuidsCache.length,this.buildIndexMarkup(e,n,this.indexUuidsCache.length)),this.setIndexAttributes(e,n),this.indexUuidsCache.push(e.uuid),this.recalculateIndexesSectionHeight(),this.buildMarkup(),this}updateIndex(e,n,i){const r=this.indexUuidsCache.indexOf(e.uuid);r!==-1&&e.uuid===this.indexUuidsCache[r]&&(this.prop(this.INDEXES_PATH+"/"+r,this.buildIndexMarkup(e,n,r),{rewrite:!0}),this.setIndexAttributes(e,n))}deleteIndex(e){const n=this.indexUuidsCache.indexOf(e);if(n===-1)return;const i=this.prop(this.INDEXES_PATH).slice();return i.splice(n,1),this.prop(this.INDEXES_PATH,i,H({rewrite:!0})),this.indexUuidsCache.splice(n,1),this.shiftIndexesYPositionBy(-this.attributes.indexItemHeight-this.attributes.indexItemSpaceY,n),this.recalculateIndexesSectionHeight(),this.buildMarkup(),this}showPorts(){let e=[];this.columnUuidsCache.forEach((n,i)=>{e=e.concat(this.generatePortDefsForColumn(n,i))}),this.addPorts(e)}showPortsForColumn(e,n){const i=this.generatePortDefsForColumn(e,n);this.addPorts(i)}generatePortDefsForColumn(e,n){const i=[],s=this.HEADER_HEIGHT+this.TAB_COLOR_VISIBLE_HEIGHT+this.COLUMN_CONTAINER_Y_PADDING+n*this.attributes.itemHeight+this.attributes.itemHeight/2;return i.push({columnUuid:e,group:"portsOutLeft",args:{y:s}}),i.push({columnUuid:e,group:"portsOutRight",args:{y:s}}),i}hidePorts(){this.removePorts()}resetPorts(){this.hidePorts(),this.showPorts()}}Object.assign(fh,{ds:{TableShape:fi}});function pu(t,e){if(!t.startsWith(e)||t.length!==e.length+36)return null;const n=t.substring(t.lastIndexOf("_")+1);return $b(n)?n:null}const dd={ONE_TO_ONE:"one-to-one",ONE_TO_MANY:"one-to-many",MANY_TO_ONE:"many-to-one"};function FH(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var VH=FH;const uf=Zn(VH);class Ui extends fh.standard.Link{static get ANCHOR_SIDE_LEFT(){return"left"}static get ANCHOR_SIDE_RIGHT(){return"right"}constructor(){super(...arguments),this.markup=[{tagName:"path",selector:"wrapper",className:"relationship-shape-wrapper",attributes:{fill:"none",stroke:"transparent"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]}defaults(){return Object.assign(Object.assign({},super.defaults),{type:"ds.RelationshipShape",z:-1,attrs:{root:{"data-testid":"canvas-relationship-single"},wrapper:{connection:!0,strokeWidth:10},line:{connection:!0,stroke:"#a0a0a0",strokeWidth:2,"data-testid":"canvas-relationship-single-line"}}})}preinitialize(){this.MARKER_MANY_END={type:"path","stroke-width":2,d:"m 20 0 l -20 7.5 l 19.85 -7.5 l -19.85 -7.5 l 20 7.5"}}colorSelected(){return this.attr(["line","stroke"],"#6366f1"),this}colorUnselected(){return this.attr(["line","stroke"],"#a0a0a0"),this}setType(e){switch(e){case dd.ONE_TO_ONE:this.removeAttr(["line","sourceMarker"]),this.removeAttr(["line","targetMarker"]);break;case dd.ONE_TO_MANY:this.removeAttr(["line","sourceMarker"]),this.attr(["line","targetMarker"],this.MARKER_MANY_END);break;case dd.MANY_TO_ONE:this.attr(["line","sourceMarker"],this.MARKER_MANY_END),this.removeAttr(["line","targetMarker"]);break}return this}getSourceAnchorSide(e,n){n=ll({usePreviousAttr:!1},n);let i,r;if(!n.usePreviousAttr)i=this.getSourceElement(),r=this.getTargetPoint();else{if(!e)return console.warn("No graph passed to getSourceAnchorSide() with opt.usePreviousAttr = true"),null;const a=this.previous("source");if(!a)return console.warn(`No previous source element found for relationship in getSourceAnchorSide(). ID: ${this.id}`),null;i=e.getCell(a.id);const l=this.previous("target");if(!l)return console.warn(`No previous target element found for relationship in getSourceAnchorSide(). ID: ${this.id}`),null;r=e.getCell(l.id).getBBox().center()}if(!i)return console.warn(`No source element found for relationship in getSourceAnchorSide(). ID: ${this.id}`),null;const s=i.getBBox();return(this.vertices().length===0?r:this.vertices()[0]).x<=s.x+s.width?Ui.ANCHOR_SIDE_LEFT:Ui.ANCHOR_SIDE_RIGHT}getTargetAnchorSide(e=null,n={}){n=ll({usePreviousAttr:!1},n);let i,r;if(!n.usePreviousAttr)i=this.getTargetElement(),r=this.getSourcePoint();else{if(!e)return console.warn("No graph passed to getTargetAnchorSide() with opt.usePreviousAttr = true"),null;const a=this.previous("target");if(!a)return console.warn(`No previous target element found for relationship in getTargetAnchorSide(). ID: ${this.id}`),null;i=e.getCell(a.id);const l=this.previous("source");if(!l)return console.warn(`No previous source element found for relationship in getTargetAnchorSide(). ID: ${this.id}`),null;r=e.getCell(l.id).getBBox().center()}if(!i)return console.warn(`No target element found for relationship in getTargetAnchorSide(). ID: ${this.id}`),null;const s=i.getBBox();return(this.vertices().length===0?r:uf(this.vertices())).x<=s.x+s.width?Ui.ANCHOR_SIDE_LEFT:Ui.ANCHOR_SIDE_RIGHT}}Object.assign(fh,{ds:{RelationshipShape:Ui}});var zH=zs,GH=An,HH=tr,UH="[object String]";function jH(t){return typeof t=="string"||!GH(t)&&HH(t)&&zH(t)==UH}var WH=jH;const YH=Zn(WH);var XH=dg;function qH(t,e){var n=[];return XH(t,function(i,r,s){e(i,r,s)&&n.push(i)}),n}var KH=qH,ZH=Z0,JH=KH,QH=Hs,tU=An;function eU(t,e){var n=tU(t)?ZH:JH;return n(t,QH(e))}var nU=eU;const _S=Zn(nU);function Tc(){const t=i=>YH(i)?$t().graph.getCell(i):i;return{resolveTableCell:t,linkEndTypeConnectedToTable:(i,r)=>i.getSourceElement().id===r?"source":i.getTargetElement().id===r?"target":null,getLinksConnectedToColumnCell:(i,r)=>{const s=t(i),o=$t().graph.getConnectedLinks(s);return _S(o,a=>pu(a.source().magnet,"columnBody_")===r||pu(a.target().magnet,"columnBody_")===r)}}}var iU=dg,rU=rs;function sU(t,e){var n=-1,i=rU(t)?Array(t.length):[];return iU(t,function(r,s,o){i[++n]=e(r,s,o)}),i}var SS=sU;function oU(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}var aU=oU,oy=Al;function lU(t,e){if(t!==e){var n=t!==void 0,i=t===null,r=t===t,s=oy(t),o=e!==void 0,a=e===null,l=e===e,c=oy(e);if(!a&&!c&&!s&&t>e||s&&o&&l&&!a&&!c||i&&o&&l||!n&&l||!r)return 1;if(!i&&!s&&!c&&t<e||c&&n&&r&&!i&&!s||a&&n&&r||!o&&r||!l)return-1}return 0}var cU=lU,uU=cU;function hU(t,e,n){for(var i=-1,r=t.criteria,s=e.criteria,o=r.length,a=n.length;++i<o;){var l=uU(r[i],s[i]);if(l){if(i>=a)return l;var c=n[i];return l*(c=="desc"?-1:1)}}return t.index-e.index}var dU=hU,fd=yp,fU=bp,pU=Hs,gU=SS,mU=aU,vU=Nu,yU=dU,bU=Cl,xU=An;function wU(t,e,n){e.length?e=fd(e,function(s){return xU(s)?function(o){return fU(o,s.length===1?s[0]:s)}:s}):e=[bU];var i=-1;e=fd(e,vU(pU));var r=gU(t,function(s,o,a){var l=fd(e,function(c){return c(s)});return{criteria:l,index:++i,value:s}});return mU(r,function(s,o){return yU(s,o,n)})}var _U=wU,SU=_U,ay=An;function EU(t,e,n,i){return t==null?[]:(ay(e)||(e=e==null?[]:[e]),n=i?void 0:n,ay(n)||(n=n==null?[]:[n]),SU(t,e,n))}var TU=EU;const cl=Zn(TU);function AU(){const t=s=>{n(s),e(s)},e=s=>{const a=$t().graph.getNeighbors(s).filter(l=>l instanceof fi);en(a,l=>{n(l)})},n=s=>{const o=Tc().resolveTableCell(s),a=o.getColumnUuids();en(a,l=>{i(o,l)})},i=(s,o,a=[Ui.ANCHOR_SIDE_LEFT,Ui.ANCHOR_SIDE_RIGHT])=>{const l=$t().graph,c=v=>{let x=[];for(let S=1;S<=v;S++){const C=S/(v+1);x.push(C-.5)}return x},h=(v,x)=>v.map(S=>{const C=Tc().linkEndTypeConnectedToTable(S,x);let P=null;return C==="source"?P=S.getSourceAnchorSide(l):C==="target"&&(P=S.getTargetAnchorSide(l)),{connectedEnd:C,anchorSide:P,link:S}}).filter(S=>S.connectedEnd!==null&&S.anchorSide!==null),u=(v,x)=>v.filter(S=>S.anchorSide===x),d=Tc().resolveTableCell(s),f=d.id;let p=Tc().getLinksConnectedToColumnCell(d,o),g=h(p,f);en(a,v=>{let x=u(g,v);if(x.length===0)return;x=cl(x,P=>{const k=P.link,N=P.connectedEnd;if(k.vertices().length>0){const b=N==="source"?k.vertices()[0]:k.vertices()[k.vertices().length-1];return console.error("Solve for vertex"),b.y}return(N==="source"?k.getTargetPoint():k.getSourcePoint()).y});let S=x.length,C=c(S);en(x,function(P,k){const N=P.link,m=C[k]*fi.COLUMN_ITEM_HEIGHT;if(P.connectedEnd==="source"){const b={id:N.getSourceCell().id,magnet:N.source().magnet,anchor:{name:"customAnchor",args:{offsetY:m}}};N.source(b)}else if(P.connectedEnd==="target"){const b={id:N.getTargetCell().id,magnet:N.target().magnet,anchor:{name:"customAnchor",args:{offsetY:m}}};N.target(b)}})})};return{spreadOutAnchorsOfSelfAndNeighbourTablesOfTableCell:t,spreadOutAnchorsForTable:n,spreadOutAnchorsOfNeighbourTablesOfTableCell:e,spreadOutAnchorsForColumn:i,spreadOutAnchorsForLink:(s,o)=>{const a=$t().graph;o=ll({usePreviousAttr:!1},o),s instanceof p8.Element;const l=s,c=o.usePreviousAttr?l.previous("target").id:l.target().id,h=o.usePreviousAttr?l.previous("source").id:l.source().id;let u=l.getSourceAnchorSide(a,o),d=l.source().magnet,f=pu(d,"columnBody_");i(h,f,[u]),u=l.getTargetAnchorSide(a,o),d=l.target().magnet,f=pu(d,"columnBody_"),i(c,f,[u])}}}var CU="\0",ds="\0",ly="",qn,As,ei,pl,Lo,Mo,li,Vi,Xr,zi,qr,fr,pr,Do,No,gr,Ti,gl,hf,Tb;let PU=(Tb=class{constructor(e){ze(this,gl);ze(this,qn,!0);ze(this,As,!1);ze(this,ei,!1);ze(this,pl,void 0);ze(this,Lo,()=>{});ze(this,Mo,()=>{});ze(this,li,{});ze(this,Vi,{});ze(this,Xr,{});ze(this,zi,{});ze(this,qr,{});ze(this,fr,{});ze(this,pr,{});ze(this,Do,0);ze(this,No,0);ze(this,gr,void 0);ze(this,Ti,void 0);e&&(oi(this,qn,e.hasOwnProperty("directed")?e.directed:!0),oi(this,As,e.hasOwnProperty("multigraph")?e.multigraph:!1),oi(this,ei,e.hasOwnProperty("compound")?e.compound:!1)),it(this,ei)&&(oi(this,gr,{}),oi(this,Ti,{}),it(this,Ti)[ds]={})}isDirected(){return it(this,qn)}isMultigraph(){return it(this,As)}isCompound(){return it(this,ei)}setGraph(e){return oi(this,pl,e),this}graph(){return it(this,pl)}setDefaultNodeLabel(e){return oi(this,Lo,e),typeof e!="function"&&oi(this,Lo,()=>e),this}nodeCount(){return it(this,Do)}nodes(){return Object.keys(it(this,li))}sources(){var e=this;return this.nodes().filter(n=>Object.keys(it(e,Vi)[n]).length===0)}sinks(){var e=this;return this.nodes().filter(n=>Object.keys(it(e,zi)[n]).length===0)}setNodes(e,n){var i=arguments,r=this;return e.forEach(function(s){i.length>1?r.setNode(s,n):r.setNode(s)}),this}setNode(e,n){return it(this,li).hasOwnProperty(e)?(arguments.length>1&&(it(this,li)[e]=n),this):(it(this,li)[e]=arguments.length>1?n:it(this,Lo).call(this,e),it(this,ei)&&(it(this,gr)[e]=ds,it(this,Ti)[e]={},it(this,Ti)[ds][e]=!0),it(this,Vi)[e]={},it(this,Xr)[e]={},it(this,zi)[e]={},it(this,qr)[e]={},++wa(this,Do)._,this)}node(e){return it(this,li)[e]}hasNode(e){return it(this,li).hasOwnProperty(e)}removeNode(e){var n=this;if(it(this,li).hasOwnProperty(e)){var i=r=>n.removeEdge(it(n,fr)[r]);delete it(this,li)[e],it(this,ei)&&($i(this,gl,hf).call(this,e),delete it(this,gr)[e],this.children(e).forEach(function(r){n.setParent(r)}),delete it(this,Ti)[e]),Object.keys(it(this,Vi)[e]).forEach(i),delete it(this,Vi)[e],delete it(this,Xr)[e],Object.keys(it(this,zi)[e]).forEach(i),delete it(this,zi)[e],delete it(this,qr)[e],--wa(this,Do)._}return this}setParent(e,n){if(!it(this,ei))throw new Error("Cannot set parent in a non-compound graph");if(n===void 0)n=ds;else{n+="";for(var i=n;i!==void 0;i=this.parent(i))if(i===e)throw new Error("Setting "+n+" as parent of "+e+" would create a cycle");this.setNode(n)}return this.setNode(e),$i(this,gl,hf).call(this,e),it(this,gr)[e]=n,it(this,Ti)[n][e]=!0,this}parent(e){if(it(this,ei)){var n=it(this,gr)[e];if(n!==ds)return n}}children(e=ds){if(it(this,ei)){var n=it(this,Ti)[e];if(n)return Object.keys(n)}else{if(e===ds)return this.nodes();if(this.hasNode(e))return[]}}predecessors(e){var n=it(this,Xr)[e];if(n)return Object.keys(n)}successors(e){var n=it(this,qr)[e];if(n)return Object.keys(n)}neighbors(e){var n=this.predecessors(e);if(n){const r=new Set(n);for(var i of this.successors(e))r.add(i);return Array.from(r.values())}}isLeaf(e){var n;return this.isDirected()?n=this.successors(e):n=this.neighbors(e),n.length===0}filterNodes(e){var n=new this.constructor({directed:it(this,qn),multigraph:it(this,As),compound:it(this,ei)});n.setGraph(this.graph());var i=this;Object.entries(it(this,li)).forEach(function([o,a]){e(o)&&n.setNode(o,a)}),Object.values(it(this,fr)).forEach(function(o){n.hasNode(o.v)&&n.hasNode(o.w)&&n.setEdge(o,i.edge(o))});var r={};function s(o){var a=i.parent(o);return a===void 0||n.hasNode(a)?(r[o]=a,a):a in r?r[a]:s(a)}return it(this,ei)&&n.nodes().forEach(o=>n.setParent(o,s(o))),n}setDefaultEdgeLabel(e){return oi(this,Mo,e),typeof e!="function"&&oi(this,Mo,()=>e),this}edgeCount(){return it(this,No)}edges(){return Object.values(it(this,fr))}setPath(e,n){var i=this,r=arguments;return e.reduce(function(s,o){return r.length>1?i.setEdge(s,o,n):i.setEdge(s,o),o}),this}setEdge(){var e,n,i,r,s=!1,o=arguments[0];typeof o=="object"&&o!==null&&"v"in o?(e=o.v,n=o.w,i=o.name,arguments.length===2&&(r=arguments[1],s=!0)):(e=o,n=arguments[1],i=arguments[3],arguments.length>2&&(r=arguments[2],s=!0)),e=""+e,n=""+n,i!==void 0&&(i=""+i);var a=Ba(it(this,qn),e,n,i);if(it(this,pr).hasOwnProperty(a))return s&&(it(this,pr)[a]=r),this;if(i!==void 0&&!it(this,As))throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(n),it(this,pr)[a]=s?r:it(this,Mo).call(this,e,n,i);var l=IU(it(this,qn),e,n,i);return e=l.v,n=l.w,Object.freeze(l),it(this,fr)[a]=l,cy(it(this,Xr)[n],e),cy(it(this,qr)[e],n),it(this,Vi)[n][a]=l,it(this,zi)[e][a]=l,wa(this,No)._++,this}edge(e,n,i){var r=arguments.length===1?pd(it(this,qn),arguments[0]):Ba(it(this,qn),e,n,i);return it(this,pr)[r]}edgeAsObj(){const e=this.edge(...arguments);return typeof e!="object"?{label:e}:e}hasEdge(e,n,i){var r=arguments.length===1?pd(it(this,qn),arguments[0]):Ba(it(this,qn),e,n,i);return it(this,pr).hasOwnProperty(r)}removeEdge(e,n,i){var r=arguments.length===1?pd(it(this,qn),arguments[0]):Ba(it(this,qn),e,n,i),s=it(this,fr)[r];return s&&(e=s.v,n=s.w,delete it(this,pr)[r],delete it(this,fr)[r],uy(it(this,Xr)[n],e),uy(it(this,qr)[e],n),delete it(this,Vi)[n][r],delete it(this,zi)[e][r],wa(this,No)._--),this}inEdges(e,n){var i=it(this,Vi)[e];if(i){var r=Object.values(i);return n?r.filter(s=>s.v===n):r}}outEdges(e,n){var i=it(this,zi)[e];if(i){var r=Object.values(i);return n?r.filter(s=>s.w===n):r}}nodeEdges(e,n){var i=this.inEdges(e,n);if(i)return i.concat(this.outEdges(e,n))}},qn=new WeakMap,As=new WeakMap,ei=new WeakMap,pl=new WeakMap,Lo=new WeakMap,Mo=new WeakMap,li=new WeakMap,Vi=new WeakMap,Xr=new WeakMap,zi=new WeakMap,qr=new WeakMap,fr=new WeakMap,pr=new WeakMap,Do=new WeakMap,No=new WeakMap,gr=new WeakMap,Ti=new WeakMap,gl=new WeakSet,hf=function(e){delete it(this,Ti)[it(this,gr)[e]][e]},Tb);function cy(t,e){t[e]?t[e]++:t[e]=1}function uy(t,e){--t[e]||delete t[e]}function Ba(t,e,n,i){var r=""+e,s=""+n;if(!t&&r>s){var o=r;r=s,s=o}return r+ly+s+ly+(i===void 0?CU:i)}function IU(t,e,n,i){var r=""+e,s=""+n;if(!t&&r>s){var o=r;r=s,s=o}var a={v:r,w:s};return i&&(a.name=i),a}function pd(t,e){return Ba(t,e.v,e.w,e.name)}var gg=PU,kU="2.1.13",OU={Graph:gg,version:kU},LU=gg,MU={write:DU,read:$U};function DU(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:NU(t),edges:RU(t)};return t.graph()!==void 0&&(e.value=structuredClone(t.graph())),e}function NU(t){return t.nodes().map(function(e){var n=t.node(e),i=t.parent(e),r={v:e};return n!==void 0&&(r.value=n),i!==void 0&&(r.parent=i),r})}function RU(t){return t.edges().map(function(e){var n=t.edge(e),i={v:e.v,w:e.w};return e.name!==void 0&&(i.name=e.name),n!==void 0&&(i.value=n),i})}function $U(t){var e=new LU(t.options).setGraph(t.value);return t.nodes.forEach(function(n){e.setNode(n.v,n.value),n.parent&&e.setParent(n.v,n.parent)}),t.edges.forEach(function(n){e.setEdge({v:n.v,w:n.w,name:n.name},n.value)}),e}var BU=FU;function FU(t){var e={},n=[],i;function r(s){e.hasOwnProperty(s)||(e[s]=!0,i.push(s),t.successors(s).forEach(r),t.predecessors(s).forEach(r))}return t.nodes().forEach(function(s){i=[],r(s),i.length&&n.push(i)}),n}var In,mr,ml,df,vl,ff,Ro,Hc,Ab;let VU=(Ab=class{constructor(){ze(this,ml);ze(this,vl);ze(this,Ro);ze(this,In,[]);ze(this,mr,{})}size(){return it(this,In).length}keys(){return it(this,In).map(function(e){return e.key})}has(e){return it(this,mr).hasOwnProperty(e)}priority(e){var n=it(this,mr)[e];if(n!==void 0)return it(this,In)[n].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return it(this,In)[0].key}add(e,n){var i=it(this,mr);if(e=String(e),!i.hasOwnProperty(e)){var r=it(this,In),s=r.length;return i[e]=s,r.push({key:e,priority:n}),$i(this,vl,ff).call(this,s),!0}return!1}removeMin(){$i(this,Ro,Hc).call(this,0,it(this,In).length-1);var e=it(this,In).pop();return delete it(this,mr)[e.key],$i(this,ml,df).call(this,0),e.key}decrease(e,n){var i=it(this,mr)[e];if(n>it(this,In)[i].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+it(this,In)[i].priority+" New: "+n);it(this,In)[i].priority=n,$i(this,vl,ff).call(this,i)}},In=new WeakMap,mr=new WeakMap,ml=new WeakSet,df=function(e){var n=it(this,In),i=2*e,r=i+1,s=e;i<n.length&&(s=n[i].priority<n[s].priority?i:s,r<n.length&&(s=n[r].priority<n[s].priority?r:s),s!==e&&($i(this,Ro,Hc).call(this,e,s),$i(this,ml,df).call(this,s)))},vl=new WeakSet,ff=function(e){for(var n=it(this,In),i=n[e].priority,r;e!==0&&(r=e>>1,!(n[r].priority<i));)$i(this,Ro,Hc).call(this,e,r),e=r},Ro=new WeakSet,Hc=function(e,n){var i=it(this,In),r=it(this,mr),s=i[e],o=i[n];i[e]=o,i[n]=s,r[o.key]=e,r[s.key]=n},Ab);var ES=VU,zU=ES,TS=HU,GU=()=>1;function HU(t,e,n,i){return UU(t,String(e),n||GU,i||function(r){return t.outEdges(r)})}function UU(t,e,n,i){var r={},s=new zU,o,a,l=function(c){var h=c.v!==o?c.v:c.w,u=r[h],d=n(c),f=a.distance+d;if(d<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+c+" Weight: "+d);f<u.distance&&(u.distance=f,u.predecessor=o,s.decrease(h,f))};for(t.nodes().forEach(function(c){var h=c===e?0:Number.POSITIVE_INFINITY;r[c]={distance:h},s.add(c,h)});s.size()>0&&(o=s.removeMin(),a=r[o],a.distance!==Number.POSITIVE_INFINITY);)i(o).forEach(l);return r}var jU=TS,WU=YU;function YU(t,e,n){return t.nodes().reduce(function(i,r){return i[r]=jU(t,r,e,n),i},{})}var AS=XU;function XU(t){var e=0,n=[],i={},r=[];function s(o){var a=i[o]={onStack:!0,lowlink:e,index:e++};if(n.push(o),t.successors(o).forEach(function(h){i.hasOwnProperty(h)?i[h].onStack&&(a.lowlink=Math.min(a.lowlink,i[h].index)):(s(h),a.lowlink=Math.min(a.lowlink,i[h].lowlink))}),a.lowlink===a.index){var l=[],c;do c=n.pop(),i[c].onStack=!1,l.push(c);while(o!==c);r.push(l)}}return t.nodes().forEach(function(o){i.hasOwnProperty(o)||s(o)}),r}var qU=AS,KU=ZU;function ZU(t){return qU(t).filter(function(e){return e.length>1||e.length===1&&t.hasEdge(e[0],e[0])})}var JU=t7,QU=()=>1;function t7(t,e,n){return e7(t,e||QU,n||function(i){return t.outEdges(i)})}function e7(t,e,n){var i={},r=t.nodes();return r.forEach(function(s){i[s]={},i[s][s]={distance:0},r.forEach(function(o){s!==o&&(i[s][o]={distance:Number.POSITIVE_INFINITY})}),n(s).forEach(function(o){var a=o.v===s?o.w:o.v,l=e(o);i[s][a]={distance:l,predecessor:s}})}),r.forEach(function(s){var o=i[s];r.forEach(function(a){var l=i[a];r.forEach(function(c){var h=l[s],u=o[c],d=l[c],f=h.distance+u.distance;f<d.distance&&(d.distance=f,d.predecessor=u.predecessor)})})}),i}function CS(t){var e={},n={},i=[];function r(s){if(n.hasOwnProperty(s))throw new pf;e.hasOwnProperty(s)||(n[s]=!0,e[s]=!0,t.predecessors(s).forEach(r),delete n[s],i.push(s))}if(t.sinks().forEach(r),Object.keys(e).length!==t.nodeCount())throw new pf;return i}class pf extends Error{constructor(){super(...arguments)}}var PS=CS;CS.CycleException=pf;var hy=PS,n7=i7;function i7(t){try{hy(t)}catch(e){if(e instanceof hy.CycleException)return!1;throw e}return!0}var IS=r7;function r7(t,e,n){Array.isArray(e)||(e=[e]);var i=t.isDirected()?a=>t.successors(a):a=>t.neighbors(a),r=n==="post"?s7:o7,s=[],o={};return e.forEach(a=>{if(!t.hasNode(a))throw new Error("Graph does not have node: "+a);r(a,i,o,s)}),s}function s7(t,e,n,i){for(var r=[[t,!1]];r.length>0;){var s=r.pop();s[1]?i.push(s[0]):n.hasOwnProperty(s[0])||(n[s[0]]=!0,r.push([s[0],!0]),kS(e(s[0]),o=>r.push([o,!1])))}}function o7(t,e,n,i){for(var r=[t];r.length>0;){var s=r.pop();n.hasOwnProperty(s)||(n[s]=!0,i.push(s),kS(e(s),o=>r.push(o)))}}function kS(t,e){for(var n=t.length;n--;)e(t[n],n,t);return t}var a7=IS,l7=c7;function c7(t,e){return a7(t,e,"post")}var u7=IS,h7=d7;function d7(t,e){return u7(t,e,"pre")}var f7=gg,p7=ES,g7=m7;function m7(t,e){var n=new f7,i={},r=new p7,s;function o(l){var c=l.v===s?l.w:l.v,h=r.priority(c);if(h!==void 0){var u=e(l);u<h&&(i[c]=s,r.decrease(c,u))}}if(t.nodeCount()===0)return n;t.nodes().forEach(function(l){r.add(l,Number.POSITIVE_INFINITY),n.setNode(l)}),r.decrease(t.nodes()[0],0);for(var a=!1;r.size()>0;){if(s=r.removeMin(),i.hasOwnProperty(s))n.setEdge(s,i[s]);else{if(a)throw new Error("Input graph is not connected: "+t);a=!0}t.nodeEdges(s).forEach(o)}return n}var v7={components:BU,dijkstra:TS,dijkstraAll:WU,findCycles:KU,floydWarshall:JU,isAcyclic:n7,postorder:l7,preorder:h7,prim:g7,tarjan:AS,topsort:PS},dy=OU,_i={Graph:dy.Graph,json:MU,alg:v7,version:dy.version};let y7=class{constructor(){let e={};e._next=e._prev=e,this._sentinel=e}dequeue(){let e=this._sentinel,n=e._prev;if(n!==e)return fy(n),n}enqueue(e){let n=this._sentinel;e._prev&&e._next&&fy(e),e._next=n._next,n._next._prev=e,n._next=e,e._prev=n}toString(){let e=[],n=this._sentinel,i=n._prev;for(;i!==n;)e.push(JSON.stringify(i,b7)),i=i._prev;return"["+e.join(", ")+"]"}};function fy(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function b7(t,e){if(t!=="_next"&&t!=="_prev")return e}var x7=y7;let w7=_i.Graph,_7=x7;var S7=T7;let E7=()=>1;function T7(t,e){if(t.nodeCount()<=1)return[];let n=C7(t,e||E7);return A7(n.graph,n.buckets,n.zeroIdx).flatMap(r=>t.outEdges(r.v,r.w))}function A7(t,e,n){let i=[],r=e[e.length-1],s=e[0],o;for(;t.nodeCount();){for(;o=s.dequeue();)gd(t,e,n,o);for(;o=r.dequeue();)gd(t,e,n,o);if(t.nodeCount()){for(let a=e.length-2;a>0;--a)if(o=e[a].dequeue(),o){i=i.concat(gd(t,e,n,o,!0));break}}}return i}function gd(t,e,n,i,r){let s=r?[]:void 0;return t.inEdges(i.v).forEach(o=>{let a=t.edge(o),l=t.node(o.v);r&&s.push({v:o.v,w:o.w}),l.out-=a,gf(e,n,l)}),t.outEdges(i.v).forEach(o=>{let a=t.edge(o),l=o.w,c=t.node(l);c.in-=a,gf(e,n,c)}),t.removeNode(i.v),s}function C7(t,e){let n=new w7,i=0,r=0;t.nodes().forEach(a=>{n.setNode(a,{v:a,in:0,out:0})}),t.edges().forEach(a=>{let l=n.edge(a.v,a.w)||0,c=e(a),h=l+c;n.setEdge(a.v,a.w,h),r=Math.max(r,n.node(a.v).out+=c),i=Math.max(i,n.node(a.w).in+=c)});let s=P7(r+i+3).map(()=>new _7),o=i+1;return n.nodes().forEach(a=>{gf(s,o,n.node(a))}),{graph:n,buckets:s,zeroIdx:o}}function gf(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}function P7(t){const e=[];for(let n=0;n<t;n++)e.push(n);return e}let OS=_i.Graph;var vn={addBorderNode:$7,addDummyNode:LS,asNonCompoundGraph:k7,buildLayerMatrix:D7,intersectRect:M7,mapValues:H7,maxRank:MS,normalizeRanks:N7,notime:V7,partition:B7,pick:G7,predecessorWeights:L7,range:NS,removeEmptyRanks:R7,simplify:I7,successorWeights:O7,time:F7,uniqueId:DS,zipObject:mg};function LS(t,e,n,i){let r;do r=DS(i);while(t.hasNode(r));return n.dummy=e,t.setNode(r,n),r}function I7(t){let e=new OS().setGraph(t.graph());return t.nodes().forEach(n=>e.setNode(n,t.node(n))),t.edges().forEach(n=>{let i=e.edge(n.v,n.w)||{weight:0,minlen:1},r=t.edge(n);e.setEdge(n.v,n.w,{weight:i.weight+r.weight,minlen:Math.max(i.minlen,r.minlen)})}),e}function k7(t){let e=new OS({multigraph:t.isMultigraph()}).setGraph(t.graph());return t.nodes().forEach(n=>{t.children(n).length||e.setNode(n,t.node(n))}),t.edges().forEach(n=>{e.setEdge(n,t.edge(n))}),e}function O7(t){let e=t.nodes().map(n=>{let i={};return t.outEdges(n).forEach(r=>{i[r.w]=(i[r.w]||0)+t.edge(r).weight}),i});return mg(t.nodes(),e)}function L7(t){let e=t.nodes().map(n=>{let i={};return t.inEdges(n).forEach(r=>{i[r.v]=(i[r.v]||0)+t.edge(r).weight}),i});return mg(t.nodes(),e)}function M7(t,e){let n=t.x,i=t.y,r=e.x-n,s=e.y-i,o=t.width/2,a=t.height/2;if(!r&&!s)throw new Error("Not possible to find intersection inside of the rectangle");let l,c;return Math.abs(s)*o>Math.abs(r)*a?(s<0&&(a=-a),l=a*r/s,c=a):(r<0&&(o=-o),l=o,c=o*s/r),{x:n+l,y:i+c}}function D7(t){let e=NS(MS(t)+1).map(()=>[]);return t.nodes().forEach(n=>{let i=t.node(n),r=i.rank;r!==void 0&&(e[r][i.order]=n)}),e}function N7(t){let e=Math.min(...t.nodes().map(n=>{let i=t.node(n).rank;return i===void 0?Number.MAX_VALUE:i}));t.nodes().forEach(n=>{let i=t.node(n);i.hasOwnProperty("rank")&&(i.rank-=e)})}function R7(t){let e=Math.min(...t.nodes().map(s=>t.node(s).rank)),n=[];t.nodes().forEach(s=>{let o=t.node(s).rank-e;n[o]||(n[o]=[]),n[o].push(s)});let i=0,r=t.graph().nodeRankFactor;Array.from(n).forEach((s,o)=>{s===void 0&&o%r!==0?--i:s!==void 0&&i&&s.forEach(a=>t.node(a).rank+=i)})}function $7(t,e,n,i){let r={width:0,height:0};return arguments.length>=4&&(r.rank=n,r.order=i),LS(t,"border",r,e)}function MS(t){return Math.max(...t.nodes().map(e=>{let n=t.node(e).rank;return n===void 0?Number.MIN_VALUE:n}))}function B7(t,e){let n={lhs:[],rhs:[]};return t.forEach(i=>{e(i)?n.lhs.push(i):n.rhs.push(i)}),n}function F7(t,e){let n=Date.now();try{return e()}finally{console.log(t+" time: "+(Date.now()-n)+"ms")}}function V7(t,e){return e()}let z7=0;function DS(t){var e=++z7;return toString(t)+e}function NS(t,e,n=1){e==null&&(e=t,t=0);let i=s=>s<e;n<0&&(i=s=>e<s);const r=[];for(let s=t;i(s);s+=n)r.push(s);return r}function G7(t,e){const n={};for(const i of e)t[i]!==void 0&&(n[i]=t[i]);return n}function H7(t,e){let n=e;return typeof e=="string"&&(n=i=>i[e]),Object.entries(t).reduce((i,[r,s])=>(i[r]=n(s,r),i),{})}function mg(t,e){return t.reduce((n,i,r)=>(n[i]=e[r],n),{})}let U7=S7,j7=vn.uniqueId;var W7={run:Y7,undo:q7};function Y7(t){(t.graph().acyclicer==="greedy"?U7(t,n(t)):X7(t)).forEach(i=>{let r=t.edge(i);t.removeEdge(i),r.forwardName=i.name,r.reversed=!0,t.setEdge(i.w,i.v,r,j7("rev"))});function n(i){return r=>i.edge(r).weight}}function X7(t){let e=[],n={},i={};function r(s){i.hasOwnProperty(s)||(i[s]=!0,n[s]=!0,t.outEdges(s).forEach(o=>{n.hasOwnProperty(o.w)?e.push(o):r(o.w)}),delete n[s])}return t.nodes().forEach(r),e}function q7(t){t.edges().forEach(e=>{let n=t.edge(e);if(n.reversed){t.removeEdge(e);let i=n.forwardName;delete n.reversed,delete n.forwardName,t.setEdge(e.w,e.v,n,i)}})}let K7=vn;var Z7={run:J7,undo:t9};function J7(t){t.graph().dummyChains=[],t.edges().forEach(e=>Q7(t,e))}function Q7(t,e){let n=e.v,i=t.node(n).rank,r=e.w,s=t.node(r).rank,o=e.name,a=t.edge(e),l=a.labelRank;if(s===i+1)return;t.removeEdge(e);let c,h,u;for(u=0,++i;i<s;++u,++i)a.points=[],h={width:0,height:0,edgeLabel:a,edgeObj:e,rank:i},c=K7.addDummyNode(t,"edge",h,"_d"),i===l&&(h.width=a.width,h.height=a.height,h.dummy="edge-label",h.labelpos=a.labelpos),t.setEdge(n,c,{weight:a.weight},o),u===0&&t.graph().dummyChains.push(c),n=c;t.setEdge(n,r,{weight:a.weight},o)}function t9(t){t.graph().dummyChains.forEach(e=>{let n=t.node(e),i=n.edgeLabel,r;for(t.setEdge(n.edgeObj,i);n.dummy;)r=t.successors(e)[0],t.removeNode(e),i.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height),e=r,n=t.node(e)})}var ph={longestPath:e9,slack:n9};function e9(t){var e={};function n(i){var r=t.node(i);if(e.hasOwnProperty(i))return r.rank;e[i]=!0;var s=Math.min(...t.outEdges(i).map(o=>o==null?Number.POSITIVE_INFINITY:n(o.w)-t.edge(o).minlen));return s===Number.POSITIVE_INFINITY&&(s=0),r.rank=s}t.sources().forEach(n)}function n9(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}var i9=_i.Graph,gu=ph.slack,RS=r9;function r9(t){var e=new i9({directed:!1}),n=t.nodes()[0],i=t.nodeCount();e.setNode(n,{});for(var r,s;s9(e,t)<i;)r=o9(e,t),s=e.hasNode(r.v)?gu(t,r):-gu(t,r),a9(e,t,s);return e}function s9(t,e){function n(i){e.nodeEdges(i).forEach(r=>{var s=r.v,o=i===s?r.w:s;!t.hasNode(o)&&!gu(e,r)&&(t.setNode(o,{}),t.setEdge(i,o,{}),n(o))})}return t.nodes().forEach(n),t.nodeCount()}function o9(t,e){return e.edges().reduce((i,r)=>{let s=Number.POSITIVE_INFINITY;return t.hasNode(r.v)!==t.hasNode(r.w)&&(s=gu(e,r)),s<i[0]?[s,r]:i},[Number.POSITIVE_INFINITY,null])[1]}function a9(t,e,n){t.nodes().forEach(i=>e.node(i).rank+=n)}var l9=RS,py=ph.slack,c9=ph.longestPath,u9=_i.alg.preorder,h9=_i.alg.postorder,d9=vn.simplify,f9=Ks;Ks.initLowLimValues=yg;Ks.initCutValues=vg;Ks.calcCutValue=$S;Ks.leaveEdge=FS;Ks.enterEdge=VS;Ks.exchangeEdges=zS;function Ks(t){t=d9(t),c9(t);var e=l9(t);yg(e),vg(e,t);for(var n,i;n=FS(e);)i=VS(e,t,n),zS(e,t,n,i)}function vg(t,e){var n=h9(t,t.nodes());n=n.slice(0,n.length-1),n.forEach(i=>p9(t,e,i))}function p9(t,e,n){var i=t.node(n),r=i.parent;t.edge(n,r).cutvalue=$S(t,e,n)}function $S(t,e,n){var i=t.node(n),r=i.parent,s=!0,o=e.edge(n,r),a=0;return o||(s=!1,o=e.edge(r,n)),a=o.weight,e.nodeEdges(n).forEach(l=>{var c=l.v===n,h=c?l.w:l.v;if(h!==r){var u=c===s,d=e.edge(l).weight;if(a+=u?d:-d,m9(t,n,h)){var f=t.edge(n,h).cutvalue;a+=u?-f:f}}}),a}function yg(t,e){arguments.length<2&&(e=t.nodes()[0]),BS(t,{},1,e)}function BS(t,e,n,i,r){var s=n,o=t.node(i);return e[i]=!0,t.neighbors(i).forEach(a=>{e.hasOwnProperty(a)||(n=BS(t,e,n,a,i))}),o.low=s,o.lim=n++,r?o.parent=r:delete o.parent,n}function FS(t){return t.edges().find(e=>t.edge(e).cutvalue<0)}function VS(t,e,n){var i=n.v,r=n.w;e.hasEdge(i,r)||(i=n.w,r=n.v);var s=t.node(i),o=t.node(r),a=s,l=!1;s.lim>o.lim&&(a=o,l=!0);var c=e.edges().filter(h=>l===gy(t,t.node(h.v),a)&&l!==gy(t,t.node(h.w),a));return c.reduce((h,u)=>py(e,u)<py(e,h)?u:h)}function zS(t,e,n,i){var r=n.v,s=n.w;t.removeEdge(r,s),t.setEdge(i.v,i.w,{}),yg(t),vg(t,e),g9(t,e)}function g9(t,e){var n=t.nodes().find(r=>!e.node(r).parent),i=u9(t,n);i=i.slice(1),i.forEach(r=>{var s=t.node(r).parent,o=e.edge(r,s),a=!1;o||(o=e.edge(s,r),a=!0),e.node(r).rank=e.node(s).rank+(a?o.minlen:-o.minlen)})}function m9(t,e,n){return t.hasEdge(e,n)}function gy(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}var v9=ph,GS=v9.longestPath,y9=RS,b9=f9,x9=w9;function w9(t){switch(t.graph().ranker){case"network-simplex":my(t);break;case"tight-tree":S9(t);break;case"longest-path":_9(t);break;default:my(t)}}var _9=GS;function S9(t){GS(t),y9(t)}function my(t){b9(t)}var E9=T9;function T9(t){let e=C9(t);t.graph().dummyChains.forEach(n=>{let i=t.node(n),r=i.edgeObj,s=A9(t,e,r.v,r.w),o=s.path,a=s.lca,l=0,c=o[l],h=!0;for(;n!==r.w;){if(i=t.node(n),h){for(;(c=o[l])!==a&&t.node(c).maxRank<i.rank;)l++;c===a&&(h=!1)}if(!h){for(;l<o.length-1&&t.node(c=o[l+1]).minRank<=i.rank;)l++;c=o[l]}t.setParent(n,c),n=t.successors(n)[0]}})}function A9(t,e,n,i){let r=[],s=[],o=Math.min(e[n].low,e[i].low),a=Math.max(e[n].lim,e[i].lim),l,c;l=n;do l=t.parent(l),r.push(l);while(l&&(e[l].low>o||a>e[l].lim));for(c=l,l=i;(l=t.parent(l))!==c;)s.push(l);return{path:r.concat(s.reverse()),lca:c}}function C9(t){let e={},n=0;function i(r){let s=n;t.children(r).forEach(i),e[r]={low:s,lim:n++}}return t.children().forEach(i),e}let mf=vn;var P9={run:I9,cleanup:L9};function I9(t){let e=mf.addDummyNode(t,"root",{},"_root"),n=k9(t),i=Math.max(...Object.values(n))-1,r=2*i+1;t.graph().nestingRoot=e,t.edges().forEach(o=>t.edge(o).minlen*=r);let s=O9(t)+1;t.children().forEach(o=>HS(t,e,r,s,i,n,o)),t.graph().nodeRankFactor=r}function HS(t,e,n,i,r,s,o){let a=t.children(o);if(!a.length){o!==e&&t.setEdge(e,o,{weight:0,minlen:n});return}let l=mf.addBorderNode(t,"_bt"),c=mf.addBorderNode(t,"_bb"),h=t.node(o);t.setParent(l,o),h.borderTop=l,t.setParent(c,o),h.borderBottom=c,a.forEach(u=>{HS(t,e,n,i,r,s,u);let d=t.node(u),f=d.borderTop?d.borderTop:u,p=d.borderBottom?d.borderBottom:u,g=d.borderTop?i:2*i,v=f!==p?1:r-s[o]+1;t.setEdge(l,f,{weight:g,minlen:v,nestingEdge:!0}),t.setEdge(p,c,{weight:g,minlen:v,nestingEdge:!0})}),t.parent(o)||t.setEdge(e,l,{weight:0,minlen:r+s[o]})}function k9(t){var e={};function n(i,r){var s=t.children(i);s&&s.length&&s.forEach(o=>n(o,r+1)),e[i]=r}return t.children().forEach(i=>n(i,1)),e}function O9(t){return t.edges().reduce((e,n)=>e+t.edge(n).weight,0)}function L9(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,t.edges().forEach(n=>{var i=t.edge(n);i.nestingEdge&&t.removeEdge(n)})}let M9=vn;var D9=N9;function N9(t){function e(n){let i=t.children(n),r=t.node(n);if(i.length&&i.forEach(e),r.hasOwnProperty("minRank")){r.borderLeft=[],r.borderRight=[];for(let s=r.minRank,o=r.maxRank+1;s<o;++s)vy(t,"borderLeft","_bl",n,r,s),vy(t,"borderRight","_br",n,r,s)}}t.children().forEach(e)}function vy(t,e,n,i,r,s){let o={width:0,height:0,rank:s,borderType:e},a=r[e][s-1],l=M9.addDummyNode(t,"border",o,n);r[e][s]=l,t.setParent(l,i),a&&t.setEdge(a,l,{weight:1})}var R9={adjust:$9,undo:B9};function $9(t){let e=t.graph().rankdir.toLowerCase();(e==="lr"||e==="rl")&&US(t)}function B9(t){let e=t.graph().rankdir.toLowerCase();(e==="bt"||e==="rl")&&F9(t),(e==="lr"||e==="rl")&&(V9(t),US(t))}function US(t){t.nodes().forEach(e=>yy(t.node(e))),t.edges().forEach(e=>yy(t.edge(e)))}function yy(t){let e=t.width;t.width=t.height,t.height=e}function F9(t){t.nodes().forEach(e=>md(t.node(e))),t.edges().forEach(e=>{let n=t.edge(e);n.points.forEach(md),n.hasOwnProperty("y")&&md(n)})}function md(t){t.y=-t.y}function V9(t){t.nodes().forEach(e=>vd(t.node(e))),t.edges().forEach(e=>{let n=t.edge(e);n.points.forEach(vd),n.hasOwnProperty("x")&&vd(n)})}function vd(t){let e=t.x;t.x=t.y,t.y=e}let z9=vn;var G9=H9;function H9(t){let e={},n=t.nodes().filter(a=>!t.children(a).length),i=Math.max(...n.map(a=>t.node(a).rank)),r=z9.range(i+1).map(()=>[]);function s(a){if(e[a])return;e[a]=!0;let l=t.node(a);r[l.rank].push(a),t.successors(a).forEach(s)}return n.sort((a,l)=>t.node(a).rank-t.node(l).rank).forEach(s),r}let U9=vn.zipObject;var j9=W9;function W9(t,e){let n=0;for(let i=1;i<e.length;++i)n+=Y9(t,e[i-1],e[i]);return n}function Y9(t,e,n){let i=U9(n,n.map((c,h)=>h)),r=e.flatMap(c=>t.outEdges(c).map(h=>({pos:i[h.w],weight:t.edge(h).weight})).sort((h,u)=>h.pos-u.pos)),s=1;for(;s<n.length;)s<<=1;let o=2*s-1;s-=1;let a=new Array(o).fill(0),l=0;return r.forEach(c=>{let h=c.pos+s;a[h]+=c.weight;let u=0;for(;h>0;)h%2&&(u+=a[h+1]),h=h-1>>1,a[h]+=c.weight;l+=c.weight*u}),l}var X9=q9;function q9(t,e=[]){return e.map(n=>{let i=t.inEdges(n);if(i.length){let r=i.reduce((s,o)=>{let a=t.edge(o),l=t.node(o.v);return{sum:s.sum+a.weight*l.order,weight:s.weight+a.weight}},{sum:0,weight:0});return{v:n,barycenter:r.sum/r.weight,weight:r.weight}}else return{v:n}})}let K9=vn;var Z9=J9;function J9(t,e){let n={};t.forEach((r,s)=>{let o=n[r.v]={indegree:0,in:[],out:[],vs:[r.v],i:s};r.barycenter!==void 0&&(o.barycenter=r.barycenter,o.weight=r.weight)}),e.edges().forEach(r=>{let s=n[r.v],o=n[r.w];s!==void 0&&o!==void 0&&(o.indegree++,s.out.push(n[r.w]))});let i=Object.values(n).filter(r=>!r.indegree);return Q9(i)}function Q9(t){let e=[];function n(r){return s=>{s.merged||(s.barycenter===void 0||r.barycenter===void 0||s.barycenter>=r.barycenter)&&tj(r,s)}}function i(r){return s=>{s.in.push(r),--s.indegree===0&&t.push(s)}}for(;t.length;){let r=t.pop();e.push(r),r.in.reverse().forEach(n(r)),r.out.forEach(i(r))}return e.filter(r=>!r.merged).map(r=>K9.pick(r,["vs","i","barycenter","weight"]))}function tj(t,e){let n=0,i=0;t.weight&&(n+=t.barycenter*t.weight,i+=t.weight),e.weight&&(n+=e.barycenter*e.weight,i+=e.weight),t.vs=e.vs.concat(t.vs),t.barycenter=n/i,t.weight=i,t.i=Math.min(e.i,t.i),e.merged=!0}let ej=vn;var nj=ij;function ij(t,e){let n=ej.partition(t,h=>h.hasOwnProperty("barycenter")),i=n.lhs,r=n.rhs.sort((h,u)=>u.i-h.i),s=[],o=0,a=0,l=0;i.sort(rj(!!e)),l=by(s,r,l),i.forEach(h=>{l+=h.vs.length,s.push(h.vs),o+=h.barycenter*h.weight,a+=h.weight,l=by(s,r,l)});let c={vs:s.flat(!0)};return a&&(c.barycenter=o/a,c.weight=a),c}function by(t,e,n){let i;for(;e.length&&(i=e[e.length-1]).i<=n;)e.pop(),t.push(i.vs),n++;return n}function rj(t){return(e,n)=>e.barycenter<n.barycenter?-1:e.barycenter>n.barycenter?1:t?n.i-e.i:e.i-n.i}let sj=X9,oj=Z9,aj=nj;var lj=jS;function jS(t,e,n,i){let r=t.children(e),s=t.node(e),o=s?s.borderLeft:void 0,a=s?s.borderRight:void 0,l={};o&&(r=r.filter(d=>d!==o&&d!==a));let c=sj(t,r);c.forEach(d=>{if(t.children(d.v).length){let f=jS(t,d.v,n,i);l[d.v]=f,f.hasOwnProperty("barycenter")&&uj(d,f)}});let h=oj(c,n);cj(h,l);let u=aj(h,i);if(o&&(u.vs=[o,u.vs,a].flat(!0),t.predecessors(o).length)){let d=t.node(t.predecessors(o)[0]),f=t.node(t.predecessors(a)[0]);u.hasOwnProperty("barycenter")||(u.barycenter=0,u.weight=0),u.barycenter=(u.barycenter*u.weight+d.order+f.order)/(u.weight+2),u.weight+=2}return u}function cj(t,e){t.forEach(n=>{n.vs=n.vs.flatMap(i=>e[i]?e[i].vs:i)})}function uj(t,e){t.barycenter!==void 0?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)}let hj=_i.Graph,dj=vn;var fj=pj;function pj(t,e,n){let i=gj(t),r=new hj({compound:!0}).setGraph({root:i}).setDefaultNodeLabel(s=>t.node(s));return t.nodes().forEach(s=>{let o=t.node(s),a=t.parent(s);(o.rank===e||o.minRank<=e&&e<=o.maxRank)&&(r.setNode(s),r.setParent(s,a||i),t[n](s).forEach(l=>{let c=l.v===s?l.w:l.v,h=r.edge(c,s),u=h!==void 0?h.weight:0;r.setEdge(c,s,{weight:t.edge(l).weight+u})}),o.hasOwnProperty("minRank")&&r.setNode(s,{borderLeft:o.borderLeft[e],borderRight:o.borderRight[e]}))}),r}function gj(t){for(var e;t.hasNode(e=dj.uniqueId("_root")););return e}var mj=vj;function vj(t,e,n){let i={},r;n.forEach(s=>{let o=t.parent(s),a,l;for(;o;){if(a=t.parent(o),a?(l=i[a],i[a]=o):(l=r,r=o),l&&l!==o){e.setEdge(l,o);return}o=a}})}let yj=G9,bj=j9,xj=lj,wj=fj,_j=mj,Sj=_i.Graph,Ac=vn;var Ej=Tj;function Tj(t){let e=Ac.maxRank(t),n=xy(t,Ac.range(1,e+1),"inEdges"),i=xy(t,Ac.range(e-1,-1,-1),"outEdges"),r=yj(t);wy(t,r);let s=Number.POSITIVE_INFINITY,o;for(let a=0,l=0;l<4;++a,++l){Aj(a%2?n:i,a%4>=2),r=Ac.buildLayerMatrix(t);let c=bj(t,r);c<s&&(l=0,o=Object.assign({},r),s=c)}wy(t,o)}function xy(t,e,n){return e.map(function(i){return wj(t,i,n)})}function Aj(t,e){let n=new Sj;t.forEach(function(i){let r=i.graph().root,s=xj(i,r,n,e);s.vs.forEach((o,a)=>i.node(o).order=a),_j(i,n,s.vs)})}function wy(t,e){Object.values(e).forEach(n=>n.forEach((i,r)=>t.node(i).order=r))}let Cj=_i.Graph,ul=vn;var Pj={positionX:Oj,findType1Conflicts:WS,findType2Conflicts:YS,addConflict:bg,hasConflict:XS,verticalAlignment:qS,horizontalCompaction:KS,alignCoordinates:JS,findSmallestWidthAlignment:ZS,balance:QS};function WS(t,e){let n={};function i(r,s){let o=0,a=0,l=r.length,c=s[s.length-1];return s.forEach((h,u)=>{let d=Ij(t,h),f=d?t.node(d).order:l;(d||h===c)&&(s.slice(a,u+1).forEach(p=>{t.predecessors(p).forEach(g=>{let v=t.node(g),x=v.order;(x<o||f<x)&&!(v.dummy&&t.node(p).dummy)&&bg(n,g,p)})}),a=u+1,o=f)}),s}return e.reduce(i),n}function YS(t,e){let n={};function i(s,o,a,l,c){let h;ul.range(o,a).forEach(u=>{h=s[u],t.node(h).dummy&&t.predecessors(h).forEach(d=>{let f=t.node(d);f.dummy&&(f.order<l||f.order>c)&&bg(n,d,h)})})}function r(s,o){let a=-1,l,c=0;return o.forEach((h,u)=>{if(t.node(h).dummy==="border"){let d=t.predecessors(h);d.length&&(l=t.node(d[0]).order,i(o,c,u,a,l),c=u,a=l)}i(o,c,o.length,l,s.length)}),o}return e.reduce(r),n}function Ij(t,e){if(t.node(e).dummy)return t.predecessors(e).find(n=>t.node(n).dummy)}function bg(t,e,n){if(e>n){let r=e;e=n,n=r}let i=t[e];i||(t[e]=i={}),i[n]=!0}function XS(t,e,n){if(e>n){let i=e;e=n,n=i}return!!t[e]&&t[e].hasOwnProperty(n)}function qS(t,e,n,i){let r={},s={},o={};return e.forEach(a=>{a.forEach((l,c)=>{r[l]=l,s[l]=l,o[l]=c})}),e.forEach(a=>{let l=-1;a.forEach(c=>{let h=i(c);if(h.length){h=h.sort((d,f)=>o[d]-o[f]);let u=(h.length-1)/2;for(let d=Math.floor(u),f=Math.ceil(u);d<=f;++d){let p=h[d];s[c]===c&&l<o[p]&&!XS(n,c,p)&&(s[p]=c,s[c]=r[c]=r[p],l=o[p])}}})}),{root:r,align:s}}function KS(t,e,n,i,r){let s={},o=kj(t,e,n,r),a=r?"borderLeft":"borderRight";function l(u,d){let f=o.nodes(),p=f.pop(),g={};for(;p;)g[p]?u(p):(g[p]=!0,f.push(p),f=f.concat(d(p))),p=f.pop()}function c(u){s[u]=o.inEdges(u).reduce((d,f)=>Math.max(d,s[f.v]+o.edge(f)),0)}function h(u){let d=o.outEdges(u).reduce((p,g)=>Math.min(p,s[g.w]-o.edge(g)),Number.POSITIVE_INFINITY),f=t.node(u);d!==Number.POSITIVE_INFINITY&&f.borderType!==a&&(s[u]=Math.max(s[u],d))}return l(c,o.predecessors.bind(o)),l(h,o.successors.bind(o)),Object.keys(i).forEach(u=>s[u]=s[n[u]]),s}function kj(t,e,n,i){let r=new Cj,s=t.graph(),o=Lj(s.nodesep,s.edgesep,i);return e.forEach(a=>{let l;a.forEach(c=>{let h=n[c];if(r.setNode(h),l){var u=n[l],d=r.edge(u,h);r.setEdge(u,h,Math.max(o(t,c,l),d||0))}l=c})}),r}function ZS(t,e){return Object.values(e).reduce((n,i)=>{let r=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;Object.entries(i).forEach(([a,l])=>{let c=Mj(t,a)/2;r=Math.max(l+c,r),s=Math.min(l-c,s)});const o=r-s;return o<n[0]&&(n=[o,i]),n},[Number.POSITIVE_INFINITY,null])[1]}function JS(t,e){let n=Object.values(e),i=Math.min(...n),r=Math.max(...n);["u","d"].forEach(s=>{["l","r"].forEach(o=>{let a=s+o,l=t[a];if(l===e)return;let c=Object.values(l),h=i-Math.min(...c);o!=="l"&&(h=r-Math.max(...c)),h&&(t[a]=ul.mapValues(l,u=>u+h))})})}function QS(t,e){return ul.mapValues(t.ul,(n,i)=>{if(e)return t[e.toLowerCase()][i];{let r=Object.values(t).map(s=>s[i]).sort((s,o)=>s-o);return(r[1]+r[2])/2}})}function Oj(t){let e=ul.buildLayerMatrix(t),n=Object.assign(WS(t,e),YS(t,e)),i={},r;["u","d"].forEach(o=>{r=o==="u"?e:Object.values(e).reverse(),["l","r"].forEach(a=>{a==="r"&&(r=r.map(u=>Object.values(u).reverse()));let l=(o==="u"?t.predecessors:t.successors).bind(t),c=qS(t,r,n,l),h=KS(t,r,c.root,c.align,a==="r");a==="r"&&(h=ul.mapValues(h,u=>-u)),i[o+a]=h})});let s=ZS(t,i);return JS(i,s),QS(i,t.graph().align)}function Lj(t,e,n){return(i,r,s)=>{let o=i.node(r),a=i.node(s),l=0,c;if(l+=o.width/2,o.hasOwnProperty("labelpos"))switch(o.labelpos.toLowerCase()){case"l":c=-o.width/2;break;case"r":c=o.width/2;break}if(c&&(l+=n?c:-c),c=0,l+=(o.dummy?e:t)/2,l+=(a.dummy?e:t)/2,l+=a.width/2,a.hasOwnProperty("labelpos"))switch(a.labelpos.toLowerCase()){case"l":c=a.width/2;break;case"r":c=-a.width/2;break}return c&&(l+=n?c:-c),c=0,l}}function Mj(t,e){return t.node(e).width}let t1=vn,Dj=Pj.positionX;var Nj=Rj;function Rj(t){t=t1.asNonCompoundGraph(t),$j(t),Object.entries(Dj(t)).forEach(([e,n])=>t.node(e).x=n)}function $j(t){let e=t1.buildLayerMatrix(t),n=t.graph().ranksep,i=0;e.forEach(r=>{const s=r.reduce((o,a)=>{const l=t.node(a).height;return o>l?o:l},0);r.forEach(o=>t.node(o).y=i+s/2),i+=s+n})}let _y=W7,Sy=Z7,Bj=x9,Fj=vn.normalizeRanks,Vj=E9,zj=vn.removeEmptyRanks,Ey=P9,Gj=D9,Ty=R9,Hj=Ej,Uj=Nj,bi=vn,jj=_i.Graph;var Wj=Yj;function Yj(t,e){let n=e&&e.debugTiming?bi.time:bi.notime;n("layout",()=>{let i=n("  buildLayoutGraph",()=>iW(t));n("  runLayout",()=>Xj(i,n)),n("  updateInputGraph",()=>qj(t,i))})}function Xj(t,e){e("    makeSpaceForEdgeLabels",()=>rW(t)),e("    removeSelfEdges",()=>fW(t)),e("    acyclic",()=>_y.run(t)),e("    nestingGraph.run",()=>Ey.run(t)),e("    rank",()=>Bj(bi.asNonCompoundGraph(t))),e("    injectEdgeLabelProxies",()=>sW(t)),e("    removeEmptyRanks",()=>zj(t)),e("    nestingGraph.cleanup",()=>Ey.cleanup(t)),e("    normalizeRanks",()=>Fj(t)),e("    assignRankMinMax",()=>oW(t)),e("    removeEdgeLabelProxies",()=>aW(t)),e("    normalize.run",()=>Sy.run(t)),e("    parentDummyChains",()=>Vj(t)),e("    addBorderSegments",()=>Gj(t)),e("    order",()=>Hj(t)),e("    insertSelfEdges",()=>pW(t)),e("    adjustCoordinateSystem",()=>Ty.adjust(t)),e("    position",()=>Uj(t)),e("    positionSelfEdges",()=>gW(t)),e("    removeBorderNodes",()=>dW(t)),e("    normalize.undo",()=>Sy.undo(t)),e("    fixupEdgeLabelCoords",()=>uW(t)),e("    undoCoordinateSystem",()=>Ty.undo(t)),e("    translateGraph",()=>lW(t)),e("    assignNodeIntersects",()=>cW(t)),e("    reversePoints",()=>hW(t)),e("    acyclic.undo",()=>_y.undo(t))}function qj(t,e){t.nodes().forEach(n=>{let i=t.node(n),r=e.node(n);i&&(i.x=r.x,i.y=r.y,i.rank=r.rank,e.children(n).length&&(i.width=r.width,i.height=r.height))}),t.edges().forEach(n=>{let i=t.edge(n),r=e.edge(n);i.points=r.points,r.hasOwnProperty("x")&&(i.x=r.x,i.y=r.y)}),t.graph().width=e.graph().width,t.graph().height=e.graph().height}let Kj=["nodesep","edgesep","ranksep","marginx","marginy"],Zj={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Jj=["acyclicer","ranker","rankdir","align"],Qj=["width","height"],Ay={width:0,height:0},tW=["minlen","weight","width","height","labeloffset"],eW={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},nW=["labelpos"];function iW(t){let e=new jj({multigraph:!0,compound:!0}),n=bd(t.graph());return e.setGraph(Object.assign({},Zj,yd(n,Kj),bi.pick(n,Jj))),t.nodes().forEach(i=>{let r=bd(t.node(i));const s=yd(r,Qj);Object.keys(Ay).forEach(o=>{s[o]===void 0&&(s[o]=Ay[o])}),e.setNode(i,s),e.setParent(i,t.parent(i))}),t.edges().forEach(i=>{let r=bd(t.edge(i));e.setEdge(i,Object.assign({},eW,yd(r,tW),bi.pick(r,nW)))}),e}function rW(t){let e=t.graph();e.ranksep/=2,t.edges().forEach(n=>{let i=t.edge(n);i.minlen*=2,i.labelpos.toLowerCase()!=="c"&&(e.rankdir==="TB"||e.rankdir==="BT"?i.width+=i.labeloffset:i.height+=i.labeloffset)})}function sW(t){t.edges().forEach(e=>{let n=t.edge(e);if(n.width&&n.height){let i=t.node(e.v),s={rank:(t.node(e.w).rank-i.rank)/2+i.rank,e};bi.addDummyNode(t,"edge-proxy",s,"_ep")}})}function oW(t){let e=0;t.nodes().forEach(n=>{let i=t.node(n);i.borderTop&&(i.minRank=t.node(i.borderTop).rank,i.maxRank=t.node(i.borderBottom).rank,e=Math.max(e,i.maxRank))}),t.graph().maxRank=e}function aW(t){t.nodes().forEach(e=>{let n=t.node(e);n.dummy==="edge-proxy"&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e))})}function lW(t){let e=Number.POSITIVE_INFINITY,n=0,i=Number.POSITIVE_INFINITY,r=0,s=t.graph(),o=s.marginx||0,a=s.marginy||0;function l(c){let h=c.x,u=c.y,d=c.width,f=c.height;e=Math.min(e,h-d/2),n=Math.max(n,h+d/2),i=Math.min(i,u-f/2),r=Math.max(r,u+f/2)}t.nodes().forEach(c=>l(t.node(c))),t.edges().forEach(c=>{let h=t.edge(c);h.hasOwnProperty("x")&&l(h)}),e-=o,i-=a,t.nodes().forEach(c=>{let h=t.node(c);h.x-=e,h.y-=i}),t.edges().forEach(c=>{let h=t.edge(c);h.points.forEach(u=>{u.x-=e,u.y-=i}),h.hasOwnProperty("x")&&(h.x-=e),h.hasOwnProperty("y")&&(h.y-=i)}),s.width=n-e+o,s.height=r-i+a}function cW(t){t.edges().forEach(e=>{let n=t.edge(e),i=t.node(e.v),r=t.node(e.w),s,o;n.points?(s=n.points[0],o=n.points[n.points.length-1]):(n.points=[],s=r,o=i),n.points.unshift(bi.intersectRect(i,s)),n.points.push(bi.intersectRect(r,o))})}function uW(t){t.edges().forEach(e=>{let n=t.edge(e);if(n.hasOwnProperty("x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function hW(t){t.edges().forEach(e=>{let n=t.edge(e);n.reversed&&n.points.reverse()})}function dW(t){t.nodes().forEach(e=>{if(t.children(e).length){let n=t.node(e),i=t.node(n.borderTop),r=t.node(n.borderBottom),s=t.node(n.borderLeft[n.borderLeft.length-1]),o=t.node(n.borderRight[n.borderRight.length-1]);n.width=Math.abs(o.x-s.x),n.height=Math.abs(r.y-i.y),n.x=s.x+n.width/2,n.y=i.y+n.height/2}}),t.nodes().forEach(e=>{t.node(e).dummy==="border"&&t.removeNode(e)})}function fW(t){t.edges().forEach(e=>{if(e.v===e.w){var n=t.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e,label:t.edge(e)}),t.removeEdge(e)}})}function pW(t){var e=bi.buildLayerMatrix(t);e.forEach(n=>{var i=0;n.forEach((r,s)=>{var o=t.node(r);o.order=s+i,(o.selfEdges||[]).forEach(a=>{bi.addDummyNode(t,"selfedge",{width:a.label.width,height:a.label.height,rank:o.rank,order:s+ ++i,e:a.e,label:a.label},"_se")}),delete o.selfEdges})})}function gW(t){t.nodes().forEach(e=>{var n=t.node(e);if(n.dummy==="selfedge"){var i=t.node(n.e.v),r=i.x+i.width/2,s=i.y,o=n.x-r,a=i.height/2;t.setEdge(n.e,n.label),t.removeNode(e),n.label.points=[{x:r+2*o/3,y:s-a},{x:r+5*o/6,y:s-a},{x:r+o,y:s},{x:r+5*o/6,y:s+a},{x:r+2*o/3,y:s+a}],n.label.x=n.x,n.label.y=n.y}})}function yd(t,e){return bi.mapValues(bi.pick(t,e),Number)}function bd(t){var e={};return t&&Object.entries(t).forEach(([n,i])=>{typeof n=="string"&&(n=n.toLowerCase()),e[n]=i}),e}let mW=vn,vW=_i.Graph;var yW={debugOrdering:bW};function bW(t){let e=mW.buildLayerMatrix(t),n=new vW({compound:!0,multigraph:!0}).setGraph({});return t.nodes().forEach(i=>{n.setNode(i,{label:i}),n.setParent(i,"layer"+t.node(i).rank)}),t.edges().forEach(i=>n.setEdge(i.v,i.w,{},i.name)),e.forEach((i,r)=>{let s="layer"+r;n.setNode(s,{rank:"same"}),i.reduce((o,a)=>(n.setEdge(o,a,{style:"invis"}),a))}),n}var xW="1.0.4",wW={graphlib:_i,layout:Wj,debug:yW,util:{time:vn.time,notime:vn.notime},version:xW};const vf={exportElement:function(t){return t.size()},exportLink:function(t){var e=t.get("labelSize")||{},n={minLen:t.get("minLen")||1,weight:t.get("weight")||1,labelpos:t.get("labelPosition")||"c",labeloffset:t.get("labelOffset")||0,width:e.width||0,height:e.height||0};return n},importElement:function(t,e,n){var i=this.getCell(e),r=n.node(e);t.setPosition?t.setPosition(i,r):i.set("position",{x:r.x-r.width/2,y:r.y-r.height/2})},importLink:function(t,e,n){const r=this.getCell(e.name),s=n.edge(e),o=s.points||[],a=new _e(o);if(t.setVertices||t.setLinkVertices)if(_t(t.setVertices))t.setVertices(r,o);else{a.simplify({threshold:.001});const l=a.points.map(h=>h.toJSON()),c=l.length;r.set("vertices",l.slice(1,c-1))}if(t.setLabels&&"x"in s&&"y"in s){const l={x:s.x,y:s.y};if(_t(t.setLabels))t.setLabels(r,l,o);else{const c=a.closestPointLength(l),h=a.pointAtLength(c),u=c/a.length(),d=new M(l).difference(h).toJSON();r.label(0,{position:{distance:u,offset:d}})}}},layout:function(t,e){var n;t instanceof On?n=t:n=new On().resetCells(t,{dry:!0,sort:!1}),t=null,e=me(e||{},{resizeClusters:!0,clusterPadding:10,exportElement:this.exportElement,exportLink:this.exportLink});var i=vf.toGraphLib(n,{directed:!0,multigraph:!0,compound:!0,setNodeLabel:e.exportElement,setEdgeLabel:e.exportLink,setEdgeName:function(c){return c.id}}),r={},s=e.marginX||0,o=e.marginY||0;if(e.rankDir&&(r.rankdir=e.rankDir),e.align&&(r.align=e.align),e.nodeSep&&(r.nodesep=e.nodeSep),e.edgeSep&&(r.edgesep=e.edgeSep),e.rankSep&&(r.ranksep=e.rankSep),e.ranker&&(r.ranker=e.ranker),s&&(r.marginx=s),o&&(r.marginy=o),i.setGraph(r),wW.layout(i,{debugTiming:!!e.debugTiming}),n.startBatch("layout"),vf.fromGraphLib(i,{importNode:this.importElement.bind(n,e),importEdge:this.importLink.bind(n,e)}),e.resizeClusters){var a=i.nodes().filter(function(c){return i.children(c).length>0}).map(n.getCell.bind(n)).sort(function(c,h){return h.getAncestors().length-c.getAncestors().length});Ue(a,"fitToChildren",{padding:e.clusterPadding})}n.stopBatch("layout");var l=i.graph();return new Z(s,o,Math.abs(l.width-2*s),Math.abs(l.height-2*o))},fromGraphLib:function(t,e){e=e||{};var n=e.importNode||go,i=e.importEdge||go,r=this instanceof On?this:new On;return t.nodes().forEach(function(s){n.call(r,s,t,r,e)}),t.edges().forEach(function(s){i.call(r,s,t,r,e)}),r},toGraphLib:function(t,e){e=e||{};for(var n=tl(e,"directed","compound","multigraph"),i=new _i.Graph(n),r=e.setNodeLabel||go,s=e.setEdgeLabel||go,o=e.setEdgeName||go,a=t.get("cells"),l=0,c=a.length;l<c;l++){var h=a.at(l);if(h.isLink()){var u=h.get("source"),d=h.get("target");if(!u.id||!d.id)break;i.setEdge(u.id,d.id,s(h),o(h))}else if(i.setNode(h.id,r(h)),i.isCompound()&&h.has("parent")){var f=h.get("parent");a.has(f)&&i.setParent(h.id,f)}}return i}},Ei={NONE:"canvas-mode-none",EDIT:"canvas-mode-edit",MULTISELECT:"canvas-mode-multiselect",DRAW_RELATIONSHIP_PATH:"canvas-mode-draw-relationship-path"},xg=is("relationships",{state:()=>({relationshipShapes:$n({})}),getters:{getRelationshipShape:t=>e=>$t().graph.getCell(e)},actions:{updateRelationshipAndShape(t,e){if(this.updateRelationship(t,e),$t().isCanvasVersionV2AndUp){const n=this.getRelationshipShape(t);if(!n)return;e.type&&n.setType(e.type)}},deleteRelationshipAndShape(t){if(this.deleteRelationship(t),$t().isCanvasVersionV2AndUp){const e=this.getRelationshipShape(t);if(!e)return;e.remove()}},addRelationship({uuid:t,sourceColumnUuid:e,targetColumnUuid:n,type:i}){Wt.dispatch("addRelationship",{uuid:t,sourceColumnUuid:e,targetColumnUuid:n,type:i})},updateRelationship(t,e){const n=Wt.state.relationships[t];n&&en(e,(i,r)=>{Wt.dispatch("updateRelationship",{targetRelationship:n,prop:r,value:i})})},deleteRelationship(t){const e=Wt.state.relationships[t];e&&Wt.dispatch("deleteRelationship",{targetRelationship:e})},SET_RELATIONSHIP_SHAPES(t,e={addToGraph:!0}){e={addToGraph:!0,...e};let n=ux(t,i=>{const r=Wt.getters.getTableUuidOfColumn(i.source_column_uuid),s=pn().tableShapes[r],o=Wt.getters.getTableUuidOfColumn(i.target_column_uuid),a=pn().tableShapes[o];if(!s||!a){console.error("Table not found when drawing relationship");return}return new Ui({id:i.uuid,source:{id:r,magnet:`columnBody_${i.source_column_uuid}`},target:{id:o,magnet:`columnBody_${i.target_column_uuid}`}}).setType(i.type)});return n=_S(n,i=>!!i),this.relationshipShapes=$n(n),e.addToGraph&&this.ADD_TO_GRAPH(n),n},ADD_TO_GRAPH(t){return t instanceof Ui?($t().graph.addCell(t),!0):($t().graph.addCells(Object.values(t)),!0)}}});function _W(t,e,n,i){for(var r=t.length,s=n+(i?1:-1);i?s--:++s<r;)if(e(t[s],s,t))return s;return-1}var e1=_W;function SW(t){return t!==t}var EW=SW;function TW(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}var AW=TW,CW=e1,PW=EW,IW=AW;function kW(t,e,n){return e===e?IW(t,e,n):CW(t,PW,n)}var OW=kW,LW=OW;function MW(t,e){var n=t==null?0:t.length;return!!n&&LW(t,e,0)>-1}var DW=MW;function NW(t,e,n){for(var i=-1,r=t==null?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}var RW=NW;function $W(){}var BW=$W,xd=tx,FW=BW,VW=pp,zW=1/0,GW=xd&&1/VW(new xd([,-0]))[1]==zW?function(t){return new xd(t)}:FW,HW=GW,UW=j0,jW=DW,WW=RW,YW=W0,XW=HW,qW=pp,KW=200;function ZW(t,e,n){var i=-1,r=jW,s=t.length,o=!0,a=[],l=a;if(n)o=!1,r=WW;else if(s>=KW){var c=e?null:XW(t);if(c)return qW(c);o=!1,r=YW,l=new UW}else l=e?[]:a;t:for(;++i<s;){var h=t[i],u=e?e(h):h;if(h=n||h!==0?h:0,o&&u===u){for(var d=l.length;d--;)if(l[d]===u)continue t;e&&l.push(u),a.push(h)}else r(l,u,n)||(l!==a&&l.push(u),a.push(h))}return a}var JW=ZW,QW=Hs,tY=JW;function eY(t,e){return t&&t.length?tY(t,QW(e)):[]}var nY=eY;const iY=Zn(nY),$t=is("canvas",{state:()=>({canvasVersion:1,graph:$n({}),paper:$n({}),paperScroller:$n({}),scale:null,canvasMode:Ei.NONE,isPanToolActivated:!1,isLassoToolActivated:!1,isLassoing:!1,selectedTableUuid:null,isResizingTable:!1,isProgramaticallyRepositioningTables:!1,expandedTableUuid:null,editingNameForTableUuid:null,draggingTableUuid:null,selectedRelationshipUuid:null}),getters:{isCanvasVersionV1:t=>t.canvasVersion===1,isCanvasVersionV2AndUp:t=>t.canvasVersion>=2,hasSelectedTable:t=>t.canvasVersion===1?Wt.getters["diagramUI/hasSelectedTable"]:t.selectedTableUuid!==null,isSelectedTable:t=>e=>t.selectedTableUuid===e,isEditingNameForTable:t=>e=>t.editingNameForTableUuid===e,isExpandedTable:t=>e=>t.expandedTableUuid===e,isDraggingAnyTable:t=>t.draggingTableUuid!==null,isDraggingTable:t=>e=>t.draggingTableUuid===e,hasSelectedRelationship:t=>t.selectedRelationshipUuid!==null,isCanvasModeNone:t=>t.canvasMode===Ei.NONE,isCanvasModeEdit:t=>t.canvasMode===Ei.EDIT,isCanvasModeMultiselect:t=>t.canvasMode===Ei.MULTISELECT},actions:{setCanvasVersion(t){this.canvasVersion=t},setGraph(t){this.graph=$n(t)},setPaper(t){this.paper=$n(t)},setPaperScroller(t){this.paperScroller=$n(t)},setScale(t){this.scale=t},async resetCanvasMode(){this.canvasMode=Ei.NONE,setTimeout(()=>{this.activateEditMode()},0)},activateEditMode(){this.canvasMode=Ei.EDIT},activateMultiselectMode(){this.canvasMode=Ei.MULTISELECT},deactivateMultiselectMode(){this.canvasMode=Ei.EDIT},toggleMultiselectMode(){this.canvasMode=this.canvasMode===Ei.MULTISELECT?Ei.EDIT:Ei.MULTISELECT},activateCanvasPanTool(){this.isPanToolActivated=!0},deactivateCanvasPanTool(){this.isPanToolActivated=!1},toggleCanvasPanTool(){this.isPanToolActivated=!this.isPanToolActivated},activateCanvasLassoTool(){this.isLassoToolActivated=!0},deactivateCanvasLassoTool(){this.isLassoToolActivated=!1},toggleCanvasLassoTool(){this.isLassoToolActivated=!this.isLassoToolActivated},setIsLassoing(t){this.isLassoing=t},selectTable(t){this.unsetDraggingTableUuid(),this.selectedTableUuid=t},unselectTable(){this.selectedTableUuid=null},setResizingTable(t){this.isResizingTable=t},enterEditingNameModeForTable(t){this.selectTable(t),this.editingNameForTableUuid=t},exitEditingNameModeForTable(){this.editingNameForTableUuid=null},expandTable(t){this.expandedTableUuid=t},collapseTable(t){this.expandedTableUuid===t&&(this.expandedTableUuid=null)},collapseAllTables(){this.expandedTableUuid=null},setDraggingTableUuid(t){this.draggingTableUuid=t},unsetDraggingTableUuid(){this.draggingTableUuid=null},resetTableStates(){this.selectedTableUuid=null,this.editingNameForTableUuid=null},setSelectedTableUuid(t){this.selectedTableUuid=t},unsetSelectedTableUuid(){this.selectedTableUuid=null},setSelectedRelationshipUuid(t){this.selectedRelationshipUuid=t},unsetSelectedRelationshipUuid(){this.selectedRelationshipUuid=null},RESET_CELLS(){const t=pn().tableShapes,e=xg().relationshipShapes;try{this.paper.freeze(),this.graph.resetCells([...Object.values(t),...Object.values(e)])}finally{this.paper.unfreeze()}},autoLayout(t=[],e={}){if(t.length===0&&(t=this.graph.getElements()),t.length===0)return;let n=[],i=[],r=[];t.forEach(s=>{const o=this.graph.getConnectedLinks(s);o.length>0?(n=[...n,...o],i.push(s)):r.push(s)}),n=iY(n,"id");try{this.isProgramaticallyRepositioningTables=!0;const s=vf.layout([...i,...n],{nodeSep:200,edgeSep:100,rankSep:100,rankDir:"TD",marginX:10,marginY:10});let o=0,a=0;"x"in e&&(o=e.x-s.x),"y"in e&&(a=e.y-s.y),i.forEach(c=>{c.position(c.position().x+o,c.position().y+a)}),en(i,c=>{c instanceof fi&&AU().spreadOutAnchorsForTable(c)});const l=Math.ceil(s.width/fi.DEFAULT_WIDTH);d8.GridLayout.layout(r,{columnWidth:"compact",rowHeight:"compact",verticalAlign:"top",columns:l,columnGap:50,rowGap:50,marginX:s.x+o,marginY:s.y+s.height+50+a}),pn().syncTablePositionsFromGraph(),this.zoomToFit()}finally{this.isProgramaticallyRepositioningTables=!1}},zoomToFit(){this.paper.updateViews(),this.paperScroller.zoomToFit({padding:10})},async reloadSchema(){await Wt.dispatch("loadSchema")}}}),Cy=is("canvasMultiselect",{state:()=>({jointSelection:$n({}),multiselectedTableUuids:[]}),getters:{hasMultiselectedTables:t=>t.multiselectedTableUuids.length>0},actions:{setJointSelection(t){this.jointSelection=$n(t)},setMultiselectedTableModels(t){this.jointSelection.collection.reset(t)},addMultiselectedTableModel(t){this.jointSelection.collection.add(t)},removeMultiselectedTableModel(t){this.jointSelection.collection.remove(t)},_setMultiselectedTableUuids(t){this.multiselectedTableUuids=t}}}),n1=is("driverDataTypes",{state:()=>({}),getters:{getDriverDataTypes:t=>Wt.getters["driverDataTypes/getDriverDataTypes"],getDriverDataType:t=>e=>Wt.getters["driverDataTypes/getDriverDataType"](e)},actions:{}});var rY=H0,sY=Tl,oY=Du,aY=An,lY=rs,cY=Sl,uY=$u,hY=Ru,dY="[object Map]",fY="[object Set]",pY=Object.prototype,gY=pY.hasOwnProperty;function mY(t){if(t==null)return!0;if(lY(t)&&(aY(t)||typeof t=="string"||typeof t.splice=="function"||cY(t)||hY(t)||oY(t)))return!t.length;var e=sY(t);if(e==dY||e==fY)return!t.size;if(uY(t))return!rY(t).length;for(var n in t)if(gY.call(t,n))return!1;return!0}var vY=mY;const i1=Zn(vY);var yY=yp,bY=Hs,xY=SS,wY=An;function _Y(t,e){var n=wY(t)?yY:xY;return n(t,bY(e))}var SY=_Y;const EY=Zn(SY),Ls=is("indexes",{state:()=>({}),getters:{getIndex:t=>e=>Wt.getters["indexes/getIndex"](e),getIndexViewData:t=>function(e){return{columnNames:this.getColumnNamesForIndex(e)}},getIndexesForTable:(t,e)=>n=>{const i=pn().getTable(n).indexes,r=_.map(i,s=>globalThis.getIndex(s));return cl(r,"order")},getTableUuidOfIndex:t=>e=>Wt.getters["indexes/getTableUuidOfIndex"](e),getColumnNamesForIndex:t=>function(e){const n=r1().getColumnIndexesForIndex(e);return _.map(n,i=>Wr().getColumn(i.column_uuid).name)}},actions:{addIndexAndShape(t,e={},n={focusOnCreated:!0}){const i=Yi();if(this.addIndex({uuid:i,table_uuid:t}),i1(e)||this.updateIndex(i,e),$t().isCanvasVersionV2AndUp){const r=this.getTableUuidOfIndex(i),s=pn().tableShapes[r];if(!s)return;const o=this.getIndex(i);return o?(s.addIndex(o,this.getIndexViewData(o.uuid)),n.focusOnCreated&&this.focusIndex(r,o.uuid),o.uuid):void 0}else{const r=this.getIndex(i);return r?(this.focusIndex(t,r.uuid),r.uuid):void 0}},updateIndexAndShape(t,e){this.updateIndex(t,e),this.redrawIndexShape(t,e)},deleteIndexAndShape(t){const e=this.getTableUuidOfIndex(t);if(this.deleteIndex(t),$t().isCanvasVersionV2AndUp){const n=pn().tableShapes[e];if(!n)return;n.deleteIndex(t)}},redrawIndexShape(t,e={}){if($t().isCanvasVersionV2AndUp){const n=this.getTableUuidOfIndex(t),i=pn().tableShapes[n];if(!i)return;const r=this.getIndex(t);if(!r)return;i.updateIndex(r,this.getIndexViewData(t),e)}},updateOrderOfIndexesInTableAndShape(t){const e=this.getTableUuidOfIndex(t[0]);let n=null;if(!($t().isCanvasVersionV2AndUp&&(n=pn().tableShapes[e],!n))&&(en(t,(i,r)=>{const s=r+1;this.updateIndex(i,{order:s})}),pn().updateTableAndShape(e,{indexes:t}),$t().isCanvasVersionV2AndUp)){$t().paper.freeze();try{n.reorderIndexes(t)}catch(i){console.error(i)}finally{$t().paper.unfreeze()}}},addIndex(t){Wt.dispatch("addIndexToTable",{uuid:t.uuid,tableUuid:t.table_uuid})},updateIndex(t,e){const n=Wt.state.indexes.indexes[t];n&&en(e,(i,r)=>{Wt.dispatch("indexes/updateIndex",{targetIndex:n,prop:r,value:i})})},deleteIndex(t){const e=Wt.state.indexes.indexes[t];e&&Wt.dispatch("indexes/deleteIndex",e.uuid)},SET_INDEXES_IN_TABLE_SHAPES(t){en(cl(t,"order"),e=>{const n=this.getTableUuidOfIndex(e.uuid),i=pn().tableShapes[n];i&&i.addIndex(e,this.getIndexViewData(e.uuid))})},focusIndex(t,e){$t().isCanvasVersionV2AndUp?this.$emitter.emit("focus-index-v2",{tableUuid:t,indexUuid:e}):this.$emitter.emit("focus-index",{tableUuid:t,indexUuid:e})}}}),r1=is("columnIndexes",{state:()=>({}),getters:{getColumnIndexesForIndex:t=>e=>Wt.getters["columnIndexes/getColumnIndexesForIndex"](e),getColumnIndexesForColumn:t=>e=>Wt.getters["columnIndexes/getColumnIndexesForColumn"](e)},actions:{syncColumnIndexesForIndexAndUpdateShape(t,e){if(this.syncColumnIndexesForIndex(t,e),$t().isCanvasVersionV2AndUp){const n=Ls().getTableUuidOfIndex(t),i=pn().tableShapes[n];if(!i)return;const r=Ls().getIndex(t);if(!r)return;i.updateIndex(r,Ls().getIndexViewData(t))}},syncColumnIndexesForIndex(t,e){Wt.dispatch("columnIndexes/syncColumnIndexesForIndex",{indexUuid:t,columnUuids:e})}}}),Wr=is("columns",{state:()=>({}),getters:{getColumn:t=>e=>Wt.getters.column(e),getColumnViewData:t=>function(e){const n=this.getColumn(e);if(!n)return;const i=n1().getDriverDataType(n.driver_data_type_id);if(!i)return{dataTypeColumnText:"Unknown-"+n.driver_data_type_id};const r=n.driver_data_type_params&&n.driver_data_type_params.length>0?"("+n.driver_data_type_params.join(",")+")":null;let s=i.name;return r&&(s+=r),{dataTypeColumnText:s}},getTableUuidOfColumn:t=>e=>{var n;return(n=Wt.getters.column(e))==null?void 0:n.table_uuid}},actions:{addColumnAndShape(t,e={},n={}){n=ll({focusOnCreated:!0,showPorts:!1},n);const i=Yi();if(this.addColumn({uuid:i,table_uuid:t}),i1(e)||this.updateColumn(i,e),$t().isCanvasVersionV2AndUp){const r=this.getTableUuidOfColumn(i),s=pn().tableShapes[r];if(!s)return;const o=this.getColumn(i);if(!o)return;const a={showPorts:n.showPorts};return s.addColumn(o,this.getColumnViewData(o.uuid),a),n.focusOnCreated&&this.focusColumn(r,o.uuid),o.uuid}else{const r=this.getColumn(i);return r?(this.focusColumn(t,r.uuid),r.uuid):void 0}},updateColumnAndShape(t,e){if(this.updateColumn(t,e),$t().isCanvasVersionV2AndUp){const n=this.getTableUuidOfColumn(t),i=pn().tableShapes[n];if(!i)return;const r=this.getColumn(t);if(!r)return;if(i.updateColumn(r,this.getColumnViewData(t),e),e.name){const s=r1().getColumnIndexesForColumn(t),o=EY(s,"index_uuid");en(o,a=>{Ls().redrawIndexShape(a)})}}},deleteColumnAndShape(t){if(this.deleteColumn(t),$t().isCanvasVersionV2AndUp){const e=this.getTableUuidOfColumn(t),n=pn().tableShapes[e];if(!n)return;n.deleteColumn(t)}},updateOrderOfColumnsInTableAndShape(t){const e=this.getTableUuidOfColumn(t[0]);let n=null;if(!($t().isCanvasVersionV2AndUp&&(n=pn().tableShapes[e],!n))&&(en(t,(i,r)=>{const s=r+1;this.updateColumn(i,{order:s})}),pn().updateTableAndShape(e,{columns:t}),$t().isCanvasVersionV2AndUp)){$t().paper.freeze();try{n.reorderColumns(t)}catch(i){console.error(i)}finally{$t().paper.unfreeze()}}},addColumn(t){Wt.dispatch("addColumnToTable",{uuid:t.uuid,tableUuid:t.table_uuid})},updateColumn(t,e){const n=Wt.state.columns[t];n&&en(e,(i,r)=>{Wt.dispatch("updateColumn",{targetColumn:n,prop:r,value:i})})},deleteColumn(t){const e=Wt.state.columns[t];e&&Wt.dispatch("deleteColumn",e)},SET_COLUMNS_IN_TABLE_SHAPES(t){en(cl(t,"order"),e=>{const n=Wt.getters.getTableUuidOfColumn(e.uuid),i=pn().tableShapes[n];i&&i.addColumn(e,this.getColumnViewData(e.uuid))})},focusColumn(t,e){$t().isCanvasVersionV2AndUp?this.$emitter.emit("focus-column-v2",{tableUuid:t,columnUuid:e}):this.$emitter.emit("focus-column",{tableUuid:t,columnUuid:e})}}}),TY={MYSQL:"mysql",PGSQL:"pgsql",SQLSRV:"sqlsrv"},pn=is("tables",{state:()=>({tableShapes:$n({})}),getters:{getTableShape:t=>e=>$t().graph.getCell(e),getTable:t=>e=>Wt.state.tables[e]},actions:{addTableAndShape(t){if(this.addTable(t),$t().isCanvasVersionV2AndUp){const e=$t().paperScroller.getVisibleArea(),n=10,i=50;this.updateTable(t,{left:e.x+n/$t().paper.scale().sx,top:e.y+i/$t().paper.scale().sy});const r=this.getTable(t);this.ADD_TABLE_SHAPE(r);const s=Wr().addColumnAndShape(t,{name:"id",is_primary_key:!0},{focusOnCreated:!1}),o=Wr().getColumn(s),a=n1().getDriverDataType(o.driver_data_type_id);a.driver===TY.MYSQL&&["int","bigint"].includes(a.name)&&Wr().updateColumn(s,{is_auto_increment:!0,is_unsigned:!0}),$t().expandTable(t),$t().enterEditingNameModeForTable(t)}},updateTableAndShape(t,e){if(this.updateTable(t,e),$t().isCanvasVersionV2AndUp){const n=this.getTableShape(t);if(!n)return;"name"in e&&n.setName(e.name),"color"in e&&n.setColor(e.color),"comment"in e&&n.setComment(e.comment)}},deleteTableAndShape(t){if(this.deleteTable(t),$t().isCanvasVersionV2AndUp){const e=this.getTableShape(t);if(!e)return;e.remove(),$t().selectedTableUuid===t&&($t().selectedTableUuid=null),Cy().multiselectedTableUuids.includes(t)&&Cy().removeMultiselectedTableModel(t)}},deleteTablesAndShapes(t){$t().paper.freeze();try{t.forEach(e=>{this.deleteTableAndShape(e)})}catch(e){console.error(e)}finally{$t().paper.unfreeze()}},duplicateTableAndShape(t){const e=this.duplicateTable(t),n=this.getTable(e);return $t().isCanvasVersionV2AndUp&&(this.ADD_TABLE_SHAPE(n,{includeChildrenShapes:!0}),$t().selectTable(e)),e},syncTablePositionsFromGraph(){$t().graph.getElements().filter(e=>e instanceof fi).forEach(e=>{const n=this.getTable(e.id);n&&(n.left===e.position().x&&n.top===e.position().y||this.updateTable(e.id,{left:e.position().x,top:e.position().y}))})},addTable(t){Wt.dispatch("addTable",t)},updateTable(t,e){const n=Wt.state.tables[t];n&&en(e,(i,r)=>{Wt.dispatch("updateTable",{targetTable:n,prop:r,value:i})})},deleteTable(t){const e=Wt.state.tables[t];e&&Wt.dispatch("deleteTable",e)},deleteTables(t){t.forEach(e=>{this.deleteTable(e)})},duplicateTable(t){const e=Wt.state.tables[t];if(!e)return;const n=Yi(),i={[t]:n};return Wt.dispatch("duplicateTable",{originTable:e,uuidMappings:i}),n},ADD_TABLE_SHAPE(t,e={addToGraph:!0,includeChildrenShapes:!1}){e={addToGraph:!0,includeChildrenShapes:!1,...e};const n=new fi({id:t.uuid,uuid:t.uuid});return n.setName(t.name).setColor(t.color).setComment(t.comment).position(t.left,t.top),t.width&&n.size(t.width),this.tableShapes[t.uuid]=$n(n),e.includeChildrenShapes&&(en(t.columns,i=>{const r=Wr().getColumn(i);n.addColumn(r,Wr().getColumnViewData(r.uuid))}),en(t.indexes,i=>{const r=Wt.getters["indexes/getIndex"](i);n.addIndex(r,Ls().getIndexViewData(r.uuid))})),e.addToGraph&&this.ADD_TO_GRAPH(n),n},SET_TABLE_SHAPES(t,e={addToGraph:!0}){e={addToGraph:!0,...e};const n=ux(t,i=>{const r=new fi({id:i.uuid,uuid:i.uuid});return r.setName(i.name).setColor(i.color).setComment(i.comment).position(i.left,i.top),i.width&&r.size(i.width),r});return this.tableShapes=$n(n),e.addToGraph&&this.ADD_TO_GRAPH(n),n},ADD_TO_GRAPH(t){return t instanceof fi?($t().graph.addCell(t),!0):($t().graph.addCells(Object.values(t)),!0)}}}),AY={isPanMode:!1,isMultiselectMode:!1,multiselectedTables:[],selectedTable:null,expandedTable:null,hoveredTable:null,isHoverEventsDisabled:!1,editingNameForTable:null,hoveredRow:null,selectedRelationship:null},CY={isInPanMode:t=>t.isPanMode,isInMultiselectMode:t=>t.isMultiselectMode,isInMultiselectReady:(t,e)=>e.isInMultiselectMode&&!e.hasMultiselectedTable,isInMultiselectDone:(t,e)=>e.isInMultiselectMode&&e.hasMultiselectedTable,getMultiselectedTableUuids:t=>t.multiselectedTables,hasMultiselectedTable:t=>!_.isEmpty(t.multiselectedTables),isTableMultiselected:(t,e)=>n=>e.isInMultiselectMode?e.getMultiselectedTableUuids.includes(n):!1,getSelectedTableUuid:t=>t.selectedTable,hasSelectedTable:t=>!!t.selectedTable,isTableSelected:(t,e)=>n=>e.getSelectedTableUuid===n,getExpandedTableUuid:t=>t.expandedTable,isTableExpanded:(t,e)=>n=>e.getExpandedTableUuid===n,getHoveredTableUuid:t=>t.hoveredTable,isTableHovered:(t,e)=>n=>e.getHoveredTableUuid===n,getEditingNameForTableUuid:t=>t.editingNameForTable,isEditingNameForTable:(t,e)=>n=>e.getEditingNameForTableUuid===n,getHoveredRowUuid:t=>t.hoveredRow,isRowHovered:(t,e)=>n=>e.getHoveredRowUuid===n,getSelectedRelationshipUuid:t=>t.selectedRelationship,isRelationshipSelected:(t,e)=>n=>e.getSelectedRelationshipUuid===n},PY={reset({dispatch:t},e=!0){t("unsetSelectedTable"),t("unsetHoveredTable"),t("exitTableNameEditModeForTable"),t("unsetSelectedRelationship"),e&&t("unsetHoveredRow")},resetMode({dispatch:t}){t("deactivatePanMode"),t("deactivateMultiselectMode")},activatePanMode({commit:t,dispatch:e}){e("deactivateMultiselectMode"),t("ACTIVATE_PAN_MODE")},deactivatePanMode({commit:t}){t("DEACTIVATE_PAN_MODE")},activateMultiselectMode({commit:t,dispatch:e}){e("deactivatePanMode"),t("ACTIVATE_MULTISELECT_MODE")},deactivateMultiselectMode({commit:t,dispatch:e}){e("unsetMultiselectedTables"),t("DEACTIVATE_MULTISELECT_MODE")},setMultiselectedTables({commit:t},e){t("SET_MULTISELECTED_TABLES",e)},unsetMultiselectedTables({commit:t}){t("SET_MULTISELECTED_TABLES",[])},setSelectedTable({commit:t},e){$t().setSelectedTableUuid(e),t("SET_SELECTED_TABLE",e)},unsetSelectedTable({commit:t,getters:e},n=null){n&&!e.isTableSelected(n)||($t().unsetSelectedTableUuid(),t("SET_SELECTED_TABLE",null))},expandTable({commit:t},e){t("SET_EXPANDED_TABLE",e)},collapseTable({commit:t},e){t("REMOVE_EXPANDED_TABLE",e)},toggleTableExpansion({dispatch:t,getters:e},n){e.isTableExpanded(n)?t("collapseTable",n):t("expandTable",n)},enableHoverEvents({commit:t}){t("SET_IS_HOVERED_EVENTS_DISABLED",!1)},disableHoverEvents({commit:t}){t("SET_IS_HOVERED_EVENTS_DISABLED",!0)},setHoveredTable({commit:t,getters:e,state:n},i){n.isHoverEventsDisabled||e.isTableHovered(i)||t("SET_HOVERED_TABLE",i)},unsetHoveredTable({commit:t,getters:e},n=null){n&&!e.isTableHovered(n)||t("SET_HOVERED_TABLE",null)},enterTableNameEditModeForTable({commit:t,dispatch:e},n){t("SET_EDITING_NAME_FOR_TABLE",n),e("setSelectedTable",n)},exitTableNameEditModeForTable({commit:t,getters:e},n){n&&!e.isEditingNameForTable(n)||t("SET_EDITING_NAME_FOR_TABLE",null)},setHoveredRow({commit:t,getters:e,state:n},i){n.isHoverEventsDisabled||e.isRowHovered(i)||t("SET_HOVERED_ROW",i)},unsetHoveredRow({commit:t,getters:e},n=null){n&&!e.isRowHovered(n)||t("SET_HOVERED_ROW",null)},setSelectedRelationship({commit:t},e){t("SET_SELECTED_RELATIONSHIP",e)},unsetSelectedRelationship({commit:t,getters:e},n=null){n&&!e.isRelationshipSelected(n)||t("SET_SELECTED_RELATIONSHIP",null)}},IY={ACTIVATE_PAN_MODE(t){t.isPanMode=!0},DEACTIVATE_PAN_MODE(t){t.isPanMode=!1},ACTIVATE_MULTISELECT_MODE(t){t.isMultiselectMode=!0},DEACTIVATE_MULTISELECT_MODE(t){t.isMultiselectMode=!1},SET_MULTISELECTED_TABLES(t,e){t.multiselectedTables=e},SET_SELECTED_TABLE(t,e){t.selectedTable=e},SET_EXPANDED_TABLE(t,e){t.expandedTable=e},REMOVE_EXPANDED_TABLE(t,e){t.expandedTable=null},SET_IS_HOVERED_EVENTS_DISABLED(t,e){t.isHoverEventsDisabled=e},SET_HOVERED_TABLE(t,e){t.hoveredTable=e},SET_EDITING_NAME_FOR_TABLE(t,e){t.editingNameForTable=e},SET_HOVERED_ROW(t,e){t.hoveredRow=e},SET_SELECTED_RELATIONSHIP(t,e){t.selectedRelationship=e}},kY={namespaced:!0,state:AY,getters:CY,actions:PY,mutations:IY},OY={canManageDiagram:!1,canUpdateDiagram:!1,canViewAccessSettingsDiagram:!1,teamAdminsCount:null},LY={canManageDiagram:t=>t.canManageDiagram,canViewAccessSettingsDiagram:t=>t.canViewAccessSettingsDiagram,teamAdminsCount:t=>t.teamAdminsCount},MY={setDiagramAccess({commit:t},e){t("SET_DIAGRAM_ACCESS",e)}},DY={SET_DIAGRAM_ACCESS(t,{canManageDiagram:e,canUpdateDiagram:n,canViewAccessSettingsDiagram:i,teamAdminsCount:r}){t.canManageDiagram=e,t.canUpdateDiagram=n,t.canViewAccessSettingsDiagram=i,t.teamAdminsCount=r}},NY={namespaced:!0,state:OY,getters:LY,actions:MY,mutations:DY},RY={tableColors:[]},$Y={tableColors:t=>t.tableColors,nextTableColor:(t,e,n,i)=>i["diagram/getDiagram"].default_table_color?i["diagram/getDiagram"].default_table_color:t.tableColors[i.tables.length%t.tableColors.length]},BY={setTableColors({commit:t},e){t("SET_TABLE_COLORS",e)}},FY={SET_TABLE_COLORS(t,e){t.tableColors=e}},VY={namespaced:!0,state:RY,getters:$Y,actions:BY,mutations:FY},zY={diagram:null},GY={getDiagram:t=>t.diagram},HY={setDiagram({commit:t},e){t("SET_DIAGRAM",e)},updateDiagram({commit:t,dispatch:e},{prop:n,value:i}){t("UPDATE_DIAGRAM",{prop:n,value:i})}},UY={SET_DIAGRAM(t,e){t.diagram=e},UPDATE_DIAGRAM(t,{prop:e,value:n}){Object.assign(t.diagram,{[e]:n})}},jY={namespaced:!0,state:zY,getters:GY,actions:HY,mutations:UY},WY={team:null},YY={getTeam:t=>t.team},XY={setTeam({commit:t},e){t("SET_TEAM",e)}},qY={SET_TEAM(t,e){t.team=e}},KY={namespaced:!0,state:WY,getters:YY,actions:XY,mutations:qY};var ZY=Hs,JY=rs,QY=ta;function tX(t){return function(e,n,i){var r=Object(e);if(!JY(e)){var s=ZY(n);e=QY(e),n=function(a){return s(r[a],a,r)}}var o=t(e,n,i);return o>-1?r[s?e[o]:o]:void 0}}var eX=tX,nX=/\s/;function iX(t){for(var e=t.length;e--&&nX.test(t.charAt(e)););return e}var rX=iX,sX=rX,oX=/^\s+/;function aX(t){return t&&t.slice(0,sX(t)+1).replace(oX,"")}var lX=aX,cX=lX,Py=Qi,uX=Al,Iy=0/0,hX=/^[-+]0x[0-9a-f]+$/i,dX=/^0b[01]+$/i,fX=/^0o[0-7]+$/i,pX=parseInt;function gX(t){if(typeof t=="number")return t;if(uX(t))return Iy;if(Py(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Py(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=cX(t);var n=dX.test(t);return n||fX.test(t)?pX(t.slice(2),n?2:8):hX.test(t)?Iy:+t}var mX=gX,vX=mX,ky=1/0,yX=17976931348623157e292;function bX(t){if(!t)return t===0?t:0;if(t=vX(t),t===ky||t===-ky){var e=t<0?-1:1;return e*yX}return t===t?t:0}var xX=bX,wX=xX;function _X(t){var e=wX(t),n=e%1;return e===e?n?e-n:e:0}var SX=_X,EX=e1,TX=Hs,AX=SX,CX=Math.max;function PX(t,e,n){var i=t==null?0:t.length;if(!i)return-1;var r=n==null?0:AX(n);return r<0&&(r=CX(i+r,0)),EX(t,TX(e),r)}var IX=PX,kX=eX,OX=IX,LX=kX(OX),MX=LX;const DX=Zn(MX),NX=new Qo.Entity("driverDataTypes"),RX={driverDataTypes:{}},$X={getDriverDataTypes:t=>t.driverDataTypes,getDriverDataType:t=>e=>t.driverDataTypes[e],getDriverDataTypeByName:t=>e=>DX(t.driverDataTypes,n=>n.name.toLowerCase()===e.toLowerCase())},BX={setDriverDataTypes({commit:t},e){const n=TI(e,[NX]),i=_.has(n.entities,"driverDataTypes")?n.entities.driverDataTypes:{};t("SET_DRIVER_DATA_TYPES",i)}},FX={SET_DRIVER_DATA_TYPES(t,e){t.driverDataTypes=e}},VX={namespaced:!0,state:RX,getters:$X,actions:BX,mutations:FX};var zX=Fl,GX=ta;function HX(t,e){return t&&zX(e,GX(e),t)}var UX=HX,jX=Fl,WX=Vl;function YX(t,e){return t&&jX(e,WX(e),t)}var XX=YX,qX=Fl,KX=gp;function ZX(t,e){return qX(t,KX(t),e)}var JX=ZX,QX=q0,tq=pg,eq=gp,nq=J0,iq=Object.getOwnPropertySymbols,rq=iq?function(t){for(var e=[];t;)QX(e,eq(t)),t=tq(t);return e}:nq,s1=rq,sq=Fl,oq=s1;function aq(t,e){return sq(t,oq(t),e)}var lq=aq,cq=K0,uq=s1,hq=Vl;function dq(t){return cq(t,hq,uq)}var fq=dq,pq=Object.prototype,gq=pq.hasOwnProperty;function mq(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&gq.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var vq=mq,yq=fg;function bq(t,e){var n=e?yq(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var xq=bq,wq=/\w*$/;function _q(t){var e=new t.constructor(t.source,wq.exec(t));return e.lastIndex=t.lastIndex,e}var Sq=_q,Oy=_l,Ly=Oy?Oy.prototype:void 0,My=Ly?Ly.valueOf:void 0;function Eq(t){return My?Object(My.call(t)):{}}var Tq=Eq,Aq=fg,Cq=xq,Pq=Sq,Iq=Tq,kq=gS,Oq="[object Boolean]",Lq="[object Date]",Mq="[object Map]",Dq="[object Number]",Nq="[object RegExp]",Rq="[object Set]",$q="[object String]",Bq="[object Symbol]",Fq="[object ArrayBuffer]",Vq="[object DataView]",zq="[object Float32Array]",Gq="[object Float64Array]",Hq="[object Int8Array]",Uq="[object Int16Array]",jq="[object Int32Array]",Wq="[object Uint8Array]",Yq="[object Uint8ClampedArray]",Xq="[object Uint16Array]",qq="[object Uint32Array]";function Kq(t,e,n){var i=t.constructor;switch(e){case Fq:return Aq(t);case Oq:case Lq:return new i(+t);case Vq:return Cq(t,n);case zq:case Gq:case Hq:case Uq:case jq:case Wq:case Yq:case Xq:case qq:return kq(t,n);case Mq:return new i;case Dq:case $q:return new i(t);case Nq:return Pq(t);case Rq:return new i;case Bq:return Iq(t)}}var Zq=Kq,Jq=Tl,Qq=tr,tK="[object Map]";function eK(t){return Qq(t)&&Jq(t)==tK}var nK=eK,iK=nK,rK=Nu,Dy=hp,Ny=Dy&&Dy.isMap,sK=Ny?rK(Ny):iK,oK=sK,aK=Tl,lK=tr,cK="[object Set]";function uK(t){return lK(t)&&aK(t)==cK}var hK=uK,dK=hK,fK=Nu,Ry=hp,$y=Ry&&Ry.isSet,pK=$y?fK($y):dK,gK=pK,mK=Gu,vK=dS,yK=xS,bK=UX,xK=XX,wK=pS,_K=mS,SK=JX,EK=lq,TK=Q0,AK=fq,CK=Tl,PK=vq,IK=Zq,kK=vS,OK=An,LK=Sl,MK=oK,DK=Qi,NK=gK,RK=ta,$K=Vl,BK=1,FK=2,VK=4,o1="[object Arguments]",zK="[object Array]",GK="[object Boolean]",HK="[object Date]",UK="[object Error]",a1="[object Function]",jK="[object GeneratorFunction]",WK="[object Map]",YK="[object Number]",l1="[object Object]",XK="[object RegExp]",qK="[object Set]",KK="[object String]",ZK="[object Symbol]",JK="[object WeakMap]",QK="[object ArrayBuffer]",tZ="[object DataView]",eZ="[object Float32Array]",nZ="[object Float64Array]",iZ="[object Int8Array]",rZ="[object Int16Array]",sZ="[object Int32Array]",oZ="[object Uint8Array]",aZ="[object Uint8ClampedArray]",lZ="[object Uint16Array]",cZ="[object Uint32Array]",Ie={};Ie[o1]=Ie[zK]=Ie[QK]=Ie[tZ]=Ie[GK]=Ie[HK]=Ie[eZ]=Ie[nZ]=Ie[iZ]=Ie[rZ]=Ie[sZ]=Ie[WK]=Ie[YK]=Ie[l1]=Ie[XK]=Ie[qK]=Ie[KK]=Ie[ZK]=Ie[oZ]=Ie[aZ]=Ie[lZ]=Ie[cZ]=!0;Ie[UK]=Ie[a1]=Ie[JK]=!1;function Uc(t,e,n,i,r,s){var o,a=e&BK,l=e&FK,c=e&VK;if(n&&(o=r?n(t,i,r,s):n(t)),o!==void 0)return o;if(!DK(t))return t;var h=OK(t);if(h){if(o=PK(t),!a)return _K(t,o)}else{var u=CK(t),d=u==a1||u==jK;if(LK(t))return wK(t,a);if(u==l1||u==o1||d&&!r){if(o=l||d?{}:kK(t),!a)return l?EK(t,xK(o,t)):SK(t,bK(o,t))}else{if(!Ie[u])return r?t:{};o=IK(t,u,a)}}s||(s=new mK);var f=s.get(t);if(f)return f;s.set(t,o),NK(t)?t.forEach(function(v){o.add(Uc(v,e,n,v,t,s))}):MK(t)&&t.forEach(function(v,x){o.set(x,Uc(v,e,n,x,t,s))});var p=c?l?AK:TK:l?$K:RK,g=h?void 0:p(t);return vK(g||t,function(v,x){g&&(x=v,v=t[x]),yK(o,x,Uc(v,e,n,x,t,s))}),o}var uZ=Uc,hZ=uZ,dZ=1,fZ=4;function pZ(t,e){return e=typeof e=="function"?e:void 0,hZ(t,dZ|fZ,e)}var gZ=pZ;const mZ=Zn(gZ);function mu(t,e={},n=[]){return mZ(t,i=>{if($b(i)&&!n.includes(i)){let r=e[i];return r||(r=Yi(),e[i]=r),r}})}function Tnt(t,e){return t.includes(e)||t.includes("*")||e.endsWith(":create")&&t.includes("*:create")||e.endsWith(":update")&&t.includes("*:update")||e.endsWith(":admin")&&t.includes("*:admin")}function vZ(){return navigator.userAgent.indexOf("Win")!==-1?"os-windows":navigator.userAgent.indexOf("Mac")!==-1?"os-mac":navigator.userAgent.indexOf("X11")!==-1?"os-unix":navigator.userAgent.indexOf("Linux")!==-1?"os-linux":"os-windows"}function Ant(t,e){const n=vZ();return n in t?t[n]:e}class Cnt{constructor({autoStart:e=!1}={}){this.autoStart=e,this._queue=[],this._running=!1,this._results=[],this._resolves=[],this._rejects=[],this._runId=0}get length(){return this._queue.length}addJob(e){this._queue.push(()=>{try{const n=this._runId,i=e(()=>{n===this._runId&&(this._results.push(i),this._next())})}catch(n){this._reject(n)}}),this.autoStart&&this.length===1&&this.start()}clear(){this._running=!1,this._queue.length=0,this._resolves.length=0,this._rejects.length=0,this._results.length=0,this._runId++}cancel(){this._resolve(),this.clear()}start(){return new Promise((e,n)=>{!this._running&&this.length>0?(this._running=!0,this._queue[0](),this._resolves.push(e),this._rejects.push(n)):e()})}_next(){this._running&&this.length>0&&(this._queue.shift(),this.length===0?this._resolve():this._queue[0]())}_resolve(){this._resolves.forEach(e=>e(this._results)),this.clear()}_reject(e){this._rejects.forEach(n=>n(e)),this.clear()}}const yZ={indexes:{}},bZ={getIndexes:t=>t.indexes,getIndex:t=>e=>t.indexes[e],getColumnNamesForIndex:(t,e,n,i)=>r=>{const s=i["columnIndexes/getColumnIndexesForIndex"](r);return _.map(s,o=>i.column(o.column_uuid).name)},getTableUuidOfIndex:(t,e)=>n=>e.getIndex(n).table_uuid},xZ={markTableDirtyViaIndex({dispatch:t,getters:e},n){t("markTableDirty",e.getTableUuidOfIndex(n),{root:!0})},setIndexes({commit:t},e){t("SET_INDEXES",e)},createIndex({commit:t,dispatch:e},{uuid:n,tableUuid:i,order:r}){const s=n||Yi(),o={uuid:s,name:s,order:r,type:Gc.INDEX,column_indexes:[],table_uuid:i};t("CREATE_INDEX",o),e("markTableDirtyViaIndex",o.uuid)},updateIndex({commit:t,dispatch:e,getters:n},{targetIndex:i,prop:r,value:s}){t("UPDATE_INDEX",{targetIndex:i,prop:r,value:s}),e("markTableDirtyViaIndex",i.uuid)},deleteIndex({commit:t,dispatch:e,getters:n},i){const r=n.getIndex(i);e("columnIndexes/deleteColumnIndexesForIndex",i,{root:!0}),e("removeIndexFromTable",{uuid:r.uuid,tableUuid:r.table_uuid},{root:!0}),e("markTableDirtyViaIndex",i),t("DELETE_INDEX",i)},duplicateIndex({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},{originIndex:s,uuidMappings:o={},updateOrder:a=!0}){const l=mu(s,o);a&&(l.order=s.order+1),t("CREATE_INDEX",l),t("ADD_INDEX_TO_TABLE",{tableUuid:l.table_uuid,indexUuid:l.uuid},{root:!0}),e("columnIndexes/duplicateColumnIndexesForIndex",{originalIndexUuid:s.uuid,uuidMappings:o},{root:!0}),e("markTableDirtyViaIndex",l.uuid)},addColumnIndexToIndex({commit:t,dispatch:e},{columnIndexUuid:n,indexUuid:i}){t("ADD_COLUMN_INDEX_TO_INDEX",{columnIndexUuid:n,indexUuid:i}),e("markTableDirtyViaIndex",i)},removeColumnIndexFromIndex({commit:t,dispatch:e},{columnIndexUuid:n,indexUuid:i}){t("REMOVE_COLUMN_INDEX_FROM_INDEX",{columnIndexUuid:n,indexUuid:i}),e("markTableDirtyViaIndex",i)}},wZ={SET_INDEXES(t,e){t.indexes=e,$t().isCanvasVersionV2AndUp&&Ls().SET_INDEXES_IN_TABLE_SHAPES(e)},CREATE_INDEX(t,e){t.indexes[e.uuid]=e},UPDATE_INDEX(t,{targetIndex:e,prop:n,value:i}){Object.assign(e,{[n]:i})},DELETE_INDEX(t,e){delete t.indexes[e]},ADD_COLUMN_INDEX_TO_INDEX(t,{columnIndexUuid:e,indexUuid:n}){t.indexes[n].column_indexes.includes(e)&&t.indexes[n].column_indexes.splice(_.indexOf(t.indexes[n].column_indexes,e),1),t.indexes[n].column_indexes.push(e)},REMOVE_COLUMN_INDEX_FROM_INDEX(t,{columnIndexUuid:e,indexUuid:n}){t.indexes[n].column_indexes.splice(_.indexOf(t.indexes[n].column_indexes,e),1)}},_Z={namespaced:!0,state:yZ,getters:bZ,actions:xZ,mutations:wZ},SZ={columnIndexes:{}},EZ={getColumnIndexes:t=>t.columnIndexes,getColumnIndex:t=>e=>t.columnIndexes[e],getColumnIndexesForIndex:t=>e=>cl(_.filter(t.columnIndexes,{index_uuid:e}),"order"),getColumnIndexesForColumn:t=>e=>_.filter(t.columnIndexes,{column_uuid:e})},TZ={setColumnIndexes({commit:t},e){t("SET_COLUMN_INDEXES",e)},syncColumnIndexesForIndex({commit:t,dispatch:e,getters:n},{indexUuid:i,columnUuids:r}){const s=_.filter(n.getColumnIndexesForIndex(i),a=>!_.includes(r,a.column_uuid));e("deleteColumnIndexes",_.map(s,"uuid"));const o=n.getColumnIndexesForIndex(i);_.forEach(r,(a,l)=>{const c=_.find(o,{column_uuid:a});c===void 0?e("createColumnIndex",{indexUuid:i,columnUuid:a,order:l}):t("UPDATE_COLUMN_INDEX",{targetColumnIndexUuid:c.uuid,newProps:{order:l}})}),e("indexes/markTableDirtyViaIndex",i,{root:!0})},createColumnIndex({commit:t,dispatch:e,getters:n},{indexUuid:i,columnUuid:r,order:s}){const o=Yi();t("CREATE_COLUMN_INDEX",{uuid:o,indexUuid:i,columnUuid:r,order:s}),e("indexes/addColumnIndexToIndex",{columnIndexUuid:o,indexUuid:i},{root:!0})},deleteColumnIndexes({commit:t,dispatch:e,getters:n},i){_.forEach(i,r=>{const s=n.getColumnIndex(r);e("indexes/removeColumnIndexFromIndex",{columnIndexUuid:r,indexUuid:s.index_uuid},{root:!0})}),t("DELETE_COLUMN_INDEXES",i)},deleteColumnIndexesForIndex({commit:t,dispatch:e,getters:n},i){const r=n.getColumnIndexesForIndex(i);e("deleteColumnIndexes",_.map(r,"uuid"))},duplicateColumnIndexesForIndex({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},{originalIndexUuid:s,uuidMappings:o={}}){const a=n.getColumnIndexesForIndex(s);en(a,l=>{const c=mu(l,o);t("CREATE_COLUMN_INDEX",{uuid:c.uuid,indexUuid:c.index_uuid,columnUuid:c.column_uuid,order:c.order}),e("indexes/addColumnIndexToIndex",{columnIndexUuid:c.uuid,indexUuid:c.index_uuid},{root:!0})})}},AZ={SET_COLUMN_INDEXES(t,e){t.columnIndexes=e},CREATE_COLUMN_INDEX(t,{uuid:e,indexUuid:n,columnUuid:i,order:r}){const s={id:null,uuid:e||Yi(),order:r,index_id:null,index_uuid:n,column_id:null,column_uuid:i};t.columnIndexes[s.uuid]=s},UPDATE_COLUMN_INDEX(t,{targetColumnIndexUuid:e,newProps:n}){t.columnIndexes[e]=Object.assign(t.columnIndexes[e],n)},DELETE_COLUMN_INDEXES(t,e){_.forEach(e,n=>{delete t.columnIndexes[n]})}},CZ={namespaced:!0,state:SZ,getters:EZ,actions:TZ,mutations:AZ},c1=new Qo.Entity("columns",{},{idAttribute:"uuid",processStrategy:(t,e,n)=>Object.assign(t,{deletedAt:null,table_uuid:e.uuid})}),wg=new Qo.Entity("indexes",{},{idAttribute:"uuid",processStrategy:(t,e,n)=>Object.assign(t,{table_uuid:e.uuid})}),u1=new Qo.Entity("columnIndexes",{},{idAttribute:"uuid"});wg.define({column_indexes:[u1]});u1.define({columns:[c1],indexes:[wg]});const PZ=new Qo.Entity("tables",{columns:[c1],indexes:[wg]},{idAttribute:"uuid",processStrategy:(t,e,n)=>Object.assign(t,{isDirty:!1,deletedAt:null,columns:_.orderBy(t.columns,"order")})});new Qo.Entity("relationships",{},{idAttribute:"uuid",processStrategy:(t,e,n)=>Object.assign(t,{isDirty:!1,deletedAt:null})});/*!
 * vuex v4.1.0
 * (c) 2022 Evan You
 * @license MIT
 */var h1="store";function Pnt(t){return t===void 0&&(t=null),Pb(t!==null?t:h1)}function ua(t,e){Object.keys(t).forEach(function(n){return e(t[n],n)})}function d1(t){return t!==null&&typeof t=="object"}function IZ(t){return t&&typeof t.then=="function"}function kZ(t,e){return function(){return t(e)}}function f1(t,e,n){return e.indexOf(t)<0&&(n&&n.prepend?e.unshift(t):e.push(t)),function(){var i=e.indexOf(t);i>-1&&e.splice(i,1)}}function p1(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var n=t.state;gh(t,n,[],t._modules.root,!0),_g(t,n,e)}function _g(t,e,n){var i=t._state,r=t._scope;t.getters={},t._makeLocalGettersCache=Object.create(null);var s=t._wrappedGetters,o={},a={},l=Nf(!0);l.run(function(){ua(s,function(c,h){o[h]=kZ(c,t),a[h]=Ob(function(){return o[h]()}),Object.defineProperty(t.getters,h,{get:function(){return a[h].value},enumerable:!0})})}),t._state=Ib({data:e}),t._scope=l,t.strict&&NZ(t),i&&n&&t._withCommit(function(){i.data=null}),r&&r.stop()}function gh(t,e,n,i,r){var s=!n.length,o=t._modules.getNamespace(n);if(i.namespaced&&(t._modulesNamespaceMap[o],t._modulesNamespaceMap[o]=i),!s&&!r){var a=Sg(e,n.slice(0,-1)),l=n[n.length-1];t._withCommit(function(){a[l]=i.state})}var c=i.context=OZ(t,o,n);i.forEachMutation(function(h,u){var d=o+u;LZ(t,d,h,c)}),i.forEachAction(function(h,u){var d=h.root?u:o+u,f=h.handler||h;MZ(t,d,f,c)}),i.forEachGetter(function(h,u){var d=o+u;DZ(t,d,h,c)}),i.forEachChild(function(h,u){gh(t,e,n.concat(u),h,r)})}function OZ(t,e,n){var i=e==="",r={dispatch:i?t.dispatch:function(s,o,a){var l=vu(s,o,a),c=l.payload,h=l.options,u=l.type;return(!h||!h.root)&&(u=e+u),t.dispatch(u,c)},commit:i?t.commit:function(s,o,a){var l=vu(s,o,a),c=l.payload,h=l.options,u=l.type;(!h||!h.root)&&(u=e+u),t.commit(u,c,h)}};return Object.defineProperties(r,{getters:{get:i?function(){return t.getters}:function(){return g1(t,e)}},state:{get:function(){return Sg(t.state,n)}}}),r}function g1(t,e){if(!t._makeLocalGettersCache[e]){var n={},i=e.length;Object.keys(t.getters).forEach(function(r){if(r.slice(0,i)===e){var s=r.slice(i);Object.defineProperty(n,s,{get:function(){return t.getters[r]},enumerable:!0})}}),t._makeLocalGettersCache[e]=n}return t._makeLocalGettersCache[e]}function LZ(t,e,n,i){var r=t._mutations[e]||(t._mutations[e]=[]);r.push(function(o){n.call(t,i.state,o)})}function MZ(t,e,n,i){var r=t._actions[e]||(t._actions[e]=[]);r.push(function(o){var a=n.call(t,{dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:i.state,rootGetters:t.getters,rootState:t.state},o);return IZ(a)||(a=Promise.resolve(a)),t._devtoolHook?a.catch(function(l){throw t._devtoolHook.emit("vuex:error",l),l}):a})}function DZ(t,e,n,i){t._wrappedGetters[e]||(t._wrappedGetters[e]=function(s){return n(i.state,i.getters,s.state,s.getters)})}function NZ(t){Rf(function(){return t._state.data},function(){},{deep:!0,flush:"sync"})}function Sg(t,e){return e.reduce(function(n,i){return n[i]},t)}function vu(t,e,n){return d1(t)&&t.type&&(n=e,e=t,t=t.type),{type:t,payload:e,options:n}}var RZ="vuex bindings",By="vuex:mutations",wd="vuex:actions",ho="vuex",$Z=0;function BZ(t,e){iT({id:"org.vuejs.vuex",app:t,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[RZ]},function(n){n.addTimelineLayer({id:By,label:"Vuex Mutations",color:Fy}),n.addTimelineLayer({id:wd,label:"Vuex Actions",color:Fy}),n.addInspector({id:ho,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree(function(i){if(i.app===t&&i.inspectorId===ho)if(i.filter){var r=[];b1(r,e._modules.root,i.filter,""),i.rootNodes=r}else i.rootNodes=[y1(e._modules.root,"")]}),n.on.getInspectorState(function(i){if(i.app===t&&i.inspectorId===ho){var r=i.nodeId;g1(e,r),i.state=zZ(HZ(e._modules,r),r==="root"?e.getters:e._makeLocalGettersCache,r)}}),n.on.editInspectorState(function(i){if(i.app===t&&i.inspectorId===ho){var r=i.nodeId,s=i.path;r!=="root"&&(s=r.split("/").filter(Boolean).concat(s)),e._withCommit(function(){i.set(e._state.data,s,i.state.value)})}}),e.subscribe(function(i,r){var s={};i.payload&&(s.payload=i.payload),s.state=r,n.notifyComponentUpdate(),n.sendInspectorTree(ho),n.sendInspectorState(ho),n.addTimelineEvent({layerId:By,event:{time:Date.now(),title:i.type,data:s}})}),e.subscribeAction({before:function(i,r){var s={};i.payload&&(s.payload=i.payload),i._id=$Z++,i._time=Date.now(),s.state=r,n.addTimelineEvent({layerId:wd,event:{time:i._time,title:i.type,groupId:i._id,subtitle:"start",data:s}})},after:function(i,r){var s={},o=Date.now()-i._time;s.duration={_custom:{type:"duration",display:o+"ms",tooltip:"Action duration",value:o}},i.payload&&(s.payload=i.payload),s.state=r,n.addTimelineEvent({layerId:wd,event:{time:Date.now(),title:i.type,groupId:i._id,subtitle:"end",data:s}})}})})}var Fy=8702998,FZ=6710886,VZ=16777215,m1={label:"namespaced",textColor:VZ,backgroundColor:FZ};function v1(t){return t&&t!=="root"?t.split("/").slice(-2,-1)[0]:"Root"}function y1(t,e){return{id:e||"root",label:v1(e),tags:t.namespaced?[m1]:[],children:Object.keys(t._children).map(function(n){return y1(t._children[n],e+n+"/")})}}function b1(t,e,n,i){i.includes(n)&&t.push({id:i||"root",label:i.endsWith("/")?i.slice(0,i.length-1):i||"Root",tags:e.namespaced?[m1]:[]}),Object.keys(e._children).forEach(function(r){b1(t,e._children[r],n,i+r+"/")})}function zZ(t,e,n){e=n==="root"?e:e[n];var i=Object.keys(e),r={state:Object.keys(t.state).map(function(o){return{key:o,editable:!0,value:t.state[o]}})};if(i.length){var s=GZ(e);r.getters=Object.keys(s).map(function(o){return{key:o.endsWith("/")?v1(o):o,editable:!1,value:yf(function(){return s[o]})}})}return r}function GZ(t){var e={};return Object.keys(t).forEach(function(n){var i=n.split("/");if(i.length>1){var r=e,s=i.pop();i.forEach(function(o){r[o]||(r[o]={_custom:{value:{},display:o,tooltip:"Module",abstract:!0}}),r=r[o]._custom.value}),r[s]=yf(function(){return t[n]})}else e[n]=yf(function(){return t[n]})}),e}function HZ(t,e){var n=e.split("/").filter(function(i){return i});return n.reduce(function(i,r,s){var o=i[r];if(!o)throw new Error('Missing module "'+r+'" for path "'+e+'".');return s===n.length-1?o:o._children},e==="root"?t:t.root._children)}function yf(t){try{return t()}catch(e){return e}}var Di=function(e,n){this.runtime=n,this._children=Object.create(null),this._rawModule=e;var i=e.state;this.state=(typeof i=="function"?i():i)||{}},x1={namespaced:{configurable:!0}};x1.namespaced.get=function(){return!!this._rawModule.namespaced};Di.prototype.addChild=function(e,n){this._children[e]=n};Di.prototype.removeChild=function(e){delete this._children[e]};Di.prototype.getChild=function(e){return this._children[e]};Di.prototype.hasChild=function(e){return e in this._children};Di.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)};Di.prototype.forEachChild=function(e){ua(this._children,e)};Di.prototype.forEachGetter=function(e){this._rawModule.getters&&ua(this._rawModule.getters,e)};Di.prototype.forEachAction=function(e){this._rawModule.actions&&ua(this._rawModule.actions,e)};Di.prototype.forEachMutation=function(e){this._rawModule.mutations&&ua(this._rawModule.mutations,e)};Object.defineProperties(Di.prototype,x1);var Zs=function(e){this.register([],e,!1)};Zs.prototype.get=function(e){return e.reduce(function(n,i){return n.getChild(i)},this.root)};Zs.prototype.getNamespace=function(e){var n=this.root;return e.reduce(function(i,r){return n=n.getChild(r),i+(n.namespaced?r+"/":"")},"")};Zs.prototype.update=function(e){w1([],this.root,e)};Zs.prototype.register=function(e,n,i){var r=this;i===void 0&&(i=!0);var s=new Di(n,i);if(e.length===0)this.root=s;else{var o=this.get(e.slice(0,-1));o.addChild(e[e.length-1],s)}n.modules&&ua(n.modules,function(a,l){r.register(e.concat(l),a,i)})};Zs.prototype.unregister=function(e){var n=this.get(e.slice(0,-1)),i=e[e.length-1],r=n.getChild(i);r&&r.runtime&&n.removeChild(i)};Zs.prototype.isRegistered=function(e){var n=this.get(e.slice(0,-1)),i=e[e.length-1];return n?n.hasChild(i):!1};function w1(t,e,n){if(e.update(n),n.modules)for(var i in n.modules){if(!e.getChild(i))return;w1(t.concat(i),e.getChild(i),n.modules[i])}}function UZ(t){return new Qn(t)}var Qn=function(e){var n=this;e===void 0&&(e={});var i=e.plugins;i===void 0&&(i=[]);var r=e.strict;r===void 0&&(r=!1);var s=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new Zs(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=s;var o=this,a=this,l=a.dispatch,c=a.commit;this.dispatch=function(d,f){return l.call(o,d,f)},this.commit=function(d,f,p){return c.call(o,d,f,p)},this.strict=r;var h=this._modules.root.state;gh(this,h,[],this._modules.root),_g(this,h),i.forEach(function(u){return u(n)})},Eg={state:{configurable:!0}};Qn.prototype.install=function(e,n){e.provide(n||h1,this),e.config.globalProperties.$store=this;var i=this._devtools!==void 0?this._devtools:!1;i&&BZ(e,this)};Eg.state.get=function(){return this._state.data};Eg.state.set=function(t){};Qn.prototype.commit=function(e,n,i){var r=this,s=vu(e,n,i),o=s.type,a=s.payload,l={type:o,payload:a},c=this._mutations[o];c&&(this._withCommit(function(){c.forEach(function(u){u(a)})}),this._subscribers.slice().forEach(function(h){return h(l,r.state)}))};Qn.prototype.dispatch=function(e,n){var i=this,r=vu(e,n),s=r.type,o=r.payload,a={type:s,payload:o},l=this._actions[s];if(l){try{this._actionSubscribers.slice().filter(function(h){return h.before}).forEach(function(h){return h.before(a,i.state)})}catch{}var c=l.length>1?Promise.all(l.map(function(h){return h(o)})):l[0](o);return new Promise(function(h,u){c.then(function(d){try{i._actionSubscribers.filter(function(f){return f.after}).forEach(function(f){return f.after(a,i.state)})}catch{}h(d)},function(d){try{i._actionSubscribers.filter(function(f){return f.error}).forEach(function(f){return f.error(a,i.state,d)})}catch{}u(d)})})}};Qn.prototype.subscribe=function(e,n){return f1(e,this._subscribers,n)};Qn.prototype.subscribeAction=function(e,n){var i=typeof e=="function"?{before:e}:e;return f1(i,this._actionSubscribers,n)};Qn.prototype.watch=function(e,n,i){var r=this;return Rf(function(){return e(r.state,r.getters)},n,Object.assign({},i))};Qn.prototype.replaceState=function(e){var n=this;this._withCommit(function(){n._state.data=e})};Qn.prototype.registerModule=function(e,n,i){i===void 0&&(i={}),typeof e=="string"&&(e=[e]),this._modules.register(e,n),gh(this,this.state,e,this._modules.get(e),i.preserveState),_g(this,this.state)};Qn.prototype.unregisterModule=function(e){var n=this;typeof e=="string"&&(e=[e]),this._modules.unregister(e),this._withCommit(function(){var i=Sg(n.state,e.slice(0,-1));delete i[e[e.length-1]]}),p1(this)};Qn.prototype.hasModule=function(e){return typeof e=="string"&&(e=[e]),this._modules.isRegistered(e)};Qn.prototype.hotUpdate=function(e){this._modules.update(e),p1(this,!0)};Qn.prototype._withCommit=function(e){var n=this._committing;this._committing=!0,e(),this._committing=n};Object.defineProperties(Qn.prototype,Eg);var Int=Ag(function(t,e){var n={};return Tg(e).forEach(function(i){var r=i.key,s=i.val;n[r]=function(){var a=this.$store.state,l=this.$store.getters;if(t){var c=Cg(this.$store,"mapState",t);if(!c)return;a=c.context.state,l=c.context.getters}return typeof s=="function"?s.call(this,a,l):a[s]},n[r].vuex=!0}),n}),knt=Ag(function(t,e){var n={};return Tg(e).forEach(function(i){var r=i.key,s=i.val;s=t+s,n[r]=function(){if(!(t&&!Cg(this.$store,"mapGetters",t)))return this.$store.getters[s]},n[r].vuex=!0}),n}),Ont=Ag(function(t,e){var n={};return Tg(e).forEach(function(i){var r=i.key,s=i.val;n[r]=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var c=this.$store.dispatch;if(t){var h=Cg(this.$store,"mapActions",t);if(!h)return;c=h.context.dispatch}return typeof s=="function"?s.apply(this,[c].concat(a)):c.apply(this.$store,[s].concat(a))}}),n});function Tg(t){return jZ(t)?Array.isArray(t)?t.map(function(e){return{key:e,val:e}}):Object.keys(t).map(function(e){return{key:e,val:t[e]}}):[]}function jZ(t){return Array.isArray(t)||d1(t)}function Ag(t){return function(e,n){return typeof e!="string"?(n=e,e=""):e.charAt(e.length-1)!=="/"&&(e+="/"),t(e,n)}}function Cg(t,e,n){var i=t._modulesNamespaceMap[n];return i}var _1={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(vs,function(){function n(I){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(y){return typeof y}:n=function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},n(I)}function i(I,y,A){return y in I?Object.defineProperty(I,y,{value:A,enumerable:!0,configurable:!0,writable:!0}):I[y]=A,I}function r(I){for(var y=1;y<arguments.length;y++){var A=arguments[y]!=null?arguments[y]:{},R=Object.keys(A);typeof Object.getOwnPropertySymbols=="function"&&(R=R.concat(Object.getOwnPropertySymbols(A).filter(function(G){return Object.getOwnPropertyDescriptor(A,G).enumerable}))),R.forEach(function(G){i(I,G,A[G])})}return I}var s={DEFAULT_INSTANCE:"$default_instance",API_VERSION:2,MAX_STRING_LENGTH:4096,MAX_PROPERTY_KEYS:1e3,IDENTIFY_EVENT:"$identify",GROUP_IDENTIFY_EVENT:"$groupidentify",LAST_EVENT_ID:"amplitude_lastEventId",LAST_EVENT_TIME:"amplitude_lastEventTime",LAST_IDENTIFY_ID:"amplitude_lastIdentifyId",LAST_SEQUENCE_NUMBER:"amplitude_lastSequenceNumber",SESSION_ID:"amplitude_sessionId",DEVICE_ID:"amplitude_deviceId",OPT_OUT:"amplitude_optOut",USER_ID:"amplitude_userId",COOKIE_TEST:"amplitude_cookie_test",REVENUE_EVENT:"revenue_amount",REVENUE_PRODUCT_ID:"$productId",REVENUE_QUANTITY:"$quantity",REVENUE_PRICE:"$price",REVENUE_REVENUE_TYPE:"$revenueType",AMP_DEVICE_ID_PARAM:"amp_device_id",REFERRER:"referrer",UTM_SOURCE:"utm_source",UTM_MEDIUM:"utm_medium",UTM_CAMPAIGN:"utm_campaign",UTM_TERM:"utm_term",UTM_CONTENT:"utm_content"},o={encode:function(y){for(var A="",R=0;R<y.length;R++){var G=y.charCodeAt(R);G<128?A+=String.fromCharCode(G):G>127&&G<2048?(A+=String.fromCharCode(G>>6|192),A+=String.fromCharCode(G&63|128)):(A+=String.fromCharCode(G>>12|224),A+=String.fromCharCode(G>>6&63|128),A+=String.fromCharCode(G&63|128))}return A},decode:function(y){for(var A="",R=0,G=0,U=0,et=0;R<y.length;)G=y.charCodeAt(R),G<128?(A+=String.fromCharCode(G),R++):G>191&&G<224?(U=y.charCodeAt(R+1),A+=String.fromCharCode((G&31)<<6|U&63),R+=2):(U=y.charCodeAt(R+1),et=y.charCodeAt(R+2),A+=String.fromCharCode((G&15)<<12|(U&63)<<6|et&63),R+=3);return A}},a={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(y){try{if(window.btoa&&window.atob)return window.btoa(unescape(encodeURIComponent(y)))}catch{}return a._encode(y)},_encode:function(y){var A="",R,G,U,et,rt,Ot,qt,be=0;for(y=o.encode(y);be<y.length;)R=y.charCodeAt(be++),G=y.charCodeAt(be++),U=y.charCodeAt(be++),et=R>>2,rt=(R&3)<<4|G>>4,Ot=(G&15)<<2|U>>6,qt=U&63,isNaN(G)?Ot=qt=64:isNaN(U)&&(qt=64),A=A+a._keyStr.charAt(et)+a._keyStr.charAt(rt)+a._keyStr.charAt(Ot)+a._keyStr.charAt(qt);return A},decode:function(y){try{if(window.btoa&&window.atob)return decodeURIComponent(escape(window.atob(y)))}catch{}return a._decode(y)},_decode:function(y){var A="",R,G,U,et,rt,Ot,qt,be=0;for(y=y.replace(/[^A-Za-z0-9\+\/\=]/g,"");be<y.length;)et=a._keyStr.indexOf(y.charAt(be++)),rt=a._keyStr.indexOf(y.charAt(be++)),Ot=a._keyStr.indexOf(y.charAt(be++)),qt=a._keyStr.indexOf(y.charAt(be++)),R=et<<2|rt>>4,G=(rt&15)<<4|Ot>>2,U=(Ot&3)<<6|qt,A=A+String.fromCharCode(R),Ot!==64&&(A=A+String.fromCharCode(G)),qt!==64&&(A=A+String.fromCharCode(U));return A=o.decode(A),A}},l=Object.prototype.toString;function c(I){switch(l.call(I)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return I===null?"null":I===void 0?"undefined":I!==I?"nan":I&&I.nodeType===1?"element":typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(I)?"buffer":(I=I.valueOf?I.valueOf():Object.prototype.valueOf.apply(I),n(I))}var h={DISABLE:0,ERROR:1,WARN:2,INFO:3},u=h.WARN,d=function(y){h.hasOwnProperty(y)&&(u=h[y])},f=function(){return u},p={error:function(y){u>=h.ERROR&&g(y)},warn:function(y){u>=h.WARN&&g(y)},info:function(y){u>=h.INFO&&g(y)}},g=function(y){try{console.log("[Amplitude] "+y)}catch{}},v=function(y){return!y||y.length===0},x=function(){try{if(window.sessionStorage)return!0}catch{}return!1},S=function I(y){if(c(y)==="array")for(var A=0;A<y.length;A++)y[A]=I(y[A]);else if(c(y)==="object")for(var R in y)y.hasOwnProperty(R)&&(y[R]=I(y[R]));else y=C(y);return y},C=function(y){return c(y)==="string"&&y.length>s.MAX_STRING_LENGTH?y.substring(0,s.MAX_STRING_LENGTH):y},P=function(y,A,R){return c(y)!==R?(p.error("Invalid "+A+" input type. Expected "+R+" but received "+c(y)),!1):!0},k=function(y){var A=c(y);if(A!=="object")return p.error("Error: invalid properties format. Expecting Javascript object, received "+A+", ignoring"),{};if(Object.keys(y).length>s.MAX_PROPERTY_KEYS)return p.error("Error: too many properties (more than 1000), ignoring"),{};var R={};for(var G in y)if(y.hasOwnProperty(G)){var U=G,et=c(U);et!=="string"&&(U=String(U),p.warn("WARNING: Non-string property key, received type "+et+', coercing to string "'+U+'"'));var rt=m(U,y[G]);rt!==null&&(R[U]=rt)}return R},N=["nan","function","arguments","regexp","element"],m=function I(y,A){var R=c(A);if(N.indexOf(R)!==-1)p.warn('WARNING: Property key "'+y+'" with invalid value type '+R+", ignoring"),A=null;else if(R==="undefined")A=null;else if(R==="error")A=String(A),p.warn('WARNING: Property key "'+y+'" with value type error, coercing to '+A);else if(R==="array"){for(var G=[],U=0;U<A.length;U++){var et=A[U],rt=c(et);if(rt==="array"){p.warn("WARNING: Cannot have "+rt+" nested in an array property value, skipping");continue}else rt==="object"?G.push(k(et)):G.push(I(y,et))}A=G}else R==="object"&&(A=k(A));return A},b=function(y){var A=c(y);if(A!=="object")return p.error("Error: invalid groups format. Expecting Javascript object, received "+A+", ignoring"),{};var R={};for(var G in y)if(y.hasOwnProperty(G)){var U=G,et=c(U);et!=="string"&&(U=String(U),p.warn("WARNING: Non-string groupType, received type "+et+', coercing to string "'+U+'"'));var rt=w(U,y[G]);rt!==null&&(R[U]=rt)}return R},w=function(y,A){var R=c(A);if(R==="string")return A;if(R==="date"||R==="number"||R==="boolean")return A=String(A),p.warn("WARNING: Non-string groupName, received type "+R+', coercing to string "'+A+'"'),A;if(R==="array"){for(var G=[],U=0;U<A.length;U++){var et=A[U],rt=c(et);if(rt==="array"||rt==="object"){p.warn("WARNING: Skipping nested "+rt+" in array groupName");continue}else rt==="string"?G.push(et):(rt==="date"||rt==="number"||rt==="boolean")&&(et=String(et),p.warn("WARNING: Non-string groupName, received type "+rt+', coercing to string "'+et+'"'),G.push(et))}return G}p.warn("WARNING: Non-string groupName, received type "+R+". Please use strings or array of strings for groupName")},T=function(y,A){y=y.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var R=new RegExp("[\\?&]"+y+"=([^&#]*)"),G=R.exec(A);return G===null?void 0:decodeURIComponent(G[1].replace(/\+/g," "))},E={setLogLevel:d,getLogLevel:f,logLevels:h,log:p,isEmptyString:v,getQueryParam:T,sessionStorageEnabled:x,truncate:S,validateGroups:b,validateInput:P,validateProperties:k},D=function(){return window.location},$=function(y){try{for(var A=document.cookie.split(";"),R=null,G=0;G<A.length;G++){for(var U=A[G];U.charAt(0)===" ";)U=U.substring(1,U.length);if(U.indexOf(y)===0){R=U.substring(y.length,U.length);break}}return R}catch{return null}},z=function(y,A,R){var G=A!==null?R.expirationDays:-1;if(G){var U=new Date;U.setTime(U.getTime()+G*24*60*60*1e3),G=U}var et=y+"="+A;G&&(et+="; expires="+G.toUTCString()),et+="; path=/",R.domain&&(et+="; domain="+R.domain),R.secure&&(et+="; Secure"),R.sameSite&&(et+="; SameSite="+R.sameSite),document.cookie=et},j={set:z,get:$},O={expirationDays:void 0,domain:void 0},B=function(){O={expirationDays:void 0,domain:void 0}},V=function(y){var A=document.createElement("a");return A.href=y,A.hostname||location.hostname},F=function(y){var A=V(y),R=A.split("."),G=R[R.length-1],U=[];if(R.length===4&&G===parseInt(G,10)||R.length<=1)return U;for(var et=R.length-2;et>=0;--et)U.push(R.slice(et).join("."));for(var rt=0;rt<U.length;++rt){var Ot="__tld_test__",qt=U[rt],be={domain:"."+qt};if(j.set(Ot,1,be),j.get(Ot))return j.set(Ot,null,be),qt}return""},At=function(y){if(arguments.length===0)return O;y=y||{},O.expirationDays=y.expirationDays,O.secure=y.secure,O.sameSite=y.sameSite;var A=E.isEmptyString(y.domain)?"."+F(D().href):y.domain,R=Math.random();O.domain=A,re("amplitude_test",R);var G=zt("amplitude_test");return(!G||G!==R)&&(A=null),wt("amplitude_test"),O.domain=A,O},vt=function(y){var A="";return O.domain&&(A=O.domain.charAt(0)==="."?O.domain.substring(1):O.domain),y+A},zt=function(y){var A=vt(y)+"=",R=j.get(A);try{if(R)return JSON.parse(a.decode(R))}catch{return null}return null},re=function(y,A){try{return j.set(vt(y),a.encode(JSON.stringify(A)),O),!0}catch{return!1}},wt=function(y){try{return j.set(vt(y),null,O),!0}catch{return!1}},Tt={reset:B,options:At,get:zt,set:re,remove:wt},Pt;{var It=function(){var y=new Date,A;try{return window.localStorage.setItem(y,y),A=window.localStorage.getItem(y)===String(y),window.localStorage.removeItem(y),A}catch{}return!1};if(It())Pt=window.localStorage;else if(window.globalStorage)try{Pt=window.globalStorage[window.location.hostname]}catch{}else if(typeof document<"u"){var mt=document.createElement("div"),Bt="localStorage";mt.style.display="none",document.getElementsByTagName("head")[0].appendChild(mt),mt.addBehavior&&(mt.addBehavior("#default#userdata"),Pt={length:0,setItem:function(y,A){mt.load(Bt),mt.getAttribute(y)||this.length++,mt.setAttribute(y,A),mt.save(Bt)},getItem:function(y){return mt.load(Bt),mt.getAttribute(y)},removeItem:function(y){mt.load(Bt),mt.getAttribute(y)&&this.length--,mt.removeAttribute(y),mt.save(Bt)},clear:function(){mt.load(Bt);for(var y=0,A;A=mt.XMLDocument.documentElement.attributes[y++];)mt.removeAttribute(A.name);mt.save(Bt),this.length=0},key:function(y){return mt.load(Bt),mt.XMLDocument.documentElement.attributes[y]}},mt.load(Bt),Pt.length=mt.XMLDocument.documentElement.attributes.length)}Pt||(Pt={length:0,setItem:function(y,A){},getItem:function(y){},removeItem:function(y){},clear:function(){},key:function(y){}})}var Ct=Pt,W=function(){this.storage=null};W.prototype._cookiesEnabled=function(){var I=String(new Date),y;try{return Tt.set(s.COOKIE_TEST,I),y=Tt.get(s.COOKIE_TEST)===I,Tt.remove(s.COOKIE_TEST),y}catch{}return!1},W.prototype.getStorage=function(){if(this.storage!==null)return this.storage;if(this._cookiesEnabled())this.storage=Tt;else{var I="amp_cookiestore_";this.storage={_options:{expirationDays:void 0,domain:void 0,secure:!1},reset:function(){this._options={expirationDays:void 0,domain:void 0,secure:!1}},options:function(A){return arguments.length===0?this._options:(A=A||{},this._options.expirationDays=A.expirationDays||this._options.expirationDays,this._options.domain=A.domain||this._options.domain||window&&window.location&&window.location.hostname,this._options.secure=A.secure||!1)},get:function(A){try{return JSON.parse(Ct.getItem(I+A))}catch{}return null},set:function(A,R){try{return Ct.setItem(I+A,JSON.stringify(R)),!0}catch{}return!1},remove:function(A){try{Ct.removeItem(I+A)}catch{return!1}}}}return this.storage};var Y=function(y,A){var R=y?"?"+y.split(".").slice(-1)[0].replace(/\|/g,"&"):"",G=function(ft,ut,ot,xt){return E.getQueryParam(ft,ut)||E.getQueryParam(ot,xt)},U=G(s.UTM_SOURCE,A,"utmcsr",R),et=G(s.UTM_MEDIUM,A,"utmcmd",R),rt=G(s.UTM_CAMPAIGN,A,"utmccn",R),Ot=G(s.UTM_TERM,A,"utmctr",R),qt=G(s.UTM_CONTENT,A,"utmcct",R),be={},de=function(ft,ut){E.isEmptyString(ut)||(be[ft]=ut)};return de(s.UTM_SOURCE,U),de(s.UTM_MEDIUM,et),de(s.UTM_CAMPAIGN,rt),de(s.UTM_TERM,Ot),de(s.UTM_CONTENT,qt),be},tt="$add",St="$append",se="$clearAll",Dt="$prepend",yt="$set",Me="$setOnce",We="$unset",he=function(){this.userPropertiesOperations={},this.properties=[]};he.prototype.add=function(I,y){return c(y)==="number"||c(y)==="string"?this._addOperation(tt,I,y):E.log.error("Unsupported type for value: "+c(y)+", expecting number or string"),this},he.prototype.append=function(I,y){return this._addOperation(St,I,y),this},he.prototype.clearAll=function(){return Object.keys(this.userPropertiesOperations).length>0?(this.userPropertiesOperations.hasOwnProperty(se)||E.log.error("Need to send $clearAll on its own Identify object without any other operations, skipping $clearAll"),this):(this.userPropertiesOperations[se]="-",this)},he.prototype.prepend=function(I,y){return this._addOperation(Dt,I,y),this},he.prototype.set=function(I,y){return this._addOperation(yt,I,y),this},he.prototype.setOnce=function(I,y){return this._addOperation(Me,I,y),this},he.prototype.unset=function(I){return this._addOperation(We,I,"-"),this},he.prototype._addOperation=function(I,y,A){if(this.userPropertiesOperations.hasOwnProperty(se)){E.log.error("This identify already contains a $clearAll operation, skipping operation "+I);return}if(this.properties.indexOf(y)!==-1){E.log.error('User property "'+y+'" already used in this identify, skipping operation '+I);return}this.userPropertiesOperations.hasOwnProperty(I)||(this.userPropertiesOperations[I]={}),this.userPropertiesOperations[I][y]=A,this.properties.push(y)};var ir=typeof window<"u"?window:typeof vs<"u"?vs:typeof self<"u"?self:{};function no(I,y){return y={exports:{}},I(y,y.exports),y.exports}var fa=no(function(I){(function(y){function A(X,kt){var nt=(X&65535)+(kt&65535),Yt=(X>>16)+(kt>>16)+(nt>>16);return Yt<<16|nt&65535}function R(X,kt){return X<<kt|X>>>32-kt}function G(X,kt,nt,Yt,ae,Fe){return A(R(A(A(kt,X),A(Yt,Fe)),ae),nt)}function U(X,kt,nt,Yt,ae,Fe,Cn){return G(kt&nt|~kt&Yt,X,kt,ae,Fe,Cn)}function et(X,kt,nt,Yt,ae,Fe,Cn){return G(kt&Yt|nt&~Yt,X,kt,ae,Fe,Cn)}function rt(X,kt,nt,Yt,ae,Fe,Cn){return G(kt^nt^Yt,X,kt,ae,Fe,Cn)}function Ot(X,kt,nt,Yt,ae,Fe,Cn){return G(nt^(kt|~Yt),X,kt,ae,Fe,Cn)}function qt(X,kt){X[kt>>5]|=128<<kt%32,X[(kt+64>>>9<<4)+14]=kt;var nt,Yt,ae,Fe,Cn,lt=1732584193,ht=-271733879,dt=-1732584194,J=271733878;for(nt=0;nt<X.length;nt+=16)Yt=lt,ae=ht,Fe=dt,Cn=J,lt=U(lt,ht,dt,J,X[nt],7,-680876936),J=U(J,lt,ht,dt,X[nt+1],12,-389564586),dt=U(dt,J,lt,ht,X[nt+2],17,606105819),ht=U(ht,dt,J,lt,X[nt+3],22,-1044525330),lt=U(lt,ht,dt,J,X[nt+4],7,-176418897),J=U(J,lt,ht,dt,X[nt+5],12,1200080426),dt=U(dt,J,lt,ht,X[nt+6],17,-1473231341),ht=U(ht,dt,J,lt,X[nt+7],22,-45705983),lt=U(lt,ht,dt,J,X[nt+8],7,1770035416),J=U(J,lt,ht,dt,X[nt+9],12,-1958414417),dt=U(dt,J,lt,ht,X[nt+10],17,-42063),ht=U(ht,dt,J,lt,X[nt+11],22,-1990404162),lt=U(lt,ht,dt,J,X[nt+12],7,1804603682),J=U(J,lt,ht,dt,X[nt+13],12,-40341101),dt=U(dt,J,lt,ht,X[nt+14],17,-1502002290),ht=U(ht,dt,J,lt,X[nt+15],22,1236535329),lt=et(lt,ht,dt,J,X[nt+1],5,-165796510),J=et(J,lt,ht,dt,X[nt+6],9,-1069501632),dt=et(dt,J,lt,ht,X[nt+11],14,643717713),ht=et(ht,dt,J,lt,X[nt],20,-373897302),lt=et(lt,ht,dt,J,X[nt+5],5,-701558691),J=et(J,lt,ht,dt,X[nt+10],9,38016083),dt=et(dt,J,lt,ht,X[nt+15],14,-660478335),ht=et(ht,dt,J,lt,X[nt+4],20,-405537848),lt=et(lt,ht,dt,J,X[nt+9],5,568446438),J=et(J,lt,ht,dt,X[nt+14],9,-1019803690),dt=et(dt,J,lt,ht,X[nt+3],14,-187363961),ht=et(ht,dt,J,lt,X[nt+8],20,1163531501),lt=et(lt,ht,dt,J,X[nt+13],5,-1444681467),J=et(J,lt,ht,dt,X[nt+2],9,-51403784),dt=et(dt,J,lt,ht,X[nt+7],14,1735328473),ht=et(ht,dt,J,lt,X[nt+12],20,-1926607734),lt=rt(lt,ht,dt,J,X[nt+5],4,-378558),J=rt(J,lt,ht,dt,X[nt+8],11,-2022574463),dt=rt(dt,J,lt,ht,X[nt+11],16,1839030562),ht=rt(ht,dt,J,lt,X[nt+14],23,-35309556),lt=rt(lt,ht,dt,J,X[nt+1],4,-1530992060),J=rt(J,lt,ht,dt,X[nt+4],11,1272893353),dt=rt(dt,J,lt,ht,X[nt+7],16,-155497632),ht=rt(ht,dt,J,lt,X[nt+10],23,-1094730640),lt=rt(lt,ht,dt,J,X[nt+13],4,681279174),J=rt(J,lt,ht,dt,X[nt],11,-358537222),dt=rt(dt,J,lt,ht,X[nt+3],16,-722521979),ht=rt(ht,dt,J,lt,X[nt+6],23,76029189),lt=rt(lt,ht,dt,J,X[nt+9],4,-640364487),J=rt(J,lt,ht,dt,X[nt+12],11,-421815835),dt=rt(dt,J,lt,ht,X[nt+15],16,530742520),ht=rt(ht,dt,J,lt,X[nt+2],23,-995338651),lt=Ot(lt,ht,dt,J,X[nt],6,-198630844),J=Ot(J,lt,ht,dt,X[nt+7],10,1126891415),dt=Ot(dt,J,lt,ht,X[nt+14],15,-1416354905),ht=Ot(ht,dt,J,lt,X[nt+5],21,-57434055),lt=Ot(lt,ht,dt,J,X[nt+12],6,1700485571),J=Ot(J,lt,ht,dt,X[nt+3],10,-1894986606),dt=Ot(dt,J,lt,ht,X[nt+10],15,-1051523),ht=Ot(ht,dt,J,lt,X[nt+1],21,-2054922799),lt=Ot(lt,ht,dt,J,X[nt+8],6,1873313359),J=Ot(J,lt,ht,dt,X[nt+15],10,-30611744),dt=Ot(dt,J,lt,ht,X[nt+6],15,-1560198380),ht=Ot(ht,dt,J,lt,X[nt+13],21,1309151649),lt=Ot(lt,ht,dt,J,X[nt+4],6,-145523070),J=Ot(J,lt,ht,dt,X[nt+11],10,-1120210379),dt=Ot(dt,J,lt,ht,X[nt+2],15,718787259),ht=Ot(ht,dt,J,lt,X[nt+9],21,-343485551),lt=A(lt,Yt),ht=A(ht,ae),dt=A(dt,Fe),J=A(J,Cn);return[lt,ht,dt,J]}function be(X){var kt,nt="",Yt=X.length*32;for(kt=0;kt<Yt;kt+=8)nt+=String.fromCharCode(X[kt>>5]>>>kt%32&255);return nt}function de(X){var kt,nt=[];for(nt[(X.length>>2)-1]=void 0,kt=0;kt<nt.length;kt+=1)nt[kt]=0;var Yt=X.length*8;for(kt=0;kt<Yt;kt+=8)nt[kt>>5]|=(X.charCodeAt(kt/8)&255)<<kt%32;return nt}function st(X){return be(qt(de(X),X.length*8))}function ft(X,kt){var nt,Yt=de(X),ae=[],Fe=[],Cn;for(ae[15]=Fe[15]=void 0,Yt.length>16&&(Yt=qt(Yt,X.length*8)),nt=0;nt<16;nt+=1)ae[nt]=Yt[nt]^909522486,Fe[nt]=Yt[nt]^1549556828;return Cn=qt(ae.concat(de(kt)),512+kt.length*8),be(qt(Fe.concat(Cn),512+128))}function ut(X){var kt="0123456789abcdef",nt="",Yt,ae;for(ae=0;ae<X.length;ae+=1)Yt=X.charCodeAt(ae),nt+=kt.charAt(Yt>>>4&15)+kt.charAt(Yt&15);return nt}function ot(X){return unescape(encodeURIComponent(X))}function xt(X){return st(ot(X))}function Un(X){return ut(xt(X))}function jn(X,kt){return ft(ot(X),ot(kt))}function fe(X,kt){return ut(jn(X,kt))}function Ht(X,kt,nt){return kt?nt?jn(kt,X):fe(kt,X):nt?xt(X):Un(X)}I.exports?I.exports=Ht:y.md5=Ht})(ir)}),ls=function(I){return encodeURIComponent(I).replace(/[!'()*]/g,function(y){return"%"+y.charCodeAt(0).toString(16).toUpperCase()})};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var $r=Object.getOwnPropertySymbols,dn=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable;function pa(I){if(I==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(I)}function Sh(){try{if(!Object.assign)return!1;var I=new String("abc");if(I[5]="de",Object.getOwnPropertyNames(I)[0]==="5")return!1;for(var y={},A=0;A<10;A++)y["_"+String.fromCharCode(A)]=A;var R=Object.getOwnPropertyNames(y).map(function(U){return y[U]});if(R.join("")!=="0123456789")return!1;var G={};return"abcdefghijklmnopqrst".split("").forEach(function(U){G[U]=U}),Object.keys(Object.assign({},G)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var jl=Sh()?Object.assign:function(I,y){for(var A,R=pa(I),G,U=1;U<arguments.length;U++){A=Object(arguments[U]);for(var et in A)dn.call(A,et)&&(R[et]=A[et]);if($r){G=$r(A);for(var rt=0;rt<G.length;rt++)He.call(A,G[rt])&&(R[G[rt]]=A[G[rt]])}}return R},Wl="%[a-f0-9]{2}",Yl=new RegExp(Wl,"gi"),Xl=new RegExp("("+Wl+")+","gi");function ga(I,y){try{return decodeURIComponent(I.join(""))}catch{}if(I.length===1)return I;y=y||1;var A=I.slice(0,y),R=I.slice(y);return Array.prototype.concat.call([],ga(A),ga(R))}function Eh(I){try{return decodeURIComponent(I)}catch{for(var y=I.match(Yl),A=1;A<y.length;A++)I=ga(y,A).join(""),y=I.match(Yl);return I}}function ql(I){for(var y={"%FE%FF":"","%FF%FE":""},A=Xl.exec(I);A;){try{y[A[0]]=decodeURIComponent(A[0])}catch{var R=Eh(A[0]);R!==A[0]&&(y[A[0]]=R)}A=Xl.exec(I)}y["%C2"]="";for(var G=Object.keys(y),U=0;U<G.length;U++){var et=G[U];I=I.replace(new RegExp(et,"g"),y[et])}return I}var ma=function(I){if(typeof I!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof I+"`");try{return I=I.replace(/\+/g," "),decodeURIComponent(I)}catch{return ql(I)}};function Kl(I){switch(I.arrayFormat){case"index":return function(y,A,R){return A===null?[sn(y,I),"[",R,"]"].join(""):[sn(y,I),"[",sn(R,I),"]=",sn(A,I)].join("")};case"bracket":return function(y,A){return A===null?sn(y,I):[sn(y,I),"[]=",sn(A,I)].join("")};default:return function(y,A){return A===null?sn(y,I):[sn(y,I),"=",sn(A,I)].join("")}}}function Zl(I){var y;switch(I.arrayFormat){case"index":return function(A,R,G){if(y=/\[(\d*)\]$/.exec(A),A=A.replace(/\[\d*\]$/,""),!y){G[A]=R;return}G[A]===void 0&&(G[A]={}),G[A][y[1]]=R};case"bracket":return function(A,R,G){if(y=/(\[\])$/.exec(A),A=A.replace(/\[\]$/,""),y){if(G[A]===void 0){G[A]=[R];return}}else{G[A]=R;return}G[A]=[].concat(G[A],R)};default:return function(A,R,G){if(G[A]===void 0){G[A]=R;return}G[A]=[].concat(G[A],R)}}}function sn(I,y){return y.encode?y.strict?ls(I):encodeURIComponent(I):I}function va(I){return Array.isArray(I)?I.sort():typeof I=="object"?va(Object.keys(I)).sort(function(y,A){return Number(y)-Number(A)}).map(function(y){return I[y]}):I}function ya(I){var y=I.indexOf("?");return y===-1?"":I.slice(y+1)}function ba(I,y){y=jl({arrayFormat:"none"},y);var A=Zl(y),R=Object.create(null);return typeof I!="string"||(I=I.trim().replace(/^[?#&]/,""),!I)?R:(I.split("&").forEach(function(G){var U=G.replace(/\+/g," ").split("="),et=U.shift(),rt=U.length>0?U.join("="):void 0;rt=rt===void 0?null:ma(rt),A(ma(et),rt,R)}),Object.keys(R).sort().reduce(function(G,U){var et=R[U];return et&&typeof et=="object"&&!Array.isArray(et)?G[U]=va(et):G[U]=et,G},Object.create(null)))}var Th=ya,Ni=ba,OE=function(I,y){var A={encode:!0,strict:!0,arrayFormat:"none"};y=jl(A,y),y.sort===!1&&(y.sort=function(){});var R=Kl(y);return I?Object.keys(I).sort(y.sort).map(function(G){var U=I[G];if(U===void 0)return"";if(U===null)return sn(G,y);if(Array.isArray(U)){var et=[];return U.slice().forEach(function(rt){rt!==void 0&&et.push(R(G,rt,et.length))}),et.join("&")}return sn(G,y)+"="+sn(U,y)}).filter(function(G){return G.length>0}).join("&"):""},LE=function(I,y){return{url:I.split("?")[0]||"",query:ba(ya(I),y)}},zg={extract:Th,parse:Ni,stringify:OE,parseUrl:LE},Gg=function(y,A){this.url=y,this.data=A||{}};Gg.prototype.send=function(I){var y=!!window.XDomainRequest;if(y){var A=new window.XDomainRequest;A.open("POST",this.url,!0),A.onload=function(){I(200,A.responseText)},A.onerror=function(){A.responseText==="Request Entity Too Large"?I(413,A.responseText):I(500,A.responseText)},A.ontimeout=function(){},A.onprogress=function(){},A.send(zg.stringify(this.data))}else{var R=new XMLHttpRequest;R.open("POST",this.url,!0),R.onreadystatechange=function(){R.readyState===4&&I(R.status,R.responseText)},R.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),R.send(zg.stringify(this.data))}};var Si=function(){this._price=null,this._productId=null,this._quantity=1,this._revenueType=null,this._properties=null};Si.prototype.setProductId=function(y){return c(y)!=="string"?E.log.error("Unsupported type for productId: "+c(y)+", expecting string"):E.isEmptyString(y)?E.log.error("Invalid empty productId"):this._productId=y,this},Si.prototype.setQuantity=function(y){return c(y)!=="number"?E.log.error("Unsupported type for quantity: "+c(y)+", expecting number"):this._quantity=parseInt(y),this},Si.prototype.setPrice=function(y){return c(y)!=="number"?E.log.error("Unsupported type for price: "+c(y)+", expecting number"):this._price=y,this},Si.prototype.setRevenueType=function(y){return c(y)!=="string"?E.log.error("Unsupported type for revenueType: "+c(y)+", expecting string"):this._revenueType=y,this},Si.prototype.setEventProperties=function(y){return c(y)!=="object"?E.log.error("Unsupported type for eventProperties: "+c(y)+", expecting object"):this._properties=E.validateProperties(y),this},Si.prototype._isValidRevenue=function(){return c(this._price)!=="number"?(E.log.error("Invalid revenue, need to set price field"),!1):!0},Si.prototype._toJSONObject=function(){var y=c(this._properties)==="object"?this._properties:{};return this._productId!==null&&(y[s.REVENUE_PRODUCT_ID]=this._productId),this._quantity!==null&&(y[s.REVENUE_QUANTITY]=this._quantity),this._price!==null&&(y[s.REVENUE_PRICE]=this._price),this._revenueType!==null&&(y[s.REVENUE_REVENUE_TYPE]=this._revenueType),y};var Hg=no(function(I,y){/*!
 * UAParser.js v0.7.19
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright  2012-2016 Faisal Salman <fyzlman@gmail.com>
 * Dual licensed under GPLv2 or MIT
 */(function(A,R){var G="0.7.19",U="",et="?",rt="function",Ot="undefined",qt="object",be="string",de="major",st="model",ft="name",ut="type",ot="vendor",xt="version",Un="architecture",jn="console",fe="mobile",Ht="tablet",X="smarttv",kt="wearable",nt="embedded",Yt={extend:function(J,Ve){var xe={};for(var qe in J)Ve[qe]&&Ve[qe].length%2===0?xe[qe]=Ve[qe].concat(J[qe]):xe[qe]=J[qe];return xe},has:function(J,Ve){return typeof J=="string"?Ve.toLowerCase().indexOf(J.toLowerCase())!==-1:!1},lowerize:function(J){return J.toLowerCase()},major:function(J){return typeof J===be?J.replace(/[^\d\.]/g,"").split(".")[0]:R},trim:function(J){return J.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},ae={rgx:function(J,Ve){for(var xe=0,qe,Ke,tc,De,xa,Ri;xe<Ve.length&&!xa;){var Yg=Ve[xe],Xg=Ve[xe+1];for(qe=Ke=0;qe<Yg.length&&!xa;)if(xa=Yg[qe++].exec(J),xa)for(tc=0;tc<Xg.length;tc++)Ri=xa[++Ke],De=Xg[tc],typeof De===qt&&De.length>0?De.length==2?typeof De[1]==rt?this[De[0]]=De[1].call(this,Ri):this[De[0]]=De[1]:De.length==3?typeof De[1]===rt&&!(De[1].exec&&De[1].test)?this[De[0]]=Ri?De[1].call(this,Ri,De[2]):R:this[De[0]]=Ri?Ri.replace(De[1],De[2]):R:De.length==4&&(this[De[0]]=Ri?De[3].call(this,Ri.replace(De[1],De[2])):R):this[De]=Ri||R;xe+=2}},str:function(J,Ve){for(var xe in Ve)if(typeof Ve[xe]===qt&&Ve[xe].length>0){for(var qe=0;qe<Ve[xe].length;qe++)if(Yt.has(Ve[xe][qe],J))return xe===et?R:xe}else if(Yt.has(Ve[xe],J))return xe===et?R:xe;return J}},Fe={browser:{oldsafari:{version:{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},name:{"Opera Mobile":"Opera Mobi","IE Mobile":"IEMobile"}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},name:{"Windows Phone":"Windows Phone OS"}}}},Cn={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[ft,xt],[/(opios)[\/\s]+([\w\.]+)/i],[[ft,"Opera Mini"],xt],[/\s(opr)\/([\w\.]+)/i],[[ft,"Opera"],xt],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[ft,xt],[/(konqueror)\/([\w\.]+)/i],[[ft,"Konqueror"],xt],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[ft,"IE"],xt],[/(edge|edgios|edga)\/((\d+)?[\w\.]+)/i],[[ft,"Edge"],xt],[/(yabrowser)\/([\w\.]+)/i],[[ft,"Yandex"],xt],[/(puffin)\/([\w\.]+)/i],[[ft,"Puffin"],xt],[/(focus)\/([\w\.]+)/i],[[ft,"Firefox Focus"],xt],[/(opt)\/([\w\.]+)/i],[[ft,"Opera Touch"],xt],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[ft,"UCBrowser"],xt],[/(comodo_dragon)\/([\w\.]+)/i],[[ft,/_/g," "],xt],[/((?:android.+)crmo|crios)\/([\w\.]+)/i,/android.+(chrome)\/([\w\.]+)\s+(?:mobile\s?safari)/i],[[ft,"Chrome Mobile"],xt],[/(micromessenger)\/([\w\.]+)/i],[[ft,"WeChat"],xt],[/(brave)\/([\w\.]+)/i],[[ft,"Brave"],xt],[/(qqbrowserlite)\/([\w\.]+)/i],[ft,xt],[/(QQ)\/([\d\.]+)/i],[ft,xt],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[ft,xt],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[ft,xt],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[ft,xt],[/(MetaSr)[\/\s]?([\w\.]+)/i],[ft],[/(LBBROWSER)/i],[ft],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[xt,[ft,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[xt,[ft,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[ft,xt],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[xt,[ft,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[ft,/(.+)/,"$1 WebView"],xt],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[ft,/(.+(?:g|us))(.+)/,"$1 $2"],xt],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[xt,[ft,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[ft,xt],[/(dolfin)\/([\w\.]+)/i],[[ft,"Dolphin"],xt],[/(coast)\/([\w\.]+)/i],[[ft,"Opera Coast"],xt],[/fxios\/([\w\.-]+)/i],[xt,[ft,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[xt,[ft,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[xt,ft],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[ft,"GSA"],xt],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[ft,[xt,ae.str,Fe.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[ft,xt],[/(navigator|netscape)\/([\w\.-]+)/i],[[ft,"Netscape"],xt],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[ft,xt]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[Un,"amd64"]],[/(ia32(?=;))/i],[[Un,Yt.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[Un,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[Un,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[Un,/ower/,"",Yt.lowerize]],[/(sun4\w)[;\)]/i],[[Un,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[Un,Yt.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[st,ot,[ut,Ht]],[/applecoremedia\/[\w\.]+ \((ipad)/],[st,[ot,"Apple"],[ut,Ht]],[/(apple\s{0,1}tv)/i],[[st,"Apple TV"],[ot,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[ot,st,[ut,Ht]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[st,[ot,"Amazon"],[ut,Ht]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[st,ae.str,Fe.device.amazon.model],[ot,"Amazon"],[ut,fe]],[/android.+aft([bms])\sbuild/i],[st,[ot,"Amazon"],[ut,X]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[st,ot,[ut,fe]],[/\((ip[honed|\s\w*]+);/i],[st,[ot,"Apple"],[ut,fe]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[ot,st,[ut,fe]],[/\(bb10;\s(\w+)/i],[st,[ot,"BlackBerry"],[ut,fe]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[st,[ot,"Asus"],[ut,Ht]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[ot,"Sony"],[st,"Xperia Tablet"],[ut,Ht]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[st,[ot,"Sony"],[ut,fe]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[ot,st,[ut,jn]],[/android.+;\s(shield)\sbuild/i],[st,[ot,"Nvidia"],[ut,jn]],[/(playstation\s[34portablevi]+)/i],[st,[ot,"Sony"],[ut,jn]],[/(sprint\s(\w+))/i],[[ot,ae.str,Fe.device.sprint.vendor],[st,ae.str,Fe.device.sprint.model],[ut,fe]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[ot,st,[ut,Ht]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[ot,[st,/_/g," "],[ut,fe]],[/(nexus\s9)/i],[st,[ot,"HTC"],[ut,Ht]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[st,[ot,"Huawei"],[ut,fe]],[/(microsoft);\s(lumia[\s\w]+)/i],[ot,st,[ut,fe]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[st,[ot,"Microsoft"],[ut,jn]],[/(kin\.[onetw]{3})/i],[[st,/\./g," "],[ot,"Microsoft"],[ut,fe]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[st,[ot,"Motorola"],[ut,fe]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[st,[ot,"Motorola"],[ut,Ht]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[ot,Yt.trim],[st,Yt.trim],[ut,X]],[/hbbtv.+maple;(\d+)/i],[[st,/^/,"SmartTV"],[ot,"Samsung"],[ut,X]],[/\(dtv[\);].+(aquos)/i],[st,[ot,"Sharp"],[ut,X]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[ot,"Samsung"],st,[ut,Ht]],[/smart-tv.+(samsung)/i],[ot,[ut,X],st],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[ot,"Samsung"],st,[ut,fe]],[/sie-(\w*)/i],[st,[ot,"Siemens"],[ut,fe]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[ot,"Nokia"],st,[ut,fe]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[st,[ot,"Acer"],[ut,Ht]],[/android.+([vl]k\-?\d{3})\s+build/i],[st,[ot,"LG"],[ut,Ht]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[ot,"LG"],st,[ut,Ht]],[/(lg) netcast\.tv/i],[ot,st,[ut,X]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[st,[ot,"LG"],[ut,fe]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[st,[ot,"Lenovo"],[ut,Ht]],[/linux;.+((jolla));/i],[ot,st,[ut,fe]],[/((pebble))app\/[\d\.]+\s/i],[ot,st,[ut,kt]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[ot,st,[ut,fe]],[/crkey/i],[[st,"Chromecast"],[ot,"Google"]],[/android.+;\s(glass)\s\d/i],[st,[ot,"Google"],[ut,kt]],[/android.+;\s(pixel c)[\s)]/i],[st,[ot,"Google"],[ut,Ht]],[/android.+;\s(pixel( [23])?( xl)?)\s/i],[st,[ot,"Google"],[ut,fe]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[st,/_/g," "],[ot,"Xiaomi"],[ut,fe]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[st,/_/g," "],[ot,"Xiaomi"],[ut,Ht]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[st,[ot,"Meizu"],[ut,Ht]],[/(mz)-([\w-]{2,})/i],[[ot,"Meizu"],st,[ut,fe]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[st,[ot,"OnePlus"],[ut,fe]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[st,[ot,"RCA"],[ut,Ht]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[st,[ot,"Dell"],[ut,Ht]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[st,[ot,"Verizon"],[ut,Ht]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[ot,"Barnes & Noble"],st,[ut,Ht]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[st,[ot,"NuVision"],[ut,Ht]],[/android.+;\s(k88)\sbuild/i],[st,[ot,"ZTE"],[ut,Ht]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[st,[ot,"Swiss"],[ut,fe]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[st,[ot,"Swiss"],[ut,Ht]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[st,[ot,"Zeki"],[ut,Ht]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[ot,"Dragon Touch"],st,[ut,Ht]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[st,[ot,"Insignia"],[ut,Ht]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[st,[ot,"NextBook"],[ut,Ht]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[ot,"Voice"],st,[ut,fe]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[ot,"LvTel"],st,[ut,fe]],[/android.+;\s(PH-1)\s/i],[st,[ot,"Essential"],[ut,fe]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[st,[ot,"Envizen"],[ut,Ht]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[ot,st,[ut,Ht]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[st,[ot,"MachSpeed"],[ut,Ht]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[ot,st,[ut,Ht]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[st,[ot,"Rotor"],[ut,Ht]],[/android.+(KS(.+))\s+build/i],[st,[ot,"Amazon"],[ut,Ht]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[ot,st,[ut,Ht]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[ut,Yt.lowerize],ot,st],[/[\s\/\(](smart-?tv)[;\)]/i],[[ut,X]],[/(android[\w\.\s\-]{0,9});.+build/i],[st,[ot,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[xt,[ft,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)/i],[[ft,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[ft,xt],[/rv\:([\w\.]{1,9}).+(gecko)/i],[xt,ft]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[ft,xt],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[[ft,ae.str,Fe.os.windows.name],[xt,ae.str,Fe.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[ft,"Windows"],[xt,ae.str,Fe.os.windows.version]],[/\((bb)(10);/i],[[ft,"BlackBerry"],xt],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[ft,xt],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[ft,"Symbian"],xt],[/\((series40);/i],[ft],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[ft,"Firefox OS"],xt],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[[ft,"Linux"],xt],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[ft,"Chromium OS"],xt],[/(sunos)\s?([\w\.\d]*)/i],[[ft,"Solaris"],xt],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[[ft,"Linux"],xt],[/(iphone)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[ft,"iPhone"],[xt,/_/g,"."]],[/(ipad)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[ft,"iPad"],[xt,/_/g,"."]],[/(haiku)\s(\w+)/i],[ft,xt],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[xt,/_/g,"."],[ft,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[ft,"Mac"],[xt,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[ft,xt]]},lt=function(J,Ve){if(typeof J=="object"&&(Ve=J,J=R),!(this instanceof lt))return new lt(J,Ve).getResult();var xe=J||(A&&A.navigator&&A.navigator.userAgent?A.navigator.userAgent:U),qe=Ve?Yt.extend(Cn,Ve):Cn;return this.getBrowser=function(){var Ke={name:R,version:R};return ae.rgx.call(Ke,xe,qe.browser),Ke.major=Yt.major(Ke.version),Ke},this.getCPU=function(){var Ke={architecture:R};return ae.rgx.call(Ke,xe,qe.cpu),Ke},this.getDevice=function(){var Ke={vendor:R,model:R,type:R};return ae.rgx.call(Ke,xe,qe.device),Ke},this.getEngine=function(){var Ke={name:R,version:R};return ae.rgx.call(Ke,xe,qe.engine),Ke},this.getOS=function(){var Ke={name:R,version:R};return ae.rgx.call(Ke,xe,qe.os),Ke},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return xe},this.setUA=function(Ke){return xe=Ke,this},this};lt.VERSION=G,lt.BROWSER={NAME:ft,MAJOR:de,VERSION:xt},lt.CPU={ARCHITECTURE:Un},lt.DEVICE={MODEL:st,VENDOR:ot,TYPE:ut,CONSOLE:jn,MOBILE:fe,SMARTTV:X,TABLET:Ht,WEARABLE:kt,EMBEDDED:nt},lt.ENGINE={NAME:ft,VERSION:xt},lt.OS={NAME:ft,VERSION:xt},I.exports&&(y=I.exports=lt),y.UAParser=lt;var ht=A&&(A.jQuery||A.Zepto);if(typeof ht!==Ot&&!ht.ua){var dt=new lt;ht.ua=dt.getResult(),ht.ua.get=function(){return dt.getUA()},ht.ua.set=function(J){dt.setUA(J);var Ve=dt.getResult();for(var xe in Ve)ht.ua[xe]=Ve[xe]}}})(typeof window=="object"?window:ir)});Hg.UAParser;var Ah=function I(y){return y?(y^Math.random()*16>>y/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,I)},Ch="5.11.0",ME=function(){return navigator&&(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage)||void 0},DE={language:ME()},NE="Web",Ph={apiEndpoint:"api.amplitude.com",batchEvents:!1,cookieExpiration:365*10,cookieName:"amplitude_id",sameSiteCookie:"None",deviceIdFromUrlParam:!1,domain:"",eventUploadPeriodMillis:30*1e3,eventUploadThreshold:30,forceHttps:!0,includeGclid:!1,includeReferrer:!1,includeUtm:!1,language:DE.language,logLevel:"WARN",optOut:!1,onError:function(){},platform:NE,savedMaxCount:1e3,saveEvents:!0,saveParamsReferrerOncePerSession:!0,secureCookie:!1,sessionTimeout:30*60*1e3,trackingOptions:{city:!0,country:!0,carrier:!0,device_manufacturer:!0,device_model:!0,dma:!0,ip_address:!0,language:!0,os_name:!0,os_version:!0,platform:!0,region:!0,version_name:!0},unsetParamsReferrerOnNewSession:!1,unsentKey:"amplitude_unsent",unsentIdentifyKey:"amplitude_unsent_identify",uploadBatchSize:100},rr,pnt,Mt=function(y){this._instanceName=E.isEmptyString(y)?s.DEFAULT_INSTANCE:y.toLowerCase(),this._legacyStorageSuffix=this._instanceName===s.DEFAULT_INSTANCE?"":"_"+this._instanceName,this._unsentEvents=[],this._unsentIdentifys=[],this._ua=new Hg(navigator.userAgent).getResult(),this.options=r({},Ph,{trackingOptions:r({},Ph.trackingOptions)}),this.cookieStorage=new W().getStorage(),this._q=[],this._sending=!1,this._updateScheduled=!1,this._onInit=[],this._eventId=0,this._identifyId=0,this._lastEventTime=null,this._newSession=!1,this._sequenceNumber=0,this._sessionId=null,this._isInitialized=!1,this._userAgent=navigator&&navigator.userAgent||null};Mt.prototype.Identify=he,Mt.prototype.Revenue=Si,Mt.prototype.init=function(y,A,R,G){var U=this;if(c(y)!=="string"||E.isEmptyString(y)){E.log.error("Invalid apiKey. Please re-initialize with a valid apiKey");return}try{this.options.apiKey=y,this._storageSuffix="_"+y+this._legacyStorageSuffix;var et=!!this.cookieStorage.get(this.options.cookieName+this._storageSuffix);if(R&&R.deferInitialization&&!et){this._deferInitialization(y,A,R,G);return}RE(this.options,R),c(this.options.logLevel)==="string"&&E.setLogLevel(this.options.logLevel);var rt=BE(this);this._apiPropertiesTrackingOptions=Object.keys(rt).length>0?{tracking_options:rt}:{},this.cookieStorage.options({expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie}),this.options.domain=this.cookieStorage.options().domain,this._instanceName===s.DEFAULT_INSTANCE&&$E(this),Ih(this),this._pendingReadStorage=!0;var Ot=function(be){U.options.deviceId=c(R)==="object"&&c(R.deviceId)==="string"&&!E.isEmptyString(R.deviceId)&&R.deviceId||U.options.deviceIdFromUrlParam&&U._getDeviceIdFromUrlParam(U._getUrlParams())||U.options.deviceId||be||Ah()+"R",U.options.userId=c(A)==="string"&&!E.isEmptyString(A)&&A||c(A)==="number"&&A.toString()||U.options.userId||null;var de=new Date().getTime();if((!U._sessionId||!U._lastEventTime||de-U._lastEventTime>U.options.sessionTimeout)&&(U.options.unsetParamsReferrerOnNewSession&&U._unsetUTMParams(),U._newSession=!0,U._sessionId=de,U.options.saveParamsReferrerOncePerSession&&U._trackParamsAndReferrer()),U.options.saveParamsReferrerOncePerSession||U._trackParamsAndReferrer(),U.options.saveEvents){for(var st=0;st<U._unsentEvents.length;st++){var ft=U._unsentEvents[st].event_properties,ut=U._unsentEvents[st].groups;U._unsentEvents[st].event_properties=E.validateProperties(ft),U._unsentEvents[st].groups=E.validateGroups(ut)}for(var ot=0;ot<U._unsentIdentifys.length;ot++){var xt=U._unsentIdentifys[ot].user_properties,Un=U._unsentIdentifys[ot].groups;U._unsentIdentifys[ot].user_properties=E.validateProperties(xt),U._unsentIdentifys[ot].groups=E.validateGroups(Un)}}U._lastEventTime=de,sr(U),U._pendingReadStorage=!1,U._sendEventsIfReady();for(var jn=0;jn<U._onInit.length;jn++)U._onInit[jn]();U._onInit=[],U._isInitialized=!0};rr||(this.options.saveEvents&&(this._unsentEvents=this._loadSavedUnsentEvents(this.options.unsentKey).concat(this._unsentEvents),this._unsentIdentifys=this._loadSavedUnsentEvents(this.options.unsentIdentifyKey).concat(this._unsentIdentifys)),Ot(),this.runQueuedFunctions(),c(G)==="function"&&G(this))}catch(qt){E.log.error(qt),this.options.onError(qt)}},Mt.prototype._migrateUnsentEvents=function(y){var A=this;Promise.all([rr.getItem(this.options.unsentKey),rr.getItem(this.options.unsentIdentifyKey)]).then(function(R){if(A.options.saveEvents){var G=R[0],U=R[1],et=[],rt=[];G&&(et.push(rr.setItem(A.options.unsentKey+A._storageSuffix,JSON.stringify(G))),rt.push(rr.removeItem(A.options.unsentKey))),U&&(et.push(rr.setItem(A.options.unsentIdentifyKey+A._storageSuffix,JSON.stringify(U))),rt.push(rr.removeItem(A.options.unsentIdentifyKey))),et.length>0&&Promise.all(et).then(function(){}).catch(function(Ot){A.options.onError(Ot)})}}).then(y).catch(function(R){A.options.onError(R)})},Mt.prototype._trackParamsAndReferrer=function(){this.options.includeUtm&&this._initUtmData(),this.options.includeReferrer&&this._saveReferrer(this._getReferrer()),this.options.includeGclid&&this._saveGclid(this._getUrlParams())};var RE=function I(y,A){if(c(A)==="object"){var R=function(et){if(y.hasOwnProperty(et)){var rt=A[et],Ot=c(y[et]);E.validateInput(rt,et+" option",Ot)&&(Ot==="boolean"?y[et]=!!rt:Ot==="string"&&!E.isEmptyString(rt)||Ot==="number"&&rt>0?y[et]=rt:Ot==="object"&&I(y[et],rt))}};for(var G in A)A.hasOwnProperty(G)&&R(G)}};Mt.prototype.runQueuedFunctions=function(){var I=this._q;this._q=[];for(var y=0;y<I.length;y++){var A=this[I[y][0]];c(A)==="function"&&A.apply(this,I[y].slice(1))}},Mt.prototype._apiKeySet=function(y){return E.isEmptyString(this.options.apiKey)?(E.log.error("Invalid apiKey. Please set a valid apiKey with init() before calling "+y),!1):!0},Mt.prototype._loadSavedUnsentEvents=function(y){var A=this._getFromStorage(Ct,y),R=this._parseSavedUnsentEventsString(A,y);return this._setInStorage(Ct,y,JSON.stringify(R)),R},Mt.prototype._parseSavedUnsentEventsString=function(y,A){if(E.isEmptyString(y))return[];if(c(y)==="string")try{var R=JSON.parse(y);if(c(R)==="array")return R}catch{}return E.log.error("Unable to load "+A+" events. Restart with a new empty queue."),[]},Mt.prototype.isNewSession=function(){return this._newSession},Mt.prototype.onInit=function(I){this._isInitialized?I():this._onInit.push(I)},Mt.prototype.getSessionId=function(){return this._sessionId},Mt.prototype.nextEventId=function(){return this._eventId++,this._eventId},Mt.prototype.nextIdentifyId=function(){return this._identifyId++,this._identifyId},Mt.prototype.nextSequenceNumber=function(){return this._sequenceNumber++,this._sequenceNumber},Mt.prototype._unsentCount=function(){return this._unsentEvents.length+this._unsentIdentifys.length},Mt.prototype._sendEventsIfReady=function(y){return this._unsentCount()===0?!1:this.options.batchEvents?this._unsentCount()>=this.options.eventUploadThreshold?(this.sendEvents(y),!0):(this._updateScheduled||(this._updateScheduled=!0,setTimeout((function(){this._updateScheduled=!1,this.sendEvents()}).bind(this),this.options.eventUploadPeriodMillis)),!1):(this.sendEvents(y),!0)},Mt.prototype._getFromStorage=function(y,A){return y.getItem(A+this._storageSuffix)},Mt.prototype._setInStorage=function(y,A,R){y.setItem(A+this._storageSuffix,R)};var $E=function(y){var A=y.cookieStorage.get(y.options.cookieName+y._storageSuffix);if(c(A)!=="object"&&(A=y.cookieStorage.get(y.options.cookieName+y._legacyStorageSuffix),!(c(A)==="object"&&A.deviceId&&A.sessionId&&A.lastEventTime))){var R=function(ot){var xt=Ct.getItem(ot);return Ct.removeItem(ot),xt},G=c(y.options.apiKey)==="string"&&"_"+y.options.apiKey.slice(0,6)||"",U=R(s.DEVICE_ID+G),et=R(s.USER_ID+G),rt=R(s.OPT_OUT+G);rt!=null&&(rt=String(rt)==="true");var Ot=parseInt(R(s.SESSION_ID)),qt=parseInt(R(s.LAST_EVENT_TIME)),be=parseInt(R(s.LAST_EVENT_ID)),de=parseInt(R(s.LAST_IDENTIFY_ID)),st=parseInt(R(s.LAST_SEQUENCE_NUMBER)),ft=function(ot){return c(A)==="object"&&A[ot]};y.options.deviceId=ft("deviceId")||U,y.options.userId=ft("userId")||et,y._sessionId=ft("sessionId")||Ot||y._sessionId,y._lastEventTime=ft("lastEventTime")||qt||y._lastEventTime,y._eventId=ft("eventId")||be||y._eventId,y._identifyId=ft("identifyId")||de||y._identifyId,y._sequenceNumber=ft("sequenceNumber")||st||y._sequenceNumber,y.options.optOut=rt||!1,A&&A.optOut!==void 0&&A.optOut!==null&&(y.options.optOut=String(A.optOut)==="true"),sr(y)}},Ih=function(y){var A=y.cookieStorage.get(y.options.cookieName+y._storageSuffix);if(c(A)==="object")Ug(y,A);else{var R=y.cookieStorage.get(y.options.cookieName+y._legacyStorageSuffix);c(R)==="object"&&(y.cookieStorage.remove(y.options.cookieName+y._legacyStorageSuffix),Ug(y,R))}},Ug=function(y,A){A.deviceId&&(y.options.deviceId=A.deviceId),A.userId&&(y.options.userId=A.userId),A.optOut!==null&&A.optOut!==void 0&&A.optOut!==!1&&(y.options.optOut=A.optOut),A.sessionId&&(y._sessionId=parseInt(A.sessionId)),A.lastEventTime&&(y._lastEventTime=parseInt(A.lastEventTime)),A.eventId&&(y._eventId=parseInt(A.eventId)),A.identifyId&&(y._identifyId=parseInt(A.identifyId)),A.sequenceNumber&&(y._sequenceNumber=parseInt(A.sequenceNumber))},sr=function(y){var A={deviceId:y.options.deviceId,userId:y.options.userId,optOut:y.options.optOut,sessionId:y._sessionId,lastEventTime:y._lastEventTime,eventId:y._eventId,identifyId:y._identifyId,sequenceNumber:y._sequenceNumber};y.cookieStorage.set(y.options.cookieName+y._storageSuffix,A)};Mt.prototype._initUtmData=function(y,A){y=y||this._getUrlParams(),A=A||this.cookieStorage.get("__utmz");var R=Y(A,y);kh(this,R)},Mt.prototype._unsetUTMParams=function(){var y=new he;y.unset(s.REFERRER),y.unset(s.UTM_SOURCE),y.unset(s.UTM_MEDIUM),y.unset(s.UTM_CAMPAIGN),y.unset(s.UTM_TERM),y.unset(s.UTM_CONTENT),this.identify(y)};var kh=function(y,A){if(!(c(A)!=="object"||Object.keys(A).length===0)){var R=new he;for(var G in A)A.hasOwnProperty(G)&&(R.setOnce("initial_"+G,A[G]),R.set(G,A[G]));y.identify(R)}};Mt.prototype._getReferrer=function(){return document.referrer},Mt.prototype._getUrlParams=function(){return location.search},Mt.prototype._saveGclid=function(y){var A=E.getQueryParam("gclid",y);if(!E.isEmptyString(A)){var R={gclid:A};kh(this,R)}},Mt.prototype._getDeviceIdFromUrlParam=function(y){return E.getQueryParam(s.AMP_DEVICE_ID_PARAM,y)},Mt.prototype._getReferringDomain=function(y){if(E.isEmptyString(y))return null;var A=y.split("/");return A.length>=3?A[2]:null},Mt.prototype._saveReferrer=function(y){if(!E.isEmptyString(y)){var A={referrer:y,referring_domain:this._getReferringDomain(y)};kh(this,A)}},Mt.prototype.saveEvents=function(){try{rr||this._setInStorage(Ct,this.options.unsentKey,JSON.stringify(this._unsentEvents))}catch{}try{rr||this._setInStorage(Ct,this.options.unsentIdentifyKey,JSON.stringify(this._unsentIdentifys))}catch{}},Mt.prototype.setDomain=function(y){if(this._shouldDeferCall())return this._q.push(["setDomain"].concat(Array.prototype.slice.call(arguments,0)));if(E.validateInput(y,"domain","string"))try{this.cookieStorage.options({expirationDays:this.options.cookieExpiration,secure:this.options.secureCookie,domain:y,sameSite:this.options.sameSiteCookie}),this.options.domain=this.cookieStorage.options().domain,Ih(this),sr(this)}catch(A){E.log.error(A)}},Mt.prototype.setUserId=function(y){if(this._shouldDeferCall())return this._q.push(["setUserId"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.userId=y!=null&&""+y||null,sr(this)}catch(A){E.log.error(A)}},Mt.prototype.setGroup=function(I,y){if(this._shouldDeferCall())return this._q.push(["setGroup"].concat(Array.prototype.slice.call(arguments,0)));if(!(!this._apiKeySet("setGroup()")||!E.validateInput(I,"groupType","string")||E.isEmptyString(I))){var A={};A[I]=y;var R=new he().set(I,y);this._logEvent(s.IDENTIFY_EVENT,null,null,R.userPropertiesOperations,A,null,null,null)}},Mt.prototype.setOptOut=function(y){if(this._shouldDeferCall())return this._q.push(["setOptOut"].concat(Array.prototype.slice.call(arguments,0)));if(E.validateInput(y,"enable","boolean"))try{this.options.optOut=y,sr(this)}catch(A){E.log.error(A)}},Mt.prototype.setSessionId=function(y){if(E.validateInput(y,"sessionId","number"))try{this._sessionId=y,sr(this)}catch(A){E.log.error(A)}},Mt.prototype.resetSessionId=function(){this.setSessionId(new Date().getTime())},Mt.prototype.regenerateDeviceId=function(){if(this._shouldDeferCall())return this._q.push(["regenerateDeviceId"].concat(Array.prototype.slice.call(arguments,0)));this.setDeviceId(Ah()+"R")},Mt.prototype.setDeviceId=function(y){if(this._shouldDeferCall())return this._q.push(["setDeviceId"].concat(Array.prototype.slice.call(arguments,0)));if(E.validateInput(y,"deviceId","string"))try{E.isEmptyString(y)||(this.options.deviceId=""+y,sr(this))}catch(A){E.log.error(A)}},Mt.prototype.setUserProperties=function(y){if(this._shouldDeferCall())return this._q.push(["setUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(!(!this._apiKeySet("setUserProperties()")||!E.validateInput(y,"userProperties","object"))){var A=E.truncate(E.validateProperties(y));if(Object.keys(A).length!==0){var R=new he;for(var G in A)A.hasOwnProperty(G)&&R.set(G,A[G]);this.identify(R)}}},Mt.prototype.clearUserProperties=function(){if(this._shouldDeferCall())return this._q.push(["clearUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("clearUserProperties()")){var y=new he;y.clearAll(),this.identify(y)}};var Oh=function(y,A){for(var R=0;R<A._q.length;R++){var G=y[A._q[R][0]];c(G)==="function"&&G.apply(y,A._q[R].slice(1))}return y};Mt.prototype.identify=function(I,y){if(this._shouldDeferCall())return this._q.push(["identify"].concat(Array.prototype.slice.call(arguments,0)));if(!this._apiKeySet("identify()")){c(y)==="function"&&y(0,"No request sent",{reason:"API key is not set"});return}if(c(I)==="object"&&I.hasOwnProperty("_q")&&(I=Oh(new he,I)),I instanceof he){if(Object.keys(I.userPropertiesOperations).length>0)return this._logEvent(s.IDENTIFY_EVENT,null,null,I.userPropertiesOperations,null,null,null,y);c(y)==="function"&&y(0,"No request sent",{reason:"No user property operations"})}else E.log.error("Invalid identify input type. Expected Identify object but saw "+c(I)),c(y)==="function"&&y(0,"No request sent",{reason:"Invalid identify input type"})},Mt.prototype.groupIdentify=function(I,y,A,R){if(this._shouldDeferCall())return this._q.push(["groupIdentify"].concat(Array.prototype.slice.call(arguments,0)));if(!this._apiKeySet("groupIdentify()")){c(R)==="function"&&R(0,"No request sent",{reason:"API key is not set"});return}if(!E.validateInput(I,"group_type","string")||E.isEmptyString(I)){c(R)==="function"&&R(0,"No request sent",{reason:"Invalid group type"});return}if(y==null){c(R)==="function"&&R(0,"No request sent",{reason:"Invalid group name"});return}if(c(A)==="object"&&A.hasOwnProperty("_q")&&(A=Oh(new he,A)),A instanceof he){if(Object.keys(A.userPropertiesOperations).length>0)return this._logEvent(s.GROUP_IDENTIFY_EVENT,null,null,null,i({},I,y),A.userPropertiesOperations,null,R);c(R)==="function"&&R(0,"No request sent",{reason:"No group property operations"})}else E.log.error("Invalid identify input type. Expected Identify object but saw "+c(A)),c(R)==="function"&&R(0,"No request sent",{reason:"Invalid identify input type"})},Mt.prototype.setVersionName=function(y){if(this._shouldDeferCall())return this._q.push(["setVersionName"].concat(Array.prototype.slice.call(arguments,0)));E.validateInput(y,"versionName","string")&&(this.options.versionName=y)},Mt.prototype._logEvent=function(y,A,R,G,U,et,rt,Ot){if(Ih(this),!y){c(Ot)==="function"&&Ot(0,"No request sent",{reason:"Missing eventType"});return}if(this.options.optOut){c(Ot)==="function"&&Ot(0,"No request sent",{reason:"optOut is set to true"});return}try{var qt;y===s.IDENTIFY_EVENT||y===s.GROUP_IDENTIFY_EVENT?qt=this.nextIdentifyId():qt=this.nextEventId();var be=this.nextSequenceNumber(),de=c(rt)==="number"?rt:new Date().getTime();(!this._sessionId||!this._lastEventTime||de-this._lastEventTime>this.options.sessionTimeout)&&(this._sessionId=de),this._lastEventTime=de,sr(this);var st=this._ua.browser.name,ft=this._ua.browser.major,ut=this._ua.device.model,ot=this._ua.device.vendor,xt,Un;G=G||{};var jn=r({},this._apiPropertiesTrackingOptions);R=r({},R||{},jn),A=A||{},U=U||{},et=et||{};var fe={device_id:this.options.deviceId,user_id:this.options.userId,timestamp:de,event_id:qt,session_id:this._sessionId||-1,event_type:y,version_name:or(this,"version_name")&&(this.options.versionName||xt)||null,platform:or(this,"platform")?this.options.platform:null,os_name:or(this,"os_name")&&st||null,os_version:or(this,"os_version")&&ft||null,device_model:or(this,"device_model")&&ut||null,device_manufacturer:or(this,"device_manufacturer")&&ot||null,language:or(this,"language")?this.options.language:null,carrier:or(this,"carrier")&&Un||null,api_properties:R,event_properties:E.truncate(E.validateProperties(A)),user_properties:E.truncate(E.validateProperties(G)),uuid:Ah(),library:{name:"amplitude-js",version:Ch},sequence_number:be,groups:E.truncate(E.validateGroups(U)),group_properties:E.truncate(E.validateProperties(et)),user_agent:this._userAgent};return y===s.IDENTIFY_EVENT||y===s.GROUP_IDENTIFY_EVENT?(this._unsentIdentifys.push(fe),this._limitEventsQueued(this._unsentIdentifys)):(this._unsentEvents.push(fe),this._limitEventsQueued(this._unsentEvents)),this.options.saveEvents&&this.saveEvents(),!this._sendEventsIfReady(Ot)&&c(Ot)==="function"&&Ot(0,"No request sent",{reason:"No events to send or upload queued"}),qt}catch(Ht){E.log.error(Ht)}};var or=function(y,A){return!!y.options.trackingOptions[A]},BE=function(y){for(var A=["city","country","dma","ip_address","region"],R={},G=0;G<A.length;G++){var U=A[G];or(y,U)||(R[U]=!1)}return R};Mt.prototype._limitEventsQueued=function(y){y.length>this.options.savedMaxCount&&y.splice(0,y.length-this.options.savedMaxCount)},Mt.prototype.logEvent=function(y,A,R){return this._shouldDeferCall()?this._q.push(["logEvent"].concat(Array.prototype.slice.call(arguments,0))):this.logEventWithTimestamp(y,A,null,R)},Mt.prototype.logEventWithTimestamp=function(y,A,R,G){return this._shouldDeferCall()?this._q.push(["logEventWithTimestamp"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEvent()")?E.validateInput(y,"eventType","string")?E.isEmptyString(y)?(c(G)==="function"&&G(0,"No request sent",{reason:"Missing eventType"}),-1):this._logEvent(y,A,null,null,null,null,R,G):(c(G)==="function"&&G(0,"No request sent",{reason:"Invalid type for eventType"}),-1):(c(G)==="function"&&G(0,"No request sent",{reason:"API key not set"}),-1)},Mt.prototype.logEventWithGroups=function(I,y,A,R){return this._shouldDeferCall()?this._q.push(["logEventWithGroups"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEventWithGroups()")?E.validateInput(I,"eventType","string")?this._logEvent(I,y,null,null,A,null,null,R):(c(R)==="function"&&R(0,"No request sent",{reason:"Invalid type for eventType"}),-1):(c(R)==="function"&&R(0,"No request sent",{reason:"API key not set"}),-1)};var jg=function(y){return!isNaN(parseFloat(y))&&isFinite(y)};Mt.prototype.logRevenueV2=function(y){if(this._shouldDeferCall())return this._q.push(["logRevenueV2"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("logRevenueV2()"))if(c(y)==="object"&&y.hasOwnProperty("_q")&&(y=Oh(new Si,y)),y instanceof Si){if(y&&y._isValidRevenue())return this.logEvent(s.REVENUE_EVENT,y._toJSONObject())}else E.log.error("Invalid revenue input type. Expected Revenue object but saw "+c(y))},Mt.prototype.logRevenue=function(y,A,R){return this._shouldDeferCall()?this._q.push(["logRevenue"].concat(Array.prototype.slice.call(arguments,0))):!this._apiKeySet("logRevenue()")||!jg(y)||A!==void 0&&!jg(A)?-1:this._logEvent(s.REVENUE_EVENT,{},{productId:R,special:"revenue_amount",quantity:A||1,price:y},null,null,null,null,null)},Mt.prototype.removeEvents=function(y,A){Wg(this,"_unsentEvents",y),Wg(this,"_unsentIdentifys",A)};var Wg=function(y,A,R){if(!(R<0)){for(var G=[],U=0;U<y[A].length;U++)y[A][U].event_id>R&&G.push(y[A][U]);y[A]=G}};Mt.prototype.sendEvents=function(y){if(!this._apiKeySet("sendEvents()")){c(y)==="function"&&y(0,"No request sent",{reason:"API key not set"});return}if(this.options.optOut){c(y)==="function"&&y(0,"No request sent",{reason:"optOut is set to true"});return}if(this._unsentCount()===0){c(y)==="function"&&y(0,"No request sent",{reason:"No events to send"});return}if(this._sending){c(y)==="function"&&y(0,"No request sent",{reason:"Request already in progress. Events will be sent once this request is complete"});return}this._sending=!0;var A=this.options.forceHttps||window.location.protocol==="https:"?"https":"http",R=A+"://"+this.options.apiEndpoint,G=Math.min(this._unsentCount(),this.options.uploadBatchSize),U=this._mergeEventsAndIdentifys(G),et=U.maxEventId,rt=U.maxIdentifyId,Ot=JSON.stringify(U.eventsToSend),qt=new Date().getTime(),be={client:this.options.apiKey,e:Ot,v:s.API_VERSION,upload_time:qt,checksum:fa(s.API_VERSION+this.options.apiKey+Ot+qt)},de=this;new Gg(R,be).send(function(st,ft){de._sending=!1;try{st===200&&ft==="success"?(de.removeEvents(et,rt),de.options.saveEvents&&de.saveEvents(),!de._sendEventsIfReady(y)&&c(y)==="function"&&y(st,ft)):st===413?(de.options.uploadBatchSize===1&&de.removeEvents(et,rt),de.options.uploadBatchSize=Math.ceil(G/2),de.sendEvents(y)):c(y)==="function"&&y(st,ft)}catch{}})},Mt.prototype._mergeEventsAndIdentifys=function(y){for(var A=[],R=0,G=-1,U=0,et=-1;A.length<y;){var rt,Ot=U>=this._unsentIdentifys.length,qt=R>=this._unsentEvents.length;if(qt&&Ot){E.log.error("Merging Events and Identifys, less events and identifys than expected");break}else Ot?(rt=this._unsentEvents[R++],G=rt.event_id):qt?(rt=this._unsentIdentifys[U++],et=rt.event_id):!("sequence_number"in this._unsentEvents[R])||this._unsentEvents[R].sequence_number<this._unsentIdentifys[U].sequence_number?(rt=this._unsentEvents[R++],G=rt.event_id):(rt=this._unsentIdentifys[U++],et=rt.event_id);A.push(rt)}return{eventsToSend:A,maxEventId:G,maxIdentifyId:et}},Mt.prototype.setGlobalUserProperties=function(y){this.setUserProperties(y)},Mt.prototype.__VERSION__=Ch,Mt.prototype._shouldDeferCall=function(){return this._pendingReadStorage||this._initializationDeferred},Mt.prototype._deferInitialization=function(){this._initializationDeferred=!0,this._q.push(["init"].concat(Array.prototype.slice.call(arguments,0)))},Mt.prototype.enableTracking=function(){this._initializationDeferred=!1,sr(this),this.runQueuedFunctions()};var ye=function(){this.options=r({},Ph),this._q=[],this._instances={}};ye.prototype.Identify=he,ye.prototype.Revenue=Si,ye.prototype.getInstance=function(y){y=E.isEmptyString(y)?s.DEFAULT_INSTANCE:y.toLowerCase();var A=this._instances[y];return A===void 0&&(A=new Mt(y),this._instances[y]=A),A},ye.prototype.runQueuedFunctions=function(){for(var I=0;I<this._q.length;I++){var y=this[this._q[I][0]];c(y)==="function"&&y.apply(this,this._q[I].slice(1))}this._q=[];for(var A in this._instances)this._instances.hasOwnProperty(A)&&this._instances[A].runQueuedFunctions()},ye.prototype.init=function(y,A,R,G){this.getInstance().init(y,A,R,(function(U){this.options=U.options,c(G)==="function"&&G(U)}).bind(this))},ye.prototype.isNewSession=function(){return this.getInstance().isNewSession()},ye.prototype.getSessionId=function(){return this.getInstance().getSessionId()},ye.prototype.nextEventId=function(){return this.getInstance().nextEventId()},ye.prototype.nextIdentifyId=function(){return this.getInstance().nextIdentifyId()},ye.prototype.nextSequenceNumber=function(){return this.getInstance().nextSequenceNumber()},ye.prototype.saveEvents=function(){this.getInstance().saveEvents()},ye.prototype.setDomain=function(y){this.getInstance().setDomain(y)},ye.prototype.setUserId=function(y){this.getInstance().setUserId(y)},ye.prototype.setGroup=function(I,y){this.getInstance().setGroup(I,y)},ye.prototype.setOptOut=function(y){this.getInstance().setOptOut(y)},ye.prototype.regenerateDeviceId=function(){this.getInstance().regenerateDeviceId()},ye.prototype.setDeviceId=function(y){this.getInstance().setDeviceId(y)},ye.prototype.setUserProperties=function(y){this.getInstance().setUserProperties(y)},ye.prototype.clearUserProperties=function(){this.getInstance().clearUserProperties()},ye.prototype.identify=function(I,y){this.getInstance().identify(I,y)},ye.prototype.setVersionName=function(y){this.getInstance().setVersionName(y)},ye.prototype.logEvent=function(y,A,R){return this.getInstance().logEvent(y,A,R)},ye.prototype.logEventWithGroups=function(I,y,A,R){return this.getInstance().logEventWithGroups(I,y,A,R)},ye.prototype.logRevenueV2=function(y){return this.getInstance().logRevenueV2(y)},ye.prototype.logRevenue=function(y,A,R){return this.getInstance().logRevenue(y,A,R)},ye.prototype.removeEvents=function(y,A){this.getInstance().removeEvents(y,A)},ye.prototype.sendEvents=function(y){this.getInstance().sendEvents(y)},ye.prototype.setGlobalUserProperties=function(y){this.getInstance().setUserProperties(y)},ye.prototype.__VERSION__=Ch;var Jl=window.amplitude||{},Ql=new ye;Ql._q=Jl._q||[];for(var Lh in Jl._iq)Jl._iq.hasOwnProperty(Lh)&&(Ql.getInstance(Lh)._q=Jl._iq[Lh]._q||[]);return Ql.runQueuedFunctions(),Ql})})(_1);var WZ=_1.exports;const S1=Zn(WZ),E1=Object.prototype.toString;function T1(t){switch(E1.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return Rs(t,Error)}}function ha(t,e){return E1.call(t)===`[object ${e}]`}function Pg(t){return ha(t,"ErrorEvent")}function Vy(t){return ha(t,"DOMError")}function YZ(t){return ha(t,"DOMException")}function Ar(t){return ha(t,"String")}function Ig(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function kg(t){return t===null||Ig(t)||typeof t!="object"&&typeof t!="function"}function Yo(t){return ha(t,"Object")}function mh(t){return typeof Event<"u"&&Rs(t,Event)}function XZ(t){return typeof Element<"u"&&Rs(t,Element)}function qZ(t){return ha(t,"RegExp")}function vh(t){return!!(t&&t.then&&typeof t.then=="function")}function KZ(t){return Yo(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function ZZ(t){return typeof t=="number"&&t!==t}function Rs(t,e){try{return t instanceof e}catch{return!1}}function A1(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}function ko(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function zy(t,e){if(!Array.isArray(t))return"";const n=[];for(let i=0;i<t.length;i++){const r=t[i];try{A1(r)?n.push("[VueViewModel]"):n.push(String(r))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function JZ(t,e,n=!1){return Ar(t)?qZ(e)?e.test(t):Ar(e)?n?t===e:t.includes(e):!1:!1}function yh(t,e=[],n=!1){return e.some(i=>JZ(t,i,n))}function QZ(t,e,n=250,i,r,s,o){if(!s.exception||!s.exception.values||!o||!Rs(o.originalException,Error))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;a&&(s.exception.values=tJ(bf(t,e,r,o.originalException,i,s.exception.values,a,0),n))}function bf(t,e,n,i,r,s,o,a){if(s.length>=n+1)return s;let l=[...s];if(Rs(i[r],Error)){Gy(o,a);const c=t(e,i[r]),h=l.length;Hy(c,r,h,a),l=bf(t,e,n,i[r],r,[c,...l],c,h)}return Array.isArray(i.errors)&&i.errors.forEach((c,h)=>{if(Rs(c,Error)){Gy(o,a);const u=t(e,c),d=l.length;Hy(u,`errors[${h}]`,d,a),l=bf(t,e,n,c,r,[u,...l],u,d)}}),l}function Gy(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,is_exception_group:!0,exception_id:e}}function Hy(t,e,n,i){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:i}}function tJ(t,e){return t.map(n=>(n.value&&(n.value=ko(n.value,e)),n))}function Cc(t){return t&&t.Math==Math?t:void 0}const ve=typeof globalThis=="object"&&Cc(globalThis)||typeof window=="object"&&Cc(window)||typeof self=="object"&&Cc(self)||typeof global=="object"&&Cc(global)||function(){return this}()||{};function Og(){return ve}function C1(t,e,n){const i=n||ve,r=i.__SENTRY__=i.__SENTRY__||{};return r[t]||(r[t]=e())}const Lg=Og(),eJ=80;function P1(t,e={}){if(!t)return"<unknown>";try{let n=t;const i=5,r=[];let s=0,o=0;const a=" > ",l=a.length;let c;const h=Array.isArray(e)?e:e.keyAttrs,u=!Array.isArray(e)&&e.maxStringLength||eJ;for(;n&&s++<i&&(c=nJ(n,h),!(c==="html"||s>1&&o+r.length*l+c.length>=u));)r.push(c),o+=c.length,n=n.parentNode;return r.reverse().join(a)}catch{return"<unknown>"}}function nJ(t,e){const n=t,i=[];let r,s,o,a,l;if(!n||!n.tagName)return"";if(Lg.HTMLElement&&n instanceof HTMLElement&&n.dataset&&n.dataset.sentryComponent)return n.dataset.sentryComponent;i.push(n.tagName.toLowerCase());const c=e&&e.length?e.filter(u=>n.getAttribute(u)).map(u=>[u,n.getAttribute(u)]):null;if(c&&c.length)c.forEach(u=>{i.push(`[${u[0]}="${u[1]}"]`)});else if(n.id&&i.push(`#${n.id}`),r=n.className,r&&Ar(r))for(s=r.split(/\s+/),l=0;l<s.length;l++)i.push(`.${s[l]}`);const h=["aria-label","type","name","title","alt"];for(l=0;l<h.length;l++)o=h[l],a=n.getAttribute(o),a&&i.push(`[${o}="${a}"]`);return i.join("")}function iJ(){try{return Lg.document.location.href}catch{return""}}function rJ(t){if(!Lg.HTMLElement)return null;let e=t;const n=5;for(let i=0;i<n;i++){if(!e)return null;if(e instanceof HTMLElement&&e.dataset.sentryComponent)return e.dataset.sentryComponent;e=e.parentNode}return null}const zl=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,sJ="Sentry Logger ",xf=["debug","info","warn","error","log","assert","trace"],yu={};function Js(t){if(!("console"in ve))return t();const e=ve.console,n={},i=Object.keys(yu);i.forEach(r=>{const s=yu[r];n[r]=e[r],e[r]=s});try{return t()}finally{i.forEach(r=>{e[r]=n[r]})}}function oJ(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return zl?xf.forEach(n=>{e[n]=(...i)=>{t&&Js(()=>{ve.console[n](`${sJ}[${n}]:`,...i)})}}):xf.forEach(n=>{e[n]=()=>{}}),e}const Ft=oJ(),aJ=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function lJ(t){return t==="http"||t==="https"}function Gl(t,e=!1){const{host:n,path:i,pass:r,port:s,projectId:o,protocol:a,publicKey:l}=t;return`${a}://${l}${e&&r?`:${r}`:""}@${n}${s?`:${s}`:""}/${i&&`${i}/`}${o}`}function cJ(t){const e=aJ.exec(t);if(!e){Js(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,i,r="",s,o="",a]=e.slice(1);let l="",c=a;const h=c.split("/");if(h.length>1&&(l=h.slice(0,-1).join("/"),c=h.pop()),c){const u=c.match(/^\d+/);u&&(c=u[0])}return I1({host:s,pass:r,path:l,projectId:c,port:o,protocol:n,publicKey:i})}function I1(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function uJ(t){if(!zl)return!0;const{port:e,projectId:n,protocol:i}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(Ft.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?lJ(i)?e&&isNaN(parseInt(e,10))?(Ft.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(Ft.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),!1):(Ft.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function hJ(t){const e=typeof t=="string"?cJ(t):I1(t);if(!(!e||!uJ(e)))return e}class Hi extends Error{constructor(e,n="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}}function Tn(t,e,n){if(!(e in t))return;const i=t[e],r=n(i);typeof r=="function"&&k1(r,i),t[e]=r}function $s(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{zl&&Ft.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function k1(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,$s(t,"__sentry_original__",e)}catch{}}function Mg(t){return t.__sentry_original__}function dJ(t){return Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}function O1(t){if(T1(t))return{message:t.message,name:t.name,stack:t.stack,...jy(t)};if(mh(t)){const e={type:t.type,target:Uy(t.target),currentTarget:Uy(t.currentTarget),...jy(t)};return typeof CustomEvent<"u"&&Rs(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function Uy(t){try{return XZ(t)?P1(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function jy(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function fJ(t,e=40){const n=Object.keys(O1(t));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=e)return ko(n[0],e);for(let i=n.length;i>0;i--){const r=n.slice(0,i).join(", ");if(!(r.length>e))return i===n.length?r:ko(r,e)}return""}function wr(t){return wf(t,new Map)}function wf(t,e){if(pJ(t)){const n=e.get(t);if(n!==void 0)return n;const i={};e.set(t,i);for(const r of Object.keys(t))typeof t[r]<"u"&&(i[r]=wf(t[r],e));return i}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const i=[];return e.set(t,i),t.forEach(r=>{i.push(wf(r,e))}),i}return t}function pJ(t){if(!Yo(t))return!1;try{const e=Object.getPrototypeOf(t).constructor.name;return!e||e==="Object"}catch{return!0}}const L1=50,Wy=/\(error: (.*)\)/,Yy=/captureMessage|captureException/;function M1(...t){const e=t.sort((n,i)=>n[0]-i[0]).map(n=>n[1]);return(n,i=0)=>{const r=[],s=n.split(`
`);for(let o=i;o<s.length;o++){const a=s[o];if(a.length>1024)continue;const l=Wy.test(a)?a.replace(Wy,"$1"):a;if(!l.match(/\S*Error: /)){for(const c of e){const h=c(l);if(h){r.push(h);break}}if(r.length>=L1)break}}return mJ(r)}}function gJ(t){return Array.isArray(t)?M1(...t):t}function mJ(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(e[e.length-1].function||"")&&e.pop(),e.reverse(),Yy.test(e[e.length-1].function||"")&&(e.pop(),Yy.test(e[e.length-1].function||"")&&e.pop()),e.slice(0,L1).map(n=>({...n,filename:n.filename||e[e.length-1].filename,function:n.function||"?"}))}const _d="<anonymous>";function ns(t){try{return!t||typeof t!="function"?_d:t.name||_d}catch{return _d}}const jc={},Xy={};function Qs(t,e){jc[t]=jc[t]||[],jc[t].push(e)}function to(t,e){Xy[t]||(e(),Xy[t]=!0)}function ki(t,e){const n=t&&jc[t];if(n)for(const i of n)try{i(e)}catch(r){zl&&Ft.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${ns(i)}
Error:`,r)}}function vJ(t){const e="console";Qs(e,t),to(e,yJ)}function yJ(){"console"in ve&&xf.forEach(function(t){t in ve.console&&Tn(ve.console,t,function(e){return yu[t]=e,function(...n){ki("console",{args:n,level:t});const r=yu[t];r&&r.apply(ve.console,n)}})})}function mi(){const t=ve,e=t.crypto||t.msCrypto;let n=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>{const i=new Uint8Array(1);return e.getRandomValues(i),i[0]})}catch{}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,i=>(i^(n()&15)>>i/4).toString(16))}function D1(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function Yr(t){const{message:e,event_id:n}=t;if(e)return e;const i=D1(t);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||n||"<unknown>":n||"<unknown>"}function _f(t,e,n){const i=t.exception=t.exception||{},r=i.values=i.values||[],s=r[0]=r[0]||{};s.value||(s.value=e||""),s.type||(s.type=n||"Error")}function hl(t,e){const n=D1(t);if(!n)return;const i={type:"generic",handled:!0},r=n.mechanism;if(n.mechanism={...i,...r,...e},e&&"data"in e){const s={...r&&r.data,...e.data};n.mechanism.data=s}}function qy(t){if(t&&t.__sentry_captured__)return!0;try{$s(t,"__sentry_captured__",!0)}catch{}return!1}function Dg(t){return Array.isArray(t)?t:[t]}const vo=ve,bJ=1e3;let Ky,Sf,Ef;function xJ(t){const e="dom";Qs(e,t),to(e,wJ)}function wJ(){if(!vo.document)return;const t=ki.bind(null,"dom"),e=Zy(t,!0);vo.document.addEventListener("click",e,!1),vo.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{const i=vo[n]&&vo[n].prototype;!i||!i.hasOwnProperty||!i.hasOwnProperty("addEventListener")||(Tn(i,"addEventListener",function(r){return function(s,o,a){if(s==="click"||s=="keypress")try{const l=this,c=l.__sentry_instrumentation_handlers__=l.__sentry_instrumentation_handlers__||{},h=c[s]=c[s]||{refCount:0};if(!h.handler){const u=Zy(t);h.handler=u,r.call(this,s,u,a)}h.refCount++}catch{}return r.call(this,s,o,a)}}),Tn(i,"removeEventListener",function(r){return function(s,o,a){if(s==="click"||s=="keypress")try{const l=this,c=l.__sentry_instrumentation_handlers__||{},h=c[s];h&&(h.refCount--,h.refCount<=0&&(r.call(this,s,h.handler,a),h.handler=void 0,delete c[s]),Object.keys(c).length===0&&delete l.__sentry_instrumentation_handlers__)}catch{}return r.call(this,s,o,a)}}))})}function _J(t){if(t.type!==Sf)return!1;try{if(!t.target||t.target._sentryId!==Ef)return!1}catch{}return!0}function SJ(t,e){return t!=="keypress"?!1:!e||!e.tagName?!0:!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)}function Zy(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const i=EJ(n);if(SJ(n.type,i))return;$s(n,"_sentryCaptured",!0),i&&!i._sentryId&&$s(i,"_sentryId",mi());const r=n.type==="keypress"?"input":n.type;_J(n)||(t({event:n,name:r,global:e}),Sf=n.type,Ef=i?i._sentryId:void 0),clearTimeout(Ky),Ky=vo.setTimeout(()=>{Ef=void 0,Sf=void 0},bJ)}}function EJ(t){try{return t.target}catch{return null}}const Tf=Og();function N1(){if(!("fetch"in Tf))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function Af(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function TJ(){if(typeof EdgeRuntime=="string")return!0;if(!N1())return!1;if(Af(Tf.fetch))return!0;let t=!1;const e=Tf.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=Af(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){zl&&Ft.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}function AJ(t){const e="fetch";Qs(e,t),to(e,CJ)}function CJ(){TJ()&&Tn(ve,"fetch",function(t){return function(...e){const{method:n,url:i}=PJ(e),r={args:e,fetchData:{method:n,url:i},startTimestamp:Date.now()};return ki("fetch",{...r}),t.apply(ve,e).then(s=>{const o={...r,endTimestamp:Date.now(),response:s};return ki("fetch",o),s},s=>{const o={...r,endTimestamp:Date.now(),error:s};throw ki("fetch",o),s})}})}function Cf(t,e){return!!t&&typeof t=="object"&&!!t[e]}function Jy(t){return typeof t=="string"?t:t?Cf(t,"url")?t.url:t.toString?t.toString():"":""}function PJ(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,i]=t;return{url:Jy(n),method:Cf(i,"method")?String(i.method).toUpperCase():"GET"}}const e=t[0];return{url:Jy(e),method:Cf(e,"method")?String(e.method).toUpperCase():"GET"}}let Pc=null;function IJ(t){const e="error";Qs(e,t),to(e,kJ)}function kJ(){Pc=ve.onerror,ve.onerror=function(t,e,n,i,r){return ki("error",{column:i,error:r,line:n,msg:t,url:e}),Pc&&!Pc.__SENTRY_LOADER__?Pc.apply(this,arguments):!1},ve.onerror.__SENTRY_INSTRUMENTED__=!0}let Ic=null;function OJ(t){const e="unhandledrejection";Qs(e,t),to(e,LJ)}function LJ(){Ic=ve.onunhandledrejection,ve.onunhandledrejection=function(t){return ki("unhandledrejection",t),Ic&&!Ic.__SENTRY_LOADER__?Ic.apply(this,arguments):!0},ve.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const kc=Og();function MJ(){const t=kc.chrome,e=t&&t.app&&t.app.runtime,n="history"in kc&&!!kc.history.pushState&&!!kc.history.replaceState;return!e&&n}const La=ve;let Oc;function R1(t){const e="history";Qs(e,t),to(e,DJ)}function DJ(){if(!MJ())return;const t=La.onpopstate;La.onpopstate=function(...n){const i=La.location.href,r=Oc;if(Oc=i,ki("history",{from:r,to:i}),t)try{return t.apply(this,n)}catch{}};function e(n){return function(...i){const r=i.length>2?i[2]:void 0;if(r){const s=Oc,o=String(r);Oc=o,ki("history",{from:s,to:o})}return n.apply(this,i)}}Tn(La.history,"pushState",e),Tn(La.history,"replaceState",e)}const NJ=ve,Fa="__sentry_xhr_v3__";function RJ(t){const e="xhr";Qs(e,t),to(e,$J)}function $J(){if(!NJ.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;Tn(t,"open",function(e){return function(...n){const i=Date.now(),r=Ar(n[0])?n[0].toUpperCase():void 0,s=BJ(n[1]);if(!r||!s)return e.apply(this,n);this[Fa]={method:r,url:s,request_headers:{}},r==="POST"&&s.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const o=()=>{const a=this[Fa];if(a&&this.readyState===4){try{a.status_code=this.status}catch{}const l={args:[r,s],endTimestamp:Date.now(),startTimestamp:i,xhr:this};ki("xhr",l)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?Tn(this,"onreadystatechange",function(a){return function(...l){return o(),a.apply(this,l)}}):this.addEventListener("readystatechange",o),Tn(this,"setRequestHeader",function(a){return function(...l){const[c,h]=l,u=this[Fa];return u&&Ar(c)&&Ar(h)&&(u.request_headers[c.toLowerCase()]=h),a.apply(this,l)}}),e.apply(this,n)}}),Tn(t,"send",function(e){return function(...n){const i=this[Fa];if(!i)return e.apply(this,n);n[0]!==void 0&&(i.body=n[0]);const r={args:[i.method,i.url],startTimestamp:Date.now(),xhr:this};return ki("xhr",r),e.apply(this,n)}})}function BJ(t){if(Ar(t))return t;try{return t.toString()}catch{}}function FJ(){return"npm"}function VJ(){const t=typeof WeakSet=="function",e=t?new WeakSet:[];function n(r){if(t)return e.has(r)?!0:(e.add(r),!1);for(let s=0;s<e.length;s++)if(e[s]===r)return!0;return e.push(r),!1}function i(r){if(t)e.delete(r);else for(let s=0;s<e.length;s++)if(e[s]===r){e.splice(s,1);break}}return[n,i]}function Hr(t,e=100,n=1/0){try{return Pf("",t,e,n)}catch(i){return{ERROR:`**non-serializable** (${i})`}}}function $1(t,e=3,n=100*1024){const i=Hr(t,e);return UJ(i)>n?$1(t,e-1,n):i}function Pf(t,e,n=1/0,i=1/0,r=VJ()){const[s,o]=r;if(e==null||["number","boolean","string"].includes(typeof e)&&!ZZ(e))return e;const a=zJ(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const l=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(l===0)return a.replace("object ","");if(s(e))return"[Circular ~]";const c=e;if(c&&typeof c.toJSON=="function")try{const f=c.toJSON();return Pf("",f,l-1,i,r)}catch{}const h=Array.isArray(e)?[]:{};let u=0;const d=O1(e);for(const f in d){if(!Object.prototype.hasOwnProperty.call(d,f))continue;if(u>=i){h[f]="[MaxProperties ~]";break}const p=d[f];h[f]=Pf(f,p,l-1,i,r),u++}return o(e),h}function zJ(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(A1(e))return"[VueViewModel]";if(KZ(e))return"[SyntheticEvent]";if(typeof e=="number"&&e!==e)return"[NaN]";if(typeof e=="function")return`[Function: ${ns(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=GJ(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function GJ(t){const e=Object.getPrototypeOf(t);return e?e.constructor.name:"null prototype"}function HJ(t){return~-encodeURI(t).split(/%..|./).length}function UJ(t){return HJ(JSON.stringify(t))}var hr;(function(t){t[t.PENDING=0]="PENDING";const n=1;t[t.RESOLVED=n]="RESOLVED";const i=2;t[t.REJECTED=i]="REJECTED"})(hr||(hr={}));function Xo(t){return new ii(e=>{e(t)})}function Ng(t){return new ii((e,n)=>{n(t)})}class ii{constructor(e){ii.prototype.__init.call(this),ii.prototype.__init2.call(this),ii.prototype.__init3.call(this),ii.prototype.__init4.call(this),this._state=hr.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new ii((i,r)=>{this._handlers.push([!1,s=>{if(!e)i(s);else try{i(e(s))}catch(o){r(o)}},s=>{if(!n)r(s);else try{i(n(s))}catch(o){r(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new ii((n,i)=>{let r,s;return this.then(o=>{s=!1,r=o,e&&e()},o=>{s=!0,r=o,e&&e()}).then(()=>{if(s){i(r);return}n(r)})})}__init(){this._resolve=e=>{this._setResult(hr.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(hr.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{if(this._state===hr.PENDING){if(vh(n)){n.then(this._resolve,this._reject);return}this._state=e,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===hr.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===hr.RESOLVED&&n[1](this._value),this._state===hr.REJECTED&&n[2](this._value),n[0]=!0)})}}}function jJ(t){const e=[];function n(){return t===void 0||e.length<t}function i(o){return e.splice(e.indexOf(o),1)[0]}function r(o){if(!n())return Ng(new Hi("Not adding Promise because buffer limit was reached."));const a=o();return e.indexOf(a)===-1&&e.push(a),a.then(()=>i(a)).then(null,()=>i(a).then(null,()=>{})),a}function s(o){return new ii((a,l)=>{let c=e.length;if(!c)return a(!0);const h=setTimeout(()=>{o&&o>0&&a(!1)},o);e.forEach(u=>{Xo(u).then(()=>{--c||(clearTimeout(h),a(!0))},l)})})}return{$:e,add:r,drain:s}}function Sd(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",i=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:i,relative:e[5]+n+i}}const WJ=["fatal","error","warning","log","info","debug"];function YJ(t){return t==="warn"?"warning":WJ.includes(t)?t:"log"}const B1=1e3;function Hl(){return Date.now()/B1}function XJ(){const{performance:t}=ve;if(!t||!t.now)return Hl;const e=Date.now()-t.now(),n=t.timeOrigin==null?e:t.timeOrigin;return()=>(n+t.now())/B1}const bh=XJ();(()=>{const{performance:t}=ve;if(!t||!t.now)return;const e=3600*1e3,n=t.now(),i=Date.now(),r=t.timeOrigin?Math.abs(t.timeOrigin+n-i):e,s=r<e,o=t.timing&&t.timing.navigationStart,l=typeof o=="number"?Math.abs(o+n-i):e,c=l<e;return s||c?r<=l?t.timeOrigin:o:i})();function da(t,e=[]){return[t,e]}function qJ(t,e){const[n,i]=t;return[n,[...i,e]]}function Qy(t,e){const n=t[1];for(const i of n){const r=i[0].type;if(e(i,r))return!0}return!1}function If(t,e){return(e||new TextEncoder).encode(t)}function KJ(t,e){const[n,i]=t;let r=JSON.stringify(n);function s(o){typeof r=="string"?r=typeof o=="string"?r+o:[If(r,e),o]:r.push(typeof o=="string"?If(o,e):o)}for(const o of i){const[a,l]=o;if(s(`
${JSON.stringify(a)}
`),typeof l=="string"||l instanceof Uint8Array)s(l);else{let c;try{c=JSON.stringify(l)}catch{c=JSON.stringify(Hr(l))}s(c)}}return typeof r=="string"?r:ZJ(r)}function ZJ(t){const e=t.reduce((r,s)=>r+s.length,0),n=new Uint8Array(e);let i=0;for(const r of t)n.set(r,i),i+=r.length;return n}function JJ(t,e){const n=typeof t.data=="string"?If(t.data,e):t.data;return[wr({type:"attachment",length:n.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),n]}const QJ={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",statsd:"unknown"};function tb(t){return QJ[t]}function F1(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function tQ(t,e,n,i){const r=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&i&&{dsn:Gl(i)},...r&&{trace:wr({...r})}}}function eQ(t,e,n){const i=[{type:"client_report"},{timestamp:n||Hl(),discarded_events:t}];return da(e?{dsn:e}:{},[i])}const nQ=60*1e3;function iQ(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const i=Date.parse(`${t}`);return isNaN(i)?nQ:i-e}function rQ(t,e){return t[e]||t.all||0}function sQ(t,e,n=Date.now()){return rQ(t,e)>n}function oQ(t,{statusCode:e,headers:n},i=Date.now()){const r={...t},s=n&&n["x-sentry-rate-limits"],o=n&&n["retry-after"];if(s)for(const a of s.trim().split(",")){const[l,c]=a.split(":",2),h=parseInt(l,10),u=(isNaN(h)?60:h)*1e3;if(!c)r.all=i+u;else for(const d of c.split(";"))r[d]=i+u}else o?r.all=i+iQ(o,i):e===429&&(r.all=i+60*1e3);return r}const Oe=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,xh="production";function Rg(){return C1("globalEventProcessors",()=>[])}function aQ(t){Rg().push(t)}function bu(t,e,n,i=0){return new ii((r,s)=>{const o=t[i];if(e===null||typeof o!="function")r(e);else{const a=o({...e},n);Oe&&o.id&&a===null&&Ft.log(`Event processor "${o.id}" dropped event`),vh(a)?a.then(l=>bu(t,l,n,i+1).then(r)).then(null,s):bu(t,a,n,i+1).then(r).then(null,s)}})}function V1(t){const e=bh(),n={sid:mi(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>lQ(n)};return t&&Bs(n,t),n}function Bs(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||bh(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:mi()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function z1(t,e){let n={};e?n={status:e}:t.status==="ok"&&(n={status:"exited"}),Bs(t,n)}function lQ(t){return wr({sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}const cQ=1;function uQ(t){const{spanId:e,traceId:n}=t.spanContext(),{data:i,op:r,parent_span_id:s,status:o,tags:a,origin:l}=dl(t);return wr({data:i,op:r,parent_span_id:s,span_id:e,status:o,tags:a,trace_id:n,origin:l})}function hQ(t){return typeof t=="number"?eb(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?eb(t.getTime()):bh()}function eb(t){return t>9999999999?t/1e3:t}function dl(t){return dQ(t)?t.getSpanJSON():typeof t.toJSON=="function"?t.toJSON():{}}function dQ(t){return typeof t.getSpanJSON=="function"}function fQ(t){const{traceFlags:e}=t.spanContext();return!!(e&cQ)}function pQ(t,e,n,i,r,s){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,l={...e,event_id:e.event_id||n.event_id||mi(),timestamp:e.timestamp||Hl()},c=n.integrations||t.integrations.map(v=>v.name);gQ(l,t),yQ(l,c),e.type===void 0&&mQ(l,t.stackParser);const h=xQ(i,n.captureContext);n.mechanism&&hl(l,n.mechanism);const u=r&&r.getEventProcessors?r.getEventProcessors():[],d=MQ().getScopeData();if(s){const v=s.getScopeData();sb(d,v)}if(h){const v=h.getScopeData();sb(d,v)}const f=[...n.attachments||[],...d.attachments];f.length&&(n.attachments=f),Y1(l,d);const p=[...u,...Rg(),...d.eventProcessors];return bu(p,l,n).then(v=>(v&&vQ(v),typeof o=="number"&&o>0?bQ(v,o,a):v))}function gQ(t,e){const{environment:n,release:i,dist:r,maxValueLength:s=250}=e;"environment"in t||(t.environment="environment"in e?n:xh),t.release===void 0&&i!==void 0&&(t.release=i),t.dist===void 0&&r!==void 0&&(t.dist=r),t.message&&(t.message=ko(t.message,s));const o=t.exception&&t.exception.values&&t.exception.values[0];o&&o.value&&(o.value=ko(o.value,s));const a=t.request;a&&a.url&&(a.url=ko(a.url,s))}const nb=new WeakMap;function mQ(t,e){const n=ve._sentryDebugIds;if(!n)return;let i;const r=nb.get(e);r?i=r:(i=new Map,nb.set(e,i));const s=Object.keys(n).reduce((o,a)=>{let l;const c=i.get(a);c?l=c:(l=e(a),i.set(a,l));for(let h=l.length-1;h>=0;h--){const u=l[h];if(u.filename){o[u.filename]=n[a];break}}return o},{});try{t.exception.values.forEach(o=>{o.stacktrace.frames.forEach(a=>{a.filename&&(a.debug_id=s[a.filename])})})}catch{}}function vQ(t){const e={};try{t.exception.values.forEach(i=>{i.stacktrace.frames.forEach(r=>{r.debug_id&&(r.abs_path?e[r.abs_path]=r.debug_id:r.filename&&(e[r.filename]=r.debug_id),delete r.debug_id)})})}catch{}if(Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.keys(e).forEach(i=>{n.push({type:"sourcemap",code_file:i,debug_id:e[i]})})}function yQ(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function bQ(t,e,n){if(!t)return null;const i={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(r=>({...r,...r.data&&{data:Hr(r.data,e,n)}}))},...t.user&&{user:Hr(t.user,e,n)},...t.contexts&&{contexts:Hr(t.contexts,e,n)},...t.extra&&{extra:Hr(t.extra,e,n)}};return t.contexts&&t.contexts.trace&&i.contexts&&(i.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(i.contexts.trace.data=Hr(t.contexts.trace.data,e,n))),t.spans&&(i.spans=t.spans.map(r=>{const s=dl(r).data;return s&&(r.data=Hr(s,e,n)),r})),i}function xQ(t,e){if(!e)return t;const n=t?t.clone():new ji;return n.update(e),n}function wQ(t){if(t)return _Q(t)?{captureContext:t}:EQ(t)?{captureContext:t}:t}function _Q(t){return t instanceof ji||typeof t=="function"}const SQ=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function EQ(t){return Object.keys(t).some(e=>SQ.includes(e))}function $g(t,e){return nr().captureException(t,wQ(e))}function G1(t,e){return nr().captureEvent(t,e)}function Fs(t,e){nr().addBreadcrumb(t,e)}function TQ(...t){const e=nr();if(t.length===2){const[n,i]=t;return n?e.withScope(()=>(e.getStackTop().scope=n,i(n))):e.withScope(i)}return e.withScope(t[0])}function Hn(){return nr().getClient()}function eo(){return nr().getScope()}function ib(t){const e=Hn(),n=Ul(),i=eo(),{release:r,environment:s=xh}=e&&e.getOptions()||{},{userAgent:o}=ve.navigator||{},a=V1({release:r,environment:s,user:i.getUser()||n.getUser(),...o&&{userAgent:o},...t}),l=n.getSession();return l&&l.status==="ok"&&Bs(l,{status:"exited"}),H1(),n.setSession(a),i.setSession(a),a}function H1(){const t=Ul(),e=eo(),n=e.getSession()||t.getSession();n&&z1(n),U1(),t.setSession(),e.setSession()}function U1(){const t=Ul(),e=eo(),n=Hn(),i=e.getSession()||t.getSession();i&&n&&n.captureSession&&n.captureSession(i)}function rb(t=!1){if(t){H1();return}U1()}function j1(t){return t.transaction}function W1(t,e,n){const i=e.getOptions(),{publicKey:r}=e.getDsn()||{},{segment:s}=n&&n.getUser()||{},o=wr({environment:i.environment||xh,release:i.release,user_segment:s,public_key:r,trace_id:t});return e.emit&&e.emit("createDsc",o),o}function AQ(t){const e=Hn();if(!e)return{};const n=W1(dl(t).trace_id||"",e,eo()),i=j1(t);if(!i)return n;const r=i&&i._frozenDynamicSamplingContext;if(r)return r;const{sampleRate:s,source:o}=i.metadata;s!=null&&(n.sample_rate=`${s}`);const a=dl(i);return o&&o!=="url"&&(n.transaction=a.description),n.sampled=String(fQ(i)),e.emit&&e.emit("createDsc",n),n}function Y1(t,e){const{fingerprint:n,span:i,breadcrumbs:r,sdkProcessingMetadata:s}=e;CQ(t,e),i&&kQ(t,i),OQ(t,n),PQ(t,r),IQ(t,s)}function sb(t,e){const{extra:n,tags:i,user:r,contexts:s,level:o,sdkProcessingMetadata:a,breadcrumbs:l,fingerprint:c,eventProcessors:h,attachments:u,propagationContext:d,transactionName:f,span:p}=e;Ma(t,"extra",n),Ma(t,"tags",i),Ma(t,"user",r),Ma(t,"contexts",s),Ma(t,"sdkProcessingMetadata",a),o&&(t.level=o),f&&(t.transactionName=f),p&&(t.span=p),l.length&&(t.breadcrumbs=[...t.breadcrumbs,...l]),c.length&&(t.fingerprint=[...t.fingerprint,...c]),h.length&&(t.eventProcessors=[...t.eventProcessors,...h]),u.length&&(t.attachments=[...t.attachments,...u]),t.propagationContext={...t.propagationContext,...d}}function Ma(t,e,n){if(n&&Object.keys(n).length){t[e]={...t[e]};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[e][i]=n[i])}}function CQ(t,e){const{extra:n,tags:i,user:r,contexts:s,level:o,transactionName:a}=e,l=wr(n);l&&Object.keys(l).length&&(t.extra={...l,...t.extra});const c=wr(i);c&&Object.keys(c).length&&(t.tags={...c,...t.tags});const h=wr(r);h&&Object.keys(h).length&&(t.user={...h,...t.user});const u=wr(s);u&&Object.keys(u).length&&(t.contexts={...u,...t.contexts}),o&&(t.level=o),a&&(t.transaction=a)}function PQ(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function IQ(t,e){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e}}function kQ(t,e){t.contexts={trace:uQ(e),...t.contexts};const n=j1(e);if(n){t.sdkProcessingMetadata={dynamicSamplingContext:AQ(e),...t.sdkProcessingMetadata};const i=dl(n).description;i&&(t.tags={transaction:i,...t.tags})}}function OQ(t,e){t.fingerprint=t.fingerprint?Dg(t.fingerprint):[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}const LQ=100;let Ed;class ji{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=ob()}static clone(e){return e?e.clone():new ji}clone(){const e=new ji;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._span=this._span,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e}setClient(e){this._client=e}getClient(){return this._client}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&Bs(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this._span;return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if(typeof e=="function"){const n=e(this);return n instanceof ji?n:this}return e instanceof ji?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession),e._propagationContext&&(this._propagationContext=e._propagationContext)):Yo(e)&&(e=e,this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=ob(),this}addBreadcrumb(e,n){const i=typeof n=="number"?n:LQ;if(i<=0)return this;const r={timestamp:Hl(),...e},s=this._breadcrumbs;return s.push(r),this._breadcrumbs=s.length>i?s.slice(-i):s,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:e,_attachments:n,_contexts:i,_tags:r,_extra:s,_user:o,_level:a,_fingerprint:l,_eventProcessors:c,_propagationContext:h,_sdkProcessingMetadata:u,_transactionName:d,_span:f}=this;return{breadcrumbs:e,attachments:n,contexts:i,tags:r,extra:s,user:o,level:a,fingerprint:l||[],eventProcessors:c,propagationContext:h,sdkProcessingMetadata:u,transactionName:d,span:f}}applyToEvent(e,n={},i=[]){Y1(e,this.getScopeData());const r=[...i,...Rg(),...this._eventProcessors];return bu(r,e,n)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const i=n&&n.event_id?n.event_id:mi();if(!this._client)return Ft.warn("No client configured on scope - will not capture exception!"),i;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...n,event_id:i},this),i}captureMessage(e,n,i){const r=i&&i.event_id?i.event_id:mi();if(!this._client)return Ft.warn("No client configured on scope - will not capture message!"),r;const s=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:s,...i,event_id:r},this),r}captureEvent(e,n){const i=n&&n.event_id?n.event_id:mi();return this._client?(this._client.captureEvent(e,{...n,event_id:i},this),i):(Ft.warn("No client configured on scope - will not capture event!"),i)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function MQ(){return Ed||(Ed=new ji),Ed}function ob(){return{traceId:mi(),spanId:mi().substring(16)}}const fl="7.101.1",X1=parseFloat(fl),DQ=100;class q1{constructor(e,n,i,r=X1){this._version=r;let s;n?s=n:(s=new ji,s.setClient(e));let o;i?o=i:(o=new ji,o.setClient(e)),this._stack=[{scope:s}],e&&this.bindClient(e),this._isolationScope=o}isOlderThan(e){return this._version<e}bindClient(e){const n=this.getStackTop();n.client=e,n.scope.setClient(e),e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(e){const n=this.pushScope();let i;try{i=e(n)}catch(r){throw this.popScope(),r}return vh(i)?i.then(r=>(this.popScope(),r),r=>{throw this.popScope(),r}):(this.popScope(),i)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,n){const i=this._lastEventId=n&&n.event_id?n.event_id:mi(),r=new Error("Sentry syntheticException");return this.getScope().captureException(e,{originalException:e,syntheticException:r,...n,event_id:i}),i}captureMessage(e,n,i){const r=this._lastEventId=i&&i.event_id?i.event_id:mi(),s=new Error(e);return this.getScope().captureMessage(e,n,{originalException:e,syntheticException:s,...i,event_id:r}),r}captureEvent(e,n){const i=n&&n.event_id?n.event_id:mi();return e.type||(this._lastEventId=i),this.getScope().captureEvent(e,{...n,event_id:i}),i}lastEventId(){return this._lastEventId}addBreadcrumb(e,n){const{scope:i,client:r}=this.getStackTop();if(!r)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:o=DQ}=r.getOptions&&r.getOptions()||{};if(o<=0)return;const l={timestamp:Hl(),...e},c=s?Js(()=>s(l,n)):l;c!==null&&(r.emit&&r.emit("beforeAddBreadcrumb",c,n),i.addBreadcrumb(c,o))}setUser(e){this.getScope().setUser(e),this.getIsolationScope().setUser(e)}setTags(e){this.getScope().setTags(e),this.getIsolationScope().setTags(e)}setExtras(e){this.getScope().setExtras(e),this.getIsolationScope().setExtras(e)}setTag(e,n){this.getScope().setTag(e,n),this.getIsolationScope().setTag(e,n)}setExtra(e,n){this.getScope().setExtra(e,n),this.getIsolationScope().setExtra(e,n)}setContext(e,n){this.getScope().setContext(e,n),this.getIsolationScope().setContext(e,n)}configureScope(e){const{scope:n,client:i}=this.getStackTop();i&&e(n)}run(e){const n=ab(this);try{e(this)}finally{ab(n)}}getIntegration(e){const n=this.getClient();if(!n)return null;try{return n.getIntegration(e)}catch{return Oe&&Ft.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,n){const i=this._callExtensionMethod("startTransaction",e,n);return Oe&&!i&&(this.getClient()?Ft.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):Ft.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),i}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const n=this.getStackTop().scope,i=n.getSession();i&&z1(i),this._sendSessionUpdate(),n.setSession()}startSession(e){const{scope:n,client:i}=this.getStackTop(),{release:r,environment:s=xh}=i&&i.getOptions()||{},{userAgent:o}=ve.navigator||{},a=V1({release:r,environment:s,user:n.getUser(),...o&&{userAgent:o},...e}),l=n.getSession&&n.getSession();return l&&l.status==="ok"&&Bs(l,{status:"exited"}),this.endSession(),n.setSession(a),a}shouldSendDefaultPii(){const e=this.getClient(),n=e&&e.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:n}=this.getStackTop(),i=e.getSession();i&&n&&n.captureSession&&n.captureSession(i)}_callExtensionMethod(e,...n){const r=wh().__SENTRY__;if(r&&r.extensions&&typeof r.extensions[e]=="function")return r.extensions[e].apply(this,n);Oe&&Ft.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function wh(){return ve.__SENTRY__=ve.__SENTRY__||{extensions:{},hub:void 0},ve}function ab(t){const e=wh(),n=kf(e);return K1(e,t),n}function nr(){const t=wh();if(t.__SENTRY__&&t.__SENTRY__.acs){const e=t.__SENTRY__.acs.getCurrentHub();if(e)return e}return NQ(t)}function Ul(){return nr().getIsolationScope()}function NQ(t=wh()){return(!RQ(t)||kf(t).isOlderThan(X1))&&K1(t,new q1),kf(t)}function RQ(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function kf(t){return C1("hub",()=>new q1,t)}function K1(t,e){if(!t)return!1;const n=t.__SENTRY__=t.__SENTRY__||{};return n.hub=e,!0}function Z1(t){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=Hn(),n=t||e&&e.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function lb(t){if(!Z1())return;const e=$Q(t),n=nr(),i=t.scope?t.scope.getSpan():Of();if(t.onlyIfParent&&!i)return;const s=Ul(),o=eo();let a;if(i)a=i.startChild(e);else{const{traceId:l,dsc:c,parentSpanId:h,sampled:u}={...s.getPropagationContext(),...o.getPropagationContext()};a=n.startTransaction({traceId:l,parentSpanId:h,parentSampled:u,...e,metadata:{dynamicSamplingContext:c,...e.metadata}})}return VQ(a,o,s),a}function Of(){return eo().getSpan()}function $Q(t){if(t.startTime){const e={...t};return e.startTimestamp=hQ(t.startTime),delete e.startTime,e}return t}const BQ="_sentryScope",FQ="_sentryIsolationScope";function VQ(t,e,n){t&&($s(t,FQ,n),$s(t,BQ,e))}function zQ(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function GQ(t,e,n,i){const r=F1(n),s={sent_at:new Date().toISOString(),...r&&{sdk:r},...!!i&&e&&{dsn:Gl(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return da(s,[o])}function HQ(t,e,n,i){const r=F1(n),s=t.type&&t.type!=="replay_event"?t.type:"event";zQ(t,n&&n.sdk);const o=tQ(t,r,i,e);return delete t.sdkProcessingMetadata,da(o,[[{type:s},t]])}const UQ="7";function jQ(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function WQ(t){return`${jQ(t)}${t.projectId}/envelope/`}function YQ(t,e){return dJ({sentry_key:t.publicKey,sentry_version:UQ,...e&&{sentry_client:`${e.name}/${e.version}`}})}function XQ(t,e={}){const n=typeof e=="string"?e:e.tunnel,i=typeof e=="string"||!e._metadata?void 0:e._metadata.sdk;return n||`${WQ(t)}?${YQ(t,i)}`}const cb=[];function qQ(t){const e={};return t.forEach(n=>{const{name:i}=n,r=e[i];r&&!r.isDefaultInstance&&n.isDefaultInstance||(e[i]=n)}),Object.keys(e).map(n=>e[n])}function KQ(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(o=>{o.isDefaultInstance=!0});let i;Array.isArray(n)?i=[...e,...n]:typeof n=="function"?i=Dg(n(e)):i=e;const r=qQ(i),s=JQ(r,o=>o.name==="Debug");if(s!==-1){const[o]=r.splice(s,1);r.push(o)}return r}function ZQ(t,e){const n={};return e.forEach(i=>{i&&J1(t,i,n)}),n}function ub(t,e){for(const n of e)n&&n.afterAllSetup&&n.afterAllSetup(t)}function J1(t,e,n){if(n[e.name]){Oe&&Ft.log(`Integration skipped because it was already installed: ${e.name}`);return}if(n[e.name]=e,cb.indexOf(e.name)===-1&&(e.setupOnce(aQ,nr),cb.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),t.on&&typeof e.preprocessEvent=="function"){const i=e.preprocessEvent.bind(e);t.on("preprocessEvent",(r,s)=>i(r,s,t))}if(t.addEventProcessor&&typeof e.processEvent=="function"){const i=e.processEvent.bind(e),r=Object.assign((s,o)=>i(s,o,t),{id:e.name});t.addEventProcessor(r)}Oe&&Ft.log(`Integration installed: ${e.name}`)}function JQ(t,e){for(let n=0;n<t.length;n++)if(e(t[n])===!0)return n;return-1}function Rr(t,e){return Object.assign(function(...i){return e(...i)},{id:t})}function QQ(t){let e="";for(const n of t){const i=Object.entries(n.tags),r=i.length>0?`|#${i.map(([s,o])=>`${s}:${o}`).join(",")}`:"";e+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${r}|T${n.timestamp}
`}return e}function ttt(t,e,n,i){const r={sent_at:new Date().toISOString()};n&&n.sdk&&(r.sdk={name:n.sdk.name,version:n.sdk.version}),i&&e&&(r.dsn=Gl(e));const s=ett(t);return da(r,[s])}function ett(t){const e=QQ(t);return[{type:"statsd",length:e.length},e]}const hb="Not capturing exception because it's already been captured.";class ntt{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=hJ(e.dsn):Oe&&Ft.warn("No DSN provided, client will not send events."),this._dsn){const n=XQ(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}}captureException(e,n,i){if(qy(e)){Oe&&Ft.log(hb);return}let r=n&&n.event_id;return this._process(this.eventFromException(e,n).then(s=>this._captureEvent(s,n,i)).then(s=>{r=s})),r}captureMessage(e,n,i,r){let s=i&&i.event_id;const o=Ig(e)?e:String(e),a=kg(e)?this.eventFromMessage(o,n,i):this.eventFromException(e,i);return this._process(a.then(l=>this._captureEvent(l,i,r)).then(l=>{s=l})),s}captureEvent(e,n,i){if(n&&n.originalException&&qy(n.originalException)){Oe&&Ft.log(hb);return}let r=n&&n.event_id;const o=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,n,o||i).then(a=>{r=a})),r}captureSession(e){typeof e.release!="string"?Oe&&Ft.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),Bs(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(e).then(i=>n.flush(e).then(r=>i&&r))):Xo(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&this._setupIntegrations()}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationById(e){return this.getIntegrationByName(e)}getIntegrationByName(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch{return Oe&&Ft.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){const n=this._integrations[e.name];J1(this,e,this._integrations),n||ub(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let i=HQ(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])i=qJ(i,JJ(s,this._options.transportOptions&&this._options.transportOptions.textEncoder));const r=this._sendEnvelope(i);r&&r.then(s=>this.emit("afterSendEvent",e,s),null)}sendSession(e){const n=GQ(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}recordDroppedEvent(e,n,i){if(this._options.sendClientReports){const r=`${e}:${n}`;Oe&&Ft.log(`Adding outcome: "${r}"`),this._outcomes[r]=this._outcomes[r]+1||1}}captureAggregateMetrics(e){Oe&&Ft.log(`Flushing aggregated metrics, number of metrics: ${e.length}`);const n=ttt(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}on(e,n){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(n)}emit(e,...n){this._hooks[e]&&this._hooks[e].forEach(i=>i(...n))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=ZQ(this,e),ub(this,e),this._integrationsInitialized=!0}_updateSessionFromEvent(e,n){let i=!1,r=!1;const s=n.exception&&n.exception.values;if(s){r=!0;for(const l of s){const c=l.mechanism;if(c&&c.handled===!1){i=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&i)&&(Bs(e,{...i&&{status:"crashed"},errors:e.errors||Number(r||i)}),this.captureSession(e))}_isClientDoneProcessing(e){return new ii(n=>{let i=0;const r=1,s=setInterval(()=>{this._numProcessing==0?(clearInterval(s),n(!0)):(i+=r,e&&i>=e&&(clearInterval(s),n(!1)))},r)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,i,r=Ul()){const s=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&o.length>0&&(n.integrations=o),this.emit("preprocessEvent",e,n),pQ(s,e,n,i,this,r).then(a=>{if(a===null)return a;const l={...r.getPropagationContext(),...i?i.getPropagationContext():void 0};if(!(a.contexts&&a.contexts.trace)&&l){const{traceId:h,spanId:u,parentSpanId:d,dsc:f}=l;a.contexts={trace:{trace_id:h,span_id:u,parent_span_id:d},...a.contexts};const p=f||W1(h,this,i);a.sdkProcessingMetadata={dynamicSamplingContext:p,...a.sdkProcessingMetadata}}return a})}_captureEvent(e,n={},i){return this._processEvent(e,n,i).then(r=>r.event_id,r=>{if(Oe){const s=r;s.logLevel==="log"?Ft.log(s.message):Ft.warn(s)}})}_processEvent(e,n,i){const r=this.getOptions(),{sampleRate:s}=r,o=tE(e),a=Q1(e),l=e.type||"error",c=`before send for type \`${l}\``;if(a&&typeof s=="number"&&Math.random()>s)return this.recordDroppedEvent("sample_rate","error",e),Ng(new Hi(`Discarding event because it's not included in the random sample (sampling rate = ${s})`,"log"));const h=l==="replay_event"?"replay":l,d=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,n,i,d).then(f=>{if(f===null)throw this.recordDroppedEvent("event_processor",h,e),new Hi("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return f;const g=rtt(r,f,n);return itt(g,c)}).then(f=>{if(f===null)throw this.recordDroppedEvent("before_send",h,e),new Hi(`${c} returned \`null\`, will not send event.`,"log");const p=i&&i.getSession();!o&&p&&this._updateSessionFromEvent(p,f);const g=f.transaction_info;if(o&&g&&f.transaction!==e.transaction){const v="custom";f.transaction_info={...g,source:v}}return this.sendEvent(f,n),f}).then(null,f=>{throw f instanceof Hi?f:(this.captureException(f,{data:{__sentry__:!0},originalException:f}),new Hi(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${f}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,n=>{Oe&&Ft.error("Error while sending event:",n)});Oe&&Ft.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map(n=>{const[i,r]=n.split(":");return{reason:i,category:r,quantity:e[n]}})}}function itt(t,e){const n=`${e} must return \`null\` or a valid event.`;if(vh(t))return t.then(i=>{if(!Yo(i)&&i!==null)throw new Hi(n);return i},i=>{throw new Hi(`${e} rejected with ${i}`)});if(!Yo(t)&&t!==null)throw new Hi(n);return t}function rtt(t,e,n){const{beforeSend:i,beforeSendTransaction:r}=t;return Q1(e)&&i?i(e,n):tE(e)&&r?r(e,n):e}function Q1(t){return t.type===void 0}function tE(t){return t.type==="transaction"}function stt(t,e){e.debug===!0&&(Oe?Ft.enable():Js(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),eo().update(e.initialScope);const i=new t(e);ott(i),att(i)}function ott(t){const n=nr().getStackTop();n.client=t,n.scope.setClient(t)}function att(t){t.init?t.init():t.setupIntegrations&&t.setupIntegrations()}const ltt=30;function eE(t,e,n=jJ(t.bufferSize||ltt)){let i={};const r=o=>n.drain(o);function s(o){const a=[];if(Qy(o,(u,d)=>{const f=tb(d);if(sQ(i,f)){const p=db(u,d);t.recordDroppedEvent("ratelimit_backoff",f,p)}else a.push(u)}),a.length===0)return Xo();const l=da(o[0],a),c=u=>{Qy(l,(d,f)=>{const p=db(d,f);t.recordDroppedEvent(u,tb(f),p)})},h=()=>e({body:KJ(l,t.textEncoder)}).then(u=>(u.statusCode!==void 0&&(u.statusCode<200||u.statusCode>=300)&&Oe&&Ft.warn(`Sentry responded with status code ${u.statusCode} to sent event.`),i=oQ(i,u),u),u=>{throw c("network_error"),u});return n.add(h).then(u=>u,u=>{if(u instanceof Hi)return Oe&&Ft.error("Skipped sending event because buffer is full."),c("queue_overflow"),Xo();throw u})}return s.__sentry__baseTransport__=!0,{send:s,flush:r}}function db(t,e){if(!(e!=="event"&&e!=="transaction"))return Array.isArray(t)?t[1]:void 0}function ctt(t,e,n=[e],i="npm"){const r=t._metadata||{};r.sdk||(r.sdk={name:`sentry.javascript.${e}`,packages:n.map(s=>({name:`${i}:@sentry/${s}`,version:fl})),version:fl}),t._metadata=r}const utt=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],htt=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],nE="InboundFilters",dtt=(t={})=>({name:nE,setupOnce(){},processEvent(e,n,i){const r=i.getOptions(),s=ftt(t,r);return ptt(e,s)?null:e}}),iE=dtt;Rr(nE,iE);function ftt(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:utt],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[],...t.disableTransactionDefaults?[]:htt],ignoreInternal:t.ignoreInternal!==void 0?t.ignoreInternal:!0}}function ptt(t,e){return e.ignoreInternal&&xtt(t)?(Oe&&Ft.warn(`Event dropped due to being internal Sentry Error.
Event: ${Yr(t)}`),!0):gtt(t,e.ignoreErrors)?(Oe&&Ft.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Yr(t)}`),!0):mtt(t,e.ignoreTransactions)?(Oe&&Ft.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Yr(t)}`),!0):vtt(t,e.denyUrls)?(Oe&&Ft.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Yr(t)}.
Url: ${xu(t)}`),!0):ytt(t,e.allowUrls)?!1:(Oe&&Ft.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Yr(t)}.
Url: ${xu(t)}`),!0)}function gtt(t,e){return t.type||!e||!e.length?!1:btt(t).some(n=>yh(n,e))}function mtt(t,e){if(t.type!=="transaction"||!e||!e.length)return!1;const n=t.transaction;return n?yh(n,e):!1}function vtt(t,e){if(!e||!e.length)return!1;const n=xu(t);return n?yh(n,e):!1}function ytt(t,e){if(!e||!e.length)return!0;const n=xu(t);return n?yh(n,e):!0}function btt(t){const e=[];t.message&&e.push(t.message);let n;try{n=t.exception.values[t.exception.values.length-1]}catch{}return n&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`)),Oe&&e.length===0&&Ft.error(`Could not extract message for event ${Yr(t)}`),e}function xtt(t){try{return t.exception.values[0].type==="SentryError"}catch{}return!1}function wtt(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function xu(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?wtt(e):null}catch{return Oe&&Ft.error(`Cannot extract url for event ${Yr(t)}`),null}}let fb;const rE="FunctionToString",pb=new WeakMap,_tt=()=>({name:rE,setupOnce(){fb=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=Mg(this),n=pb.has(Hn())&&e!==void 0?e:this;return fb.apply(n,t)}}catch{}},setup(t){pb.set(t,!0)}}),sE=_tt;Rr(rE,sE);const Ae=ve;let Lf=0;function oE(){return Lf>0}function Stt(){Lf++,setTimeout(()=>{Lf--})}function qo(t,e={},n){if(typeof t!="function")return t;try{const r=t.__sentry_wrapped__;if(r)return r;if(Mg(t))return t}catch{return t}const i=function(){const r=Array.prototype.slice.call(arguments);try{n&&typeof n=="function"&&n.apply(this,arguments);const s=r.map(o=>qo(o,e));return t.apply(this,s)}catch(s){throw Stt(),TQ(o=>{o.addEventProcessor(a=>(e.mechanism&&(_f(a,void 0,void 0),hl(a,e.mechanism)),a.extra={...a.extra,arguments:r},a)),$g(s)}),s}};try{for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}catch{}k1(i,t),$s(t,"__sentry_wrapped__",i);try{Object.getOwnPropertyDescriptor(i,"name").configurable&&Object.defineProperty(i,"name",{get(){return t.name}})}catch{}return i}const _r=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function aE(t,e){const n=Bg(t,e),i={type:e&&e.name,value:Ctt(e)};return n.length&&(i.stacktrace={frames:n}),i.type===void 0&&i.value===""&&(i.value="Unrecoverable error caught"),i}function Ett(t,e,n,i){const r=Hn(),s=r&&r.getOptions().normalizeDepth,o={exception:{values:[{type:mh(e)?e.constructor.name:i?"UnhandledRejection":"Error",value:ktt(e,{isUnhandledRejection:i})}]},extra:{__serialized__:$1(e,s)}};if(n){const a=Bg(t,n);a.length&&(o.exception.values[0].stacktrace={frames:a})}return o}function Td(t,e){return{exception:{values:[aE(t,e)]}}}function Bg(t,e){const n=e.stacktrace||e.stack||"",i=Att(e);try{return t(n,i)}catch{}return[]}const Ttt=/Minified React error #\d+;/i;function Att(t){if(t){if(typeof t.framesToPop=="number")return t.framesToPop;if(Ttt.test(t.message))return 1}return 0}function Ctt(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function Ptt(t,e,n,i){const r=n&&n.syntheticException||void 0,s=Fg(t,e,r,i);return hl(s),s.level="error",n&&n.event_id&&(s.event_id=n.event_id),Xo(s)}function Itt(t,e,n="info",i,r){const s=i&&i.syntheticException||void 0,o=Mf(t,e,s,r);return o.level=n,i&&i.event_id&&(o.event_id=i.event_id),Xo(o)}function Fg(t,e,n,i,r){let s;if(Pg(e)&&e.error)return Td(t,e.error);if(Vy(e)||YZ(e)){const o=e;if("stack"in e)s=Td(t,e);else{const a=o.name||(Vy(o)?"DOMError":"DOMException"),l=o.message?`${a}: ${o.message}`:a;s=Mf(t,l,n,i),_f(s,l)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":`${o.code}`}),s}return T1(e)?Td(t,e):Yo(e)||mh(e)?(s=Ett(t,e,n,r),hl(s,{synthetic:!0}),s):(s=Mf(t,e,n,i),_f(s,`${e}`,void 0),hl(s,{synthetic:!0}),s)}function Mf(t,e,n,i){const r={};if(i&&n){const s=Bg(t,n);s.length&&(r.exception={values:[{value:e,stacktrace:{frames:s}}]})}if(Ig(e)){const{__sentry_template_string__:s,__sentry_template_values__:o}=e;return r.logentry={message:s,params:o},r}return r.message=e,r}function ktt(t,{isUnhandledRejection:e}){const n=fJ(t),i=e?"promise rejection":"exception";return Pg(t)?`Event \`ErrorEvent\` captured as ${i} with message \`${t.message}\``:mh(t)?`Event \`${Ott(t)}\` (type=${t.type}) captured as ${i}`:`Object captured as ${i} with keys: ${n}`}function Ott(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function Ltt(t,{metadata:e,tunnel:n,dsn:i}){const r={event_id:t.event_id,sent_at:new Date().toISOString(),...e&&e.sdk&&{sdk:{name:e.sdk.name,version:e.sdk.version}},...!!n&&!!i&&{dsn:Gl(i)}},s=Mtt(t);return da(r,[s])}function Mtt(t){return[{type:"user_report"},t]}class Dtt extends ntt{constructor(e){const n=Ae.SENTRY_SDK_SOURCE||FJ();ctt(e,"browser",["browser"],n),super(e),e.sendClientReports&&Ae.document&&Ae.document.addEventListener("visibilitychange",()=>{Ae.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,n){return Ptt(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",i){return Itt(this._options.stackParser,e,n,i,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled()){_r&&Ft.warn("SDK not enabled, will not capture user feedback.");return}const n=Ltt(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(n)}_prepareEvent(e,n,i){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,i)}_flushOutcomes(){const e=this._clearOutcomes();if(e.length===0){_r&&Ft.log("No outcomes to send");return}if(!this._dsn){_r&&Ft.log("No dsn provided, will not send outcomes");return}_r&&Ft.log("Sending outcomes:",e);const n=eQ(e,this._options.tunnel&&Gl(this._dsn));this._sendEnvelope(n)}}let Va;function Ntt(){if(Va)return Va;if(Af(Ae.fetch))return Va=Ae.fetch.bind(Ae);const t=Ae.document;let e=Ae.fetch;if(t&&typeof t.createElement=="function")try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n);const i=n.contentWindow;i&&i.fetch&&(e=i.fetch),t.head.removeChild(n)}catch(n){_r&&Ft.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return Va=e.bind(Ae)}function Rtt(){Va=void 0}function $tt(t,e=Ntt()){let n=0,i=0;function r(s){const o=s.body.length;n+=o,i++;const a={body:s.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n<=6e4&&i<15,...t.fetchOptions};try{return e(t.url,a).then(l=>(n-=o,i--,{statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}}))}catch(l){return Rtt(),n-=o,i--,Ng(l)}}return eE(t,r)}const Btt=4;function Ftt(t){function e(n){return new ii((i,r)=>{const s=new XMLHttpRequest;s.onerror=r,s.onreadystatechange=()=>{s.readyState===Btt&&i({statusCode:s.status,headers:{"x-sentry-rate-limits":s.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":s.getResponseHeader("Retry-After")}})},s.open("POST",t.url);for(const o in t.headers)Object.prototype.hasOwnProperty.call(t.headers,o)&&s.setRequestHeader(o,t.headers[o]);s.send(n.body)})}return eE(t,e)}const _h="?",Vtt=30,ztt=40,Gtt=50;function Vg(t,e,n,i){const r={filename:t,function:e,in_app:!0};return n!==void 0&&(r.lineno=n),i!==void 0&&(r.colno=i),r}const Htt=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Utt=/\((\S*)(?::(\d+))(?::(\d+))\)/,jtt=t=>{const e=Htt.exec(t);if(e){if(e[2]&&e[2].indexOf("eval")===0){const s=Utt.exec(e[2]);s&&(e[2]=s[1],e[3]=s[2],e[4]=s[3])}const[i,r]=lE(e[1]||_h,e[2]);return Vg(r,i,e[3]?+e[3]:void 0,e[4]?+e[4]:void 0)}},Wtt=[Vtt,jtt],Ytt=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Xtt=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,qtt=t=>{const e=Ytt.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const s=Xtt.exec(e[3]);s&&(e[1]=e[1]||"eval",e[3]=s[1],e[4]=s[2],e[5]="")}let i=e[3],r=e[1]||_h;return[r,i]=lE(r,i),Vg(i,r,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},Ktt=[Gtt,qtt],Ztt=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Jtt=t=>{const e=Ztt.exec(t);return e?Vg(e[2],e[1]||_h,+e[3],e[4]?+e[4]:void 0):void 0},Qtt=[ztt,Jtt],tet=[Wtt,Ktt,Qtt],eet=M1(...tet),lE=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,i=t.indexOf("safari-web-extension")!==-1;return n||i?[t.indexOf("@")!==-1?t.split("@")[0]:_h,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},Lc=1024,cE="Breadcrumbs",net=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:cE,setupOnce(){},setup(n){e.console&&vJ(set(n)),e.dom&&xJ(ret(n,e.dom)),e.xhr&&RJ(oet(n)),e.fetch&&AJ(aet(n)),e.history&&R1(cet(n)),e.sentry&&n.on&&n.on("beforeSendEvent",iet(n))}}},uE=net;Rr(cE,uE);function iet(t){return function(n){Hn()===t&&Fs({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:Yr(n)},{event:n})}}function ret(t,e){return function(i){if(Hn()!==t)return;let r,s,o=typeof e=="object"?e.serializeAttribute:void 0,a=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;a&&a>Lc&&(_r&&Ft.warn(`\`dom.maxStringLength\` cannot exceed ${Lc}, but a value of ${a} was configured. Sentry will use ${Lc} instead.`),a=Lc),typeof o=="string"&&(o=[o]);try{const c=i.event,h=uet(c)?c.target:c;r=P1(h,{keyAttrs:o,maxStringLength:a}),s=rJ(h)}catch{r="<unknown>"}if(r.length===0)return;const l={category:`ui.${i.name}`,message:r};s&&(l.data={"ui.component_name":s}),Fs(l,{event:i.event,name:i.name,global:i.global})}}function set(t){return function(n){if(Hn()!==t)return;const i={category:"console",data:{arguments:n.args,logger:"console"},level:YJ(n.level),message:zy(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)i.message=`Assertion failed: ${zy(n.args.slice(1)," ")||"console.assert"}`,i.data.arguments=n.args.slice(1);else return;Fs(i,{input:n.args,level:n.level})}}function oet(t){return function(n){if(Hn()!==t)return;const{startTimestamp:i,endTimestamp:r}=n,s=n.xhr[Fa];if(!i||!r||!s)return;const{method:o,url:a,status_code:l,body:c}=s,h={method:o,url:a,status_code:l},u={xhr:n.xhr,input:c,startTimestamp:i,endTimestamp:r};Fs({category:"xhr",data:h,type:"http"},u)}}function aet(t){return function(n){if(Hn()!==t)return;const{startTimestamp:i,endTimestamp:r}=n;if(r&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.error){const s=n.fetchData,o={data:n.error,input:n.args,startTimestamp:i,endTimestamp:r};Fs({category:"fetch",data:s,level:"error",type:"http"},o)}else{const s=n.response,o={...n.fetchData,status_code:s&&s.status},a={input:n.args,response:s,startTimestamp:i,endTimestamp:r};Fs({category:"fetch",data:o,type:"http"},a)}}}function cet(t){return function(n){if(Hn()!==t)return;let i=n.from,r=n.to;const s=Sd(Ae.location.href);let o=i?Sd(i):void 0;const a=Sd(r);(!o||!o.path)&&(o=s),s.protocol===a.protocol&&s.host===a.host&&(r=a.relative),s.protocol===o.protocol&&s.host===o.host&&(i=o.relative),Fs({category:"navigation",data:{from:i,to:r}})}}function uet(t){return!!t&&!!t.target}const hE="Dedupe",het=()=>{let t;return{name:hE,setupOnce(){},processEvent(e){if(e.type)return e;try{if(det(e,t))return _r&&Ft.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}},dE=het;Rr(hE,dE);function det(t,e){return e?!!(fet(t,e)||pet(t,e)):!1}function fet(t,e){const n=t.message,i=e.message;return!(!n&&!i||n&&!i||!n&&i||n!==i||!pE(t,e)||!fE(t,e))}function pet(t,e){const n=gb(e),i=gb(t);return!(!n||!i||n.type!==i.type||n.value!==i.value||!pE(t,e)||!fE(t,e))}function fE(t,e){let n=mb(t),i=mb(e);if(!n&&!i)return!0;if(n&&!i||!n&&i||(n=n,i=i,i.length!==n.length))return!1;for(let r=0;r<i.length;r++){const s=i[r],o=n[r];if(s.filename!==o.filename||s.lineno!==o.lineno||s.colno!==o.colno||s.function!==o.function)return!1}return!0}function pE(t,e){let n=t.fingerprint,i=e.fingerprint;if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;n=n,i=i;try{return n.join("")===i.join("")}catch{return!1}}function gb(t){return t.exception&&t.exception.values&&t.exception.values[0]}function mb(t){const e=t.exception;if(e)try{return e.values[0].stacktrace.frames}catch{return}}const gE="GlobalHandlers",get=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:gE,setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&(met(n),vb("onerror")),e.onunhandledrejection&&(vet(n),vb("onunhandledrejection"))}}},mE=get;Rr(gE,mE);function met(t){IJ(e=>{const{stackParser:n,attachStacktrace:i}=yE();if(Hn()!==t||oE())return;const{msg:r,url:s,line:o,column:a,error:l}=e,c=l===void 0&&Ar(r)?xet(r,s,o,a):vE(Fg(n,l||r,void 0,i,!1),s,o,a);c.level="error",G1(c,{originalException:l,mechanism:{handled:!1,type:"onerror"}})})}function vet(t){OJ(e=>{const{stackParser:n,attachStacktrace:i}=yE();if(Hn()!==t||oE())return;const r=yet(e),s=kg(r)?bet(r):Fg(n,r,void 0,i,!0);s.level="error",G1(s,{originalException:r,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function yet(t){if(kg(t))return t;const e=t;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return t}function bet(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function xet(t,e,n,i){const r=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let s=Pg(t)?t.message:t,o="Error";const a=s.match(r);return a&&(o=a[1],s=a[2]),vE({exception:{values:[{type:o,value:s}]}},e,n,i)}function vE(t,e,n,i){const r=t.exception=t.exception||{},s=r.values=r.values||[],o=s[0]=s[0]||{},a=o.stacktrace=o.stacktrace||{},l=a.frames=a.frames||[],c=isNaN(parseInt(i,10))?void 0:i,h=isNaN(parseInt(n,10))?void 0:n,u=Ar(e)&&e.length>0?e:iJ();return l.length===0&&l.push({colno:c,filename:u,function:"?",in_app:!0,lineno:h}),t}function vb(t){_r&&Ft.log(`Global Handler attached: ${t}`)}function yE(){const t=Hn();return t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const bE="HttpContext",wet=()=>({name:bE,setupOnce(){},preprocessEvent(t){if(!Ae.navigator&&!Ae.location&&!Ae.document)return;const e=t.request&&t.request.url||Ae.location&&Ae.location.href,{referrer:n}=Ae.document||{},{userAgent:i}=Ae.navigator||{},r={...t.request&&t.request.headers,...n&&{Referer:n},...i&&{"User-Agent":i}},s={...t.request,...e&&{url:e},headers:r};t.request=s}}),xE=wet;Rr(bE,xE);const _et="cause",Eet=5,wE="LinkedErrors",Tet=(t={})=>{const e=t.limit||Eet,n=t.key||_et;return{name:wE,setupOnce(){},preprocessEvent(i,r,s){const o=s.getOptions();QZ(aE,o.stackParser,o.maxValueLength,n,e,i,r)}}},_E=Tet;Rr(wE,_E);const Aet=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],SE="TryCatch",Cet=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t};return{name:SE,setupOnce(){e.setTimeout&&Tn(Ae,"setTimeout",yb),e.setInterval&&Tn(Ae,"setInterval",yb),e.requestAnimationFrame&&Tn(Ae,"requestAnimationFrame",Pet),e.XMLHttpRequest&&"XMLHttpRequest"in Ae&&Tn(XMLHttpRequest.prototype,"send",Iet);const n=e.eventTarget;n&&(Array.isArray(n)?n:Aet).forEach(ket)}}},EE=Cet;Rr(SE,EE);function yb(t){return function(...e){const n=e[0];return e[0]=qo(n,{mechanism:{data:{function:ns(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function Pet(t){return function(e){return t.apply(this,[qo(e,{mechanism:{data:{function:"requestAnimationFrame",handler:ns(t)},handled:!1,type:"instrument"}})])}}function Iet(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(r=>{r in n&&typeof n[r]=="function"&&Tn(n,r,function(s){const o={mechanism:{data:{function:r,handler:ns(s)},handled:!1,type:"instrument"}},a=Mg(s);return a&&(o.mechanism.data.handler=ns(a)),qo(s,o)})}),t.apply(this,e)}}function ket(t){const e=Ae,n=e[t]&&e[t].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(Tn(n,"addEventListener",function(i){return function(r,s,o){try{typeof s.handleEvent=="function"&&(s.handleEvent=qo(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:ns(s),target:t},handled:!1,type:"instrument"}}))}catch{}return i.apply(this,[r,qo(s,{mechanism:{data:{function:"addEventListener",handler:ns(s),target:t},handled:!1,type:"instrument"}}),o])}}),Tn(n,"removeEventListener",function(i){return function(r,s,o){const a=s;try{const l=a&&a.__sentry_wrapped__;l&&i.call(this,r,l,o)}catch{}return i.call(this,r,a,o)}}))}const Oet=[iE(),sE(),EE(),uE(),mE(),_E(),dE(),xE()];function TE(t){return[...Oet]}function Let(t={}){t.defaultIntegrations===void 0&&(t.defaultIntegrations=TE()),t.release===void 0&&(typeof __SENTRY_RELEASE__=="string"&&(t.release=__SENTRY_RELEASE__),Ae.SENTRY_RELEASE&&Ae.SENTRY_RELEASE.id&&(t.release=Ae.SENTRY_RELEASE.id)),t.autoSessionTracking===void 0&&(t.autoSessionTracking=!0),t.sendClientReports===void 0&&(t.sendClientReports=!0);const e={...t,stackParser:gJ(t.stackParser||eet),integrations:KQ(t),transport:t.transport||(N1()?$tt:Ftt)};stt(Dtt,e),t.autoSessionTracking&&Met()}function Met(){if(typeof Ae.document>"u"){_r&&Ft.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}ib({ignoreDuration:!0}),rb(),R1(({from:t,to:e})=>{t!==void 0&&t!==e&&(ib({ignoreDuration:!0}),rb())})}const AE=["activate","mount","update"],Det=/(?:^|[-_])(\w)/g,Net=t=>t.replace(Det,e=>e.toUpperCase()).replace(/[-_]/g,""),Ret="<Root>",Ad="<Anonymous>",$et=(t,e)=>t.repeat?t.repeat(e):t,Wa=(t,e)=>{if(!t)return Ad;if(t.$root===t)return Ret;if(!t.$options)return Ad;const n=t.$options;let i=n.name||n._componentTag;const r=n.__file;if(!i&&r){const s=r.match(/([^/\\]+)\.vue$/);s&&(i=s[1])}return(i?`<${Net(i)}>`:Ad)+(r&&e!==!1?` at ${r}`:"")},Bet=t=>{if(t&&(t._isVue||t.__isVue)&&t.$parent){const e=[];let n=0;for(;t;){if(e.length>0){const r=e[e.length-1];if(r.constructor===t.constructor){n++,t=t.$parent;continue}else n>0&&(e[e.length-1]=[r,n],n=0)}e.push(t),t=t.$parent}return`

found in

${e.map((r,s)=>`${(s===0?"---> ":$et(" ",5+s*2))+(Array.isArray(r)?`${Wa(r[0])}... (${r[1]} recursive calls)`:Wa(r))}`).join(`
`)}`}return`

(found in ${Wa(t)})`},Fet=(t,e)=>{const{errorHandler:n,warnHandler:i,silent:r}=t.config;t.config.errorHandler=(s,o,a)=>{const l=Wa(o,!1),c=o?Bet(o):"",h={componentName:l,lifecycleHook:a,trace:c};if(e.attachProps&&o&&(o.$options&&o.$options.propsData?h.propsData=o.$options.propsData:o.$props&&(h.propsData=o.$props)),setTimeout(()=>{$g(s,{captureContext:{contexts:{vue:h}},mechanism:{handled:!1}})}),typeof n=="function"&&n.call(t,s,o,a),e.logErrors){const u=typeof console<"u",d=`Error in ${a}: "${s&&s.toString()}"`;i?i.call(null,d,o,c):u&&!r&&Js(()=>{console.error(`[Vue warn]: ${d}${c}`)})}}},Vet=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,bb="ui.vue",zet={activate:["activated","deactivated"],create:["beforeCreate","created"],unmount:["beforeUnmount","unmounted"],destroy:["beforeDestroy","destroyed"],mount:["beforeMount","mounted"],update:["beforeUpdate","updated"]};function Get(t,e,n){t.$_sentryRootSpanTimer&&clearTimeout(t.$_sentryRootSpanTimer),t.$_sentryRootSpanTimer=setTimeout(()=>{t.$root&&t.$root.$_sentryRootSpan&&(t.$root.$_sentryRootSpan.end(e),t.$root.$_sentryRootSpan=void 0)},n)}const Het=t=>{const e=(t.hooks||[]).concat(AE).filter((i,r,s)=>s.indexOf(i)===r),n={};for(const i of e){const r=zet[i];if(!r){Vet&&Ft.warn(`Unknown hook: ${i}`);continue}for(const s of r)n[s]=function(){const o=this.$root===this;o&&Of()&&(this.$_sentryRootSpan=this.$_sentryRootSpan||lb({name:"Application Render",op:`${bb}.render`,origin:"auto.ui.vue"}));const a=Wa(this,!1),l=Array.isArray(t.trackComponents)?t.trackComponents.indexOf(a)>-1:t.trackComponents;if(!(!o&&!l))if(this.$_sentrySpans=this.$_sentrySpans||{},s==r[0]){if(this.$root&&this.$root.$_sentryRootSpan||Of()){const h=this.$_sentrySpans[i];h&&h.end(),this.$_sentrySpans[i]=lb({name:`Vue <${a}>`,op:`${bb}.${i}`,origin:"auto.ui.vue"})}}else{const c=this.$_sentrySpans[i];if(!c)return;c.end(),Get(this,bh(),t.timeout)}}}return n},Uet=ve,jet={Vue:Uet.Vue,attachProps:!0,logErrors:!0,hooks:AE,timeout:2e3,trackComponents:!1},CE="Vue",Wet=(t={})=>({name:CE,setupOnce(){},setup(e){Yet(e,t)}}),PE=Wet;Rr(CE,PE);function Yet(t,e){const n={...jet,...t.getOptions(),...e};if(!n.Vue&&!n.app){Js(()=>{console.warn("[@sentry/vue]: Misconfigured SDK. Vue specific errors will not be captured.\nUpdate your `Sentry.init` call with an appropriate config option:\n`app` (Application Instance - Vue 3) or `Vue` (Vue Constructor - Vue 2).")});return}n.app?Dg(n.app).forEach(r=>xb(r,n)):n.Vue&&xb(n.Vue,n)}const xb=(t,e)=>{const n=t;(n._instance&&n._instance.isMounted)===!0&&Js(()=>{console.warn("[@sentry/vue]: Misconfigured SDK. Vue app is already mounted. Make sure to call `app.mount()` after `Sentry.init()`.")}),Fet(t,e),Z1(e)&&t.mixin(Het({...e,...e.tracingOptions}))};function Xet(t={}){const e={_metadata:{sdk:{name:"sentry.javascript.vue",packages:[{name:"npm:@sentry/vue",version:fl}],version:fl}},defaultIntegrations:[...TE(),PE()],...t};Let(e)}const ms={lastSavedAt:null,isViewOnly:!0,isSaving:!1,shouldRedraw:!1,shouldReloadCanvas:!1,blueprint:null,tables:{},columns:{},relationships:{}},qet={isViewOnly:t=>t.isViewOnly,shouldRedraw:t=>t.shouldRedraw,shouldReloadCanvas:t=>t.shouldReloadCanvas,blueprint:t=>t.blueprint,isTableCommentsCollapsed:t=>t.blueprint.is_table_comments_collapsed,isAutosaveEnabled:t=>{var e;return(e=t.blueprint)==null?void 0:e.is_autosave_enabled},schema:(t,e,n,i)=>{let r=1;return $t().isCanvasVersionV2AndUp&&(r=2),{version:r,tables:e.tablesObjArray,columns:e.columnsObjArray,indexes:i["indexes/getIndexes"],column_indexes:i["columnIndexes/getColumnIndexes"],relationships:e.relationshipsObjArray}},tables:t=>_.chain(t.tables).filter({deletedAt:null}).orderBy("order").value(),tablesObjArray:t=>_.pickBy(t.tables,{deletedAt:null}),totalUnsavedTables:(t,e)=>e.unsavedTables.length,unsavedTables:(t,e)=>_.union(_.filter(e.tables,{isDirty:!0}),_.filter(e.deletedTables,{isDirty:!0})),table:t=>e=>t.tables[e],indexOfTable:t=>e=>Object.keys(t.tables).indexOf(e),denormalizeTable:(t,e,n,i)=>r=>II(r,PZ,{tables:t.tables,columns:t.columns,indexes:i["indexes/getIndexes"],columnIndexes:i["columnIndexes/getColumnIndexes"]}),deletedTables:t=>_.reject(t.tables,{deletedAt:null}),columnsForTable:(t,e)=>n=>{const i=e.table(n).columns,r=_.map(i,s=>e.column(s));return _.orderBy(r,"order")},columns:t=>_.filter(t.columns,{deletedAt:null}),columnsObjArray:t=>_.pickBy(t.columns,{deletedAt:null}),column:t=>e=>t.columns[e],indexOfColumnInTable:(t,e)=>n=>e.table(e.getTableUuidOfColumn(n)).columns.indexOf(n),relationships:t=>_.filter(t.relationships,{deletedAt:null}),relationshipsObjArray:t=>_.pickBy(t.relationships,{deletedAt:null}),totalUnsavedRelationships:(t,e)=>e.unsavedRelationships.length,unsavedRelationships:(t,e)=>_.union(_.filter(e.relationships,{isDirty:!0}),_.filter(e.deletedRelationships,{isDirty:!0})),deletedRelationships:t=>_.reject(t.relationships,{deletedAt:null}),relationship:t=>e=>t.relationships[e],relationshipsOfTable:(t,e)=>n=>{let i=[];return _.forEach(e.table(n).columns,r=>{const s=_.filter(e.relationships,{target_column_uuid:r}),o=_.filter(e.relationships,{source_column_uuid:r});i=_.unionBy(i,s,o,"uuid")}),i},totalUnsavedUpdates:(t,e)=>e.totalUnsavedTables+e.totalUnsavedRelationships,isSaving:t=>t.isSaving,getTableUuidOfColumn:(t,e)=>n=>{const i=e.column(n);return i==null?void 0:i.table_uuid},isTableDirty:(t,e)=>n=>e.table(n).isDirty},Ket={setIsViewOnly({commit:t},e){t("SET_IS_VIEW_ONLY",e)},setBlueprint({commit:t},e){t("SET_BLUEPRINT",e)},setShouldRedraw({commit:t}){t("SET_SHOULD_REDRAW")},unsetShouldRedraw({commit:t}){t("UNSET_SHOULD_REDRAW")},reloadCanvas({commit:t,dispatch:e,getters:n,state:i}){t("SET_SHOULD_RELOAD_CANVAS")},unsetShouldReloadCanvas({commit:t}){t("UNSET_SHOULD_RELOAD_CANVAS")},async saveBlueprint(){await axios.patch(`/api/blueprints/${ms.blueprint.id}`)},async saveDiagram({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},{shouldRefetchDiagram:s=!1,shouldToast:o=!1,amplitudeTag:a=null,shouldSkipIfRecentlySaved:l=!1}){var c;t("SET_IS_SAVING");try{if(l&&i.lastSavedAt&&new Date-i.lastSavedAt<2.5*60*1e3)return;try{await e("saveSchema"),t("SET_LAST_SAVED_AT_TO_NOW")}catch(h){throw $g(h),console.error(h),h}s?(await e("loadSchema"),e("setShouldRedraw")):await e("markSchemaClean"),o&&this.$emitter.emit("toast-success","Diagram saved!"),a&&S1.getInstance().logEvent(a,{blueprint_id:i.blueprint.id,team_id:(c=r["team/getTeam"])==null?void 0:c.id,driver:n.blueprint.driver,total_tables:n.tables.length,total_columns:n.columns.length,total_relationships:n.relationships.length})}catch(h){console.error(h),this.$emitter.emit("toast-error","Oops.. something went wrong while saving.")}finally{t("UNSET_IS_SAVING")}},hydrateAndCommitSchema({commit:t,dispatch:e,getters:n,state:i},r){const s=_.mapValues(r,(o,a)=>["tables","relationships"].includes(a)?_.mapValues(o,(l,c)=>(l.isDirty=null,l.deletedAt=null,l)):["columns","indexes","column_indexes"].includes(a)?_.mapValues(o,(l,c)=>(l.deletedAt=null,l)):o);t("SET_TABLES",s.tables),t("SET_COLUMNS",s.columns),e("columnIndexes/setColumnIndexes",s.column_indexes,{root:!0}),e("indexes/setIndexes",s.indexes,{root:!0}),t("SET_RELATIONSHIPS",s.relationships),$t().isCanvasVersionV2AndUp&&$t().RESET_CELLS()},async loadSchema({commit:t,dispatch:e,rootGetters:n}){n["team/getTeam"]||console.error("Cannot load schema, no team detected");const i=await axios.get(`/api/teams/${n["team/getTeam"].slug}/blueprints/${ms.blueprint.id}/schemas`);e("hydrateAndCommitSchema",i.data.data.schema)},markSchemaClean({commit:t,dispatch:e,getters:n}){const i=_.filter(n.tables,{isDirty:!0});for(const s of i)t("MARK_TABLE_CLEAN",s.uuid);const r=_.filter(n.relationships,{isDirty:!0});for(const s of r)t("MARK_RELATIONSHIP_CLEAN",s.uuid)},async saveSchema({commit:t,dispatch:e,getters:n,state:i,rootGetters:r}){return axios.post(`/api/blueprints/${i.blueprint.id}/schemas`,{schema:n.schema})},addTable({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},s){s=s||Yi();let o=1;_.maxBy(n.tables,"order")!==void 0&&(o=_.maxBy(n.tables,"order").order+1);const a={id:null,blueprint_id:i.blueprint.id,uuid:s,name:`table_${n.tables.length+1}`,order:o,color:r["constants/nextTableColor"],comment:"",left:0,top:0,columns:[],indexes:[],isDirty:!0,deletedAt:null};t("ADD_TABLE",a)},updateTable({commit:t,dispatch:e},{targetTable:n,prop:i,value:r}){t("UPDATE_TABLE",{targetTable:n,prop:i,value:r}),e("markTableDirty",n.uuid)},deleteTables({commit:t,dispatch:e,getters:n},i){_.forEach(i,r=>{e("deleteTable",n.table(r))})},deleteTable({commit:t,dispatch:e,getters:n},i){const r=n.columnsForTable(i.uuid),s=r.length-1;for(let o=s;o>=0;o--)e("deleteColumn",r[o]);t("DELETE_TABLE",i),e("markTableDirty",i.uuid)},duplicateTable({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},{originTable:s,uuidMappings:o={}}){const a=mu(s,o);a.name=`${s.name}_copy`,a.top+=30,a.left+=50,a.isDirty=!0,a.order=s.order+1,t("ADD_TABLE",a),_.forEach(s.columns,l=>{const c=n.column(l);e("duplicateColumn",{originColumn:c,uuidMappings:o,updateOrder:!1})}),_.forEach(s.indexes,l=>{const c=r["indexes/getIndex"](l);e("indexes/duplicateIndex",{originIndex:c,uuidMappings:o,updateOrder:!1},{root:!0})})},markTableDirty({commit:t,getters:e},n){e.isTableDirty(n)||t("MARK_TABLE_DIRTY",n)},autoTableName({dispatch:t,getters:e},n){t("updateTable",{targetTable:e.table(n),prop:"name",value:"unnamed_table_"+(e.indexOfTable(n)+1)})},updateOrderOfTables({dispatch:t,getters:e},n){_.forEach(n,(r,s)=>{const o=s+1,a=e.table(r);a.order!==o&&t("updateTable",{targetTable:a,prop:"order",value:o})});const i=_.filter(ms.tables,r=>!_.includes(n,r.uuid));_.forEach(i,(r,s)=>{const o=n.length+s+1;r.order!==o&&t("updateTable",{targetTable:r,prop:"order",value:o})})},async saveTables({commit:t,dispatch:e,getters:n}){const r=_.chain(n.unsavedTables).differenceBy(n.deletedTables,"uuid").reject({id:null}).value().map(c=>axios.patch(`/api/tables/${c.uuid}`,n.denormalizeTable(c))),o=_.chain(n.unsavedTables).differenceBy(n.deletedTables,"uuid").filter({id:null}).value().map(c=>axios.post(`/api/blueprints/${ms.blueprint.id}/tables`,n.denormalizeTable(c))),l=_.reject(n.deletedTables,{id:null}).map(c=>axios.delete(`/api/tables/${c.uuid}`));try{await Promise.all(l)}catch(c){console.error("Error deleting tables",c)}await Promise.all(_.union(r,o))},addColumnToTable({commit:t,dispatch:e,getters:n,rootGetters:i},{uuid:r,tableUuid:s}){const o=n.table(s),a={uuid:r||Yi(),name:"",is_primary_key:!1,is_unique_key:!1,is_index:!1,is_nullable:!1,is_auto_increment:!1,is_unsigned:!1,default:"",comment:"",driver_data_type_id:i["diagram/getDiagram"].default_column_driver_data_type_id,driver_data_type_params:i["diagram/getDiagram"].default_column_driver_data_type_id&&i["diagram/getDiagram"].default_column_driver_data_type_params?i["diagram/getDiagram"].default_column_driver_data_type_params:[],order:o.columns.length>0?n.column(uf(o.columns)).order+1:1,table_uuid:s,deletedAt:null};t("ADD_COLUMN_TO_TABLE",{column:a,table:o}),e("markTableDirty",o.uuid)},updateColumn({commit:t,dispatch:e},{targetColumn:n,prop:i,value:r}){t("UPDATE_COLUMN",{targetColumn:n,prop:i,value:r}),e("markTableDirtyViaColumn",n.uuid)},deleteColumn({commit:t,getters:e,state:n,dispatch:i,rootGetters:r},s){const o=e.table(e.getTableUuidOfColumn(s.uuid));t("DELETE_COLUMN",{column:s,table:o}),i("markTableDirty",o.uuid);const a=_.union(_.filter(n.relationships,{source_column_uuid:s.uuid}),_.filter(n.relationships,{target_column_uuid:s.uuid}));_.forEach(a,h=>{xg().deleteRelationshipAndShape(h.uuid)});const l=r["columnIndexes/getColumnIndexesForColumn"](s.uuid),c=_.map(_.uniqBy(l,"index_uuid"),"index_uuid");_.forEach(c,h=>{Ls().deleteIndexAndShape(h)})},duplicateColumn({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},{originColumn:s,uuidMappings:o={},updateOrder:a=!0}){const l=mu(s,o);a&&(l.order=s.order+1),t("ADD_COLUMN_TO_TABLE",{column:l,table:n.table(l.table_uuid)}),e("markTableDirtyViaColumn",l.uuid)},markTableDirtyViaColumn({dispatch:t,getters:e},n){const i=e.getTableUuidOfColumn(n);t("markTableDirty",i)},autoColumnName({dispatch:t,getters:e},n){Wr().updateColumnAndShape(n,{name:"column_"+(e.indexOfColumnInTable(n)+1)})},addIndexToTable({commit:t,getters:e,state:n,dispatch:i,rootGetters:r},{uuid:s,tableUuid:o}){const a=e.table(o);a&&(i("indexes/createIndex",{uuid:s,tableUuid:o,order:a.indexes.length>0?r["indexes/getIndex"](uf(a.indexes)).order+1:1},{root:!0}),t("ADD_INDEX_TO_TABLE",{tableUuid:o,indexUuid:s}))},removeIndexFromTable({commit:t,dispatch:e,getters:n},{uuid:i,tableUuid:r}){t("REMOVE_INDEX_FROM_TABLE",{tableUuid:r,indexUuid:i})},addRelationship({commit:t},{uuid:e,sourceColumnUuid:n,targetColumnUuid:i,type:r}){t("ADD_RELATIONSHIP",{uuid:e,sourceColumnUuid:n,targetColumnUuid:i,type:r})},updateRelationship({commit:t},{targetRelationship:e,prop:n,value:i}){t("UPDATE_RELATIONSHIP",{targetRelationship:e,prop:n,value:i}),t("MARK_RELATIONSHIP_DIRTY",e.uuid)},setRelationshipConnectionId({commit:t},{targetRelationship:e,value:n}){t("UPDATE_RELATIONSHIP",{targetRelationship:e,prop:"connectionId",value:n})},updateRelationshipType({dispatch:t},{targetRelationship:e,value:n}){t("updateRelationship",{targetRelationship:e,prop:"type",value:n})},deleteRelationship({commit:t},{targetRelationship:e}){t("DELETE_RELATIONSHIP",e),t("MARK_RELATIONSHIP_DIRTY",e.uuid)},resetConnectionOfRelationship({commit:t}){t("RESET_CONNECTION_OF_RELATIONSHIPS")},async saveRelationships({commit:t,dispatch:e,getters:n}){const r=_.chain(n.unsavedRelationships).differenceBy(n.deletedRelationships,"uuid").reject({id:null}).value().map(c=>(c=_.omit(c,["connectionId"]),axios.patch(`/api/relationships/${c.uuid}`,c))),o=_.chain(n.unsavedRelationships).differenceBy(n.deletedRelationships,"uuid").filter({id:null}).value().map(c=>(c=_.omit(c,["connectionId"]),axios.post(`/api/blueprints/${ms.blueprint.id}/relationships`,c))),l=n.deletedRelationships.map(c=>(c=_.omit(c,["connectionId"]),axios.delete(`/api/relationships/${c.uuid}`,c)));try{await Promise.all(_.union(r,o,l))}catch(c){if(c.response.status===404)console.info("Relationship already deleted, probably when the attached column was deleted");else throw c}}},Zet={SET_LAST_SAVED_AT_TO_NOW(t){t.lastSavedAt=new Date},SET_IS_VIEW_ONLY(t,e){t.isViewOnly=e},SET_BLUEPRINT(t,e){t.blueprint=e},SET_CANVAS_VERSION(t,e){t.canvasVersion=e},SET_TABLES(t,e){t.tables=e,$t().isCanvasVersionV2AndUp&&pn().SET_TABLE_SHAPES(e,{addToGraph:!1})},SET_IS_SAVING(t){t.isSaving=!0},UNSET_IS_SAVING(t){t.isSaving=!1},SET_SHOULD_REDRAW(t){t.shouldRedraw=!0},UNSET_SHOULD_REDRAW(t){t.shouldRedraw=!1},SET_SHOULD_RELOAD_CANVAS(t){t.shouldReloadCanvas=!0},UNSET_SHOULD_RELOAD_CANVAS(t){t.shouldReloadCanvas=!1},ADD_TABLE(t,e){t.tables[e.uuid]=e},UPDATE_TABLE(t,{targetTable:e,prop:n,value:i}){Object.assign(e,{[n]:i})},DELETE_TABLE(t,e){Object.assign(e,{deletedAt:bt().format()})},ADD_COLUMN_TO_TABLE(t,{column:e,table:n}){t.columns[e.uuid]=e,n.columns.includes(e.uuid)&&n.columns.splice(_.indexOf(n.columns,e.uuid),1),n.columns.push(e.uuid)},SET_COLUMNS(t,e){t.columns=e,$t().isCanvasVersionV2AndUp&&Wr().SET_COLUMNS_IN_TABLE_SHAPES(e)},UPDATE_COLUMN(t,{targetColumn:e,prop:n,value:i}){i===void 0&&delete e[n],Object.assign(e,{[n]:i})},DELETE_COLUMN(t,{column:e,table:n}){n.columns.splice(_.indexOf(n.columns,e.uuid),1),Object.assign(e,{deletedAt:bt().format()})},MARK_TABLE_DIRTY(t,e){const n=t.tables[e];n.isDirty=!0},MARK_TABLE_CLEAN(t,e){const n=t.tables[e];n.isDirty=!1},ADD_INDEX_TO_TABLE(t,{tableUuid:e,indexUuid:n}){t.tables[e].indexes.includes(n)&&t.tables[e].indexes.splice(_.indexOf(t.tables[e].indexes,n),1),t.tables[e].indexes.push(n)},REMOVE_INDEX_FROM_TABLE(t,{tableUuid:e,indexUuid:n}){t.tables[e].indexes.splice(_.indexOf(t.tables[e].indexes,n),1)},ADD_RELATIONSHIP(t,{uuid:e,sourceColumnUuid:n,targetColumnUuid:i,type:r}){const s={id:null,uuid:e||Yi(),source_column_uuid:n,target_column_uuid:i,type:r,isDirty:!0,deletedAt:null};t.relationships[s.uuid]=s},UPDATE_RELATIONSHIP(t,{targetRelationship:e,prop:n,value:i}){const r=t.relationships[e.uuid];Object.assign(r,{[n]:i})},SET_RELATIONSHIPS(t,e){t.relationships=e,$t().isCanvasVersionV2AndUp&&xg().SET_RELATIONSHIP_SHAPES(e,{addToGraph:!1})},MARK_RELATIONSHIP_DIRTY(t,e){const n=t.relationships[e];n.isDirty=!0},MARK_RELATIONSHIP_CLEAN(t,e){const n=t.relationships[e];n.isDirty=!1},DELETE_RELATIONSHIP(t,e){Object.assign(e,{deletedAt:bt().format()})},RESET_CONNECTION_OF_RELATIONSHIPS(){_.forEach(ms.relationships,t=>{t.connectionId=null})}},Wt=UZ({modules:{constants:VY,diagramUI:kY,diagramAccess:NY,diagram:jY,driverDataTypes:VX,indexes:_Z,team:KY,columnIndexes:CZ},state:ms,getters:qet,mutations:Zet,actions:Ket,strict:!1}),Jet={install:(t,{apiKey:e,userId:n,config:i})=>{S1.getInstance().init(e,n,i)}};async function Qet(t,e){const n=e[t];if(typeof n>"u")throw new Error(`Page not found: ${t}`);return typeof n=="function"?n():n}function ti(){return ti=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ti.apply(this,arguments)}var tnt=String.prototype.replace,ent=/%20/g,wb="RFC3986",Oo={default:wb,formatters:{RFC1738:function(t){return tnt.call(t,ent,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:wb},Cd=Object.prototype.hasOwnProperty,fs=Array.isArray,Bi=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),_b=function(t,e){for(var n=e&&e.plainObjects?Object.create(null):{},i=0;i<t.length;++i)t[i]!==void 0&&(n[i]=t[i]);return n},vr={arrayToObject:_b,assign:function(t,e){return Object.keys(e).reduce(function(n,i){return n[i]=e[i],n},t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],i=0;i<e.length;++i)for(var r=e[i],s=r.obj[r.prop],o=Object.keys(s),a=0;a<o.length;++a){var l=o[a],c=s[l];typeof c=="object"&&c!==null&&n.indexOf(c)===-1&&(e.push({obj:s,prop:l}),n.push(c))}return function(h){for(;h.length>1;){var u=h.pop(),d=u.obj[u.prop];if(fs(d)){for(var f=[],p=0;p<d.length;++p)d[p]!==void 0&&f.push(d[p]);u.obj[u.prop]=f}}}(e),t},decode:function(t,e,n){var i=t.replace(/\+/g," ");if(n==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},encode:function(t,e,n,i,r){if(t.length===0)return t;var s=t;if(typeof t=="symbol"?s=Symbol.prototype.toString.call(t):typeof t!="string"&&(s=String(t)),n==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var o="",a=0;a<s.length;++a){var l=s.charCodeAt(a);l===45||l===46||l===95||l===126||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||r===Oo.RFC1738&&(l===40||l===41)?o+=s.charAt(a):l<128?o+=Bi[l]:l<2048?o+=Bi[192|l>>6]+Bi[128|63&l]:l<55296||l>=57344?o+=Bi[224|l>>12]+Bi[128|l>>6&63]+Bi[128|63&l]:(l=65536+((1023&l)<<10|1023&s.charCodeAt(a+=1)),o+=Bi[240|l>>18]+Bi[128|l>>12&63]+Bi[128|l>>6&63]+Bi[128|63&l])}return o},isBuffer:function(t){return!(!t||typeof t!="object"||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},maybeMap:function(t,e){if(fs(t)){for(var n=[],i=0;i<t.length;i+=1)n.push(e(t[i]));return n}return e(t)},merge:function t(e,n,i){if(!n)return e;if(typeof n!="object"){if(fs(e))e.push(n);else{if(!e||typeof e!="object")return[e,n];(i&&(i.plainObjects||i.allowPrototypes)||!Cd.call(Object.prototype,n))&&(e[n]=!0)}return e}if(!e||typeof e!="object")return[e].concat(n);var r=e;return fs(e)&&!fs(n)&&(r=_b(e,i)),fs(e)&&fs(n)?(n.forEach(function(s,o){if(Cd.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=t(a,s,i):e.push(s)}else e[o]=s}),e):Object.keys(n).reduce(function(s,o){var a=n[o];return s[o]=Cd.call(s,o)?t(s[o],a,i):a,s},r)}},nnt=Object.prototype.hasOwnProperty,Sb={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},Ts=Array.isArray,int=String.prototype.split,rnt=Array.prototype.push,IE=function(t,e){rnt.apply(t,Ts(e)?e:[e])},snt=Date.prototype.toISOString,Eb=Oo.default,wn={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:vr.encode,encodeValuesOnly:!1,format:Eb,formatter:Oo.formatters[Eb],indices:!1,serializeDate:function(t){return snt.call(t)},skipNulls:!1,strictNullHandling:!1},ont=function t(e,n,i,r,s,o,a,l,c,h,u,d,f,p){var g,v=e;if(typeof a=="function"?v=a(n,v):v instanceof Date?v=h(v):i==="comma"&&Ts(v)&&(v=vr.maybeMap(v,function(D){return D instanceof Date?h(D):D})),v===null){if(r)return o&&!f?o(n,wn.encoder,p,"key",u):n;v=""}if(typeof(g=v)=="string"||typeof g=="number"||typeof g=="boolean"||typeof g=="symbol"||typeof g=="bigint"||vr.isBuffer(v)){if(o){var x=f?n:o(n,wn.encoder,p,"key",u);if(i==="comma"&&f){for(var S=int.call(String(v),","),C="",P=0;P<S.length;++P)C+=(P===0?"":",")+d(o(S[P],wn.encoder,p,"value",u));return[d(x)+"="+C]}return[d(x)+"="+d(o(v,wn.encoder,p,"value",u))]}return[d(n)+"="+d(String(v))]}var k,N=[];if(v===void 0)return N;if(i==="comma"&&Ts(v))k=[{value:v.length>0?v.join(",")||null:void 0}];else if(Ts(a))k=a;else{var m=Object.keys(v);k=l?m.sort(l):m}for(var b=0;b<k.length;++b){var w=k[b],T=typeof w=="object"&&w.value!==void 0?w.value:v[w];if(!s||T!==null){var E=Ts(v)?typeof i=="function"?i(n,w):n:n+(c?"."+w:"["+w+"]");IE(N,t(T,E,i,r,s,o,a,l,c,h,u,d,f,p))}}return N},Df=Object.prototype.hasOwnProperty,ant=Array.isArray,bn={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:vr.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},lnt=function(t){return t.replace(/&#(\d+);/g,function(e,n){return String.fromCharCode(parseInt(n,10))})},kE=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},cnt=function(t,e,n,i){if(t){var r=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,s=/(\[[^[\]]*])/g,o=n.depth>0&&/(\[[^[\]]*])/.exec(r),a=o?r.slice(0,o.index):r,l=[];if(a){if(!n.plainObjects&&Df.call(Object.prototype,a)&&!n.allowPrototypes)return;l.push(a)}for(var c=0;n.depth>0&&(o=s.exec(r))!==null&&c<n.depth;){if(c+=1,!n.plainObjects&&Df.call(Object.prototype,o[1].slice(1,-1))&&!n.allowPrototypes)return;l.push(o[1])}return o&&l.push("["+r.slice(o.index)+"]"),function(h,u,d,f){for(var p=f?u:kE(u,d),g=h.length-1;g>=0;--g){var v,x=h[g];if(x==="[]"&&d.parseArrays)v=[].concat(p);else{v=d.plainObjects?Object.create(null):{};var S=x.charAt(0)==="["&&x.charAt(x.length-1)==="]"?x.slice(1,-1):x,C=parseInt(S,10);d.parseArrays||S!==""?!isNaN(C)&&x!==S&&String(C)===S&&C>=0&&d.parseArrays&&C<=d.arrayLimit?(v=[])[C]=p:S!=="__proto__"&&(v[S]=p):v={0:p}}p=v}return p}(l,e,n,i)}},unt=function(t,e){var n=function(c){if(!c)return bn;if(c.decoder!=null&&typeof c.decoder!="function")throw new TypeError("Decoder has to be a function.");if(c.charset!==void 0&&c.charset!=="utf-8"&&c.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");return{allowDots:c.allowDots===void 0?bn.allowDots:!!c.allowDots,allowPrototypes:typeof c.allowPrototypes=="boolean"?c.allowPrototypes:bn.allowPrototypes,arrayLimit:typeof c.arrayLimit=="number"?c.arrayLimit:bn.arrayLimit,charset:c.charset===void 0?bn.charset:c.charset,charsetSentinel:typeof c.charsetSentinel=="boolean"?c.charsetSentinel:bn.charsetSentinel,comma:typeof c.comma=="boolean"?c.comma:bn.comma,decoder:typeof c.decoder=="function"?c.decoder:bn.decoder,delimiter:typeof c.delimiter=="string"||vr.isRegExp(c.delimiter)?c.delimiter:bn.delimiter,depth:typeof c.depth=="number"||c.depth===!1?+c.depth:bn.depth,ignoreQueryPrefix:c.ignoreQueryPrefix===!0,interpretNumericEntities:typeof c.interpretNumericEntities=="boolean"?c.interpretNumericEntities:bn.interpretNumericEntities,parameterLimit:typeof c.parameterLimit=="number"?c.parameterLimit:bn.parameterLimit,parseArrays:c.parseArrays!==!1,plainObjects:typeof c.plainObjects=="boolean"?c.plainObjects:bn.plainObjects,strictNullHandling:typeof c.strictNullHandling=="boolean"?c.strictNullHandling:bn.strictNullHandling}}(e);if(t===""||t==null)return n.plainObjects?Object.create(null):{};for(var i=typeof t=="string"?function(c,h){var u,d={},f=(h.ignoreQueryPrefix?c.replace(/^\?/,""):c).split(h.delimiter,h.parameterLimit===1/0?void 0:h.parameterLimit),p=-1,g=h.charset;if(h.charsetSentinel)for(u=0;u<f.length;++u)f[u].indexOf("utf8=")===0&&(f[u]==="utf8=%E2%9C%93"?g="utf-8":f[u]==="utf8=%26%2310003%3B"&&(g="iso-8859-1"),p=u,u=f.length);for(u=0;u<f.length;++u)if(u!==p){var v,x,S=f[u],C=S.indexOf("]="),P=C===-1?S.indexOf("="):C+1;P===-1?(v=h.decoder(S,bn.decoder,g,"key"),x=h.strictNullHandling?null:""):(v=h.decoder(S.slice(0,P),bn.decoder,g,"key"),x=vr.maybeMap(kE(S.slice(P+1),h),function(k){return h.decoder(k,bn.decoder,g,"value")})),x&&h.interpretNumericEntities&&g==="iso-8859-1"&&(x=lnt(x)),S.indexOf("[]=")>-1&&(x=ant(x)?[x]:x),d[v]=Df.call(d,v)?vr.combine(d[v],x):x}return d}(t,n):t,r=n.plainObjects?Object.create(null):{},s=Object.keys(i),o=0;o<s.length;++o){var a=s[o],l=cnt(a,i[a],n,typeof t=="string");r=vr.merge(r,l,n)}return vr.compact(r)};class Pd{constructor(e,n,i){var r,s;this.name=e,this.definition=n,this.bindings=(r=n.bindings)!=null?r:{},this.wheres=(s=n.wheres)!=null?s:{},this.config=i}get template(){const e=`${this.origin}/${this.definition.uri}`.replace(/\/+$/,"");return e===""?"/":e}get origin(){return this.config.absolute?this.definition.domain?`${this.config.url.match(/^\w+:\/\//)[0]}${this.definition.domain}${this.config.port?`:${this.config.port}`:""}`:this.config.url:""}get parameterSegments(){var e,n;return(e=(n=this.template.match(/{[^}?]+\??}/g))==null?void 0:n.map(i=>({name:i.replace(/{|\??}/g,""),required:!/\?}$/.test(i)})))!=null?e:[]}matchesUrl(e){if(!this.definition.methods.includes("GET"))return!1;const n=this.template.replace(/(\/?){([^}?]*)(\??)}/g,(o,a,l,c)=>{var h;const u=`(?<${l}>${((h=this.wheres[l])==null?void 0:h.replace(/(^\^)|(\$$)/g,""))||"[^/?]+"})`;return c?`(${a}${u})?`:`${a}${u}`}).replace(/^\w+:\/\//,""),[i,r]=e.replace(/^\w+:\/\//,"").split("?"),s=new RegExp(`^${n}/?$`).exec(decodeURI(i));if(s){for(const o in s.groups)s.groups[o]=typeof s.groups[o]=="string"?decodeURIComponent(s.groups[o]):s.groups[o];return{params:s.groups,query:unt(r)}}return!1}compile(e){return this.parameterSegments.length?this.template.replace(/{([^}?]+)(\??)}/g,(n,i,r)=>{var s,o;if(!r&&[null,void 0].includes(e[i]))throw new Error(`Ziggy error: '${i}' parameter is required for route '${this.name}'.`);if(this.wheres[i]&&!new RegExp(`^${r?`(${this.wheres[i]})?`:this.wheres[i]}$`).test((o=e[i])!=null?o:""))throw new Error(`Ziggy error: '${i}' parameter '${e[i]}' does not match required format '${this.wheres[i]}' for route '${this.name}'.`);return encodeURI((s=e[i])!=null?s:"").replace(/%7C/g,"|").replace(/%25/g,"%").replace(/\$/g,"%24")}).replace(this.config.absolute?/(\.[^/]+?)(\/\/)/:/(^)(\/\/)/,"$1/").replace(/\/+$/,""):this.template}}class hnt extends String{constructor(e,n,i=!0,r){if(super(),this.t=r??(typeof Ziggy<"u"?Ziggy:globalThis==null?void 0:globalThis.Ziggy),this.t=ti({},this.t,{absolute:i}),e){if(!this.t.routes[e])throw new Error(`Ziggy error: route '${e}' is not in the route list.`);this.i=new Pd(e,this.t.routes[e],this.t),this.u=this.l(n)}}toString(){const e=Object.keys(this.u).filter(n=>!this.i.parameterSegments.some(({name:i})=>i===n)).filter(n=>n!=="_query").reduce((n,i)=>ti({},n,{[i]:this.u[i]}),{});return this.i.compile(this.u)+function(n,i){var r,s=n,o=function(f){if(!f)return wn;if(f.encoder!=null&&typeof f.encoder!="function")throw new TypeError("Encoder has to be a function.");var p=f.charset||wn.charset;if(f.charset!==void 0&&f.charset!=="utf-8"&&f.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var g=Oo.default;if(f.format!==void 0){if(!nnt.call(Oo.formatters,f.format))throw new TypeError("Unknown format option provided.");g=f.format}var v=Oo.formatters[g],x=wn.filter;return(typeof f.filter=="function"||Ts(f.filter))&&(x=f.filter),{addQueryPrefix:typeof f.addQueryPrefix=="boolean"?f.addQueryPrefix:wn.addQueryPrefix,allowDots:f.allowDots===void 0?wn.allowDots:!!f.allowDots,charset:p,charsetSentinel:typeof f.charsetSentinel=="boolean"?f.charsetSentinel:wn.charsetSentinel,delimiter:f.delimiter===void 0?wn.delimiter:f.delimiter,encode:typeof f.encode=="boolean"?f.encode:wn.encode,encoder:typeof f.encoder=="function"?f.encoder:wn.encoder,encodeValuesOnly:typeof f.encodeValuesOnly=="boolean"?f.encodeValuesOnly:wn.encodeValuesOnly,filter:x,format:g,formatter:v,serializeDate:typeof f.serializeDate=="function"?f.serializeDate:wn.serializeDate,skipNulls:typeof f.skipNulls=="boolean"?f.skipNulls:wn.skipNulls,sort:typeof f.sort=="function"?f.sort:null,strictNullHandling:typeof f.strictNullHandling=="boolean"?f.strictNullHandling:wn.strictNullHandling}}(i);typeof o.filter=="function"?s=(0,o.filter)("",s):Ts(o.filter)&&(r=o.filter);var a=[];if(typeof s!="object"||s===null)return"";var l=Sb[i&&i.arrayFormat in Sb?i.arrayFormat:i&&"indices"in i?i.indices?"indices":"repeat":"indices"];r||(r=Object.keys(s)),o.sort&&r.sort(o.sort);for(var c=0;c<r.length;++c){var h=r[c];o.skipNulls&&s[h]===null||IE(a,ont(s[h],h,l,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset))}var u=a.join(o.delimiter),d=o.addQueryPrefix===!0?"?":"";return o.charsetSentinel&&(d+=o.charset==="iso-8859-1"?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),u.length>0?d+u:""}(ti({},e,this.u._query),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:(n,i)=>typeof n=="boolean"?Number(n):i(n)})}p(e){e?this.t.absolute&&e.startsWith("/")&&(e=this.h().host+e):e=this.v();let n={};const[i,r]=Object.entries(this.t.routes).find(([s,o])=>n=new Pd(s,o,this.t).matchesUrl(e))||[void 0,void 0];return ti({name:i},n,{route:r})}v(){const{host:e,pathname:n,search:i}=this.h();return(this.t.absolute?e+n:n.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"))+i}current(e,n){const{name:i,params:r,query:s,route:o}=this.p();if(!e)return i;const a=new RegExp(`^${e.replace(/\./g,"\\.").replace(/\*/g,".*")}$`).test(i);if([null,void 0].includes(n)||!a)return a;const l=new Pd(i,o,this.t);n=this.l(n,l);const c=ti({},r,s);if(Object.values(n).every(u=>!u)&&!Object.values(c).some(u=>u!==void 0))return!0;const h=(u,d)=>Object.entries(u).every(([f,p])=>Array.isArray(p)&&Array.isArray(d[f])?p.every(g=>d[f].includes(g)):typeof p=="object"&&typeof d[f]=="object"&&p!==null&&d[f]!==null?h(p,d[f]):d[f]==p);return h(n,c)}h(){var e,n,i,r,s,o;const{host:a="",pathname:l="",search:c=""}=typeof window<"u"?window.location:{};return{host:(e=(n=this.t.location)==null?void 0:n.host)!=null?e:a,pathname:(i=(r=this.t.location)==null?void 0:r.pathname)!=null?i:l,search:(s=(o=this.t.location)==null?void 0:o.search)!=null?s:c}}get params(){const{params:e,query:n}=this.p();return ti({},e,n)}has(e){return Object.keys(this.t.routes).includes(e)}l(e={},n=this.i){e!=null||(e={}),e=["string","number"].includes(typeof e)?[e]:e;const i=n.parameterSegments.filter(({name:r})=>!this.t.defaults[r]);return Array.isArray(e)?e=e.reduce((r,s,o)=>ti({},r,i[o]?{[i[o].name]:s}:typeof s=="object"?s:{[s]:""}),{}):i.length!==1||e[i[0].name]||!e.hasOwnProperty(Object.values(n.bindings)[0])&&!e.hasOwnProperty("id")||(e={[i[0].name]:e}),ti({},this.m(n),this.j(e,n))}m(e){return e.parameterSegments.filter(({name:n})=>this.t.defaults[n]).reduce((n,{name:i},r)=>ti({},n,{[i]:this.t.defaults[i]}),{})}j(e,{bindings:n,parameterSegments:i}){return Object.entries(e).reduce((r,[s,o])=>{if(!o||typeof o!="object"||Array.isArray(o)||!i.some(({name:a})=>a===s))return ti({},r,{[s]:o});if(!o.hasOwnProperty(n[s])){if(!o.hasOwnProperty("id"))throw new Error(`Ziggy error: object passed as '${s}' parameter is missing route model binding key '${n[s]}'.`);n[s]="id"}return ti({},r,{[s]:o[n[s]]})},{})}valueOf(){return this.toString()}}function dnt(t,e,n,i){const r=new hnt(t,e,n,i);return t?r.toString():r}const fnt={install(t,e){const n=(i,r,s,o=e)=>dnt(i,r,s,o);parseInt(t.version)>2?(t.config.globalProperties.route=n,t.provide("route",n)):t.mixin({methods:{route:n}})}};jE({title:t=>`${t}`,resolve:t=>Qet(`./Pages/${t}.vue`,Object.assign({"./Pages/API/Index.vue":()=>Zt(()=>import("./Index-5a6a7542.js"),["assets/Index-5a6a7542.js","assets/ApiTokenManager-f6cdb698.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/Button-03e53c17.js","assets/ConfirmationModal-0f0d9123.js","assets/Modal-706df429.js","assets/DangerButton-32bddeba.js","assets/DialogModal-78d0db93.js","assets/FormSection-d7ad6841.js","assets/Input-d5846cb4.js","assets/Checkbox-06b54ec2.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js","assets/AppLayout-b8de6d51.js","assets/BaseLayout-71b4d9d7.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/ValidationErrors-ccdf439b.js","assets/Banner-82979b90.js","assets/BaseMenu-cb81a806.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/_baseFlatten-e5cb9b58.js","assets/NavbarUserDropdown-37f0b991.js","assets/use-current-team-2a8bf787.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js"]),"./Pages/API/Partials/ApiTokenManager.vue":()=>Zt(()=>import("./ApiTokenManager-f6cdb698.js"),["assets/ApiTokenManager-f6cdb698.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/Button-03e53c17.js","assets/ConfirmationModal-0f0d9123.js","assets/Modal-706df429.js","assets/DangerButton-32bddeba.js","assets/DialogModal-78d0db93.js","assets/FormSection-d7ad6841.js","assets/Input-d5846cb4.js","assets/Checkbox-06b54ec2.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js"]),"./Pages/Auth/ConfirmPassword.vue":()=>Zt(()=>import("./ConfirmPassword-79963567.js"),["assets/ConfirmPassword-79963567.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCard-e906a4e2.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js"]),"./Pages/Auth/ForgotPassword.vue":()=>Zt(()=>import("./ForgotPassword-7b10321e.js"),["assets/ForgotPassword-7b10321e.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCard-e906a4e2.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js"]),"./Pages/Auth/Login.vue":()=>Zt(()=>import("./Login-9e6cccbb.js"),["assets/Login-9e6cccbb.js","assets/index.esm-4dcaccf3.js","assets/Button-03e53c17.js","assets/BaseInput-fcb7e685.js","assets/Input-d5846cb4.js","assets/BaseFieldErrors-601b2e42.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/Checkbox-06b54ec2.js","assets/Label-43647b22.js","assets/TwoPaneLayout-c44c13e3.js","assets/Banner-82979b90.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseAlert-a328c715.js"]),"./Pages/Auth/Register.vue":()=>Zt(()=>import("./Register-bb0581a8.js"),["assets/Register-bb0581a8.js","assets/index.esm-4dcaccf3.js","assets/Button-03e53c17.js","assets/BaseInput-fcb7e685.js","assets/Input-d5846cb4.js","assets/BaseFieldErrors-601b2e42.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/Checkbox-06b54ec2.js","assets/Label-43647b22.js","assets/TwoPaneLayout-c44c13e3.js","assets/Banner-82979b90.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseAlert-a328c715.js","assets/InputError-5bc69726.js"]),"./Pages/Auth/ResetPassword.vue":()=>Zt(()=>import("./ResetPassword-41cf2a49.js"),["assets/ResetPassword-41cf2a49.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCard-e906a4e2.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js"]),"./Pages/Auth/TwoFactorChallenge.vue":()=>Zt(()=>import("./TwoFactorChallenge-c8aa577d.js"),["assets/TwoFactorChallenge-c8aa577d.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCard-e906a4e2.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js"]),"./Pages/Auth/VerifyEmail.vue":()=>Zt(()=>import("./VerifyEmail-9eaa5db5.js"),["assets/VerifyEmail-9eaa5db5.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCard-e906a4e2.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-03e53c17.js"]),"./Pages/Dashboard.vue":()=>Zt(()=>import("./Dashboard-6f8a5d71.js"),["assets/Dashboard-6f8a5d71.js","assets/AppLayout-b8de6d51.js","assets/BaseLayout-71b4d9d7.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-82979b90.js","assets/BaseMenu-cb81a806.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/_baseFlatten-e5cb9b58.js","assets/NavbarUserDropdown-37f0b991.js","assets/use-current-team-2a8bf787.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js"]),"./Pages/Diagrams/DiagramsIndex.vue":()=>Zt(()=>import("./DiagramsIndex-e196c977.js"),["assets/DiagramsIndex-e196c977.js","assets/AppLayout-b8de6d51.js","assets/BaseLayout-71b4d9d7.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-82979b90.js","assets/BaseMenu-cb81a806.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/_baseFlatten-e5cb9b58.js","assets/NavbarUserDropdown-37f0b991.js","assets/use-current-team-2a8bf787.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js","assets/BaseSpinner-45530dc1.js","assets/BasePopover-22de608c.js","assets/use-team-in-url-78771335.js","assets/use-blueprint-driver-transforms-5a947102.js","assets/BaseListboxDataDriven-0da3894d.js","assets/form-a9b2eced.js","assets/BaseInput-fcb7e685.js","assets/statamic-urls-e4aac463.js","assets/DiagramsIndex-66042de6.css"]),"./Pages/FirstTeams/FirstTeamsCreate.vue":()=>Zt(()=>import("./FirstTeamsCreate-65165f6a.js"),["assets/FirstTeamsCreate-65165f6a.js","assets/index.esm-4dcaccf3.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/TwoPaneLayout-c44c13e3.js","assets/Banner-82979b90.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css"]),"./Pages/PrivacyPolicy.vue":()=>Zt(()=>import("./PrivacyPolicy-7bb498b9.js"),["assets/PrivacyPolicy-7bb498b9.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css"]),"./Pages/Profile/Partials/DeleteUserForm.vue":()=>Zt(()=>import("./DeleteUserForm-8b755f12.js"),["assets/DeleteUserForm-8b755f12.js","assets/index.esm-4dcaccf3.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/DialogModal-78d0db93.js","assets/Modal-706df429.js","assets/DangerButton-32bddeba.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/SecondaryButton-603e6d8d.js"]),"./Pages/Profile/Partials/LogoutOtherBrowserSessionsForm.vue":()=>Zt(()=>import("./LogoutOtherBrowserSessionsForm-d7911b77.js"),["assets/LogoutOtherBrowserSessionsForm-d7911b77.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/Button-03e53c17.js","assets/DialogModal-78d0db93.js","assets/Modal-706df429.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/SecondaryButton-603e6d8d.js"]),"./Pages/Profile/Partials/TwoFactorAuthenticationForm.vue":()=>Zt(()=>import("./TwoFactorAuthenticationForm-801276db.js"),["assets/TwoFactorAuthenticationForm-801276db.js","assets/index.esm-4dcaccf3.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/Button-03e53c17.js","assets/DialogModal-78d0db93.js","assets/Modal-706df429.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/SecondaryButton-603e6d8d.js","assets/DangerButton-32bddeba.js","assets/Label-43647b22.js"]),"./Pages/Profile/Partials/UpdatePasswordForm.vue":()=>Zt(()=>import("./UpdatePasswordForm-6ad6d449.js"),["assets/UpdatePasswordForm-6ad6d449.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-03e53c17.js","assets/FormSection-d7ad6841.js","assets/SectionTitle-b985e920.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js"]),"./Pages/Profile/Partials/UpdateProfileInformationForm.vue":()=>Zt(()=>import("./UpdateProfileInformationForm-da8ef524.js"),["assets/UpdateProfileInformationForm-da8ef524.js","assets/index.esm-4dcaccf3.js","assets/Button-03e53c17.js","assets/FormSection-d7ad6841.js","assets/SectionTitle-b985e920.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/SecondaryButton-603e6d8d.js"]),"./Pages/Profile/Show.vue":()=>Zt(()=>import("./Show-c602af22.js"),["assets/Show-c602af22.js","assets/AppLayout-b8de6d51.js","assets/BaseLayout-71b4d9d7.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-82979b90.js","assets/BaseMenu-cb81a806.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/_baseFlatten-e5cb9b58.js","assets/NavbarUserDropdown-37f0b991.js","assets/use-current-team-2a8bf787.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js","assets/DeleteUserForm-8b755f12.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/DialogModal-78d0db93.js","assets/Modal-706df429.js","assets/DangerButton-32bddeba.js","assets/InputError-5bc69726.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js","assets/LogoutOtherBrowserSessionsForm-d7911b77.js","assets/TwoFactorAuthenticationForm-801276db.js","assets/UpdatePasswordForm-6ad6d449.js","assets/FormSection-d7ad6841.js","assets/UpdateProfileInformationForm-da8ef524.js"]),"./Pages/SandboxShow.vue":()=>Zt(()=>import("./SandboxShow-4d1d9796.js"),["assets/SandboxShow-4d1d9796.js","assets/joint-plus-2422b6af.js","assets/index.esm-4dcaccf3.js","assets/headlessui-float-afd6f717.js","assets/BaseButtonSolid-7d99f2a9.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/_baseFlatten-e5cb9b58.js","assets/combobox-ddd1a678.js","assets/form-a9b2eced.js","assets/joint-plus-a18d037f.css","assets/BasePopover-22de608c.js","assets/SandboxShow-b636d36a.css"]),"./Pages/TeamDiagramClones/TeamDiagramClonesShow.vue":()=>Zt(()=>import("./TeamDiagramClonesShow-b4d52b19.js"),["assets/TeamDiagramClonesShow-b4d52b19.js","assets/BaseLayout-71b4d9d7.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-82979b90.js","assets/use-blueprint-driver-transforms-5a947102.js","assets/BaseSpinner-45530dc1.js","assets/use-current-team-2a8bf787.js","assets/BaseCardStatus-bedfa41d.js","assets/role-permissions-feb7b1ca.js"]),"./Pages/TeamDiagramEmbeds/TeamDiagramEmbedsShow.vue":()=>Zt(()=>import("./TeamDiagramEmbedsShow-555313b4.js"),["assets/TeamDiagramEmbedsShow-555313b4.js","assets/Editor-eb89fe0f.js","assets/BaseLayout-71b4d9d7.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-82979b90.js","assets/BasePopover-22de608c.js","assets/headlessui-float-afd6f717.js","assets/vue-resize.esm-903d13a9.js","assets/vue-resize-ed4cdaec.css","assets/use-team-in-url-78771335.js","assets/BaseSpinner-45530dc1.js","assets/BaseListboxDataDriven-0da3894d.js","assets/form-a9b2eced.js","assets/use-text-value-460f9583.js","assets/joint-plus-2422b6af.js","assets/_baseFlatten-e5cb9b58.js","assets/combobox-ddd1a678.js","assets/joint-plus-a18d037f.css","assets/Checkbox-06b54ec2.js","assets/BaseInput-fcb7e685.js","assets/BaseMenu-cb81a806.js","assets/BaseButtonSecondary-80093306.js","assets/Editor-07a587b0.css","assets/BaseHead-46c51054.js"]),"./Pages/TeamDiagramPreviews/TeamDiagramPreviewsShow.vue":()=>Zt(()=>import("./TeamDiagramPreviewsShow-aacae108.js"),["assets/TeamDiagramPreviewsShow-aacae108.js","assets/Editor-eb89fe0f.js","assets/BaseLayout-71b4d9d7.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-82979b90.js","assets/BasePopover-22de608c.js","assets/headlessui-float-afd6f717.js","assets/vue-resize.esm-903d13a9.js","assets/vue-resize-ed4cdaec.css","assets/use-team-in-url-78771335.js","assets/BaseSpinner-45530dc1.js","assets/BaseListboxDataDriven-0da3894d.js","assets/form-a9b2eced.js","assets/use-text-value-460f9583.js","assets/joint-plus-2422b6af.js","assets/_baseFlatten-e5cb9b58.js","assets/combobox-ddd1a678.js","assets/joint-plus-a18d037f.css","assets/Checkbox-06b54ec2.js","assets/BaseInput-fcb7e685.js","assets/BaseMenu-cb81a806.js","assets/BaseButtonSecondary-80093306.js","assets/Editor-07a587b0.css"]),"./Pages/TeamDiagramVersions/TeamDiagramVersionsShow.vue":()=>Zt(()=>import("./TeamDiagramVersionsShow-e61d7c86.js"),["assets/TeamDiagramVersionsShow-e61d7c86.js","assets/Editor-eb89fe0f.js","assets/BaseLayout-71b4d9d7.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-82979b90.js","assets/BasePopover-22de608c.js","assets/headlessui-float-afd6f717.js","assets/vue-resize.esm-903d13a9.js","assets/vue-resize-ed4cdaec.css","assets/use-team-in-url-78771335.js","assets/BaseSpinner-45530dc1.js","assets/BaseListboxDataDriven-0da3894d.js","assets/form-a9b2eced.js","assets/use-text-value-460f9583.js","assets/joint-plus-2422b6af.js","assets/_baseFlatten-e5cb9b58.js","assets/combobox-ddd1a678.js","assets/joint-plus-a18d037f.css","assets/Checkbox-06b54ec2.js","assets/BaseInput-fcb7e685.js","assets/BaseMenu-cb81a806.js","assets/BaseButtonSecondary-80093306.js","assets/Editor-07a587b0.css","assets/BaseHead-46c51054.js"]),"./Pages/TeamDiagrams/TeamDiagramsShow.vue":()=>Zt(()=>import("./TeamDiagramsShow-71b5a1ba.js"),["assets/TeamDiagramsShow-71b5a1ba.js","assets/Editor-eb89fe0f.js","assets/BaseLayout-71b4d9d7.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-82979b90.js","assets/BasePopover-22de608c.js","assets/headlessui-float-afd6f717.js","assets/vue-resize.esm-903d13a9.js","assets/vue-resize-ed4cdaec.css","assets/use-team-in-url-78771335.js","assets/BaseSpinner-45530dc1.js","assets/BaseListboxDataDriven-0da3894d.js","assets/form-a9b2eced.js","assets/use-text-value-460f9583.js","assets/joint-plus-2422b6af.js","assets/_baseFlatten-e5cb9b58.js","assets/combobox-ddd1a678.js","assets/joint-plus-a18d037f.css","assets/Checkbox-06b54ec2.js","assets/BaseInput-fcb7e685.js","assets/BaseMenu-cb81a806.js","assets/BaseButtonSecondary-80093306.js","assets/Editor-07a587b0.css","assets/BaseHead-46c51054.js","assets/statamic-urls-e4aac463.js","assets/BaseCardStatus-bedfa41d.js","assets/BaseAlertError-5c13e689.js","assets/use-blueprint-driver-transforms-5a947102.js","assets/use-current-team-2a8bf787.js","assets/NavbarUserDropdown-37f0b991.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/ComboboxTeamMembershipsAndGroups-b391c683.js","assets/LabelGuest-94fd857d.js","assets/TeamDiagramsShow-6abd1298.css"]),"./Pages/TeamMemberships/TeamMembershipsShow.vue":()=>Zt(()=>import("./TeamMembershipsShow-0a7db618.js"),["assets/TeamMembershipsShow-0a7db618.js","assets/index.esm-4dcaccf3.js","assets/AppLayout-b8de6d51.js","assets/BaseLayout-71b4d9d7.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-82979b90.js","assets/BaseMenu-cb81a806.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/_baseFlatten-e5cb9b58.js","assets/NavbarUserDropdown-37f0b991.js","assets/use-current-team-2a8bf787.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js","assets/TeamMemberManager-4605d230.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/ConfirmationModal-0f0d9123.js","assets/Modal-706df429.js","assets/DangerButton-32bddeba.js","assets/DialogModal-78d0db93.js","assets/FormSection-d7ad6841.js","assets/InputError-5bc69726.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js","assets/AlertFreePlan-45864c1b.js","assets/BaseAlert-a328c715.js","assets/TeamMemberOrGroupTabs-0d1385df.js","assets/TeamGroupManager-1ca60fd4.js","assets/BaseListboxDataDriven-0da3894d.js","assets/form-a9b2eced.js","assets/ComboboxTeamMembershipsAndGroups-b391c683.js","assets/combobox-ddd1a678.js","assets/BaseButtonSecondary-80093306.js","assets/BaseInput-fcb7e685.js","assets/BaseSpinner-45530dc1.js","assets/TeamGuestUserManager-e175cbc2.js"]),"./Pages/Teams/Create.vue":()=>Zt(()=>import("./Create-f3baff5e.js"),["assets/Create-f3baff5e.js","assets/AppLayout-b8de6d51.js","assets/BaseLayout-71b4d9d7.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-82979b90.js","assets/BaseMenu-cb81a806.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/_baseFlatten-e5cb9b58.js","assets/NavbarUserDropdown-37f0b991.js","assets/use-current-team-2a8bf787.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js","assets/CreateTeamForm-55e7c020.js","assets/FormSection-d7ad6841.js","assets/SectionTitle-b985e920.js","assets/InputError-5bc69726.js"]),"./Pages/Teams/Partials/CreateTeamForm.vue":()=>Zt(()=>import("./CreateTeamForm-55e7c020.js"),["assets/CreateTeamForm-55e7c020.js","assets/index.esm-4dcaccf3.js","assets/Button-03e53c17.js","assets/FormSection-d7ad6841.js","assets/SectionTitle-b985e920.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js"]),"./Pages/Teams/Partials/DeleteTeamForm.vue":()=>Zt(()=>import("./DeleteTeamForm-865cccfd.js"),["assets/DeleteTeamForm-865cccfd.js","assets/index.esm-4dcaccf3.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/ConfirmationModal-0f0d9123.js","assets/Modal-706df429.js","assets/DangerButton-32bddeba.js","assets/SecondaryButton-603e6d8d.js"]),"./Pages/Teams/Partials/TeamGroupManager.vue":()=>Zt(()=>import("./TeamGroupManager-1ca60fd4.js"),["assets/TeamGroupManager-1ca60fd4.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/Button-03e53c17.js","assets/FormSection-d7ad6841.js","assets/Label-43647b22.js","assets/SectionBorder-7a20332b.js","assets/BaseListboxDataDriven-0da3894d.js","assets/BaseButtonSolid-7d99f2a9.js","assets/headlessui-float-afd6f717.js","assets/form-a9b2eced.js","assets/use-text-value-460f9583.js","assets/ComboboxTeamMembershipsAndGroups-b391c683.js","assets/combobox-ddd1a678.js","assets/BaseModal-90243189.js","assets/BaseButtonSecondary-80093306.js","assets/BaseInput-fcb7e685.js","assets/Input-d5846cb4.js","assets/BaseFieldErrors-601b2e42.js","assets/use-current-team-2a8bf787.js","assets/BaseSpinner-45530dc1.js","assets/ConfirmationModal-0f0d9123.js","assets/Modal-706df429.js"]),"./Pages/Teams/Partials/TeamGuestUserManager.vue":()=>Zt(()=>import("./TeamGuestUserManager-e175cbc2.js"),["assets/TeamGuestUserManager-e175cbc2.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/LabelGuest-94fd857d.js"]),"./Pages/Teams/Partials/TeamMemberManager.vue":()=>Zt(()=>import("./TeamMemberManager-4605d230.js"),["assets/TeamMemberManager-4605d230.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/Button-03e53c17.js","assets/ConfirmationModal-0f0d9123.js","assets/Modal-706df429.js","assets/DangerButton-32bddeba.js","assets/DialogModal-78d0db93.js","assets/FormSection-d7ad6841.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js"]),"./Pages/Teams/Partials/TeamMemberOrGroupTabs.vue":()=>Zt(()=>import("./TeamMemberOrGroupTabs-0d1385df.js"),["assets/TeamMemberOrGroupTabs-0d1385df.js","assets/index.esm-4dcaccf3.js"]),"./Pages/Teams/Partials/UpdateTeamNameForm.vue":()=>Zt(()=>import("./UpdateTeamNameForm-a7c6ddc4.js"),["assets/UpdateTeamNameForm-a7c6ddc4.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-03e53c17.js","assets/FormSection-d7ad6841.js","assets/SectionTitle-b985e920.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/SecondaryButton-603e6d8d.js"]),"./Pages/Teams/Show.vue":()=>Zt(()=>import("./Show-2041b960.js"),["assets/Show-2041b960.js","assets/AppLayout-b8de6d51.js","assets/BaseLayout-71b4d9d7.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-03e53c17.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-82979b90.js","assets/BaseMenu-cb81a806.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/_baseFlatten-e5cb9b58.js","assets/NavbarUserDropdown-37f0b991.js","assets/use-current-team-2a8bf787.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js","assets/DeleteTeamForm-865cccfd.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/ConfirmationModal-0f0d9123.js","assets/Modal-706df429.js","assets/DangerButton-32bddeba.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js","assets/UpdateTeamNameForm-a7c6ddc4.js","assets/FormSection-d7ad6841.js","assets/InputError-5bc69726.js","assets/AlertFreePlan-45864c1b.js","assets/BaseAlert-a328c715.js"]),"./Pages/TermsOfService.vue":()=>Zt(()=>import("./TermsOfService-302b5532.js"),["assets/TermsOfService-302b5532.js","assets/index.esm-4dcaccf3.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css"]),"./Pages/Welcome.vue":()=>Zt(()=>import("./Welcome-d4754900.js"),["assets/Welcome-d4754900.js","assets/index.esm-4dcaccf3.js"])})),setup({el:t,App:e,props:n,plugin:i}){const r=n.initialPage.props,s=r.appEnv==="production"?"5e6ccd208487d71e0c6584a192bbfc01":"b62074847b1530362bc463c118af0194",o=r!=null&&r.auth.user?r==null?void 0:r.auth.user.id:null,a=rT(),l=YE({render:()=>XE(e,n)}).use(a).use(i).use(fnt,Ziggy).use(Jet,{apiKey:s,userId:o,config:{includeReferrer:!0,includeUtm:!0}}),c=uT();l.provide("emitter",c),l.use(Wt),Wt.$emitter=c,a.use(({store:h})=>{h.$emitter=c}),(r==null?void 0:r.appEnv)!=="local"&&(r==null?void 0:r.appEnv)!=="testing"&&Xet({vueApp:l,dsn:"https://122e9a3f8f63486bab36d5da8bb72d9e@o167571.ingest.sentry.io/1273092",environment:r==null?void 0:r.appEnv,trackComponents:!0}),l.mount(t)},progress:{color:"#00e5b7"}});window.Cypress&&(window.$store=Wt);WE.on("navigate",t=>{t.detail.page.props.auth.user?($crisp.push(["set","user:email",t.detail.page.props.auth.user.email]),$crisp.push(["set","user:nickname",t.detail.page.props.auth.user.name])):$crisp.push(["do","session:reset"])});export{gH as $,Ls as A,TY as B,Ji as C,mX as D,ON as E,WV as F,EV as G,_e as H,Gc as I,Cnt as J,nn as K,gt as L,Z as M,gs as N,Cy as O,M as P,xg as Q,dd as R,Qi as S,as as T,ED as U,L as V,Cl as W,V8 as X,BW as Y,tr as Z,kH as _,DX as a,dS as a0,DW as a1,bH as a2,cp as a3,eH as a4,EH as a5,E8 as a6,xnt as a7,en as a8,fi as a9,AU as aa,Ui as ab,H5 as ac,pu as ad,ll as ae,M_ as af,vnt as ag,Hs as ah,JW as ai,K8 as aj,VH as ak,cl as al,Int as am,bR as an,H0 as ao,Tl as ap,rs as aq,WH as ar,_S as as,_l as at,Du as au,fh as b,p8 as c,er as d,Tnt as e,$t as f,Pnt as g,bt as h,i1 as i,S1 as j,Ont as k,ce as l,knt as m,at as n,Ant as o,pn as p,Wr as q,EY as r,Wt as s,SX as t,wnt as u,Yi as v,q0 as w,mS as x,An as y,r1 as z};
